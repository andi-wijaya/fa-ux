$.fn.extend({autocomplete:function(b){var e=$.val("class",b,{d:""});var a=$.val("name",b,{d:""});var g=$.val("src",b,{d:""});var d=$.val("width",b);var f=$.val("placeholder",b,{d:""});var c={};if(d!=null){c.width=d}this.each(function(){var i=this;var h=[];h.push("<input type='text' placeholder=\""+f+'"/>');h.push("<span class='icon fa fa-search hoverable selectable'></span>");h.push("<span class='popup'></span>");$(i).addClass("autocomplete");$(i).addClass(e);$(i).html(h.join(""));$(i).css(c);$(i).attr("data-name",a);$(i).attr("data-type","autocomplete");$(i).data("options",b);$("input[type='text']",i).on("keyup",function(m){var l=$(this).closest(".autocomplete");if($(l).hasClass("readonly")){return}var k=$(l).data("options");var j=$.val("readonly",k);if(!j&&g.length>0){var n={};n.key=this.value;$.api_get(g,n,function(o){var t=$.val("data",o);var q=[];if($.type(t)=="array"){for(var p=0;p<t.length;p++){var r=t[p];var s=$.val("value",r,{d:""});var u=$.val("text",r,{d:s});q.push("<div class='item' data-value=\""+s+'">');q.push("<label>"+u+"</label>");q.push("</div>")}}$(".popup",l).html(q.join(""));$(".item",$(".popup",l)).on("click",function(){var w=this.getAttribute("data-value");var y=$("label",this).text();var x={value:w,text:y};$(l).autocomplete_val(x,true)});$.popup_open($(".popup",l),l,{min_width:$(l).outerWidth()})})}})})},autocomplete_val:function(c,a){if(typeof c=="undefined"){var b=[];$(this).each(function(){var f=$(this).data("options");var d=$.val("multiple",f,{d:false});if(d){$(".text",this).each(function(){b.push(this.getAttribute("data-value"))})}else{var g=$("input",this).val();var e=$(this).data("value");if(e==null){e=g}b.push(e)}});return b.join(",")}else{$(this).each(function(){var j=$(this).data("options");var f=$.val("multiple",j,{d:false});var l=b="";if($.type(c)=="object"){b=$.val("value",c,{d:""});l=$.val("text",c,{d:b})}else{l=b=c}if(f){var e=typeof a!="undefined"&&a===true?true:false;if(!e==true){$(".text",this).remove()}var d=$(this).val();b=b.split(",");l=l.split(",");for(var k=0;k<b.length;k++){var h=b[k];var g=typeof l[k]!="undefined"?l[k]:h;if(!$.in_array(h,d)&&h!==""){$("<span class='text' data-value=\""+h+'">'+g+"<span class='icon-remove glyphicons glyphicons-remove'></span></span>").insertBefore($("input",this));$(".glyphicons-remove",$("input",this).prev()).on("click",function(){$(this).parent().remove()})}}$("input",this).val("")}else{$("input",this).val(l);$(this).data("value",b)}})}},autocomplete_readonly:function(a){if(typeof a=="undefined"){return $(this).hasClass("readonly")?true:false}else{if(a){$(this).addClass("readonly");$("input",this).attr("readonly",true);$("input",this).data("placeholder",$("input",this).attr("placeholder"));$("input",this).attr("placeholder","")}else{$(this).removeClass("readonly");$("input",this).attr("readonly",false);$("input",this).attr("placeholder",$("input",this).data("placeholder"))}}},autocomplete_reset:function(){$(this).autocomplete_val("",true)}});$.fn.extend({calendar:function(a){this.each(function(){var c=this;var d=$.val("value",a,{d:"2017-01-01"});d=$.date("j M Y",$.strtotime(d));var b=[];b.push("<input type='text' value='"+d+"' readonly/>");b.push("<span class='icon fa fa-calendar'></span>");b.push("<span class='popup'>Calendar</span>");$(c).addClass("calendar");$(c).html(b.join(""));$(c).attr("data-type","calendar");$(".icon",this).click(function(f){f.preventDefault();f.stopPropagation()});$(".popup",this).click(function(f){f.preventDefault();f.stopPropagation()})})}});$.extend({calendar_open:function(d){var b=d.refEl;var c=d.value;var a=$("#calendar");if(a.length==0){a=document.createElement("div");a.id="calendar";a.className="popup";document.body.appendChild(a);a=$("#calendar")}a=a[0];$(a).data("params",d);$.calendar_set(c);$.popup_open(a,b)},calendar_set:function(b){var c=$("#calendar").data("params");var a=$.val("type",c,{d:""});switch(a){case"range":$.calendar_set_range(b);break;default:$.calendar_set_single(b);break}},calendar_set_single:function(n){var a=$("#calendar");$(a).attr("data-value",n);var l=$.date("n",$.strtotime(n));var m=$.date("Y",$.strtotime(n));var c=$.date("j",$.strtotime(n));var k=$.start_day_of_month(m,l)%7;var o=$.last_date_of_month(m,l);var p=$.date("M Y",$.strtotime(n));var e=$(a).data("params");var d=e.onchange;var h=[];h.push("<table>");h.push("<tr>");h.push("<td><span class='calendar-prev fa fa-caret-left padding5'></span></td>");h.push("<td colspan='5'><span class='date-label'>"+p+"</span></td>");h.push("<td><span class='calendar-next fa fa-caret-right padding5'></span></td>");h.push("</tr>");h.push("<tr>");h.push("<td>Sun</td>");h.push("<td>Mon</td>");h.push("<td>Tue</td>");h.push("<td>Wed</td>");h.push("<td>Thu</td>");h.push("<td>Fri</td>");h.push("<td>Sun</td>");h.push("</tr>");var b=1;for(var g=0;g<6;g++){h.push("<tr>");for(var f=0;f<7;f++){if(k>0){h.push("<td></td>");k--}else{if(b<=o){h.push(b==c?"<td class='day active'>"+b+"</td>":"<td class='day'>"+b+"</td>");b++}else{h.push("<td></td>")}}}h.push("</tr>")}h.push("</table>");a.html(h.join(""));$(".day",a).click(function(t){t.preventDefault();t.stopPropagation();var i=$(this).closest("#calendar");var q=$(i).attr("data-value");var j=this.innerHTML;var s=parseInt($.date("n",$.strtotime(q)));var r=$.date("Y",$.strtotime(q));var u=$.date("j M Y",$.mktime(0,0,0,s,j,r));$.fire_event(d,[u],i);$.popup_close(i)});$(".calendar-prev",a).click(function(s){s.preventDefault();s.stopPropagation();var i=$(this).closest("#calendar");var j=$(i).attr("data-value");var r=parseInt($.date("n",$.strtotime(j)));var q=parseInt($.date("Y",$.strtotime(j)));var u=parseInt($("td.active",i).html());var t=$.date("Y-m-d",$.mktime(0,0,0,r-1,u,q));$.calendar_set(t)});$(".calendar-next",a).click(function(s){s.preventDefault();s.stopPropagation();var i=$(this).closest("#calendar");var j=$(i).attr("data-value");var r=parseInt($.date("n",$.strtotime(j)));var q=parseInt($.date("Y",$.strtotime(j)));var u=parseInt($("td.active",i).html());var t=$.date("Y-m-d",$.mktime(0,0,0,r+1,u,q));$.calendar_set(t)})},calendar_set_range:function(l,u,e){var b=$("#calendar");$(b).attr("data-value",l);var y=$(b).data("params");var x=y.onchange;l=l.split("-");var a=l[0];var A=l[1];if($.date("Y",$.strtotime(a))=="1970"){a=$.date("Y-m-d")}if($.date("Y",$.strtotime(A))=="1970"){A=$.date("Y-m-d")}var w=[],m=[],r=[],d=[],t=[],c=[],h=[];var p=$.date("Y",$.strtotime(u))!="1970"?u:a;var n=$.date("Y",$.strtotime(e))!="1970"?e:A;if($.date("Ym",$.strtotime(n))==$.date("Ym",$.strtotime(p))){n=$.date("Y-m-d",$.mktime(0,0,0,parseInt($.date("n",$.strtotime(n)))+1,$.date("j",1,$.date("Y",$.strtotime(n)))))}w[0]=$.date("n",$.strtotime(p));m[0]=$.date("m",$.strtotime(p));r[0]=$.date("Y",$.strtotime(p));d[0]=$.date("j",$.strtotime(p));t[0]=$.start_day_of_month(r[0],w[0])%7;c[0]=$.last_date_of_month(r[0],w[0]);h[0]=$.date("M Y",$.strtotime(p));w[1]=$.date("n",$.strtotime(n));m[1]=$.date("m",$.strtotime(n));r[1]=$.date("Y",$.strtotime(n));d[1]=$.date("j",$.strtotime(n));t[1]=$.start_day_of_month(r[1],w[1])%7;c[1]=$.last_date_of_month(r[1],w[1]);h[1]=$.date("M Y",$.strtotime(n));var g=[];for(var s=0;s<2;s++){g.push("<table class='calendar-table range-"+s+"'>");g.push("<tr>");g.push($.p("<td><span class='calendar-prev fa fa-caret-left padding5' data-calendaridx='$i'></span></td>",[s]));g.push("<td colspan='5'><span class='date-label'>"+h[s]+"</span></td>");g.push($.p("<td><span class='calendar-next fa fa-caret-right padding5' data-calendaridx='$i'></span></td>",[s]));g.push("</tr>");g.push("<tr>");g.push("<td>Sun</td>");g.push("<td>Mon</td>");g.push("<td>Tue</td>");g.push("<td>Wed</td>");g.push("<td>Thu</td>");g.push("<td>Fri</td>");g.push("<td>Sun</td>");g.push("</tr>");var z=1;for(var q=0;q<6;q++){g.push("<tr>");for(var o=0;o<7;o++){if(t[s]>0){g.push("<td></td>");t[s]--}else{if(z<=c[s]){var f=$.date("Y-m-d",$.strtotime(r[s]+"-"+m[s]+"-"+$.str_pad(z,2,"0","STR_PAD_LEFT")));if($.strtotime(f)>=$.strtotime(a)&&$.strtotime(f)<=$.strtotime(A)){g.push("<td class='day active' data-date='"+f+"'>"+z+"</td>")}else{g.push("<td class='day' data-date='"+f+"'>"+z+"</td>")}z++}else{g.push("<td></td>")}}}g.push("</tr>")}g.push("</table>")}b.html(g.join(""));b.data("seq",0);$(".day",b).click(function(B){B.preventDefault();B.stopPropagation();console.log("value: "+1);var i=$(this).closest("#calendar");var k=$(i).attr("data-value");var j=this.innerHTML;var C=parseInt($.date("n",$.strtotime(k)));var E=$.date("Y",$.strtotime(k));var D=$.date("j M Y",$.mktime(0,0,0,C,j,E));var I=parseInt(i.data("seq"));if(I==0){$(".day.active-0").removeClass("active active-0");$(this).addClass("active active-0");var J=$(this).attr("data-date");var F=$(i).attr("data-value");F=F.split(",");var H=$.val(1,F,{d:J});$(".day",i).each(function(){var K=$(this).attr("data-date");if($.strtotime(K)>=$.strtotime(J)&&$.strtotime(K)<=$.strtotime(H)){$(this).addClass("active")}else{$(this).removeClass("active")}})}else{$(".day.active-1").removeClass("active active-1");$(this).addClass("active active-1")}i.data("seq",I+1);if(I==1){var J=$(".day.active-0").attr("data-date");var H=$(".day.active-1").attr("data-date");if($.strtotime(J)>$.strtotime(H)){var G=J;J=H;H=G}var F=$.date("Ymd",$.strtotime(J))+"-"+$.date("Ymd",$.strtotime(H));$.popup_close(i);$.fire_event(x,[F],i)}});$(".calendar-prev",b).click(function(j){var i=parseInt($(this).attr("data-calendaridx"));console.log(["prev",l,parseInt($(this).attr("data-calendaridx")),p,n]);j.preventDefault();j.stopPropagation();if(i==0){p=$.date("Y-m-d",$.mktime(0,0,0,parseInt($.date("n",$.strtotime(p)))-1,$.date("j",$.strtotime(p)),$.date("Y",$.strtotime(p))))}else{if(i==1){n=$.date("Y-m-d",$.mktime(0,0,0,parseInt($.date("n",$.strtotime(n)))-1,$.date("j",$.strtotime(n)),$.date("Y",$.strtotime(n))));if($.date("Ym",$.strtotime(p))>=$.date("Ym",$.strtotime(n))){p=$.date("Y-m-d",$.mktime(0,0,0,parseInt($.date("n",$.strtotime(p)))-1,$.date("j",$.strtotime(p)),$.date("Y",$.strtotime(p))))}}}$.calendar_set_range(l.join(","),p,n)});$(".calendar-next",b).click(function(j){var i=parseInt($(this).attr("data-calendaridx"));j.preventDefault();j.stopPropagation();if(i==0){p=$.date("Y-m-d",$.mktime(0,0,0,parseInt($.date("n",$.strtotime(p)))+1,$.date("j",$.strtotime(p)),$.date("Y",$.strtotime(p))));if($.date("Ym",$.strtotime(n))<=$.date("Ym",$.strtotime(p))){n=$.date("Y-m-d",$.mktime(0,0,0,parseInt($.date("n",$.strtotime(n)))+1,$.date("j",$.strtotime(n)),$.date("Y",$.strtotime(n))))}}else{if(i==1){n=$.date("Y-m-d",$.mktime(0,0,0,parseInt($.date("n",$.strtotime(n)))+1,$.date("j",$.strtotime(n)),$.date("Y",$.strtotime(n))))}}$.calendar_set_range(l.join(","),p,n)})}});$.fn.extend({chart:function(c){var b=$.val("name",c);var a=$.val("height",c);var d=$.val("width",c);this.each(function(){var g=this;var f={};f.height=a;f.width=d;var e=[];$(g).addClass("chart");$(this).html(e.join(""));$(this).css(f);$(g).attr("data-type","chart");$(g).attr("data-name",b);$(g).data("options",c)})},chart_set:function(a){this.each(function(){var d=this;var b=$(d).data("options");var c=$.val("type",b,{default_value:"line"});switch(c){case"bar":$(this).chart_bar_set(a);break;default:$(this).chart_line_set(a);break}})},chart_bar_set:function(a){this.each(function(){var b=this;var f=$(b).data("options");var t=$(b).outerHeight();var z=$(b).outerWidth();var s=$.val("padding",f,{default_value:10});var A=$.array_key_count(a);var i=$.object_value_min(a);var r=$.object_value_max(a);var u=s;var k=z-s;var E=k-u;var q=(z*0.8)/A;var g=(E-(q*A))/(A+1);var H=t-s;var I=10;var c=H-I;var j=c/(r-i);var p=[];p.push($.p('<svg width="$1" height="$2">',[z,t]));var D=u;var C=k;var e=H,d=H;p.push($.p('<line x1="$x1" y1="$y1" x2="$x2" y2="$y2" style="stroke:rgb(0,0,0);stroke-width:1" />',[D,e,C,d]));var m=0;for(var G in a){var F=a[G];var o=q;var B=j*F;if(B<5){B=5}var n=m*(g+q)+g;var l=H-B;p.push($.p('<rect x="$1" y="$1" width="$1" height="$1" stroke="#4A89DC" stroke-width="2" fill="rgba(74, 137, 220, .2)" data-key="$1" data-value="$1" onmouseover="$1" onmouseout="$1"/>',[n,l,o,B,G,F,"$.chart_line_mouseover.call(this)","$.chart_line_mouseout.call(this)"]));m++}p.push("</svg>");$(b).html(p.join(""))})},chart_line_set:function(a){this.each(function(){var b=this;var i=$(b).data("options");var q=$(b).outerHeight();var s=$(b).outerWidth();var t=$.array_key_count(a);var j=$.object_value_min(a);var o=$.object_value_max(a);var p=$.val("padding",i,{default_value:10});var r=p;var l=s-p;var y=l-r;var z=y/(t-1);var C=q-p;var D=10;var c=C-D;var k=c/(o-j);var n=[];n.push($.p('<svg width="$1" height="$2">',[s,q]));var w=r;var u=l;var h=C,f=C;n.push($.p('<line x1="$x1" y1="$y1" x2="$x2" y2="$y2" style="stroke:rgb(0,0,0);stroke-width:1" />',[w,h,u,f]));var m=1;for(var B in a){var g=Math.round(r+(m*z));n.push($.p('<line x1="$1" y1="$1" x2="$1" y2="$1" style="stroke:rgba(0, 0, 0, .05);stroke-width:1" />',[g,C,g,D]));m++}var m=0;var x=[];x.push($.p("M$1 $2",[Math.round(r+(m*z)),C]));for(var B in a){var A=a[B];var g=Math.round(r+(m*z));var e=Math.round(C-(A*k));x.push($.p("L$1 $2",[g,e]));m++}x.push($.p("M$1 $2 Z",[g,C]));n.push($.p('<path d="$1" stroke-width="0" stroke="transparent" fill="rgba(74, 137, 220, .2)"/>',[x.join(" ")]));var m=0;var x=[];for(var B in a){var A=a[B];var g=Math.round(r+(m*z));var e=Math.round(C-(A*k));if(m==0){x.push($.p("M$1 $2",[g,e]))}else{x.push($.p("L$1 $2",[g,e]))}m++}n.push($.p('<path d="$1" stroke-width="2" stroke="#4A89DC" fill="transparent"/>',[x.join(" ")]));var m=0;for(var B in a){var A=a[B];var g=r+(m*z);var e=C-(A*k);n.push($.p('<circle cx="$1" cy="$1" r="1" stroke="#4A89DC" stroke-width="2" fill="#4A89DC" onmouseover="$1" onmouseout="$1" data-key="$1" data-value="$1"/>',[g,e,"$.chart_line_mouseover.call(this)","$.chart_line_mouseout.call(this)",B,A]));m++}n.push("</svg>");$(b).html(n.join(""))})}});$.extend({chart_line_mouseover:function(){$(this).attr({r:2});var a=$(this).attr("data-key");var b=$(this).attr("data-value");$.tooltip(this,a+"<br />"+b)},chart_line_mouseout:function(){$(this).attr({r:1});$.tooltip_remove()}});$.fn.extend({checkbox:function(a){this.each(function(){var e=$.val("class",a,{d:""});var b=$.val("items",a,{d:null});var d=[];if($.type(b)=="array"){$(b).each(function(){var j=$.val("text",this,{d:""});var i=$.val("value",this,{d:""});var h="checkbox-"+$.uniqid();d.push("<span class='item'><input id='"+h+"' type='checkbox' value=\""+i+"\"/><label for='"+h+"'>"+j+"</label></span>")})}else{var g=$.val("text",a,{d:""});var f="";var c="checkbox-"+$.uniqid();d.push("<span class='item'><input id='"+c+"' type='checkbox' value=\""+f+"\"/><label for='"+c+"'>"+g+"</label></span>")}$(this).addClass("checkbox");$(this).addClass(e);$(this).html(d.join(""));$(this).data("options",a)})}});$.fn.extend({checklist:function(a){$(this).each(function(){var b=this;var c=[];c.push("<div class='checklist-body'>");c.push("<div class='checklist-item'>");c.push("<input type='checkbox' />");c.push("<input type='text' />");c.push("<span class='iconbar'>");c.push("<span class='checklist-remove fa fa-times padding5 selectable'></span>");c.push("</span>");c.push("</div>");c.push("</div>");c.push("<div class='checklist-foot'>");c.push("<span class='checklist-add fa fa-plus-circle padding5 selectable hoverable'></span>");c.push("</div>");$(this).addClass("checklist");$(this).html(c.join(""));$(".checklist-add",this).click(function(){$(b).checklist_add()});$(".checklist-remove",this).on("click.checklist",function(){$(this).closest(".checklist-item").remove()})})},checklist_add:function(){$(this).each(function(){var a=[];a.push("<div class='checklist-item'>");a.push("<input type='checkbox' />");a.push("<input type='text' />");a.push("<span class='iconbar'>");a.push("<span class='checklist-remove fa fa-times padding5 selectable hoverable'></span>");a.push("</span>");a.push("</div>");$(".checklist-body",this).append(a.join(""));$(".checklist-remove",$(".checklist-body",this)).on("click.checklist",function(){$(this).closest(".checklist-item").remove()})})},checklist_get:function(){var a=[];$(this).each(function(){$(".checklist-item",this).each(function(){var b=$("input[type='checkbox']",this)[0].checked;var c=$("input[type='text']",this).val();if(c.length>0){a.push({checked:b,text:c})}})});return a.length==0?null:a},checklist_set:function(a){$(this).checklist_attr({value:a})},checklist_attr:function(a){if($.type(a)!="object"){return}$(this).each(function(){for(var d in a){var g=a[d];switch(d){case"readonly":if(g){$("input[type='checkbox']",this).attr("disabled",true);$("input[type='text']",this).attr("readonly",true);$(".checklist-remove",this).addClass("hidden");$(".checklist-add",this).addClass("hidden")}else{$("input[type='checkbox']",this).attr("disabled",false);$("input[type='text']",this).attr("readonly",false);$(".checklist-remove",this).removeClass("hidden");$(".checklist-add",this).removeClass("hidden")}break;case"value":var c=[];if($.type(g)=="array"){for(var b=0;b<g.length;b++){var f=g[b];var h=$.val("text",f,{d:""});var e=$.val("checked",f,{d:false});if(h==""){continue}c.push("<div class='checklist-item'>");c.push("<input type='checkbox'"+(e?" checked":"")+"/>");c.push("<input type='text' value=\""+h+'" />');c.push("<span class='iconbar'>");c.push("<span class='checklist-remove fa fa-times padding5 selectable hoverable'></span>");c.push("</span>");c.push("</div>")}}c.push("<div class='checklist-item'>");c.push("<input type='checkbox'/>");c.push("<input type='text'/>");c.push("<span class='iconbar'>");c.push("<span class='checklist-remove fa fa-times padding5 selectable hoverable'></span>");c.push("</span>");c.push("</div>");$(".checklist-body",this).html(c.join(""));$(".checklist-remove",$(".checklist-body",this)).on("click.checklist",function(){$(this).closest(".checklist-item").remove()});break}}})}});$.fn.extend({choice:function(a){$(this).each(function(){var e=$.val("class",a,{d:""});var b=$.val("items",a,{d:[],datatype:"array"});var d=[];if($.type(b)=="array"){for(var c=0;c<b.length;c++){var f=b[c];var g=$.val("value",f,{d:""});var h=$.val("text",f,{d:g});if(g.length==0){continue}d.push($.p('<span class="item">'));d.push($.p("</span>"))}}$(this).addClass("choice");$(this).addClass(e)})}});$.fn.extend({codeeditor:function(c){var a=$.val("height",c,{d:"200px"});var d=$.val("width",c,{d:"300px"});var b=$.val("name",c,{d:""});var e=$.val("value",c,{d:"300px"});this.each(function(){var g=$.uniqid();var f=[];f.push($.p('<textarea id="$1""></textarea>',["codeeditor-text-"+g]));$(this).addClass("codeeditor");$(this).html(f.join(""));$(this).css({width:d,height:a});$(this).codeeditor_attr({name:b});var h=CodeMirror.fromTextArea(document.getElementById("codeeditor-text-"+g),{lineNumbers:true,mode:"text/x-mariadb",indentWithTabs:true,smartIndent:true,matchBrackets:true,autofocus:true})})},codeeditor_get:function(){var a=[];$(this).each(function(){a.push($("textarea",this).val())});return a.length==1?a[0]:(a.length>1?a:"")},codeeditor_set:function(a){$(this).each(function(){$("textarea",this).val(a)})},codeeditor_attr:function(a){this.each(function(){var d={};var e={};var b={};for(var c in b){var f=b[c];switch(c){case"name":b.name=f}}$(this).attr(b);$(this).css(d);$("textarea",this).css(e)})}});$.fn.extend({codefield:function(c){var f=$.val("placeholder",c,{d:""});var b=$.val("name",c,{d:""});var a=$.val("height",c);var e=$.val("width",c);var d={width:e,height:a};this.each(function(){var h=this;var g=[];g.push("<pre style='height:"+a+";'>"+JSON.stringify({name:"andy"},null,2)+"</pre>");g.push("<span class='icon fa hidden'></span>");$(h).addClass("codefield");$(h).css(d);$(h).html(g.join(""));$(h).attr("data-type","codefield");$(h).attr("data-name",b);$(h).data("options",c)})},codefield_get:function(){var a=[];this.each(function(){var b=$("pre",this).html();a.push(b)});return a.length>1?a:(a.length==1?a[0]:"")},codefield_set:function(a){this.each(function(){$("pre",this).html(a)})}});$.fn.extend({commentlist:function(b){var a=$.val("onsubmit",b);$(this).each(function(){var c=this;var d=[];d.push("<div class='commentlist-write'>");d.push("<input type='text' placeholder='Write comment here...' />");d.push("</div>");d.push("<div class='commentlist-list'></div>");$(this).addClass("commentlist");$(this).html(d.join(""));$(this).data("options",b);$("input[type='text']",this).on("keyup",function(f){if(f.keyCode==13){if(f.shiftKey){}else{if(this.value!=""){$.fire_event(a,[this.value],c);this.value="";$(this).blur()}}}})})},commentlist_add:function(a){$(this).each(function(){var c=$(this).data("options");var e=$.val("onremove",c);var i=$.val("id",a);var h=$.val("comment",a);var g=$.val("full_name",a);var f=$.val("createdon",a);var b=$.val("removable",a,{d:0});if(!h||!g){return}var d=[];d.push("<div class='commentlist-item' data-id='"+i+"'>");d.push("<p style='word-wrap: break-word;'><b>"+g+"</b> "+h+"</p>");d.push("<div class='commentlist-item-footer'>");d.push("<label class=''>"+f+"</label>");if(b){d.push("<span class='width5 height5'>&nbsp;</span>");d.push("<span class='comment-item-remove selectable hoverable'>Remove</span>")}d.push("</div>");d.push("</div>");$(".commentlist-list",this).append(d.join(""));$(".comment-item-remove",$(".commentlist-list",this)).on("click",function(){var j=$(this).closest(".commentlist-item").attr("data-id");$.fire_event(e,[j],this)})})},commentlist_set:function(a){$(this).each(function(){var l=$(this).data("options");var e=$.val("onremove",l);var g=[];if($.type(a)=="array"){for(var f=0;f<a.length;f++){var d=a[f];var c=$.val("id",d);var h=$.val("comment",d);var j=$.val("full_name",d);var k=$.val("createdon",d);var b=$.val("removable",d,{d:0});if(!h||!j){continue}g.push("<div class='commentlist-item' data-id='"+c+"'>");g.push("<p style='word-wrap: break-word;'><b>"+j+"</b> "+h+"</p>");g.push("<div class='commentlist-item-footer'>");g.push("<label class=''>"+k+"</label>");if(b){g.push("<span class='width5 height5'>&nbsp;</span>");g.push("<span class='comment-item-remove selectable hoverable'>Remove</span>")}g.push("</div>");g.push("</div>")}}$(".commentlist-list",this).html(g.join(""));$(".comment-item-remove",$(".commentlist-list",this)).on("click",function(){var i=$(this).closest(".commentlist-item").attr("data-id");$.fire_event(e,[i],this)})})}});$.fn.extend({container_val:function(a){if(typeof a=="undefined"){result={};$("*[data-type]",this).each(function(){var b=this.getAttribute("data-name");if(b!=null&&b!=""){var c=$(this).val();result[b]=c}});return result}else{$("*[data-type]",this).each(function(){var b=this.getAttribute("data-name");if(b!=null&&b!=""){var c=$.val(b,a,{d:""});$(this).val(c)}})}},container_reset:function(){$("*[data-type]",this).each(function(){var a=$(this).attr("data-type");if(a!=null&&typeof $(this)[a+"_reset"]!="undefined"){$(this)[a+"_reset"].apply(this,arguments)}})}});$.fn.extend({datepicker:function(a){var b=$.val("type",a);this.each(function(){var d=this;var c=[];c.push("<input type='text' readonly/>");c.push("<span class='icon fa fa-calendar'></span>");$(d).addClass("datepicker");$(d).html(c.join(""));$(d).attr("data-type","datepicker");$(d).data("options",a);$(".icon",this).click(function(i){i.preventDefault();i.stopPropagation();var h=$(this).closest(".datepicker");var g=$(h).data("options");var f=$.val("readonly",g,{d:false});if(f=="0"||f==false){$.calendar_open({refEl:h,value:$(h).data("value"),type:b,onchange:function(e){$(h).datepicker_val(e)}})}});$(".popup",this).click(function(f){f.preventDefault();f.stopPropagation()});$(this).datepicker_val($.val("value",a,{d:"20170101"}))})},datepicker_val:function(a){if(typeof a=="undefined"){var a=[];$(this).each(function(){var b=$(this).data("value");a.push(b)});return a.length==1?a[0]:(a.length==0?null:a)}else{$(this).each(function(){var f="";a=$.date_parse(a);if(a.indexOf("-")>=0){var e=a.split("-");var c=$.date("M j, Y",$.strtotime(e[0]));var b=$.date("M j, Y",$.strtotime(e[1]));f=c+" - "+b}else{var e=$.date("M j, Y",$.strtotime(a));f=e}$("input",this).val(f);$(this).data("value",a)})}}});$.fn.extend({dropdown:function(j){var e=$.val("class",j,{d:""});var b=$.val("name",j,{d:""});var i=$.val("defaultvalue",j,{d:""});var h=$.val("value",j,{d:i});var f=$.val("items",j,{d:[]});var c=$.val("width",j,{d:[]});var a=$.val("src",j,{d:""});var g=$.val("placeholder",j,{d:""});var d=[];d.push("<input class='text' type='text' placeholder=\""+g+'" readonly/>');d.push("<span class='icon fa fa-caret-down hoverable'></span>");d.push("<span class='popup'></span>");this.each(function(){var k=this;$(k).addClass("dropdown");$(k).addClass(e);$(k).html(d.join(""));$(k).data("options",j);$(k).attr("data-type","dropdown");$(k).attr("data-name",b);$(k).dropdown_attr(j);$(".icon, .text",k).click(function(o){o.preventDefault();o.stopPropagation();var n=$(this).closest(".dropdown");var m=$(n).data("options");var l=$.val("readonly",m);if(!l){if($(".popup",n).hasClass("on")){$.popup_close($(".popup",n))}else{$.popup_open($(".popup",n),n,{min_width:$(n).outerWidth()});$(".search-item input",$(".popup",n)).val("");$(".search-item input",$(".popup",n)).focus();$(".item",$(".popup",n)).show()}}});if(h!=""){$(k).dropdown_val()}if(a.length>0){$(this).dropdown_load()}})},dropdown_val:function(c,b){if(typeof c=="undefined"){var a=[];this.each(function(){var d=this;var e=$(d).attr("data-value");var f=$("input",d).length==1?$("input",d).val():$(".text",d).html();e=e==null?f:e;a.push(e)});return a.length==1?a[0]:(a.length>1?a:null)}else{this.each(function(){var e=$(this).data("options");var d=$.val("items",e,{d:[]});var j="";var h="";if($.type(c)=="object"){h=$.val("value",c);j=$.val("text",c,{d:h})}else{if($.type(h)=="string"){j=h=c}}if($.type(d)=="array"){for(var f=0;f<d.length;f++){var g=d[f];if(g.value==h){j=g.text;h=g.value;break}}}$(this).attr("data-value",h);$("input",this).val(j);$(".text",this).html(j)})}},dropdown_items:function(a){if(typeof a=="undefined"){var b=[];this.each(function(){var e=this;var d=$(e).data("options");var c=$.val("items",d,{d:[]});$(c).each(function(){if($.type(this)=="object"){b.push(this)}})});return b}else{this.each(function(){var c=this;var n=$(c).data("options");var h=$.val("searchable",n,{d:false});var o=$.val("multiple",n,{d:false});var d=$.val("onchange",n);var f=[];if(h==true){f.push("<div class='search-item'>");f.push("<input type='text' placeholder='Search'/>");f.push("</div>")}if($.type(a)=="array"){for(var e=0;e<a.length;e++){var l=a[e];var k=l.text;var j=l.value;var m=(k+" "+j).toLowerCase();var g=$.uniqid();f.push("<div class='item' data-value=\""+j+'" data-search="'+m+'">');if(o){f.push("<input type='checkbox' id='dropdown_item_checkbox_"+g+"'/>")}f.push("<label for='dropdown_item_checkbox_"+g+"'>"+k+"</label>");f.push("</div>")}}f=f.join("");$(".popup",c).html(f);$(c).data("options",n);$(".item",$(".popup",c)).click(function(t){if(o){t.stopPropagation()}var x=$("label",this).html();var w=$(this).attr("data-value");var s=-1;var q=null;for(var r=0;r<a.length;r++){var y=a[r];var u=$.val("text",y);var p=$.val("value",y);if(p==w||u==x){s=r;q=y;break}}if(q){q._index=s}$("input",c).val(x);$(".text",c).html(x);$(c).attr("data-value",w);$.fire_event(d,[t,q],c)});$(".item>input[type='checkbox']",$(".popup",c)).on("change",function(){var p=this.nextElementSibling.innerHTML;var i=this.parentNode.getAttribute("data-value");$(c).dropdown_val({text:p,value:i},true)});$(".popup .search-item input",c).click(function(i){i.preventDefault();i.stopPropagation()});$(".popup .search-item input",c).keyup(function(q){var p=this.value;var i=$(this).closest(".popup");$(".item",i).show();if(p.length>0){$(".item:not([data-search*='"+p+"'])",i).hide()}});n.items=a;$(c).data("options",n);$(c).dropdown_val("*")})}},dropdown_attr:function(a){this.each(function(){var b=$(this).data("options");if($.type(a)=="object"){for(var d in a){var e=a[d];var c={};switch(d){case"items":$(this).dropdown_items(e);break;case"readonly":if(e){$(this).addClass("readonly");b.readonly=true}else{$(this).removeClass("readonly");b.readonly=false}break;case"value":$(this).dropdown_val(e);break;case"width":c.width=parseInt(e);break}$(this).css(c)}}$(this).data("options",b)})},dropdown_load:function(){this.each(function(){var b=this;var a=$(b).data("options");var c=$.val("src",a,{d:""});$.api_post(c,{},function(d){var e=$.val("data",d);if($.type(e)=="array"){$(b).dropdown_items(e)}})})},dropdown_reset:function(){$(this).each(function(){var a=$(this).data("options");var b=$.val("defaultvalue",a,{d:""});$(this).dropdown_val(b)})},dropdown_readonly:function(a){$(this).each(function(){if($.istrue(a)){$(this).addClass("readonly")}else{$(this).removeClass("readonly")}})}});$.fn.extend({feed:function(a){$(this).each(function(){var c=$.val("class",a,{d:""});var e=$.val("src",a,{d:""});var d=$.val("autoload",a,{d:false});var b=[];b.push("<div class='feed-content'></div>");b.push("<div class='feed-footer'></div>");$(this).addClass("feed");$(this).addClass(c);$(this).html(b.join(""));$(this).data("options",a);if(d){$(this).feed_load()}})},feed_val:function(b,a){if(typeof b=="undefined"){}else{$(this).each(function(){var l=$(this).data("options");var c=$.val("src",l,{d:""});var k=$.val("template",l,{d:""});if($.type(b)=="array"&&b.length>0){var h="feed_group_"+$.uniqid();var j=document.createElement("div");j.setAttribute("data-feed-group-id",h);var g=[];for(var f=0;f<b.length;f++){g.push("<div class='feed-item'></div>")}j.innerHTML=g.join("");$(".feed-content",this).append(j);for(var f=0;f<b.length;f++){var e=b[f];var d=j.childNodes[f];$.fire_event(k,[e],d)}}})}},feed_load:function(a){$(this).each(function(){if(!$(this).hasClass("feed")){return}var b=this;var c=$(this).data("options");var d=$.val("src",c,{d:""});if(d!=""){$.api_post(d,[],function(g){var i=$.val("data",g,{d:[]});var h=$.val("page",g,{d:1});var f=h==1?false:true;$(b).feed_val(i,f);var e=$.val("max_page",g,{d:h});if(e>=h+1){$(".feed-footer",b).html("<div class='load-more align-center padding10'>Load More...</div>");$(".load-more",b).on("click",function(){$(b).feed_load({page:h+1})})}else{$(".feed-footer",b).html("")}})}})}});$.extend({foldedpane_toggle:function(c){var a=$(c);if(typeof a[0]=="undefined"){return}var b=$(".toggler",a);if(a[0].classList.contains("folded")){a[0].classList.remove("folded");if(b.length==1){b.html("<span class='fa fa-caret-up'></span>")}}else{a[0].classList.add("folded");if(b.length==1){b.html("<span class='fa fa-caret-down'></span>")}}},foldedpane_init:function(){var b=document.body.querySelectorAll(".folded-pane");for(var a=0;a<b.length;a++){var c=b[a];var d=c.querySelector(".toggler");if(d!=null){d.addEventListener("click",function(){$.foldedpane_toggle(c)})}}}});$.fn.extend({grid:function(c){var f=$.val("autoload",c,{d:true});var d=$.val("columns",c,{d:[]});var e=$.val("class",c,{d:null});var b=$.val("name",c,{d:""});var h=$.val("footer",c,{d:""});var g=$.val("value",c,{d:null});var a=$.val("height",c,{d:"auto"});c.page=0;c.row_per_page=12;this.each(function(){var j=this;var i=[];i.push("<table class='grid-body'>");i.push("<tbody class='grid-size'></tbody>");i.push("</table>");i.push("<div class='grid-footer'></div>");$(j).attr("data-type","grid");$(j).addClass("grid");$(j).addClass(e);if(b!=""){$(j).attr("data-name",b)}$(j).data("options",c);$(j).attr("data-type","grid");$(j).html(i.join(""));$.fire_event(h,[],$(".grid-footer",j));$(this).grid_set_columns(d);if(g!=null){$(j).grid_set(g)}if(f){$(j).grid_load()}})},grid_add:function(a){this.each(function(){var c=this;var t=c.querySelector(".grid-body");var g=$(c).data("options");var b=$.val("columns",g,{d:[]});var o=[];if($(".grid-size",t).length==0){var l=[];l.push("<tr class='grid-size'>");for(var r=0;r<b.length;r++){var f=b[r];var m=$.val("width",f,{d:""});l.push("<td style='width:"+m+";'></td>");l.push("<td class='separator'></td>")}l.push("<td style='width:100%'></td>");l.push("</tr>");o.push(l.join(""))}o.push("<tr>");for(var q=0;q<b.length;q++){var f=b[q];var e=$.val("type",f,{d:"text"});var k=$.val("datatype",f,{d:"text"});var u=$.val("name",f,{d:""});var m=$.val("width",f,{d:""});var p=$.val("align",f,{d:""});var h="";var d="";var n="";switch(e){case"index":n=r+1;h="right";d="label";break;case"html":gridtypecoord=0+","+q;break;default:switch(k){case"number":case"money":h="right";n=$.val(u,a,{d:0});break;case"enum":var s=$.val("enums",f,{d:{}});n=$.val(u,a,{d:"-"});n=$.val(n,s,{d:"-"});break;default:n=$.val(u,a,{d:"-"});break}d="label";break}if(p!=""){h=p}o.push("<td data-gridtype='"+e+"' data-gridtypecoord='"+gridtypecoord+"' class='"+d+"' style='text-align:"+h+"'>"+n+"</td>");o.push("<td class='separator'></td>")}o.push("<td></td>");o.push("</tr>");$("tbody",t).append(o.join(""));$("td[data-gridtype='html']",$("tr",$("tbody",t)).last()).each(function(){var y=$(this).attr("data-gridtypecoord").split(",");var i=parseInt(y[1]);var w=b[i];var x=$.val("html",w,{d:""});$.fire_event(x,[a,w],this)})})},grid_remove:function(b){var a=this;$(b).each(function(){var d=$(this).closest(".grid");d=typeof d[0]!="undefined"?d[0]:-2;var c=typeof a[0]!="undefined"?a[0]:-1;if(d==c){$(this).remove()}})},grid_set_columns:function(a){$(this).each(function(){if(!$(this).hasClass("grid")){return}var c=$(this).data("options");c.columns=a;$(this).data("options",c);var e=[];e.push("<tr>");for(var d=0;d<a.length;d++){var g=a[d];var b=$.val("name",g);var f=$.val("width",g);var h=$.val("active",g,{d:1});if(h==1){e.push($.p("<td class='grid-size-label' style='width:$1' data-key='"+b+"'></td>",[f]))}else{e.push($.p("<td class='grid-size-label inactive' style='width:$1' data-key='"+b+"'></td>",[f]))}}e.push("<td style='width:100%'></td>");e.push("</tr>");$(".grid-size",this).html(e.join(""))})},grid_append:function(b,a){this.each(function(){var d=this;var n=d.querySelector(".grid-body");var o=$(d).data("options");var c=$.val("src",o,{d:""});var l=$.val("onselect",o);var e=$.val("columns",o,{d:[]});var k=$.val("page",b,{d:1});var m=$.val("row_per_page",b,{d:10});var f=$.val("max_page",b,{d:k});var j=$.val("data",b);if(typeof o.data=="undefined"){o.data=[]}var h=document.createElement("tbody");$(h).html($.grid_html(j,e,o.data.length));$(n).append(h);$("td[data-gridtype='html']",h).each(function(){var u=$(this).attr("data-gridtypecoord").split(",");var q=parseInt(u[0]);var p=parseInt(u[1]);var s=j[q];var r=e[p];var t=$.val("html",r,{d:""});$.fire_event(t,[s,r],this)});$("tr",h).click(function(){var p=$(this).closest("table");$(".active",p).removeClass("active");$(this).addClass("active");var i=$(this).attr("data-idx");var q=o.data[i];$.fire_event(l,[q],d)});$(".grid-more",d).remove();if(f>k){$(d).append("<div class='grid-more' data-page='"+k+"'><label class='cl-gray'>Load more...</label></div>");$(".grid-more",d).click(function(){var p=parseInt($(this).attr("data-page"));var i=$.val("onloadmore",o);$(this).html("<i class='fa fa-circle-o-notch fa-spin fa-fw cl-gray'></i>");if(c!=""){$(d).grid_load()}$.fire_event(i,[{page:p}],d)});$(".grid-more",d).appear(function(){var p=parseInt($(this).attr("data-page"));var i=$.val("onloadmore",o);$(this).html("<i class='fa fa-circle-o-notch fa-spinfa-fw cl-gray'></i>");if(c!=""){$(d).grid_load()}$.fire_event(i,[{page:p}],d)})}for(var g=0;g<j.length;g++){o.data.push(j[g])}$(d).data("options",o)})},grid_load:function(a){this.each(function(){var b=this;var d=$(b).data("options");var h=$.val("src",d,{d:""});var i=$.val("method",d,{d:"post"});if(h.length>0){var g=$.val("page",a,{d:1});var f=$.val("row_per_page",a,{d:10});var e=$.val("columns",d);var c={page:g,row_per_page:f,columns:e};if(i.toString().toLowerCase()=="get"){$.api_get(h,c,function(k){var n=$.val("data",k,{d:[]});var m=$.val("page",k,{d:1});var j=m==1?false:true;$(b).grid_val(n,j);var l=$.val("next_page",k,{d:m});if(l>m){$(".grid-footer",b).html("<div class='load-more align-center padding10'>Load More...</div>");$(".load-more",b).on("click",function(){$(b).grid_load({page:l})})}else{$(".grid-footer",b).html("")}})}else{$.api_post(h,c,function(k){var n=$.val("data",k,{d:[]});var m=$.val("page",k,{d:1});var j=m==1?false:true;$(b).grid_val(n,j);var l=$.val("next_page",k,{d:m});if(l>m){$(".grid-footer",b).html("<div class='load-more align-center padding10'>Load More...</div>");$(".load-more",b).on("click",function(){$(b).grid_load({page:l})})}else{$(".grid-footer",b).html("")}})}$(".grid-footer",this).html("<div class='align-center padding10'>Loading...</div>")}})},grid_val:function(b,a){if(typeof b=="undefined"){var b=[];this.each(function(){var d=this;var e=d.querySelector(".grid-body");var c=$("tbody",e);$(c).children().each(function(){if(this.classList.contains("grid-size")){}else{var f=$(this).attr("data-idx");var g=$.el_get(this);if(JSON.stringify(g).length>3){b.push(g)}}})});return b}else{this.each(function(){var p=this;var q=$(p).data("options");var m=$.val("onselect",q);var e=$.val("columns",q,{d:[]});var k=document.createElement("tbody");k.className="grid-content";k.innerHTML=$.grid_html(b,e);if(typeof a=="undefined"||a!==true){$(".grid-content",p).remove()}$(".grid-body",p).append(k);for(var h=0;h<k.childNodes.length;h++){var o=k.childNodes[h];var g=b[h];for(var f=0;f<o.childNodes.length;f++){var d=o.childNodes[f];var n=d.getAttribute("data-column-type");if(n=="html"){var c=e[f];var l=$.val("html",c,{d:""});$.fire_event(l,[g,c],d)}}}$("tr",k).on("click.gridrow",function(j){var i=$(this).closest("table");$(".active",i).removeClass("active");$(this).addClass("active");$.fire_event(m,[j,this],p)})})}},grid_get_selected_value:function(){var a=null;$(this).each(function(){var c=$(this).data("options");var d=$.val("data",c);var b=$("tr[class='active']").attr("data-idx");a=$.val(b,d)});return a}});$.extend({grid_html:function(k,f){if(!k){return}var m=[];for(var l=0;l<k.length;l++){var h=k[l];m.push("<tr>");for(var g=0;g<f.length;g++){var e=f[g];var p=$.val("type",e,{d:"text"});var c=$.val("datatype",e,{d:"text"});var b=$.val("name",e,{d:""});var d=$.val("align",e,{d:""});var o="";var r="";var n="";switch(p){case"html":break;default:switch(c){case"number":case"money":o="right";n=$.val(b,h,{d:0});n=$.number_format(n);break;case"enum":var q=$.val("enums",e,{d:{}});n=$.val(b,h,{d:"-"});n=$.val(n,q,{d:"-"});break;default:n=$.val(b,h,{d:"-"});break}var a=$.val("lettercase",e,{d:""});switch(a){case"capitalize":n=n.toString().capitalize();break;case"lowercase":n=n.toString().toLowerCase();break;case"uppercase":n=n.toString().toUpperCase();break}r="label";break}if(d!=""){o=d}m.push("<td data-column-type='"+p+"' class='"+r+"' style='text-align:"+o+"'>"+n+"</td>")}m.push("<td></td>");m.push("</tr>")}return m.join("")}});$.fn.extend({gridhead:function(c){var g=$.val("autoload",c,{d:true});var e=$.val("columns",c,{d:[]});var f=$.val("class",c,{d:null});var b=$.val("name",c,{d:""});var d=$.val("grid",c,{d:null});var a=$.val("height",c,{d:null});this.each(function(){var h=this;$(h).addClass("gridhead");$(h).addClass(f);$(h).attr("data-type","gridhead");if(b!=""){$(h).attr("data-name",b)}$(h).data("options",c);$(h).attr("data-type","gridhead");$(h).gridhead_attr({height:a});$(this).gridhead_set(e)})},gridhead_set:function(a){$(this).each(function(){var f=this;var q=$(this).data("options");var b=$.val("grid",q,{d:null});var o=$.val("oncolumnclick",q);q.columns=a;var k=[];k.push("<table class='grid-head'><tr>");for(var j=0;j<a.length;j++){var h=a[j];var c=$.val("name",h,{d:""});var e=$.val("active",h,{d:1});var p=$.val("text",h,{d:"-"});var n=$.val("width",h,{d:""});var d=$.val("datatype",h,{d:"text"});var g=$.val("align",h,{d:""});var l="";switch(d){case"number":case"money":l="right";break;case"enum":break;default:break}if(g!=""){l=g}var m="label"+(!e?" inactive":"");k.push("<td class='"+m+"' style='width:"+n+";text-align:"+l+"' data-key=\""+c+'">'+p+"<span class='separator'></span></span></td>")}k.push("<td style='width:100%'></td>");k.push("</tr></table>");$(f).html(k.join(""));$(".separator",f).mousedown(function(t){t.preventDefault();t.stopPropagation();var r=this.parentNode;var s=r.parentNode;var i=t.clientX;$(window).on("mousemove.gridhead",function(w){w.preventDefault();w.stopPropagation();var u=w.clientX-i;r.style.width=(parseInt(r.style.width)+u)+"px";i=w.clientX});$(window).on("mouseup.gridhead",function(z){z.preventDefault();z.stopPropagation();var x=$(b);var B=$(".grid-size",x);if(B.length==1){var w=-1;for(var y=0;y<s.childNodes.length;y++){if(s.childNodes[y]==r){w=y;break}}w=parseInt(w);$(".grid-size-label:eq("+(w)+")",B).css({width:$(r).outerWidth()});var u=$(f).data("options");u.columns[w]["width"]=$(r).outerWidth();var A=$.val("oncolumnresize",u);$.fire_event(A,[{index:w,width:$(r).outerWidth()}],f)}$(window).off("mousemove.gridhead");$(window).off("mouseup.gridhead")})});$(".separator",f).click(function(i){i.preventDefault();i.stopPropagation()});$(".label",f).on("click",function(s){s.preventDefault();s.stopPropagation();var r=$(this).attr("data-key");var i=$(this).attr("data-sorttype");if(i=="asc"){i="desc"}else{if(i=="desc"){i="asc"}else{i="asc"}}$(this).attr("data-sorttype",i);$.fire_event(o,[[{key:r,type:i}]],f)})})},gridhead_attr:function(a){$(this).each(function(){for(var b in a){var c=a[b];switch(b){case"height":$(this).css({height:c});break}}})},gridhead_modify_column:function(a){$(this).each(function(){if(!$(this).hasClass("gridhead")){return}var n=$(this).data("options");var b=$.val("grid",n);var m=$.val("columns",n);for(var k=0;k<m.length;k++){var e=m[k];var l=$.val("name",e,{d:""});var d=$.val("width",e,{d:""});if(l==""){continue}for(var h=0;h<a.length;h++){var g=a[h];var c=$.val("name",g,{d:""});var f=$.val("active",g,{d:1});if(l==c){if(f){$(".label[data-key='"+c+"']",this).removeClass("inactive");$(".grid-size-label[data-key='"+c+"']",$(b)).removeClass("inactive")}else{$(".label[data-key='"+c+"']",this).addClass("inactive");$(".grid-size-label[data-key='"+c+"']",$(b)).addClass("inactive")}n.columns[k]["active"]=f;column_exists=true}}}$(this).data("options",n)})}});$.fn.extend({gridsetting:function(b){var a=$.val("onchange",b);this.each(function(){var d=this;var c=[];c.push("<div class='modal-head'>");c.push("<div class='align-center padding10'>");c.push("<ul class='tab'>");c.push("<li class='active' data-value='presets'>Presets</li>");c.push("<li data-value='columns'>Columns</li>");c.push("<li data-value='filters'>Filters</li>");c.push("</ul>");c.push("</div>");c.push("</div>");c.push("<div class='modal-body padding20'>");c.push("<div class='cont12 space10 gridsetting-presets'>");c.push("<div class='lg12'><button class='blue preset-add-btn'><span class='fa fa-plus'></span> Add Preset...</button></div>");c.push("<div class='lg12'><span class='preset-grid'></span></div>");c.push("</div>");c.push("<div class='cont12 space10 gridsetting-columns' style='display:none'>");c.push("<div class='lg12'>");c.push("<button class='blue column-up-btn'><span class='fa fa-caret-up'></span>Up</button>");c.push("&nbsp;");c.push("<button class='blue column-down-btn'><span class='fa fa-caret-down'></span>Down</button>");c.push("</div>");c.push("<div class='lg6'><span class='column-grid'></span></div>");c.push("<div class='lg6'>");c.push("<div class='cont12 space10 gridsetting-column-detail'>");c.push("<div class='lg3 align-right'><label class='padding10'>Align</label></div>");c.push("<div class='lg9'><span class='gridsetting-column-align'></span></div>");c.push("<div class='lg3 align-right'><label class='padding10'>Name</label></div>");c.push("<div class='lg9'><label class='gridsetting-column-name padding10'></label></div>");c.push("<div class='lg3 align-right'><label class='padding10'>Text</label></div>");c.push("<div class='lg9'><span class='gridsetting-column-text'></span></div>");c.push("<div class='lg3 align-right'><label class='padding10'>Width</label></div>");c.push("<div class='lg9'><span class='gridsetting-column-width'></span></div>");c.push("</div>");c.push("</div>");c.push("</div>");c.push("<div class='cont12 space10 gridsetting-filters' style='display:none'>");c.push("<div class='lg12'><button class='blue filter-add-btn'><span class='fa fa-plus'></span> Add Filter...</button></div>");c.push("<div class='lg12'><span class='filter-grid'></span></div>");c.push("</div>");c.push("</div>");c.push("<div class='modal-foot'>");c.push("<button class='blue apply-btn'><span class='fa fa-save'></span> Apply Filter</button>");c.push("&nbsp;");c.push("<button class='close-btn'><span class='fa fa-times'></span> Close</button>");c.push("</div>");$(d).addClass("modal width800 gridsetting");$(d).html(c.join(""));$(".tab",d).tab({onchange:function(e){$(".modal-body",d).children().hide();$(".gridsetting-"+e.value,d).show()}});$(".preset-add-btn").click(function(){});$(".preset-grid",d).grid({"class":"transparent",columns:[{text:"",type:"html",html:"$.gridsetting_preset_option",width:"50px"},{text:"Preset Name",name:"text",width:"150px"}]});$(".column-grid",d).grid({"class":"transparent",columns:[{text:"Column Name",name:"text",width:"150px"},{text:"Width",name:"width",width:"100px"}],onselect:function(g){var e=$(this).closest(".gridsetting-columns");var f=$(".gridsetting-column-detail",e);$.el_set(f,g);$(".gridsetting-column-name",f).html($.val("name",g,{d:""}))}});$(".gridsetting-column-align",d).dropdown({name:"align",items:[{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]});$(".gridsetting-column-name",d).html("");$(".gridsetting-column-text",d).textbox({name:"text",onchange:function(j){var e=$(d).data("params");var h=$(this).closest(".gridsetting-column-detail");var f=$(".gridsetting-column-name",h).html();for(var g=0;g<e.presets[e.active_idx]["columns"].length;g++){if(e.presets[e.active_idx]["columns"][g]["name"]==f){e.presets[e.active_idx]["columns"][g]["text"]=j}}$(d).data("presets",e)}});$(".gridsetting-column-width",d).textbox({name:"width",onchange:function(j){var e=$(d).data("params");var h=$(this).closest(".gridsetting-column-detail");var f=$(".gridsetting-column-name",h).html();for(var g=0;g<e.presets[e.active_idx]["columns"].length;g++){if(e.presets[e.active_idx]["columns"][g]["name"]==f){e.presets[e.active_idx]["columns"][g]["width"]=j}}$(d).data("presets",e)}});$(".filter-add-btn",d).click(function(){$(".filter-grid",d).grid_add()});$(".filter-grid",d).grid({"class":"transparent",columns:[{text:"",type:"html",html:"$.gridsetting_grid_option",width:"50px"},{text:"Key",type:"html",html:"$.gridsetting_grid_key",width:"150px"},{text:"Operator",type:"html",html:"$.gridsetting_grid_opt",width:"150px"},{text:"Value",type:"html",html:"$.gridsetting_grid_val",width:"150px"}]});$(".apply-btn",d).click(function(){var e=$(".filter-grid",d).grid_value();var g=$(d).data("params");var f=parseInt($.val("active_idx",g,{d:0}));g.presets[f]["filters"]=e;$.fire_event(a,[g],d);$(d).modal_close()});$(".close-btn",d).click(function(){$(d).modal_close()})})},gridsetting_close:function(){$(this).modal_close()},gridsetting_open:function(b,a){this.each(function(){var c=$.val("presets",b);var f=b.presets[b.active_idx];var d=$.val("columns",b);var e=$.val("filters",b);$(this).data("params",b);$(this).data("columns",d);$(".preset-grid",this).grid_set(c);$(".column-grid",this).grid_set(d);$(".filter-grid",this).grid_set(e);$(this).modal_open({height:window.innerHeight*0.8})})}});$.extend({gridsetting_preset_option:function(a){$(this).html("<button class='preset-grid-options'><span class='fa fa-times'></span></button>");$(".preset-grid-options",this).click(function(){$(this).closest("tr").remove()})},gridsetting_grid_option:function(a){$(this).html("<button class='filter-grid-options'><span class='fa fa-times'></span></button>");$(".filter-grid-options",this).click(function(){$(this).closest("tr").remove()})},gridsetting_grid_type:function(a){$(this).html("<span class='filter-grid-type'></span>");$(".filter-grid-type",this).textbox({name:"type",value:$.val("type",a,{d:null})})},gridsetting_grid_key:function(f,d){var b=$(this).closest(".gridsetting");var e=$(b).data("params");var k=e.presets[e.active_idx];var d=e.columns;var h=[];if($.type(d)=="array"){for(var g=0;g<d.length;g++){var c=d[g];var a=$.val("name",c,{d:""});var j=$.val("text",c,{d:a});if(a.length>0){h.push({text:j,value:a})}}}$(this).html("<span class='filter-grid-key'></span>");$(".filter-grid-key",this).dropdown({name:"key",items:h,value:$.val("key",f,{d:null})})},gridsetting_grid_opt:function(a){$(this).html("<span class='filter-grid-opt'></span>");$(".filter-grid-opt",this).dropdown({name:"operator",items:[{text:"Contains",value:"contains"},{text:"Equals",value:"equals"}],value:$.val("operator",a,{d:null})})},gridsetting_grid_val:function(a){$(this).html("<span class='filter-grid-val'></span>");$(".filter-grid-val",this).textbox({name:"value",value:$.val("value",a,{d:null})})}});$.fn.extend({hidden:function(b){var a=$.val("name",b,{d:""});$(this).each(function(){var c=[];$(this).html(c.join(""));$(this).attr("data-type","hidden");$(this).attr("data-name",a);$(this).addClass("hidden");$(this).data("options",b)})},hidden_val:function(b){if(typeof b=="undefined"){var a=[];$(this).each(function(){a.push($(this).data("value"))});return a.length>1?a:(a.length==1?a[0]:"")}else{$(this).each(function(){$(this).data("value",b)})}}});$.fn.extend({image:function(c){var e=$.val("class",c,{d:""});var a=$.val("height",c,{d:"50px"});var b=$.val("name",c,{d:""});var f=$.val("value",c,{d:""});var d=$.val("width",c,{d:"50px"});this.each(function(){var h=this;var g=[];g.push('<img src="'+f+'"/>');$(h).attr("data-type","image");$(h).attr("data-name",b);$(h).addClass("image");$(h).addClass(e);$(h).html(g.join(""));$(h).data("options",c);$("img",h).css({width:d,height:a})})},image_val:function(b){if(typeof b=="undefined"){var a=[];this.each(function(){a.push($("img",this).attr("src"))});return a.length>1?a:(a.length==1?a[0]:"")}else{this.each(function(){$("img",this).attr("src",b)})}}});$.extend({layout_resize:function(){$(".layout-sidebar, .layout-main, .layout-ext",$(".layout")).css({height:window.innerHeight-$(".header").outerHeight()})}});$.fn.extend({layout:function(b){var d=$.val("class",b,{d:""});var c=$.val("size",b,{d:{}});var e=$.val("large",c,{d:"300px auto 400px"});var a=e.split(" ");$(this).each(function(){var f=$.val(0,a,{d:"200px"});var h="100%";var g=$.val(2,a,{d:"300px"});$(this).addClass("layout");$(this).addClass(d);$(".layout-sidebar",this).css({flex:"0 0 "+f});$(".layout-main",this).css({flex:"1 1 "+h});$(".layout-ext",this).css({flex:"0 0 "+g});$(".layout-sidebar, .layout-main, .layout-ext",this).css({height:window.innerHeight-$(".header").outerHeight()})});$(window).on("resize.layout",function(){$.layout_resize()})}});$.extend({layout2_resize:function(){$(".layout2").layout2_resize()}});$.fn.extend({layout2:function(a){var c=$.val("class",a,{d:""});var b=$.val("size",a,{d:"300px auto 400px"});var d=b.split(" ");$(this).each(function(){$(this).addClass("layout2");$(this).addClass(c);$(this).data("options",a);$(this).layout2_resize()});$(window).on("resize.layout",function(){$.layout2_resize()})},layout2_resize:function(){$(this).each(function(){var i=$(this).data("options");var a=$.val("onresize",i);var d=$.val("ext_hidden",i);var h=$.val("size",i,{d:"300px auto 400px"});var g=h.split(" ");var e=window.innerHeight-$(".header").outerHeight();var b=$.val(0,g,{d:"200px"});var c=$.val(2,g,{d:"300px"});var e=window.innerHeight-$(".header").outerHeight();c=$.calc_size(c,e);var f=e-c;$(".layout-sidebar",this).css({flex:"0 0 "+b,height:e});$(".layout-content",this).css({flex:"1 1 auto"});if(d==0){$(this).removeClass("ext-hidden");$(".layout-main",this).css({height:c});$(".layout-ext",this).css({height:f})}else{$(this).addClass("ext-hidden");$(".layout-main",this).css({height:e});$(".layout-ext",this).css({height:0})}$.fire_event(a,[],this)})},layout2_toggleext:function(a){$(this).each(function(){if(!$(this).hasClass("layout2")){return}var b=$(this).data("options");b.ext_hidden=a?0:1;$(this).data("options",b);$(this).layout2_resize()})},layout2_ext_state:function(){var a=0;$(this).each(function(){var b=$(this).data("options");a=$.val("ext_hidden",b,{d:-1})>0?0:1});return a}});$.fn.extend({modal_open:function(a){this.each(function(){var b=this;$(b).addClass("on");$(document.body).css({overflow:"hidden"});var e=$(b).outerHeight()-5-($(".modal-head",b).outerHeight()+$(".modal-foot",b).outerHeight());if(!isNaN(e)){$(".modal-body",b).css({height:e})}var c=$.val("reset",a,{d:false});if(c===true){$(b).reset()}var d=$.val("value",a,{d:null});if(d!=null){$(b).val(a.value)}})},modal_close:function(b,a){this.each(function(){var c=this;$(c).removeClass("on");$(".modal-bg").removeClass("on")});if($(".modal.on").length==0){$(document.body).css({overflow:""})}}});$.extend({popup_close:function(a){$(a).removeClass("on")},popup_open:function(a,b,i){$.popup_close_all();$(a).addClass("on");var e={};var d=$(b).offset();var h=d.left+a.clientWidth;var g=d.top-$(window).scrollTop()+$(b).outerHeight()+1;var f=window.innerHeight-g-10;e.top=g;e["max-height"]=f;if(h>window.innerWidth){d.left=window.innerWidth-a.clientWidth}e.left=d.left;var c=$.val("min_width",i);if(!isNaN(parseInt(c))){e["min-width"]=c}$(a).css(e)},popup_toggle:function(c,a,b){if(c.classList.contains("on")){$.popup_close(c,a,b)}else{$.popup_open(c,a,b)}},popup_close_all:function(){var a=document.body.querySelectorAll(".popup");for(var b=0;b<a.length;b++){$.popup_close(a[b])}}});$.fn.extend({radio:function(a){$(this).each(function(){var g=$.val("items",a,{d:null});var f=$.val("class",a,{d:""});var n=$.val("text",a,{d:""});var b=$.val("name",a,{d:""});var j=$.val("value",a,{d:""});var d=[];if($.type(g)=="array"){var o="radio-name-"+$.uniqid();for(var c=0;c<g.length;c++){var m=g[c];var l=m.text;var k=m.value;var h=j!=""&&j==k?true:false;var e="radio-"+$.uniqid();d.push("<input type='radio' id='"+e+"' value=\""+k+"\" name='"+o+"'"+(h?" checked":"")+"/>");d.push("<label for='"+e+"'>"+l+"</label>")}}else{var h=parseInt(j)==1||j===true?true:false;var e="radio-"+$.uniqid();d.push("<input type='radio' id='"+e+"'"+(h?" checked":"")+"/>");d.push("<label for='"+e+"'>"+n+"</label>")}$(this).addClass("radio");$(this).addClass(f);$(this).attr({"data-type":"radio"});$(this).html(d.join(""))})},radio_val:function(b){if(typeof b=="undefined"){var a=[];$(this).each(function(){var c=this.querySelectorAll("input");if(c.length==1){a.push(c[0].checked?1:0)}else{for(var d=0;d<c.length;d++){if(c[d].checked){a.push(c[d].value)}}}});a=a.join(",");return a}else{$(this).each(function(){var c=this.querySelectorAll("input");if(c.length==1){c[0].checked=(parseInt(b)==1||b===true)?true:false}else{var e=false;for(var d=0;d<c.length;d++){if(c[d].value==b){c[d].checked=true;e=true;break}}if(!e){$("input",this).attr("checked",false)}}})}}});$.extend({role_init:function(b){var a=typeof b!="undefined"&&b instanceof HTMLElement?b:document.body;$("*[data-role]",a).each(function(){var d=this.getAttribute("data-role");switch(d){case"modal.close":$(this).click(function(){$(this).closest(".modal").modal_close()});break;case"url.open":var c=$(this).attr("data-role-value");$(this).click(function(){window.location=c});break}})}});$.fn.extend({autocomplete:function(b){var e=$.val("class",b,{d:""});var a=$.val("name",b,{d:""});var g=$.val("src",b,{d:""});var d=$.val("width",b);var f=$.val("placeholder",b,{d:""});var c={};if(d!=null){c.width=d}this.each(function(){var i=this;var h=[];h.push("<input type='text' placeholder=\""+f+'"/>');h.push("<span class='icon fa fa-search hoverable selectable'></span>");h.push("<span class='popup'></span>");$(i).addClass("autocomplete");$(i).addClass(e);$(i).html(h.join(""));$(i).css(c);$(i).attr("data-name",a);$(i).attr("data-type","autocomplete");$(i).data("options",b);$("input[type='text']",i).on("keyup",function(m){var l=$(this).closest(".autocomplete");if($(l).hasClass("readonly")){return}var k=$(l).data("options");var j=$.val("readonly",k);if(!j&&g.length>0){var n={};n.key=this.value;$.api_get(g,n,function(o){var t=$.val("data",o);var q=[];if($.type(t)=="array"){for(var p=0;p<t.length;p++){var r=t[p];var s=$.val("value",r,{d:""});var u=$.val("text",r,{d:s});q.push("<div class='item' data-value=\""+s+'">');q.push("<label>"+u+"</label>");q.push("</div>")}}$(".popup",l).html(q.join(""));$(".item",$(".popup",l)).on("click",function(){var w=this.getAttribute("data-value");var y=$("label",this).text();var x={value:w,text:y};$(l).autocomplete_val(x)});$.popup_open($(".popup",l),l,{min_width:$(l).outerWidth()})})}})})},autocomplete_val:function(c,a){if(typeof c=="undefined"){var b=[];$(this).each(function(){var f=$(this).data("options");var d=$.val("multiple",f,{d:false});if(d){$(".text",this).each(function(){b.push(this.getAttribute("data-value"))})}else{var g=$("input",this).val();var e=$(this).data("value");if(e==null){e=g}b.push(e)}});return b.length==1?b[0]:(b.length>1?b:"")}else{$(this).each(function(){var g=$(this).data("options");var f=$.val("multiple",g,{d:false});var h=b="";if($.type(c)=="object"){b=$.val("value",c,{d:""});h=$.val("text",c,{d:b})}else{h=b=c}if(f){var e=typeof a!="undefined"&&a===true?true:false;if(e){$(".text",this).remove()}var d=$(this).val();if(!$.in_array(b,d)&&b!==""){$("<span class='text' data-value=\""+b+'">'+h+"<span class='icon-remove glyphicons glyphicons-remove'></span></span>").insertBefore($("input",this));$(".glyphicons-remove",$("input",this).prev()).on("click",function(){$(this).parent().remove()})}$("input",this).val("")}else{$("input",this).val(h);$(this).data("value",b)}})}},autocomplete_readonly:function(a){if(typeof a=="undefined"){return $(this).hasClass("readonly")?true:false}else{if(a){$(this).addClass("readonly");$("input",this).attr("readonly",true);$("input",this).data("placeholder",$("input",this).attr("placeholder"));$("input",this).attr("placeholder","")}else{$(this).removeClass("readonly");$("input",this).attr("readonly",false);$("input",this).attr("placeholder",$("input",this).data("placeholder"))}}},autocomplete_reset:function(){$(this).autocomplete_val("",true)}});$.fn.extend({calendar:function(a){this.each(function(){var c=this;var d=$.val("value",a,{d:"2017-01-01"});d=$.date("j M Y",$.strtotime(d));var b=[];b.push("<input type='text' value='"+d+"' readonly/>");b.push("<span class='icon fa fa-calendar'></span>");b.push("<span class='popup'>Calendar</span>");$(c).addClass("calendar");$(c).html(b.join(""));$(c).attr("data-type","calendar");$(".icon",this).click(function(f){f.preventDefault();f.stopPropagation()});$(".popup",this).click(function(f){f.preventDefault();f.stopPropagation()})})}});$.extend({calendar_open:function(d){var b=d.refEl;var c=d.value;var a=$("#calendar");if(a.length==0){a=document.createElement("div");a.id="calendar";a.className="popup";document.body.appendChild(a);a=$("#calendar")}a=a[0];$(a).data("params",d);$.calendar_set(c);$.popup_open(a,b)},calendar_set:function(b){var c=$("#calendar").data("params");var a=$.val("type",c,{d:""});switch(a){case"range":$.calendar_set_range(b);break;default:$.calendar_set_single(b);break}},calendar_set_single:function(n){var a=$("#calendar");$(a).attr("data-value",n);var l=$.date("n",$.strtotime(n));var m=$.date("Y",$.strtotime(n));var c=$.date("j",$.strtotime(n));var k=$.start_day_of_month(m,l)%7;var o=$.last_date_of_month(m,l);var p=$.date("M Y",$.strtotime(n));var e=$(a).data("params");var d=e.onchange;var h=[];h.push("<table>");h.push("<tr>");h.push("<td><span class='calendar-prev fa fa-caret-left padding5'></span></td>");h.push("<td colspan='5'><span class='date-label'>"+p+"</span></td>");h.push("<td><span class='calendar-next fa fa-caret-right padding5'></span></td>");h.push("</tr>");h.push("<tr>");h.push("<td>Sun</td>");h.push("<td>Mon</td>");h.push("<td>Tue</td>");h.push("<td>Wed</td>");h.push("<td>Thu</td>");h.push("<td>Fri</td>");h.push("<td>Sun</td>");h.push("</tr>");var b=1;for(var g=0;g<6;g++){h.push("<tr>");for(var f=0;f<7;f++){if(k>0){h.push("<td></td>");k--}else{if(b<=o){h.push(b==c?"<td class='day active'>"+b+"</td>":"<td class='day'>"+b+"</td>");b++}else{h.push("<td></td>")}}}h.push("</tr>")}h.push("</table>");a.html(h.join(""));$(".day",a).click(function(t){t.preventDefault();t.stopPropagation();var i=$(this).closest("#calendar");var q=$(i).attr("data-value");var j=this.innerHTML;var s=parseInt($.date("n",$.strtotime(q)));var r=$.date("Y",$.strtotime(q));var u=$.date("j M Y",$.mktime(0,0,0,s,j,r));$.fire_event(d,[u],i);$.popup_close(i)});$(".calendar-prev",a).click(function(s){s.preventDefault();s.stopPropagation();var i=$(this).closest("#calendar");var j=$(i).attr("data-value");var r=parseInt($.date("n",$.strtotime(j)));var q=parseInt($.date("Y",$.strtotime(j)));var u=parseInt($("td.active",i).html());var t=$.date("Y-m-d",$.mktime(0,0,0,r-1,u,q));$.calendar_set(t)});$(".calendar-next",a).click(function(s){s.preventDefault();s.stopPropagation();var i=$(this).closest("#calendar");var j=$(i).attr("data-value");var r=parseInt($.date("n",$.strtotime(j)));var q=parseInt($.date("Y",$.strtotime(j)));var u=parseInt($("td.active",i).html());var t=$.date("Y-m-d",$.mktime(0,0,0,r+1,u,q));$.calendar_set(t)})},calendar_set_range:function(l,u,e){var b=$("#calendar");$(b).attr("data-value",l);var y=$(b).data("params");var x=y.onchange;l=l.split("-");var a=l[0];var A=l[1];if($.date("Y",$.strtotime(a))=="1970"){a=$.date("Y-m-d")}if($.date("Y",$.strtotime(A))=="1970"){A=$.date("Y-m-d")}var w=[],m=[],r=[],d=[],t=[],c=[],h=[];var p=$.date("Y",$.strtotime(u))!="1970"?u:a;var n=$.date("Y",$.strtotime(e))!="1970"?e:A;if($.date("Ym",$.strtotime(n))==$.date("Ym",$.strtotime(p))){n=$.date("Y-m-d",$.mktime(0,0,0,parseInt($.date("n",$.strtotime(n)))+1,$.date("j",1,$.date("Y",$.strtotime(n)))))}w[0]=$.date("n",$.strtotime(p));m[0]=$.date("m",$.strtotime(p));r[0]=$.date("Y",$.strtotime(p));d[0]=$.date("j",$.strtotime(p));t[0]=$.start_day_of_month(r[0],w[0])%7;c[0]=$.last_date_of_month(r[0],w[0]);h[0]=$.date("M Y",$.strtotime(p));w[1]=$.date("n",$.strtotime(n));m[1]=$.date("m",$.strtotime(n));r[1]=$.date("Y",$.strtotime(n));d[1]=$.date("j",$.strtotime(n));t[1]=$.start_day_of_month(r[1],w[1])%7;c[1]=$.last_date_of_month(r[1],w[1]);h[1]=$.date("M Y",$.strtotime(n));var g=[];for(var s=0;s<2;s++){g.push("<table class='calendar-table range-"+s+"'>");g.push("<tr>");g.push($.p("<td><span class='calendar-prev fa fa-caret-left padding5' data-calendaridx='$i'></span></td>",[s]));g.push("<td colspan='5'><span class='date-label'>"+h[s]+"</span></td>");g.push($.p("<td><span class='calendar-next fa fa-caret-right padding5' data-calendaridx='$i'></span></td>",[s]));g.push("</tr>");g.push("<tr>");g.push("<td>Sun</td>");g.push("<td>Mon</td>");g.push("<td>Tue</td>");g.push("<td>Wed</td>");g.push("<td>Thu</td>");g.push("<td>Fri</td>");g.push("<td>Sun</td>");g.push("</tr>");var z=1;for(var q=0;q<6;q++){g.push("<tr>");for(var o=0;o<7;o++){if(t[s]>0){g.push("<td></td>");t[s]--}else{if(z<=c[s]){var f=$.date("Y-m-d",$.strtotime(r[s]+"-"+m[s]+"-"+$.str_pad(z,2,"0","STR_PAD_LEFT")));if($.strtotime(f)>=$.strtotime(a)&&$.strtotime(f)<=$.strtotime(A)){g.push("<td class='day active' data-date='"+f+"'>"+z+"</td>")}else{g.push("<td class='day' data-date='"+f+"'>"+z+"</td>")}z++}else{g.push("<td></td>")}}}g.push("</tr>")}g.push("</table>")}b.html(g.join(""));b.data("seq",0);$(".day",b).click(function(B){B.preventDefault();B.stopPropagation();console.log("value: "+1);var i=$(this).closest("#calendar");var k=$(i).attr("data-value");var j=this.innerHTML;var C=parseInt($.date("n",$.strtotime(k)));var E=$.date("Y",$.strtotime(k));var D=$.date("j M Y",$.mktime(0,0,0,C,j,E));var I=parseInt(i.data("seq"));if(I==0){$(".day.active-0").removeClass("active active-0");$(this).addClass("active active-0");var J=$(this).attr("data-date");var F=$(i).attr("data-value");F=F.split(",");var H=$.val(1,F,{d:J});$(".day",i).each(function(){var K=$(this).attr("data-date");if($.strtotime(K)>=$.strtotime(J)&&$.strtotime(K)<=$.strtotime(H)){$(this).addClass("active")}else{$(this).removeClass("active")}})}else{$(".day.active-1").removeClass("active active-1");$(this).addClass("active active-1")}i.data("seq",I+1);if(I==1){var J=$(".day.active-0").attr("data-date");var H=$(".day.active-1").attr("data-date");if($.strtotime(J)>$.strtotime(H)){var G=J;J=H;H=G}var F=$.date("Ymd",$.strtotime(J))+"-"+$.date("Ymd",$.strtotime(H));$.popup_close(i);$.fire_event(x,[F],i)}});$(".calendar-prev",b).click(function(j){var i=parseInt($(this).attr("data-calendaridx"));console.log(["prev",l,parseInt($(this).attr("data-calendaridx")),p,n]);j.preventDefault();j.stopPropagation();if(i==0){p=$.date("Y-m-d",$.mktime(0,0,0,parseInt($.date("n",$.strtotime(p)))-1,$.date("j",$.strtotime(p)),$.date("Y",$.strtotime(p))))}else{if(i==1){n=$.date("Y-m-d",$.mktime(0,0,0,parseInt($.date("n",$.strtotime(n)))-1,$.date("j",$.strtotime(n)),$.date("Y",$.strtotime(n))));if($.date("Ym",$.strtotime(p))>=$.date("Ym",$.strtotime(n))){p=$.date("Y-m-d",$.mktime(0,0,0,parseInt($.date("n",$.strtotime(p)))-1,$.date("j",$.strtotime(p)),$.date("Y",$.strtotime(p))))}}}$.calendar_set_range(l.join(","),p,n)});$(".calendar-next",b).click(function(j){var i=parseInt($(this).attr("data-calendaridx"));j.preventDefault();j.stopPropagation();if(i==0){p=$.date("Y-m-d",$.mktime(0,0,0,parseInt($.date("n",$.strtotime(p)))+1,$.date("j",$.strtotime(p)),$.date("Y",$.strtotime(p))));if($.date("Ym",$.strtotime(n))<=$.date("Ym",$.strtotime(p))){n=$.date("Y-m-d",$.mktime(0,0,0,parseInt($.date("n",$.strtotime(n)))+1,$.date("j",$.strtotime(n)),$.date("Y",$.strtotime(n))))}}else{if(i==1){n=$.date("Y-m-d",$.mktime(0,0,0,parseInt($.date("n",$.strtotime(n)))+1,$.date("j",$.strtotime(n)),$.date("Y",$.strtotime(n))))}}$.calendar_set_range(l.join(","),p,n)})}});$.fn.extend({chart:function(c){var b=$.val("name",c);var a=$.val("height",c);var d=$.val("width",c);this.each(function(){var g=this;var f={};f.height=a;f.width=d;var e=[];$(g).addClass("chart");$(this).html(e.join(""));$(this).css(f);$(g).attr("data-type","chart");$(g).attr("data-name",b);$(g).data("options",c)})},chart_set:function(a){this.each(function(){var d=this;var b=$(d).data("options");var c=$.val("type",b,{default_value:"line"});switch(c){case"bar":$(this).chart_bar_set(a);break;default:$(this).chart_line_set(a);break}})},chart_bar_set:function(a){this.each(function(){var b=this;var f=$(b).data("options");var t=$(b).outerHeight();var z=$(b).outerWidth();var s=$.val("padding",f,{default_value:10});var A=$.array_key_count(a);var i=$.object_value_min(a);var r=$.object_value_max(a);var u=s;var k=z-s;var E=k-u;var q=(z*0.8)/A;var g=(E-(q*A))/(A+1);var H=t-s;var I=10;var c=H-I;var j=c/(r-i);var p=[];p.push($.p('<svg width="$1" height="$2">',[z,t]));var D=u;var C=k;var e=H,d=H;p.push($.p('<line x1="$x1" y1="$y1" x2="$x2" y2="$y2" style="stroke:rgb(0,0,0);stroke-width:1" />',[D,e,C,d]));var m=0;for(var G in a){var F=a[G];var o=q;var B=j*F;if(B<5){B=5}var n=m*(g+q)+g;var l=H-B;p.push($.p('<rect x="$1" y="$1" width="$1" height="$1" stroke="#4A89DC" stroke-width="2" fill="rgba(74, 137, 220, .2)" data-key="$1" data-value="$1" onmouseover="$1" onmouseout="$1"/>',[n,l,o,B,G,F,"$.chart_line_mouseover.call(this)","$.chart_line_mouseout.call(this)"]));m++}p.push("</svg>");$(b).html(p.join(""))})},chart_line_set:function(a){this.each(function(){var b=this;var i=$(b).data("options");var q=$(b).outerHeight();var s=$(b).outerWidth();var t=$.array_key_count(a);var j=$.object_value_min(a);var o=$.object_value_max(a);var p=$.val("padding",i,{default_value:10});var r=p;var l=s-p;var y=l-r;var z=y/(t-1);var C=q-p;var D=10;var c=C-D;var k=c/(o-j);var n=[];n.push($.p('<svg width="$1" height="$2">',[s,q]));var w=r;var u=l;var h=C,f=C;n.push($.p('<line x1="$x1" y1="$y1" x2="$x2" y2="$y2" style="stroke:rgb(0,0,0);stroke-width:1" />',[w,h,u,f]));var m=1;for(var B in a){var g=Math.round(r+(m*z));n.push($.p('<line x1="$1" y1="$1" x2="$1" y2="$1" style="stroke:rgba(0, 0, 0, .05);stroke-width:1" />',[g,C,g,D]));m++}var m=0;var x=[];x.push($.p("M$1 $2",[Math.round(r+(m*z)),C]));for(var B in a){var A=a[B];var g=Math.round(r+(m*z));var e=Math.round(C-(A*k));x.push($.p("L$1 $2",[g,e]));m++}x.push($.p("M$1 $2 Z",[g,C]));n.push($.p('<path d="$1" stroke-width="0" stroke="transparent" fill="rgba(74, 137, 220, .2)"/>',[x.join(" ")]));var m=0;var x=[];for(var B in a){var A=a[B];var g=Math.round(r+(m*z));var e=Math.round(C-(A*k));if(m==0){x.push($.p("M$1 $2",[g,e]))}else{x.push($.p("L$1 $2",[g,e]))}m++}n.push($.p('<path d="$1" stroke-width="2" stroke="#4A89DC" fill="transparent"/>',[x.join(" ")]));var m=0;for(var B in a){var A=a[B];var g=r+(m*z);var e=C-(A*k);n.push($.p('<circle cx="$1" cy="$1" r="1" stroke="#4A89DC" stroke-width="2" fill="#4A89DC" onmouseover="$1" onmouseout="$1" data-key="$1" data-value="$1"/>',[g,e,"$.chart_line_mouseover.call(this)","$.chart_line_mouseout.call(this)",B,A]));m++}n.push("</svg>");$(b).html(n.join(""))})}});$.extend({chart_line_mouseover:function(){$(this).attr({r:2});var a=$(this).attr("data-key");var b=$(this).attr("data-value");$.tooltip(this,a+"<br />"+b)},chart_line_mouseout:function(){$(this).attr({r:1});$.tooltip_remove()}});$.fn.extend({checkbox:function(a){this.each(function(){var e=$.val("class",a,{d:""});var b=$.val("items",a,{d:null});var d=[];if($.type(b)=="array"){$(b).each(function(){var j=$.val("text",this,{d:""});var i=$.val("value",this,{d:""});var h="checkbox-"+$.uniqid();d.push("<span class='item'><input id='"+h+"' type='checkbox' value=\""+i+"\"/><label for='"+h+"'>"+j+"</label></span>")})}else{var g=$.val("text",a,{d:""});var f="";var c="checkbox-"+$.uniqid();d.push("<span class='item'><input id='"+c+"' type='checkbox' value=\""+f+"\"/><label for='"+c+"'>"+g+"</label></span>")}$(this).addClass("checkbox");$(this).addClass(e);$(this).html(d.join(""));$(this).data("options",a)})}});$.fn.extend({checklist:function(a){$(this).each(function(){var b=this;var c=[];c.push("<div class='checklist-body'>");c.push("<div class='checklist-item'>");c.push("<input type='checkbox' />");c.push("<input type='text' />");c.push("<span class='iconbar'>");c.push("<span class='checklist-remove fa fa-times padding5 selectable'></span>");c.push("</span>");c.push("</div>");c.push("</div>");c.push("<div class='checklist-foot'>");c.push("<span class='checklist-add fa fa-plus-circle padding5 selectable hoverable'></span>");c.push("</div>");$(this).addClass("checklist");$(this).html(c.join(""));$(".checklist-add",this).click(function(){$(b).checklist_add()});$(".checklist-remove",this).on("click.checklist",function(){$(this).closest(".checklist-item").remove()})})},checklist_add:function(){$(this).each(function(){var a=[];a.push("<div class='checklist-item'>");a.push("<input type='checkbox' />");a.push("<input type='text' />");a.push("<span class='iconbar'>");a.push("<span class='checklist-remove fa fa-times padding5 selectable hoverable'></span>");a.push("</span>");a.push("</div>");$(".checklist-body",this).append(a.join(""));$(".checklist-remove",$(".checklist-body",this)).on("click.checklist",function(){$(this).closest(".checklist-item").remove()})})},checklist_get:function(){var a=[];$(this).each(function(){$(".checklist-item",this).each(function(){var b=$("input[type='checkbox']",this)[0].checked;var c=$("input[type='text']",this).val();if(c.length>0){a.push({checked:b,text:c})}})});return a.length==0?null:a},checklist_set:function(a){$(this).checklist_attr({value:a})},checklist_attr:function(a){if($.type(a)!="object"){return}$(this).each(function(){for(var d in a){var g=a[d];switch(d){case"readonly":if(g){$("input[type='checkbox']",this).attr("disabled",true);$("input[type='text']",this).attr("readonly",true);$(".checklist-remove",this).addClass("hidden");$(".checklist-add",this).addClass("hidden")}else{$("input[type='checkbox']",this).attr("disabled",false);$("input[type='text']",this).attr("readonly",false);$(".checklist-remove",this).removeClass("hidden");$(".checklist-add",this).removeClass("hidden")}break;case"value":var c=[];if($.type(g)=="array"){for(var b=0;b<g.length;b++){var f=g[b];var h=$.val("text",f,{d:""});var e=$.val("checked",f,{d:false});if(h==""){continue}c.push("<div class='checklist-item'>");c.push("<input type='checkbox'"+(e?" checked":"")+"/>");c.push("<input type='text' value=\""+h+'" />');c.push("<span class='iconbar'>");c.push("<span class='checklist-remove fa fa-times padding5 selectable hoverable'></span>");c.push("</span>");c.push("</div>")}}c.push("<div class='checklist-item'>");c.push("<input type='checkbox'/>");c.push("<input type='text'/>");c.push("<span class='iconbar'>");c.push("<span class='checklist-remove fa fa-times padding5 selectable hoverable'></span>");c.push("</span>");c.push("</div>");$(".checklist-body",this).html(c.join(""));$(".checklist-remove",$(".checklist-body",this)).on("click.checklist",function(){$(this).closest(".checklist-item").remove()});break}}})}});$.fn.extend({choice:function(a){$(this).each(function(){var e=$.val("class",a,{d:""});var b=$.val("items",a,{d:[],datatype:"array"});var d=[];if($.type(b)=="array"){for(var c=0;c<b.length;c++){var f=b[c];var g=$.val("value",f,{d:""});var h=$.val("text",f,{d:g});if(g.length==0){continue}d.push($.p('<span class="item">'));d.push($.p("</span>"))}}$(this).addClass("choice");$(this).addClass(e)})}});$.fn.extend({codeeditor:function(c){var a=$.val("height",c,{d:"200px"});var d=$.val("width",c,{d:"300px"});var b=$.val("name",c,{d:""});var e=$.val("value",c,{d:"300px"});this.each(function(){var g=$.uniqid();var f=[];f.push($.p('<textarea id="$1""></textarea>',["codeeditor-text-"+g]));$(this).addClass("codeeditor");$(this).html(f.join(""));$(this).css({width:d,height:a});$(this).codeeditor_attr({name:b});var h=CodeMirror.fromTextArea(document.getElementById("codeeditor-text-"+g),{lineNumbers:true,mode:"text/x-mariadb",indentWithTabs:true,smartIndent:true,matchBrackets:true,autofocus:true})})},codeeditor_get:function(){var a=[];$(this).each(function(){a.push($("textarea",this).val())});return a.length==1?a[0]:(a.length>1?a:"")},codeeditor_set:function(a){$(this).each(function(){$("textarea",this).val(a)})},codeeditor_attr:function(a){this.each(function(){var d={};var e={};var b={};for(var c in b){var f=b[c];switch(c){case"name":b.name=f}}$(this).attr(b);$(this).css(d);$("textarea",this).css(e)})}});$.fn.extend({codefield:function(c){var f=$.val("placeholder",c,{d:""});var b=$.val("name",c,{d:""});var a=$.val("height",c);var e=$.val("width",c);var d={width:e,height:a};this.each(function(){var h=this;var g=[];g.push("<pre style='height:"+a+";'>"+JSON.stringify({name:"andy"},null,2)+"</pre>");g.push("<span class='icon fa hidden'></span>");$(h).addClass("codefield");$(h).css(d);$(h).html(g.join(""));$(h).attr("data-type","codefield");$(h).attr("data-name",b);$(h).data("options",c)})},codefield_get:function(){var a=[];this.each(function(){var b=$("pre",this).html();a.push(b)});return a.length>1?a:(a.length==1?a[0]:"")},codefield_set:function(a){this.each(function(){$("pre",this).html(a)})}});$.fn.extend({commentlist:function(b){var a=$.val("onsubmit",b);$(this).each(function(){var c=this;var d=[];d.push("<div class='commentlist-write'>");d.push("<input type='text' placeholder='Write comment here...' />");d.push("</div>");d.push("<div class='commentlist-list'></div>");$(this).addClass("commentlist");$(this).html(d.join(""));$(this).data("options",b);$("input[type='text']",this).on("keyup",function(f){if(f.keyCode==13){if(f.shiftKey){}else{if(this.value!=""){$.fire_event(a,[this.value],c);this.value="";$(this).blur()}}}})})},commentlist_add:function(a){$(this).each(function(){var c=$(this).data("options");var e=$.val("onremove",c);var i=$.val("id",a);var h=$.val("comment",a);var g=$.val("full_name",a);var f=$.val("createdon",a);var b=$.val("removable",a,{d:0});if(!h||!g){return}var d=[];d.push("<div class='commentlist-item' data-id='"+i+"'>");d.push("<p style='word-wrap: break-word;'><b>"+g+"</b> "+h+"</p>");d.push("<div class='commentlist-item-footer'>");d.push("<label class=''>"+f+"</label>");if(b){d.push("<span class='width5 height5'>&nbsp;</span>");d.push("<span class='comment-item-remove selectable hoverable'>Remove</span>")}d.push("</div>");d.push("</div>");$(".commentlist-list",this).append(d.join(""));$(".comment-item-remove",$(".commentlist-list",this)).on("click",function(){var j=$(this).closest(".commentlist-item").attr("data-id");$.fire_event(e,[j],this)})})},commentlist_set:function(a){$(this).each(function(){var l=$(this).data("options");var e=$.val("onremove",l);var g=[];if($.type(a)=="array"){for(var f=0;f<a.length;f++){var d=a[f];var c=$.val("id",d);var h=$.val("comment",d);var j=$.val("full_name",d);var k=$.val("createdon",d);var b=$.val("removable",d,{d:0});if(!h||!j){continue}g.push("<div class='commentlist-item' data-id='"+c+"'>");g.push("<p style='word-wrap: break-word;'><b>"+j+"</b> "+h+"</p>");g.push("<div class='commentlist-item-footer'>");g.push("<label class=''>"+k+"</label>");if(b){g.push("<span class='width5 height5'>&nbsp;</span>");g.push("<span class='comment-item-remove selectable hoverable'>Remove</span>")}g.push("</div>");g.push("</div>")}}$(".commentlist-list",this).html(g.join(""));$(".comment-item-remove",$(".commentlist-list",this)).on("click",function(){var i=$(this).closest(".commentlist-item").attr("data-id");$.fire_event(e,[i],this)})})}});$.fn.extend({container_val:function(a){if(typeof a=="undefined"){result={};$("*[data-type]",this).each(function(){var b=this.getAttribute("data-name");if(b!=null&&b!=""){var c=$(this).val();result[b]=c}});return result}else{$("*[data-type]",this).each(function(){var b=this.getAttribute("data-name");if(b!=null&&b!=""){var c=$.val(b,a,{d:""});$(this).val(c)}})}},container_reset:function(){$("*[data-type]",this).each(function(){var a=$(this).attr("data-type");if(a!=null&&typeof $(this)[a+"_reset"]!="undefined"){$(this)[a+"_reset"].apply(this,arguments)}})}});$.fn.extend({datepicker:function(a){var b=$.val("type",a);this.each(function(){var d=this;var c=[];c.push("<input type='text' readonly/>");c.push("<span class='icon fa fa-calendar'></span>");$(d).addClass("datepicker");$(d).html(c.join(""));$(d).attr("data-type","datepicker");$(d).data("options",a);$(".icon",this).click(function(i){i.preventDefault();i.stopPropagation();var h=$(this).closest(".datepicker");var g=$(h).data("options");var f=$.val("readonly",g,{d:false});if(f=="0"||f==false){$.calendar_open({refEl:h,value:$(h).data("value"),type:b,onchange:function(e){$(h).datepicker_val(e)}})}});$(".popup",this).click(function(f){f.preventDefault();f.stopPropagation()});$(this).datepicker_val($.val("value",a,{d:"20170101"}))})},datepicker_val:function(a){if(typeof a=="undefined"){var a=[];$(this).each(function(){var b=$(this).data("value");a.push(b)});return a.length==1?a[0]:(a.length==0?null:a)}else{$(this).each(function(){var f="";a=$.date_parse(a);if(a.indexOf("-")>=0){var e=a.split("-");var c=$.date("M j, Y",$.strtotime(e[0]));var b=$.date("M j, Y",$.strtotime(e[1]));f=c+" - "+b}else{var e=$.date("M j, Y",$.strtotime(a));f=e}$("input",this).val(f);$(this).data("value",a)})}}});$.fn.extend({dropdown:function(j){var e=$.val("class",j,{d:""});var b=$.val("name",j,{d:""});var i=$.val("defaultvalue",j,{d:""});var h=$.val("value",j,{d:i});var f=$.val("items",j,{d:[]});var c=$.val("width",j,{d:[]});var a=$.val("src",j,{d:""});var g=$.val("placeholder",j,{d:""});var d=[];d.push("<input class='text' type='text' placeholder=\""+g+'" readonly/>');d.push("<span class='icon fa fa-caret-down hoverable'></span>");d.push("<span class='popup'></span>");this.each(function(){var k=this;$(k).addClass("dropdown");$(k).addClass(e);$(k).html(d.join(""));$(k).data("options",j);$(k).attr("data-type","dropdown");$(k).attr("data-name",b);$(k).dropdown_attr(j);$(".icon, .text",k).click(function(o){o.preventDefault();o.stopPropagation();var n=$(this).closest(".dropdown");var m=$(n).data("options");var l=$.val("readonly",m);if(!l){if($(".popup",n).hasClass("on")){$.popup_close($(".popup",n))}else{$.popup_open($(".popup",n),n,{min_width:$(n).outerWidth()});$(".search-item input",$(".popup",n)).val("");$(".search-item input",$(".popup",n)).focus();$(".item",$(".popup",n)).show()}}});if(h!=""){$(k).dropdown_val()}if(a.length>0){$(this).dropdown_load()}})},dropdown_val:function(c,b){if(typeof c=="undefined"){var a=[];this.each(function(){var d=this;var e=$(d).attr("data-value");var f=$("input",d).length==1?$("input",d).val():$(".text",d).html();e=e==null?f:e;a.push(e)});return a.length==1?a[0]:(a.length>1?a:null)}else{this.each(function(){var e=$(this).data("options");var d=$.val("items",e,{d:[]});var j="";var h="";if($.type(c)=="object"){h=$.val("value",c);j=$.val("text",c,{d:h})}else{if($.type(h)=="string"){j=h=c}}if($.type(d)=="array"){for(var f=0;f<d.length;f++){var g=d[f];if(g.value==h){j=g.text;h=g.value;break}}}$(this).attr("data-value",h);$("input",this).val(j);$(".text",this).html(j)})}},dropdown_items:function(a){if(typeof a=="undefined"){var b=[];this.each(function(){var e=this;var d=$(e).data("options");var c=$.val("items",d,{d:[]});$(c).each(function(){if($.type(this)=="object"){b.push(this)}})});return b}else{this.each(function(){var c=this;var n=$(c).data("options");var h=$.val("searchable",n,{d:false});var o=$.val("multiple",n,{d:false});var d=$.val("onchange",n);var f=[];if(h==true){f.push("<div class='search-item'>");f.push("<input type='text' placeholder='Search'/>");f.push("</div>")}if($.type(a)=="array"){for(var e=0;e<a.length;e++){var l=a[e];var k=l.text;var j=l.value;var m=(k+" "+j).toLowerCase();var g=$.uniqid();f.push("<div class='item' data-value=\""+j+'" data-search="'+m+'">');if(o){f.push("<input type='checkbox' id='dropdown_item_checkbox_"+g+"'/>")}f.push("<label for='dropdown_item_checkbox_"+g+"'>"+k+"</label>");f.push("</div>")}}f=f.join("");$(".popup",c).html(f);$(c).data("options",n);$(".item",$(".popup",c)).click(function(t){if(o){t.stopPropagation()}var x=$("label",this).html();var w=$(this).attr("data-value");var s=-1;var q=null;for(var r=0;r<a.length;r++){var y=a[r];var u=$.val("text",y);var p=$.val("value",y);if(p==w||u==x){s=r;q=y;break}}if(q){q._index=s}$("input",c).val(x);$(".text",c).html(x);$(c).attr("data-value",w);$.fire_event(d,[t,q],c)});$(".item>input[type='checkbox']",$(".popup",c)).on("change",function(){var p=this.nextElementSibling.innerHTML;var i=this.parentNode.getAttribute("data-value");$(c).dropdown_val({text:p,value:i},true)});$(".popup .search-item input",c).click(function(i){i.preventDefault();i.stopPropagation()});$(".popup .search-item input",c).keyup(function(q){var p=this.value;var i=$(this).closest(".popup");$(".item",i).show();if(p.length>0){$(".item:not([data-search*='"+p+"'])",i).hide()}});n.items=a;$(c).data("options",n);$(c).dropdown_val("*")})}},dropdown_attr:function(a){this.each(function(){var b=$(this).data("options");if($.type(a)=="object"){for(var d in a){var e=a[d];var c={};switch(d){case"items":$(this).dropdown_items(e);break;case"readonly":if(e){$(this).addClass("readonly");b.readonly=true}else{$(this).removeClass("readonly");b.readonly=false}break;case"value":$(this).dropdown_val(e);break;case"width":c.width=parseInt(e);break}$(this).css(c)}}$(this).data("options",b)})},dropdown_load:function(){this.each(function(){var b=this;var a=$(b).data("options");var c=$.val("src",a,{d:""});$.api_post(c,{},function(d){var e=$.val("data",d);if($.type(e)=="array"){$(b).dropdown_items(e)}})})},dropdown_reset:function(){$(this).each(function(){var a=$(this).data("options");var b=$.val("defaultvalue",a,{d:""});$(this).dropdown_val(b)})},dropdown_readonly:function(a){$(this).each(function(){if($.istrue(a)){$(this).addClass("readonly")}else{$(this).removeClass("readonly")}})}});$.fn.extend({feed:function(a){$(this).each(function(){var c=$.val("class",a,{d:""});var e=$.val("src",a,{d:""});var d=$.val("autoload",a,{d:false});var b=[];b.push("<div class='feed-content'></div>");b.push("<div class='feed-footer'></div>");$(this).addClass("feed");$(this).addClass(c);$(this).html(b.join(""));$(this).data("options",a);if(d){$(this).feed_load()}})},feed_val:function(b,a){if(typeof b=="undefined"){}else{$(this).each(function(){var l=$(this).data("options");var c=$.val("src",l,{d:""});var k=$.val("template",l,{d:""});if($.type(b)=="array"&&b.length>0){var h="feed_group_"+$.uniqid();var j=document.createElement("div");j.setAttribute("data-feed-group-id",h);var g=[];for(var f=0;f<b.length;f++){g.push("<div class='feed-item'></div>")}j.innerHTML=g.join("");$(".feed-content",this).append(j);for(var f=0;f<b.length;f++){var e=b[f];var d=j.childNodes[f];$.fire_event(k,[e],d)}}})}},feed_load:function(a){$(this).each(function(){if(!$(this).hasClass("feed")){return}var b=this;var c=$(this).data("options");var d=$.val("src",c,{d:""});if(d!=""){$.api_post(d,[],function(g){var i=$.val("data",g,{d:[]});var h=$.val("page",g,{d:1});var f=h==1?false:true;$(b).feed_val(i,f);var e=$.val("max_page",g,{d:h});if(e>=h+1){$(".feed-footer",b).html("<div class='load-more align-center padding10'>Load More...</div>");$(".load-more",b).on("click",function(){$(b).feed_load({page:h+1})})}else{$(".feed-footer",b).html("")}})}})}});$.extend({foldedpane_toggle:function(c){var a=$(c);if(typeof a[0]=="undefined"){return}var b=$(".toggler",a);if(a[0].classList.contains("folded")){a[0].classList.remove("folded");if(b.length==1){b.html("<span class='fa fa-caret-up'></span>")}}else{a[0].classList.add("folded");if(b.length==1){b.html("<span class='fa fa-caret-down'></span>")}}},foldedpane_init:function(){var b=document.body.querySelectorAll(".folded-pane");for(var a=0;a<b.length;a++){var c=b[a];var d=c.querySelector(".toggler");if(d!=null){d.addEventListener("click",function(){$.foldedpane_toggle(c)})}}}});$.fn.extend({grid:function(c){var f=$.val("autoload",c,{d:true});var d=$.val("columns",c,{d:[]});var e=$.val("class",c,{d:null});var b=$.val("name",c,{d:""});var h=$.val("footer",c,{d:""});var g=$.val("value",c,{d:null});var a=$.val("height",c,{d:"auto"});c.page=0;c.row_per_page=12;this.each(function(){var j=this;var i=[];i.push("<table class='grid-body'>");i.push("<tbody class='grid-size'></tbody>");i.push("</table>");i.push("<div class='grid-footer'></div>");$(j).attr("data-type","grid");$(j).addClass("grid");$(j).addClass(e);if(b!=""){$(j).attr("data-name",b)}$(j).data("options",c);$(j).attr("data-type","grid");$(j).html(i.join(""));$.fire_event(h,[],$(".grid-footer",j));$(this).grid_set_columns(d);if(g!=null){$(j).grid_set(g)}if(f){$(j).grid_load()}})},grid_add:function(a){this.each(function(){var c=this;var t=c.querySelector(".grid-body");var g=$(c).data("options");var b=$.val("columns",g,{d:[]});var o=[];if($(".grid-size",t).length==0){var l=[];l.push("<tr class='grid-size'>");for(var r=0;r<b.length;r++){var f=b[r];var m=$.val("width",f,{d:""});l.push("<td style='width:"+m+";'></td>");l.push("<td class='separator'></td>")}l.push("<td style='width:100%'></td>");l.push("</tr>");o.push(l.join(""))}o.push("<tr>");for(var q=0;q<b.length;q++){var f=b[q];var e=$.val("type",f,{d:"text"});var k=$.val("datatype",f,{d:"text"});var u=$.val("name",f,{d:""});var m=$.val("width",f,{d:""});var p=$.val("align",f,{d:""});var h="";var d="";var n="";switch(e){case"index":n=r+1;h="right";d="label";break;case"html":gridtypecoord=0+","+q;break;default:switch(k){case"number":case"money":h="right";n=$.val(u,a,{d:0});break;case"enum":var s=$.val("enums",f,{d:{}});n=$.val(u,a,{d:"-"});n=$.val(n,s,{d:"-"});break;default:n=$.val(u,a,{d:"-"});break}d="label";break}if(p!=""){h=p}o.push("<td data-gridtype='"+e+"' data-gridtypecoord='"+gridtypecoord+"' class='"+d+"' style='text-align:"+h+"'>"+n+"</td>");o.push("<td class='separator'></td>")}o.push("<td></td>");o.push("</tr>");$("tbody",t).append(o.join(""));$("td[data-gridtype='html']",$("tr",$("tbody",t)).last()).each(function(){var y=$(this).attr("data-gridtypecoord").split(",");var i=parseInt(y[1]);var w=b[i];var x=$.val("html",w,{d:""});$.fire_event(x,[a,w],this)})})},grid_remove:function(b){var a=this;$(b).each(function(){var d=$(this).closest(".grid");d=typeof d[0]!="undefined"?d[0]:-2;var c=typeof a[0]!="undefined"?a[0]:-1;if(d==c){$(this).remove()}})},grid_set_columns:function(a){$(this).each(function(){if(!$(this).hasClass("grid")){return}var c=$(this).data("options");c.columns=a;$(this).data("options",c);var e=[];e.push("<tr>");for(var d=0;d<a.length;d++){var g=a[d];var b=$.val("name",g);var f=$.val("width",g);var h=$.val("active",g,{d:1});if(h==1){e.push($.p("<td class='grid-size-label' style='width:$1' data-key='"+b+"'></td>",[f]))}else{e.push($.p("<td class='grid-size-label inactive' style='width:$1' data-key='"+b+"'></td>",[f]))}}e.push("<td style='width:100%'></td>");e.push("</tr>");$(".grid-size",this).html(e.join(""))})},grid_append:function(b,a){this.each(function(){var d=this;var n=d.querySelector(".grid-body");var o=$(d).data("options");var c=$.val("src",o,{d:""});var l=$.val("onselect",o);var e=$.val("columns",o,{d:[]});var k=$.val("page",b,{d:1});var m=$.val("row_per_page",b,{d:10});var f=$.val("max_page",b,{d:k});var j=$.val("data",b);if(typeof o.data=="undefined"){o.data=[]}var h=document.createElement("tbody");$(h).html($.grid_html(j,e,o.data.length));$(n).append(h);$("td[data-gridtype='html']",h).each(function(){var u=$(this).attr("data-gridtypecoord").split(",");var q=parseInt(u[0]);var p=parseInt(u[1]);var s=j[q];var r=e[p];var t=$.val("html",r,{d:""});$.fire_event(t,[s,r],this)});$("tr",h).click(function(){var p=$(this).closest("table");$(".active",p).removeClass("active");$(this).addClass("active");var i=$(this).attr("data-idx");var q=o.data[i];$.fire_event(l,[q],d)});$(".grid-more",d).remove();if(f>k){$(d).append("<div class='grid-more' data-page='"+k+"'><label class='cl-gray'>Load more...</label></div>");$(".grid-more",d).click(function(){var p=parseInt($(this).attr("data-page"));var i=$.val("onloadmore",o);$(this).html("<i class='fa fa-circle-o-notch fa-spin fa-fw cl-gray'></i>");if(c!=""){$(d).grid_load()}$.fire_event(i,[{page:p}],d)});$(".grid-more",d).appear(function(){var p=parseInt($(this).attr("data-page"));var i=$.val("onloadmore",o);$(this).html("<i class='fa fa-circle-o-notch fa-spinfa-fw cl-gray'></i>");if(c!=""){$(d).grid_load()}$.fire_event(i,[{page:p}],d)})}for(var g=0;g<j.length;g++){o.data.push(j[g])}$(d).data("options",o)})},grid_load:function(a){this.each(function(){var b=this;var d=$(b).data("options");var h=$.val("src",d,{d:""});var i=$.val("method",d,{d:"post"});if(h.length>0){var g=$.val("page",a,{d:1});var f=$.val("row_per_page",a,{d:10});var e=$.val("columns",d);var c={page:g,row_per_page:f,columns:e};if(i.toString().toLowerCase()=="get"){$.api_get(h,c,function(k){var n=$.val("data",k,{d:[]});var m=$.val("page",k,{d:1});var j=m==1?false:true;$(b).grid_val(n,j);var l=$.val("next_page",k,{d:m});if(l>m){$(".grid-footer",b).html("<div class='load-more align-center padding10'>Load More...</div>");$(".load-more",b).on("click",function(){$(b).grid_load({page:l})})}else{$(".grid-footer",b).html("")}})}else{$.api_post(h,c,function(k){var n=$.val("data",k,{d:[]});var m=$.val("page",k,{d:1});var j=m==1?false:true;$(b).grid_val(n,j);var l=$.val("next_page",k,{d:m});if(l>m){$(".grid-footer",b).html("<div class='load-more align-center padding10'>Load More...</div>");$(".load-more",b).on("click",function(){$(b).grid_load({page:l})})}else{$(".grid-footer",b).html("")}})}$(".grid-footer",this).html("<div class='align-center padding10'>Loading...</div>")}})},grid_val:function(b,a){if(typeof b=="undefined"){var b=[];this.each(function(){var d=this;var e=d.querySelector(".grid-body");var c=$("tbody",e);$(c).children().each(function(){if(this.classList.contains("grid-size")){}else{var f=$(this).attr("data-idx");var g=$.el_get(this);if(JSON.stringify(g).length>3){b.push(g)}}})});return b}else{this.each(function(){var p=this;var q=$(p).data("options");var m=$.val("onselect",q);var e=$.val("columns",q,{d:[]});var k=document.createElement("tbody");k.className="grid-content";k.innerHTML=$.grid_html(b,e);if(typeof a=="undefined"||a!==true){$(".grid-content",p).remove()}$(".grid-body",p).append(k);for(var h=0;h<k.childNodes.length;h++){var o=k.childNodes[h];var g=b[h];for(var f=0;f<o.childNodes.length;f++){var d=o.childNodes[f];var n=d.getAttribute("data-column-type");if(n=="html"){var c=e[f];var l=$.val("html",c,{d:""});$.fire_event(l,[g,c],d)}}}$("tr",k).on("click.gridrow",function(j){var i=$(this).closest("table");$(".active",i).removeClass("active");$(this).addClass("active");$.fire_event(m,[j,this],p)})})}},grid_get_selected_value:function(){var a=null;$(this).each(function(){var c=$(this).data("options");var d=$.val("data",c);var b=$("tr[class='active']").attr("data-idx");a=$.val(b,d)});return a}});$.extend({grid_html:function(k,f){if(!k){return}var m=[];for(var l=0;l<k.length;l++){var h=k[l];m.push("<tr>");for(var g=0;g<f.length;g++){var e=f[g];var p=$.val("type",e,{d:"text"});var c=$.val("datatype",e,{d:"text"});var b=$.val("name",e,{d:""});var d=$.val("align",e,{d:""});var o="";var r="";var n="";switch(p){case"html":break;default:switch(c){case"number":case"money":o="right";n=$.val(b,h,{d:0});n=$.number_format(n);break;case"enum":var q=$.val("enums",e,{d:{}});n=$.val(b,h,{d:"-"});n=$.val(n,q,{d:"-"});break;default:n=$.val(b,h,{d:"-"});break}var a=$.val("lettercase",e,{d:""});switch(a){case"capitalize":n=n.toString().capitalize();break;case"lowercase":n=n.toString().toLowerCase();break;case"uppercase":n=n.toString().toUpperCase();break}r="label";break}if(d!=""){o=d}m.push("<td data-column-type='"+p+"' class='"+r+"' style='text-align:"+o+"'>"+n+"</td>")}m.push("<td></td>");m.push("</tr>")}return m.join("")}});$.fn.extend({gridhead:function(c){var g=$.val("autoload",c,{d:true});var e=$.val("columns",c,{d:[]});var f=$.val("class",c,{d:null});var b=$.val("name",c,{d:""});var d=$.val("grid",c,{d:null});var a=$.val("height",c,{d:null});this.each(function(){var h=this;$(h).addClass("gridhead");$(h).addClass(f);$(h).attr("data-type","gridhead");if(b!=""){$(h).attr("data-name",b)}$(h).data("options",c);$(h).attr("data-type","gridhead");$(h).gridhead_attr({height:a});$(this).gridhead_set(e)})},gridhead_set:function(a){$(this).each(function(){var f=this;var q=$(this).data("options");var b=$.val("grid",q,{d:null});var o=$.val("oncolumnclick",q);q.columns=a;var k=[];k.push("<table class='grid-head'><tr>");for(var j=0;j<a.length;j++){var h=a[j];var c=$.val("name",h,{d:""});var e=$.val("active",h,{d:1});var p=$.val("text",h,{d:"-"});var n=$.val("width",h,{d:""});var d=$.val("datatype",h,{d:"text"});var g=$.val("align",h,{d:""});var l="";switch(d){case"number":case"money":l="right";break;case"enum":break;default:break}if(g!=""){l=g}var m="label"+(!e?" inactive":"");k.push("<td class='"+m+"' style='width:"+n+";text-align:"+l+"' data-key=\""+c+'">'+p+"<span class='separator'></span></span></td>")}k.push("<td style='width:100%'></td>");k.push("</tr></table>");$(f).html(k.join(""));$(".separator",f).mousedown(function(t){t.preventDefault();t.stopPropagation();var r=this.parentNode;var s=r.parentNode;var i=t.clientX;$(window).on("mousemove.gridhead",function(w){w.preventDefault();w.stopPropagation();var u=w.clientX-i;r.style.width=(parseInt(r.style.width)+u)+"px";i=w.clientX});$(window).on("mouseup.gridhead",function(z){z.preventDefault();z.stopPropagation();var x=$(b);var B=$(".grid-size",x);if(B.length==1){var w=-1;for(var y=0;y<s.childNodes.length;y++){if(s.childNodes[y]==r){w=y;break}}w=parseInt(w);$(".grid-size-label:eq("+(w)+")",B).css({width:$(r).outerWidth()});var u=$(f).data("options");u.columns[w]["width"]=$(r).outerWidth();var A=$.val("oncolumnresize",u);$.fire_event(A,[{index:w,width:$(r).outerWidth()}],f)}$(window).off("mousemove.gridhead");$(window).off("mouseup.gridhead")})});$(".separator",f).click(function(i){i.preventDefault();i.stopPropagation()});$(".label",f).on("click",function(s){s.preventDefault();s.stopPropagation();var r=$(this).attr("data-key");var i=$(this).attr("data-sorttype");if(i=="asc"){i="desc"}else{if(i=="desc"){i="asc"}else{i="asc"}}$(this).attr("data-sorttype",i);$.fire_event(o,[[{key:r,type:i}]],f)})})},gridhead_attr:function(a){$(this).each(function(){for(var b in a){var c=a[b];switch(b){case"height":$(this).css({height:c});break}}})},gridhead_modify_column:function(a){$(this).each(function(){if(!$(this).hasClass("gridhead")){return}var n=$(this).data("options");var b=$.val("grid",n);var m=$.val("columns",n);for(var k=0;k<m.length;k++){var e=m[k];var l=$.val("name",e,{d:""});var d=$.val("width",e,{d:""});if(l==""){continue}for(var h=0;h<a.length;h++){var g=a[h];var c=$.val("name",g,{d:""});var f=$.val("active",g,{d:1});if(l==c){if(f){$(".label[data-key='"+c+"']",this).removeClass("inactive");$(".grid-size-label[data-key='"+c+"']",$(b)).removeClass("inactive")}else{$(".label[data-key='"+c+"']",this).addClass("inactive");$(".grid-size-label[data-key='"+c+"']",$(b)).addClass("inactive")}n.columns[k]["active"]=f;column_exists=true}}}$(this).data("options",n)})}});$.fn.extend({gridsetting:function(b){var a=$.val("onchange",b);this.each(function(){var d=this;var c=[];c.push("<div class='modal-head'>");c.push("<div class='align-center padding10'>");c.push("<ul class='tab'>");c.push("<li class='active' data-value='presets'>Presets</li>");c.push("<li data-value='columns'>Columns</li>");c.push("<li data-value='filters'>Filters</li>");c.push("</ul>");c.push("</div>");c.push("</div>");c.push("<div class='modal-body padding20'>");c.push("<div class='cont12 space10 gridsetting-presets'>");c.push("<div class='lg12'><button class='blue preset-add-btn'><span class='fa fa-plus'></span> Add Preset...</button></div>");c.push("<div class='lg12'><span class='preset-grid'></span></div>");c.push("</div>");c.push("<div class='cont12 space10 gridsetting-columns' style='display:none'>");c.push("<div class='lg12'>");c.push("<button class='blue column-up-btn'><span class='fa fa-caret-up'></span>Up</button>");c.push("&nbsp;");c.push("<button class='blue column-down-btn'><span class='fa fa-caret-down'></span>Down</button>");c.push("</div>");c.push("<div class='lg6'><span class='column-grid'></span></div>");c.push("<div class='lg6'>");c.push("<div class='cont12 space10 gridsetting-column-detail'>");c.push("<div class='lg3 align-right'><label class='padding10'>Align</label></div>");c.push("<div class='lg9'><span class='gridsetting-column-align'></span></div>");c.push("<div class='lg3 align-right'><label class='padding10'>Name</label></div>");c.push("<div class='lg9'><label class='gridsetting-column-name padding10'></label></div>");c.push("<div class='lg3 align-right'><label class='padding10'>Text</label></div>");c.push("<div class='lg9'><span class='gridsetting-column-text'></span></div>");c.push("<div class='lg3 align-right'><label class='padding10'>Width</label></div>");c.push("<div class='lg9'><span class='gridsetting-column-width'></span></div>");c.push("</div>");c.push("</div>");c.push("</div>");c.push("<div class='cont12 space10 gridsetting-filters' style='display:none'>");c.push("<div class='lg12'><button class='blue filter-add-btn'><span class='fa fa-plus'></span> Add Filter...</button></div>");c.push("<div class='lg12'><span class='filter-grid'></span></div>");c.push("</div>");c.push("</div>");c.push("<div class='modal-foot'>");c.push("<button class='blue apply-btn'><span class='fa fa-save'></span> Apply Filter</button>");c.push("&nbsp;");c.push("<button class='close-btn'><span class='fa fa-times'></span> Close</button>");c.push("</div>");$(d).addClass("modal width800 gridsetting");$(d).html(c.join(""));$(".tab",d).tab({onchange:function(e){$(".modal-body",d).children().hide();$(".gridsetting-"+e.value,d).show()}});$(".preset-add-btn").click(function(){});$(".preset-grid",d).grid({"class":"transparent",columns:[{text:"",type:"html",html:"$.gridsetting_preset_option",width:"50px"},{text:"Preset Name",name:"text",width:"150px"}]});$(".column-grid",d).grid({"class":"transparent",columns:[{text:"Column Name",name:"text",width:"150px"},{text:"Width",name:"width",width:"100px"}],onselect:function(g){var e=$(this).closest(".gridsetting-columns");var f=$(".gridsetting-column-detail",e);$.el_set(f,g);$(".gridsetting-column-name",f).html($.val("name",g,{d:""}))}});$(".gridsetting-column-align",d).dropdown({name:"align",items:[{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]});$(".gridsetting-column-name",d).html("");$(".gridsetting-column-text",d).textbox({name:"text",onchange:function(j){var e=$(d).data("params");var h=$(this).closest(".gridsetting-column-detail");var f=$(".gridsetting-column-name",h).html();for(var g=0;g<e.presets[e.active_idx]["columns"].length;g++){if(e.presets[e.active_idx]["columns"][g]["name"]==f){e.presets[e.active_idx]["columns"][g]["text"]=j}}$(d).data("presets",e)}});$(".gridsetting-column-width",d).textbox({name:"width",onchange:function(j){var e=$(d).data("params");var h=$(this).closest(".gridsetting-column-detail");var f=$(".gridsetting-column-name",h).html();for(var g=0;g<e.presets[e.active_idx]["columns"].length;g++){if(e.presets[e.active_idx]["columns"][g]["name"]==f){e.presets[e.active_idx]["columns"][g]["width"]=j}}$(d).data("presets",e)}});$(".filter-add-btn",d).click(function(){$(".filter-grid",d).grid_add()});$(".filter-grid",d).grid({"class":"transparent",columns:[{text:"",type:"html",html:"$.gridsetting_grid_option",width:"50px"},{text:"Key",type:"html",html:"$.gridsetting_grid_key",width:"150px"},{text:"Operator",type:"html",html:"$.gridsetting_grid_opt",width:"150px"},{text:"Value",type:"html",html:"$.gridsetting_grid_val",width:"150px"}]});$(".apply-btn",d).click(function(){var e=$(".filter-grid",d).grid_value();var g=$(d).data("params");var f=parseInt($.val("active_idx",g,{d:0}));g.presets[f]["filters"]=e;$.fire_event(a,[g],d);$(d).modal_close()});$(".close-btn",d).click(function(){$(d).modal_close()})})},gridsetting_close:function(){$(this).modal_close()},gridsetting_open:function(b,a){this.each(function(){var c=$.val("presets",b);var f=b.presets[b.active_idx];var d=$.val("columns",b);var e=$.val("filters",b);$(this).data("params",b);$(this).data("columns",d);$(".preset-grid",this).grid_set(c);$(".column-grid",this).grid_set(d);$(".filter-grid",this).grid_set(e);$(this).modal_open({height:window.innerHeight*0.8})})}});$.extend({gridsetting_preset_option:function(a){$(this).html("<button class='preset-grid-options'><span class='fa fa-times'></span></button>");$(".preset-grid-options",this).click(function(){$(this).closest("tr").remove()})},gridsetting_grid_option:function(a){$(this).html("<button class='filter-grid-options'><span class='fa fa-times'></span></button>");$(".filter-grid-options",this).click(function(){$(this).closest("tr").remove()})},gridsetting_grid_type:function(a){$(this).html("<span class='filter-grid-type'></span>");$(".filter-grid-type",this).textbox({name:"type",value:$.val("type",a,{d:null})})},gridsetting_grid_key:function(f,d){var b=$(this).closest(".gridsetting");var e=$(b).data("params");var k=e.presets[e.active_idx];var d=e.columns;var h=[];if($.type(d)=="array"){for(var g=0;g<d.length;g++){var c=d[g];var a=$.val("name",c,{d:""});var j=$.val("text",c,{d:a});if(a.length>0){h.push({text:j,value:a})}}}$(this).html("<span class='filter-grid-key'></span>");$(".filter-grid-key",this).dropdown({name:"key",items:h,value:$.val("key",f,{d:null})})},gridsetting_grid_opt:function(a){$(this).html("<span class='filter-grid-opt'></span>");$(".filter-grid-opt",this).dropdown({name:"operator",items:[{text:"Contains",value:"contains"},{text:"Equals",value:"equals"}],value:$.val("operator",a,{d:null})})},gridsetting_grid_val:function(a){$(this).html("<span class='filter-grid-val'></span>");$(".filter-grid-val",this).textbox({name:"value",value:$.val("value",a,{d:null})})}});$.fn.extend({hidden:function(b){var a=$.val("name",b,{d:""});$(this).each(function(){var c=[];$(this).html(c.join(""));$(this).attr("data-type","hidden");$(this).attr("data-name",a);$(this).addClass("hidden");$(this).data("options",b)})},hidden_val:function(b){if(typeof b=="undefined"){var a=[];$(this).each(function(){a.push($(this).data("value"))});return a.length>1?a:(a.length==1?a[0]:"")}else{$(this).each(function(){$(this).data("value",b)})}}});$.fn.extend({image:function(c){var e=$.val("class",c,{d:""});var a=$.val("height",c,{d:"50px"});var b=$.val("name",c,{d:""});var f=$.val("value",c,{d:""});var d=$.val("width",c,{d:"50px"});this.each(function(){var h=this;var g=[];g.push('<img src="'+f+'"/>');$(h).attr("data-type","image");$(h).attr("data-name",b);$(h).addClass("image");$(h).addClass(e);$(h).html(g.join(""));$(h).data("options",c);$("img",h).css({width:d,height:a})})},image_val:function(b){if(typeof b=="undefined"){var a=[];this.each(function(){a.push($("img",this).attr("src"))});return a.length>1?a:(a.length==1?a[0]:"")}else{this.each(function(){$("img",this).attr("src",b)})}}});$.extend({layout_resize:function(){$(".layout-sidebar, .layout-main, .layout-ext",$(".layout")).css({height:window.innerHeight-$(".header").outerHeight()})}});$.fn.extend({layout:function(b){var d=$.val("class",b,{d:""});var c=$.val("size",b,{d:{}});var e=$.val("large",c,{d:"300px auto 400px"});var a=e.split(" ");$(this).each(function(){var f=$.val(0,a,{d:"200px"});var h="100%";var g=$.val(2,a,{d:"300px"});$(this).addClass("layout");$(this).addClass(d);$(".layout-sidebar",this).css({flex:"0 0 "+f});$(".layout-main",this).css({flex:"1 1 "+h});$(".layout-ext",this).css({flex:"0 0 "+g});$(".layout-sidebar, .layout-main, .layout-ext",this).css({height:window.innerHeight-$(".header").outerHeight()})});$(window).on("resize.layout",function(){$.layout_resize()})}});$.extend({layout2_resize:function(){$(".layout2").layout2_resize()}});$.fn.extend({layout2:function(a){var c=$.val("class",a,{d:""});var b=$.val("size",a,{d:"300px auto 400px"});var d=b.split(" ");$(this).each(function(){$(this).addClass("layout2");$(this).addClass(c);$(this).data("options",a);$(this).layout2_resize()});$(window).on("resize.layout",function(){$.layout2_resize()})},layout2_resize:function(){$(this).each(function(){var i=$(this).data("options");var a=$.val("onresize",i);var d=$.val("ext_hidden",i);var h=$.val("size",i,{d:"300px auto 400px"});var g=h.split(" ");var e=window.innerHeight-$(".header").outerHeight();var b=$.val(0,g,{d:"200px"});var c=$.val(2,g,{d:"300px"});var e=window.innerHeight-$(".header").outerHeight();c=$.calc_size(c,e);var f=e-c;$(".layout-sidebar",this).css({flex:"0 0 "+b,height:e});$(".layout-content",this).css({flex:"1 1 auto"});if(d==0){$(this).removeClass("ext-hidden");$(".layout-main",this).css({height:c});$(".layout-ext",this).css({height:f})}else{$(this).addClass("ext-hidden");$(".layout-main",this).css({height:e});$(".layout-ext",this).css({height:0})}$.fire_event(a,[],this)})},layout2_toggleext:function(a){$(this).each(function(){if(!$(this).hasClass("layout2")){return}var b=$(this).data("options");b.ext_hidden=a?0:1;$(this).data("options",b);$(this).layout2_resize()})},layout2_ext_state:function(){var a=0;$(this).each(function(){var b=$(this).data("options");a=$.val("ext_hidden",b,{d:-1})>0?0:1});return a}});$.fn.extend({modal_open:function(a){this.each(function(){var b=this;$(b).addClass("on");$(document.body).css({overflow:"hidden"});var e=$(b).outerHeight()-5-($(".modal-head",b).outerHeight()+$(".modal-foot",b).outerHeight());if(!isNaN(e)){$(".modal-body",b).css({height:e})}var c=$.val("reset",a,{d:false});if(c===true){$(b).reset()}var d=$.val("value",a,{d:null});if(d!=null){$(b).val(a.value)}})},modal_close:function(b,a){this.each(function(){var c=this;$(c).removeClass("on");$(".modal-bg").removeClass("on")});if($(".modal.on").length==0){$(document.body).css({overflow:""})}}});$.extend({popup_close:function(a){$(a).removeClass("on")},popup_open:function(a,b,i){$.popup_close_all();$(a).addClass("on");var e={};var d=$(b).offset();var h=d.left+a.clientWidth;var g=d.top-$(window).scrollTop()+$(b).outerHeight()+1;var f=window.innerHeight-g-10;e.top=g;e["max-height"]=f;if(h>window.innerWidth){d.left=window.innerWidth-a.clientWidth}e.left=d.left;var c=$.val("min_width",i);if(!isNaN(parseInt(c))){e["min-width"]=c}$(a).css(e)},popup_toggle:function(c,a,b){if(c.classList.contains("on")){$.popup_close(c,a,b)}else{$.popup_open(c,a,b)}},popup_close_all:function(){var a=document.body.querySelectorAll(".popup");for(var b=0;b<a.length;b++){$.popup_close(a[b])}}});$.fn.extend({radio:function(a){$(this).each(function(){var g=$.val("items",a,{d:null});var f=$.val("class",a,{d:""});var n=$.val("text",a,{d:""});var b=$.val("name",a,{d:""});var j=$.val("value",a,{d:""});var d=[];if($.type(g)=="array"){var o="radio-name-"+$.uniqid();for(var c=0;c<g.length;c++){var m=g[c];var l=m.text;var k=m.value;var h=j!=""&&j==k?true:false;var e="radio-"+$.uniqid();d.push("<input type='radio' id='"+e+"' value=\""+k+"\" name='"+o+"'"+(h?" checked":"")+"/>");d.push("<label for='"+e+"'>"+l+"</label>")}}else{var h=parseInt(j)==1||j===true?true:false;var e="radio-"+$.uniqid();d.push("<input type='radio' id='"+e+"'"+(h?" checked":"")+"/>");d.push("<label for='"+e+"'>"+n+"</label>")}$(this).addClass("radio");$(this).addClass(f);$(this).attr({"data-type":"radio"});$(this).html(d.join(""))})},radio_val:function(b){if(typeof b=="undefined"){var a=[];$(this).each(function(){var c=this.querySelectorAll("input");if(c.length==1){a.push(c[0].checked?1:0)}else{for(var d=0;d<c.length;d++){if(c[d].checked){a.push(c[d].value)}}}});a=a.join(",");return a}else{$(this).each(function(){var c=this.querySelectorAll("input");if(c.length==1){c[0].checked=(parseInt(b)==1||b===true)?true:false}else{var e=false;for(var d=0;d<c.length;d++){if(c[d].value==b){c[d].checked=true;e=true;break}}if(!e){$("input",this).attr("checked",false)}}})}}});$.extend({role_init:function(b){var a=typeof b!="undefined"&&b instanceof HTMLElement?b:document.body;$("*[data-role]",a).each(function(){var d=this.getAttribute("data-role");switch(d){case"modal.close":$(this).click(function(){$(this).closest(".modal").modal_close()});break;case"url.open":var c=$(this).attr("data-role-value");$(this).click(function(){window.location=c});break}})}});$.fn.extend({spinner:function(a){var b=$.val("size",a,{defaultvalue:"20px"});this.each(function(){var c=[];c.push('<div class="sk-fading-circle" style="width:'+b+";height:"+b+';">');c.push('<div class="sk-circle1 sk-circle"></div>');c.push('<div class="sk-circle2 sk-circle"></div>');c.push('<div class="sk-circle3 sk-circle"></div>');c.push('<div class="sk-circle4 sk-circle"></div>');c.push('<div class="sk-circle5 sk-circle"></div>');c.push('<div class="sk-circle6 sk-circle"></div>');c.push('<div class="sk-circle7 sk-circle"></div>');c.push('<div class="sk-circle8 sk-circle"></div>');c.push('<div class="sk-circle9 sk-circle"></div>');c.push('<div class="sk-circle10 sk-circle"></div>');c.push('<div class="sk-circle11 sk-circle"></div>');c.push('<div class="sk-circle12 sk-circle"></div>');c.push("</div>");$(this).html(c.join(""))})}});$.fn.extend({tab:function(d){var a=$.val("container",d,{d:""});var c=$.val("name",d,{d:""});var b=$.val("onchange",d);this.each(function(){var e=this;$(e).attr("data-type","tab");$(e).attr("data-name",c);$(e).data("options",d);$("li",e).click(function(){if(this.classList.contains("active")){}else{$("li",this.parentNode).removeClass("active");$(this).addClass("active");var h=this.innerHTML;var g=this.getAttribute("data-value");if(g==null){g=$.slug(h)}var f=$(this).index();if($(a).length>0){$(a+">*").addClass("off");$(a+">*:eq("+f+")").removeClass("off")}$.fire_event(b,[{text:h,value:g}],e)}})})},tab_set:function(d){var c=this;var b=$(c).data("options");var a=$.val("onchange",b);$("li",this).removeClass("active");$("li",this).each(function(){var e=this.innerHTML;var f=this.getAttribute("data-value");if(f==null){f=$.slug(e)}if(f==d){$(this).addClass("active");$.fire_event(a,[{text:e,value:f}],c)}})}});$.fn.extend({textarea:function(l){var j=$.val("placeholder",l,{d:""});var g=$.val("class",l,{d:""});var b=$.val("name",l,{d:""});var k=$.val("height",l,{d:"1em"});var c=$.val("width",l);var d=$.val("maxlength",l,{d:""});var h=$.val("onblur",l);var a=$.val("onkeyup",l);var e=$.val("onchange",l);var i=$.val("value",l,{d:""});var f={width:c};this.each(function(){var n=this;var m=[];m.push("<textarea rows='1' placeholder='"+j+"' style='height:"+k+";' maxlength='"+d+"'></textarea>");m.push("<span class='icon fa hidden'></span>");$(n).addClass("textarea");$(n).addClass(g);$(n).css(f);$(n).html(m.join(""));$(n).attr("data-type","textarea");$(n).attr("data-name",b);$(n).data("options",l);$("textarea",n).blur(function(o){$(n).textarea_validate();$.fire_event(h,[],n)}).keyup(function(o){$.fire_event(a,[this.value],n);if($(this).data("last_value")!=this.value){$.fire_event(e,[this.value],n)}$(this).data("last_value",this.value)});$("textarea",n).each(function(){this.setAttribute("style","height:"+(this.scrollHeight<=0?"":this.scrollHeight)+"px;overflow-y:hidden;")}).on("input",function(){this.style.height="auto";this.style.height=(this.scrollHeight)+"px"});if(i!=""){$(this).textarea_val(i)}})},textarea_val:function(b){if(typeof b=="undefined"){var a=[];$(this).each(function(){a.push($("textarea",this).val())});return a.length>1?a:(a.length==1?a[0]:"")}else{$(this).each(function(){$("textarea",this).val(b).each(function(){this.style.height="auto";this.style.height=(this.scrollHeight)+"px"})})}},textarea_placeholder:function(b){if(typeof b=="undefined"){var a=[];$(this).each(function(){a.push($("input",this).attr("placeholder"))});return a.length>1?a:(a.length==1?a[0]:"")}else{$(this).each(function(){$("input",this).attr("placeholder",b)})}},textarea_reset:function(){$(this).textarea_val("")},textarea_validate:function(){$(this).each(function(){var i=$(this).data("options");var e=$.val("required",i,{d:false});var d=$.val("required_text",i,{d:"Field required."});var b=$.val("validation",i,{d:""});var c=$.val("validation_text",i,{d:"Validation error."});var g=$(this).textarea_val();var a=true;var h="";if(e){if(g.toString().trim()==""){a=false;h=d}else{if(b!=""){switch(b){default:var f=new RegExp(b);a=f.test(g);if(!a){h=c}break}}}}else{if(g.toString().length>0){switch(b){default:var f=new RegExp(b);a=f.test(g);if(!a){h=c}break}}}if(!a){$(this).addClass("invalid");console.warn(h)}else{$(this).removeClass("invalid")}})}});$.fn.extend({textbox:function(m){var k=$.val("placeholder",m,{d:""});var b=$.val("name",m,{d:""});var i=$.val("class",m,{d:""});var l=$.val("value",m,{d:""});var f=$.val("readonly",m,{d:false});var d=$.val("maxlength",m,{d:""});var h=$.val("mode",m,{d:"text"});var c=$.val("width",m);var j=$.val("onblur",m);var a=$.val("onkeyup",m);var e=$.val("onchange",m);var g={width:c};this.each(function(){var o=this;var n=[];n.push($.p('<input type="$1" placeholder="$1" maxlength="$1"/>',[h,k,d]));n.push("<span class='icon fa hidden'></span>");$(o).addClass("textbox");$(o).addClass(i);$(o).css(g);$(o).html(n.join(""));$(o).attr("data-type","textbox");$(o).attr("data-name",b);$(o).data("options",m);$("input",o).val(l);$("input",o).blur(function(p){$(o).textbox_validate();$.fire_event(j,[],o)}).keyup(function(p){$.fire_event(a,[this.value],o);if($(this).data("last_value")!=this.value){$.fire_event(e,[this.value],o)}$(this).data("last_value",this.value)})})},textbox_val:function(b){if(typeof b=="undefined"){var a=[];$(this).each(function(){a.push($("input",this).val())});return a.length>1?a:(a.length==1?a[0]:"")}else{$(this).each(function(){$("input",this).val(b)})}},textbox_placeholder:function(b){if(typeof b=="undefined"){var a=[];$(this).each(function(){a.push($("input",this).attr("placeholder"))});return a.length>1?a:(a.length==1?a[0]:"")}else{$(this).each(function(){$("input",this).attr("placeholder",b)})}},textbox_reset:function(){$(this).textbox_val("")},textbox_validate:function(){$(this).each(function(){var i=$(this).data("options");var e=$.val("required",i,{d:false});var d=$.val("required_text",i,{d:"Field required."});var b=$.val("validation",i,{d:""});var c=$.val("validation_text",i,{d:"Validation error."});var g=$(this).textbox_val();var a=true;var h="";if(e){if(g.toString().trim()==""){a=false;h=d}else{if(b!=""){switch(b){default:var f=new RegExp(b);a=f.test(g);if(!a){h=c}break}}}}else{if(g.toString().length>0){switch(b){default:var f=new RegExp(b);a=f.test(g);if(!a){h=c}break}}}if(!a){$(this).addClass("invalid");console.warn(h)}else{$(this).removeClass("invalid")}})}});$.fn.extend({toggle:function(b){var c=$.val("class",b,{d:""});var a=$.val("name",b,{d:""});var d=$.val("value",b,{d:false});this.each(function(){var f=this;var e=[];e.push("<span class='main-toggle'></span>");f.innerHTML=e.join("");$(this).addClass("toggle");$(this).addClass(c);$(f).attr("data-type","toggle");if(a!=""){$(f).attr("data-name",a)}f.querySelector(".main-toggle").addEventListener("click",function(){if(this.parentNode.classList.contains("on")){this.parentNode.classList.remove("on")}else{this.parentNode.classList.add("on")}});$(f).toggle_val(d);return f})},toggle_val:function(a){if(!$(this).hasClass("toggle")){return undefined}if(typeof a=="undefined"){return $(this).hasClass("on")?1:0}else{if(a==true||a==1){$(this).addClass("on")}else{$(this).removeClass("on")}}}});$.extend({tooltip:function(b,d){var a=$(".tooltip");if(a.length==0){$.warn("No tooltip defined.")}$(a).addClass("on");var f=b.getBoundingClientRect();var c={};var e=[];console.log(b);c.left=f.left;console.log([f.top,f.top+f.height+$(a).outerHeight()+10,window.innerHeight]);if(f.top+f.height+$(a).outerHeight()+10>window.innerHeight){c.top=f.top-$(a).outerHeight()-10;e.push("<div class='arrow-down'></div>")}else{c.top=f.top+f.height+10;e.push("<div class='arrow-up'></div>")}e.push(d);$(a).html(e.join(""));$(a).css(c)},tooltip_remove:function(){$(".tooltip").removeClass("on")}});$.extend({date:function(j,h){var g=this;var i,e;var d=["Sun","Mon","Tues","Wednes","Thurs","Fri","Satur","January","February","March","April","May","June","July","August","September","October","November","December"];var b=/\\?(.?)/gi;var a=function(f,k){return e[f]?e[f]():k};var c=function(k,f){k=String(k);while(k.length<f){k="0"+k}return k};e={d:function(){return c(e.j(),2)},D:function(){return e.l().slice(0,3)},j:function(){return i.getDate()},l:function(){return d[e.w()]+"day"},N:function(){return e.w()||7},S:function(){var f=e.j();var k=f%10;if(k<=3&&parseInt((f%100)/10,10)==1){k=0}return["st","nd","rd"][k-1]||"th"},w:function(){return i.getDay()},z:function(){var k=new Date(e.Y(),e.n()-1,e.j());var f=new Date(e.Y(),0,1);return Math.round((k-f)/86400000)},W:function(){var k=new Date(e.Y(),e.n()-1,e.j()-e.N()+3);var f=new Date(k.getFullYear(),0,4);return c(1+Math.round((k-f)/86400000/7),2)},F:function(){return d[6+e.n()]},m:function(){return c(e.n(),2)},M:function(){return e.F().slice(0,3)},n:function(){return i.getMonth()+1},t:function(){return(new Date(e.Y(),e.n(),0)).getDate()},L:function(){var f=e.Y();return f%4===0&f%100!==0|f%400===0},o:function(){var l=e.n();var f=e.W();var k=e.Y();return k+(l===12&&f<9?1:l===1&&f>9?-1:0)},Y:function(){return i.getFullYear()},y:function(){return e.Y().toString().slice(-2)},a:function(){return i.getHours()>11?"pm":"am"},A:function(){return e.a().toUpperCase()},B:function(){var k=i.getUTCHours()*3600;var f=i.getUTCMinutes()*60;var l=i.getUTCSeconds();return c(Math.floor((k+f+l+3600)/86.4)%1000,3)},g:function(){return e.G()%12||12},G:function(){return i.getHours()},h:function(){return c(e.g(),2)},H:function(){return c(e.G(),2)},i:function(){return c(i.getMinutes(),2)},s:function(){return c(i.getSeconds(),2)},u:function(){return c(i.getMilliseconds()*1000,6)},e:function(){throw"Not supported (see source code of date() for timezone on how to add support)"},I:function(){var k=new Date(e.Y(),0);var m=Date.UTC(e.Y(),0);var f=new Date(e.Y(),6);var l=Date.UTC(e.Y(),6);return((k-m)!==(f-l))?1:0},O:function(){var k=i.getTimezoneOffset();var f=Math.abs(k);return(k>0?"-":"+")+c(Math.floor(f/60)*100+f%60,4)},P:function(){var f=e.O();return(f.substr(0,3)+":"+f.substr(3,2))},T:function(){return"UTC"},Z:function(){return -i.getTimezoneOffset()*60},c:function(){return"Y-m-d\\TH:i:sP".replace(b,a)},r:function(){return"D, d M Y H:i:s O".replace(b,a)},U:function(){return i/1000|0}};this.date=function(k,f){g=this;i=(f===undefined?new Date():(f instanceof Date)?new Date(f):new Date(f*1000));return k.replace(b,a)};return this.date(j,h)},uniqid:function(){if(typeof $.__UNIQID=="undefined"){$.__UNIQID=0}return ++$.__UNIQID},val:function(g,b,j){if(typeof j=="undefined"||$.type(j)!="object"){j={}}var f=null;var h=typeof j.default_value!="undefined"?j.default_value:(typeof j.d!="undefined"?j.d:null);var c=typeof j.t!="undefined"?j.t:(typeof j.datatype!="undefined"?j.datatype:"string");var e=typeof j.required!="undefined"&&e==1?true:false;if($.type(b)=="object"){if($.type(g)=="array"){f=null;for(var d=0;d<g.length;d++){var a=g[d];v=$.val(a,b,{default_value:null});if(v!=null){f=v;break}}}else{if($.type(g)=="string"||$.type(g)=="number"){if(typeof b[g]!="undefined"){f=b[g]}}}}else{if($.type(b)=="array"){if(typeof b[g]!="undefined"){f=b[g]}}}if(e){if(f==null){}}else{f=f==null&&h!=null?h:f}switch(c){case"number":case"integer":case"float":case"double":f=parseFloat(f);break}return f},strtotime:function(q,d){var m,j,n,l,f,p,b,k,a,o,h,e=false;if(!q){return e}if(/^\d{8}$/.test(q)){q=q.substr(0,4)+"-"+q.substr(4,2)+"-"+q.substr(6,2)}q=q.replace(/^\s+|\s+$/g,"").replace(/\s{2,}/g," ").replace(/[\t\r\n]/g,"").toLowerCase();j=q.match(/^(\d{1,4})([\-\.\/\:])(\d{1,2})([\-\.\/\:])(\d{1,4})(?:\s(\d{1,2}):(\d{2})?:?(\d{2})?)?(?:\s([A-Z]+)?)?$/);if(j&&j[2]===j[4]){if(j[1]>1901){switch(j[2]){case"-":if(j[3]>12||j[5]>31){return e}return new Date(j[1],parseInt(j[3],10)-1,j[5],j[6]||0,j[7]||0,j[8]||0,j[9]||0)/1000;case".":return e;case"/":if(j[3]>12||j[5]>31){return e}return new Date(j[1],parseInt(j[3],10)-1,j[5],j[6]||0,j[7]||0,j[8]||0,j[9]||0)/1000}}else{if(j[5]>1901){switch(j[2]){case"-":if(j[3]>12||j[1]>31){return e}return new Date(j[5],parseInt(j[3],10)-1,j[1],j[6]||0,j[7]||0,j[8]||0,j[9]||0)/1000;case".":if(j[3]>12||j[1]>31){return e}return new Date(j[5],parseInt(j[3],10)-1,j[1],j[6]||0,j[7]||0,j[8]||0,j[9]||0)/1000;case"/":if(j[1]>12||j[3]>31){return e}return new Date(j[5],parseInt(j[1],10)-1,j[3],j[6]||0,j[7]||0,j[8]||0,j[9]||0)/1000}}else{switch(j[2]){case"-":if(j[3]>12||j[5]>31||(j[1]<70&&j[1]>38)){return e}l=j[1]>=0&&j[1]<=38?+j[1]+2000:j[1];return new Date(l,parseInt(j[3],10)-1,j[5],j[6]||0,j[7]||0,j[8]||0,j[9]||0)/1000;case".":if(j[5]>=70){if(j[3]>12||j[1]>31){return e}return new Date(j[5],parseInt(j[3],10)-1,j[1],j[6]||0,j[7]||0,j[8]||0,j[9]||0)/1000}if(j[5]<60&&!j[6]){if(j[1]>23||j[3]>59){return e}n=new Date();return new Date(n.getFullYear(),n.getMonth(),n.getDate(),j[1]||0,j[3]||0,j[5]||0,j[9]||0)/1000}return e;case"/":if(j[1]>12||j[3]>31||(j[5]<70&&j[5]>38)){return e}l=j[5]>=0&&j[5]<=38?+j[5]+2000:j[5];return new Date(l,parseInt(j[1],10)-1,j[3],j[6]||0,j[7]||0,j[8]||0,j[9]||0)/1000;case":":if(j[1]>23||j[3]>59||j[5]>59){return e}n=new Date();return new Date(n.getFullYear(),n.getMonth(),n.getDate(),j[1]||0,j[3]||0,j[5]||0)/1000}}}}if(q==="now"){return d===null||isNaN(d)?new Date().getTime()/1000|0:d|0}if(!isNaN(m=Date.parse(q))){return m/1000|0}f=d?new Date(d*1000):new Date();p={sun:0,mon:1,tue:2,wed:3,thu:4,fri:5,sat:6};b={yea:"FullYear",mon:"Month",day:"Date",hou:"Hours",min:"Minutes",sec:"Seconds"};function g(t,s,i){var u,r=p[s];if(typeof r!=="undefined"){u=r-f.getDay();if(u===0){u=7*i}else{if(u>0&&t==="last"){u-=7}else{if(u<0&&t==="next"){u+=7}}}f.setDate(f.getDate()+u)}}function c(w){var x=w.split(" "),t=x[0],i=x[1].substring(0,3),u=/\d+/.test(t),s=x[2]==="ago",r=(t==="last"?-1:1)*(s?-1:1);if(u){r*=parseInt(t,10)}if(b.hasOwnProperty(i)&&!x[1].match(/^mon(day|\.)?$/i)){return f["set"+b[i]](f["get"+b[i]]()+r)}if(i==="wee"){return f.setDate(f.getDate()+(r*7))}if(t==="next"||t==="last"){g(t,i,r)}else{if(!u){return false}}return true}a="(years?|months?|weeks?|days?|hours?|minutes?|min|seconds?|sec|sunday|sun\\.?|monday|mon\\.?|tuesday|tue\\.?|wednesday|wed\\.?|thursday|thu\\.?|friday|fri\\.?|saturday|sat\\.?)";o="([+-]?\\d+\\s"+a+"|(last|next)\\s"+a+")(\\sago)?";j=q.match(new RegExp(o,"gi"));if(!j){return e}for(h=0,k=j.length;h<k;h++){if(!c(j[h])){return e}}return(f.getTime()/1000)},mktime:function(){var f=new Date(),b=arguments,a=0,c=["Hours","Minutes","Seconds","Month","Date","FullYear"];for(a=0;a<c.length;a++){if(typeof b[a]==="undefined"){b[a]=f["get"+c[a]]();b[a]+=(a===3)}else{b[a]=parseInt(b[a],10);if(isNaN(b[a])){return false}}}b[5]+=(b[5]>=0?(b[5]<=69?2000:(b[5]<=100?1900:0)):0);f.setFullYear(b[5],b[3]-1,b[4]);f.setHours(b[0],b[1],b[2]);return(f.getTime()/1000>>0)-(f.getTime()<0)},date_parse:function(a){switch(a){case"this_month":a=$.date("Ym")+"01-"+$.date("Ymd",$.mktime(0,0,0,parseInt($.date("m"))+1,0,$.date("Y")));break}return a},start_day_of_month:function(a,b){var c=$.date("N",$.mktime(0,0,0,b,1,a));return c},last_date_of_month:function(b,c){var e=27;do{e++;var a=parseInt($.date("j",$.mktime(0,0,0,c,e,b)));if(a!=e){e--;break}}while(true);return e},api_get:function(c,e,f,b){var a=$.http_build_query(e);c+=a.length>0?"?"+a:"";var d=new XMLHttpRequest();d.open("GET",c,true);d.addEventListener("load",function(){if(this.readyState==4){var i=$.eval_as_object(this.responseText);var g=$.val("error",i,{d:0,datatype:"integer"});var h=$.val("error_message",i,{d:""});if(g>0){if(b!=null){$.fire_event(b,[this.responseText],d)}else{alert(h)}}else{$.fire_event(f,[i],d)}}});d.addEventListener("error",function(){if(typeof b!="undefined"||b!=null){$.fire_event(b)}else{console.log(this.responseText)}});d.send();return d},api_post:function(b,d,e,a){var c=new XMLHttpRequest();c.open("POST",b,true);c.addEventListener("load",function(){if(this.readyState==4){var h=$.eval_as_object(this.responseText);var f=$.val("error",h,{d:0,datatype:"integer"});var g=$.val("error_message",h,{d:""});if(parseInt(f)==0){$.fire_event(e,[h],c)}else{if(typeof a!="undefined"||a!=null){$.fire_event(a,[{error:f,error_message:g}])}else{alert(JSON.stringify(h,null,2))}}}});c.addEventListener("error",function(){if(typeof a!="undefined"||a!=null){$.fire_event(a)}else{console.log(this.responseText)}});c.send(JSON.stringify(d));return c},http_build_query:function(c,a,d){var b=[];if($.type(c)=="object"){Object.keys(c).forEach(function(h){var e=h;a&&!isNaN(e)?e=a+e:"";var e=encodeURIComponent(e.toString().replace(/[!'()*]/g,escape));d?e=d+"["+e+"]":"";if(typeof c[h]==="object"){var g=$.http_build_query(c[h],null,e);b.push(g)}else{var f=encodeURIComponent(c[h].toString().replace(/[!'()*]/g,escape));b.push(e+"="+f)}})}return b.join("&")},fire_event:function(callback,params,thisArg){if(typeof thisArg=="undefined"){thisArg=null}if($.type(callback)=="string"){callback=eval(callback)}if($.type(callback)=="function"){return callback.apply(thisArg,params)}},eval_as_object:function(exp){try{return eval("("+exp+")")}catch(e){return null}},ux:function(a){a=typeof a=="undefined"||!(a instanceof HTMLElement)?document.body:a;var b=a.querySelectorAll("*[data-type]");$(b).each(function(){var d=this.getAttribute("data-type");if(typeof $(this)[d]=="function"){var c=$.options_from_html(this);$(this)[d](c)}else{console.warn("Unknown ux "+d)}})},el_get:function(a){if($(a).attr("data-type")!=null){var c=$(a).attr("data-type");if(typeof $(a)[c+"_get"]=="function"){return $(a)[c+"_get"]()}return null}else{var d={};var b=$("*[data-type]",a);$(b).each(function(){var f=this;var g=$.el_get(f);var e=f.getAttribute("data-name");if(e==null){e="undefined"}d[e]=g});return d}},el_set:function(a,b){$("*[data-type]",a).each(function(){var d=this.getAttribute("data-type");var c=this.getAttribute("data-name");var e=$.val(c,b);if(typeof $(this)[d+"_set"]=="function"){$(this)[d+"_set"](e)}else{console.warn("unknown method")}})},options_from_html:function(el){var options=null;if(el.getAttribute("data-options")!=null){try{options=eval("("+el.getAttribute("data-options")+")")}catch(e){options=null}}else{var options={};for(var i=0;i<el.attributes.length;i++){options[el.attributes[i].nodeName.replace("data-","")]=el.attributes[i].nodeValue}}return options},cookie_getitem:function(a){if(!a){return null}return decodeURIComponent(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+encodeURIComponent(a).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1"))||null},cookie_setitem:function(d,g,c,b,a,e){if(!d||/^(?:expires|max\-age|path|domain|secure)$/i.test(d)){return false}var f="";if(c){switch(c.constructor){case Number:f=c===Infinity?"; expires=Fri, 31 Dec 9999 23:59:59 GMT":"; max-age="+c;break;case String:f="; expires="+c;break;case Date:f="; expires="+c.toUTCString();break}}document.cookie=encodeURIComponent(d)+"="+encodeURIComponent(g)+f+(a?"; domain="+a:"")+(b?"; path="+b:"")+(e?"; secure":"");return true},cookie_removeitem:function(c,b,a){if(!this.hasItem(c)){return false}document.cookie=encodeURIComponent(c)+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT"+(a?"; domain="+a:"")+(b?"; path="+b:"");return true},cookie_hasitem:function(a){if(!a){return false}return(new RegExp("(?:^|;\\s*)"+encodeURIComponent(a).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=")).test(document.cookie)},cookie_keys:function(){var a=document.cookie.replace(/((?:^|\s*;)[^\=]+)(?=;|$)|^\s*|\s*(?:\=[^;]*)?(?:\1|$)/g,"").split(/\s*(?:\=[^;]*)?;\s*/);for(var c=a.length,b=0;b<c;b++){a[b]=decodeURIComponent(a[b])}return a},slug:function(c){var b="";var a=$.trim(c);b=a.replace(/[^a-z0-9-]/gi,"-").replace(/-+/g,"-").replace(/^-|-$/g,"");return b.toLowerCase()},warn:function(a){console.warn(a)},array_merge:function(){var g=Array.prototype.slice.call(arguments);var l=g.length;var m;var b={};var a="";var n=0;var c=0;var e=0;var f=0;var h=Object.prototype.toString;var d=true;for(e=0;e<l;e++){if(h.call(g[e])!=="[object Array]"){d=false;break}}if(d){d=[];for(e=0;e<l;e++){d=d.concat(g[e])}return d}for(e=0,f=0;e<l;e++){m=g[e];if(h.call(m)==="[object Array]"){for(c=0,n=m.length;c<n;c++){b[f++]=m[c]}}else{for(a in m){if(m.hasOwnProperty(a)){if(parseInt(a,10)+""===a){b[f++]=m[a]}else{b[a]=m[a]}}}}}return b},in_array:function(e,d,c){var b="";var a=!!c;if(a){for(b in d){if(d[b]===e){return true}}}else{for(b in d){if(d[b]==e){return true}}}return false},number_format:function(e,c,h,g){e=(e+"").replace(/[^0-9+\-Ee.]/g,"");var b=!isFinite(+e)?0:+e;var a=!isFinite(+c)?0:Math.abs(c);var j=(typeof g==="undefined")?",":g;var d=(typeof h==="undefined")?".":h;var i="";var f=function(o,m){var l=Math.pow(10,m);return""+(Math.round(o*l)/l).toFixed(m)};i=(a?f(b,a):""+Math.round(b)).split(".");if(i[0].length>3){i[0]=i[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,j)}if((i[1]||"").length<a){i[1]=i[1]||"";i[1]+=new Array(a-i[1].length+1).join("0")}return i.join(d)},qs:(function(d){if(d==""){return{}}var c={};for(var e=0;e<d.length;++e){var f=d[e].split("=",2);if(f.length==1){c[f[0]]=""}else{c[f[0]]=decodeURIComponent(f[1].replace(/\+/g," "))}}return c})(window.location.search.substr(1).split("&")),p:function(g,f){var e=g.match(/\$\w+/g);if(e!=null){if($.type(f)=="array"){for(var c=0;c<e.length;c++){var a=e[c];var d=typeof f[c]!="undefined"?f[c]:"";g=g.replace(a,d)}}else{if($.type(f)=="object"){for(var c=0;c<e.length;c++){var a=e[c];var b=a.replace("$","");var d=typeof f[b]!="undefined"?f[b]:"";g=g.replace(a,d)}}}}return g},array_key_count:function(c){var b=0;for(var a in c){b++}return b},object_value_min:function(c){var b=-1;if($.type(c)=="object"){for(var a in c){var d=c[a];if(b==-1||parseFloat(d)<parseFloat(b)){b=d}}}return b},object_value_max:function(c){var b=-1;if($.type(c)=="object"){for(var a in c){var d=c[a];if(b==-1||parseFloat(d)>parseFloat(b)){b=d}}}return b},ksort:function(d){var c=Object.keys(d).sort(),a={};for(var b in c){a[c[b]]=d[c[b]]}return a},str_pad:function(b,f,d,g){var e="";var a;var c=function(i,h){var j="";while(j.length<h){j+=i}j=j.substr(0,h);return j};b+="";d=d!==undefined?d:" ";if(g!=="STR_PAD_LEFT"&&g!=="STR_PAD_RIGHT"&&g!=="STR_PAD_BOTH"){g="STR_PAD_RIGHT"}if((a=f-b.length)>0){if(g==="STR_PAD_LEFT"){b=c(d,a)+b}else{if(g==="STR_PAD_RIGHT"){b=b+c(d,a)}else{if(g==="STR_PAD_BOTH"){e=c(d,Math.ceil(a/2));b=e+b+e;b=b.substr(0,f)}}}}return b},template_parse:function(k,a){var d=k.match(/<!--IF.+?(?=-->)(.+)?(?=<!--END-->)<!--END-->/gi,"gi");if($.type(d)=="array"){for(var c=0;c<d.length;c++){var e=d[c];var d=e.match(/\(.+?(?=\))\)/gi,"gi");var j=d[0];j=j.substr(1,j.length-2);var g=new Function("obj","return "+j+";");if(!g(a)){k=k.replace(e,"","gi")}}}var d=k.match(/<!--IF_NOT_EMPTY.+?(?=-->)(.+)?(?=<!--END-->)<!--END-->/gi,"gi");if($.type(d)=="array"){for(var c=0;c<d.length;c++){var e=d[c];var d=e.match(/\(\w+\)/gi,"gi");var j=d[0];j=j.substr(1,j.length-2);if($.val(j,a,{d:""})==""){k=k.replace(e,"","gi")}}}var d=k.match(/{\w+(:\w+)*?(?=})}/gi,"gi");if($.type(d)=="array"){for(var c=0;c<d.length;c++){var e=d[c];var j=e.substr(1,e.length-2);var b="string";if(j.indexOf(":")>=0){var l=j.split(":");j=l[0];b=l[1]}var h=$.val(j,a,{d:"-"});h=$.convert_datatype(h,b);k=k.replace(e,h,"gi")}}return k},convert_datatype:function(b,a){switch(a){case"date":b=$.date("j M Y",$.strtotime(b));break}return b},calc_size:function(b,a){a=typeof a=="undefined"||!a?window.innerWidth:a;if(b.indexOf("%")>=0){b=b.replace("%","","gi");if(!isNaN(parseFloat(b))){b=parseFloat(b)/100*a}}return b},download:function(c){var b=document.createElement("a");b.href=c;b.setAttribute("download",c);document.body.appendChild(b);b.click();document.body.removeChild(b)},ux_init:function(a){a=typeof a=="undefined"||!(a instanceof HTMLElement)?document.body:a;$("*[data-type]",a).each(function(){var c=this.getAttribute("data-type");if(typeof $(this)[c]=="function"){var b=$.options_from_html(this);$(this)[c](b)}else{console.warn("Unknown ux "+c)}});$("*[data-action]",a).each(function(){switch(this.getAttribute("data-action")){case"modal.close":$(this).on("click.data-action",function(){$(this).closest(".modal").modal_close()});break}});$(window).on("click",$.popup_close_all).on("scroll",$.popup_close_all);$(window).on("keyup",function(b){switch(b.keyCode){case 27:$(".modal").modal_close();break}})},istrue:function(a){if(typeof a!="undefined"&&(parseInt(a)==1||a===true)){return true}return false}});var oldVal=$.fn.val;$.fn.val=function(b){var a=$(this).attr("data-type");if(a!=null&&typeof $(this)[a+"_val"]!="undefined"){return $(this)[a+"_val"].apply(this,arguments)}else{if($(this).hasClass("container")){return $(this).container_val.apply(this,arguments)}else{return oldVal.apply(this,arguments)}}};$.fn.placeholder=function(){var a=$(this).attr("data-type");if(a!=null&&typeof $(this)[a+"_placeholder"]!="undefined"){return $(this)[a+"_placeholder"].apply(this,arguments)}else{if($(this).hasClass("container")){return $(this).container_placeholder.apply(this,arguments)}}};$.fn.readonly=function(){var a=$(this).attr("data-type");if(a!=null&&typeof $(this)[a+"_readonly"]!="undefined"){return $(this)[a+"_readonly"].apply(this,arguments)}else{if($(this).hasClass("container")){return $(this).container_readonly.apply(this,arguments)}}};$.fn.reset=function(){var a=$(this).attr("data-type");if(a!=null&&typeof $(this)[a+"_reset"]!="undefined"){return $(this)[a+"_reset"].apply(this,arguments)}else{if($(this).hasClass("container")){return $(this).container_reset.apply(this,arguments)}}};String.prototype.capitalize=function(){return this.charAt(0).toUpperCase()+this.slice(1)};$($.ux_init);$.fn.extend({vfields:function(a){var b=$.val("value",a);$(this).each(function(){var c=this;$(c).addClass("vfields");$(c).data("options",a);if($.type(b)=="array"){$(c).form_set(b)}})},form_set:function(a){if(typeof a=="undefined"||$.type(a)!="array"){return}$(this).each(function(){var b=this;var d=$(this).data("options");var c=$.val("html_callback",d);$(a).each(function(){var f=this;var e=[];e.push("<table><tr><td class='vfields-col1' align='center' style='width:24px'>");e.push("<span class='fa fa-times-circle selectable vfields-remove hoverable'></span>");e.push("</td><td class='vfields-col2'></td></tr></table>");var g=document.createElement("div");g.className="vfields-item";g.innerHTML=e.join("");$(b).append(g);$.fire_event(c,[f],$(".vfields-col2",g))});$(".vfields-remove",b).click(function(){$(this).closest(".vfields-item").remove()})})},vfields_get:function(){var a=[];$(this).each(function(){var b=this;$(".vfields-col2",b).each(function(){var c=$.el_get(this);a.push(c)})});return a}});$.fn.extend({webeditor:function(b){var a=$.val("height",b);this.each(function(){var d=$.uniqid();var c=[];c.push($.p('<textarea id="$1"></textarea>',["webeditor"+d]));$(this).addClass("webeditor");$(this).html(c.join(""));$(this).data("options",b);CKEDITOR.replace("webeditor"+d,{height:a})})},webeditor_get:function(b){var a=[];this.each(function(){var d=$("textarea",this).attr("id");if(typeof CKEDITOR.instances[d]!="undefined"){var c=CKEDITOR.instances[d].getData();a.push(c)}});return a.length==1?a[0]:(a.length>1?a:null)},webeditor_set:function(a){this.each(function(){var b=$("textarea",this).attr("id");if(typeof CKEDITOR.instances[b]!="undefined"){CKEDITOR.instances[b].setData(a)}})}});$.fn.extend({widget:function(a){this.each(function(){var o=this;var m=$.val("type",a);var c=$.val("src",a);var n=$.val("title",a,{default_value:"Untitled"});var e=$.val("columns",a);var l=$.uniqid();var k=$.val("default_presets",a);var j=parseInt($.val("preset_idx",a,{d:0}));if(isNaN(j)){j=0}var h=[];h.push($.p('<div class="widget-head padding10">',[n]));h.push($.p("<table><tr>",[]));h.push($.p('<td style="width:100%">',[]));h.push($.p('<h5 class="padding10">$1</h5>',[n]));h.push($.p("</td>",[n]));h.push($.p("<td>",[]));h.push($.p('<span id="$1"></span>',["preset-selector"+l]));h.push($.p('<span class="icon icon-reload fa fa-refresh padding10 selectable"></span>',[]));h.push($.p('<span class="icon icon-customize fa fa-ellipsis-h padding10 selectable"></span>',[]));h.push($.p("</td>",[]));h.push($.p("</tr></table>",[]));h.push($.p("</div>",[]));h.push($.p('<div class="modal" id="$1"></div>',["customize"+l]));var p=null;var d=[];var g="";if($.type(k)=="array"){for(var f=0;f<k.length;f++){if(f==j){g=k[f]["text"];p=k[f]}d.push({text:k[f]["text"],value:k[f]["text"]})}}switch(m){case"grid":h.push($.p('<div class="widget-body align-center margin10 ">',[]));h.push($.p('<span id="$1"></span>',["gridhead"+l]));h.push($.p("<div></div>",[]));h.push($.p('<span id="$1"></span>',["grid"+l]));h.push($.p("</div>",[]));$(o).html(h.join(""));var e=$.val("columns",a);$("#gridhead"+l,o).gridhead({columns:e,grid:"#grid"+l});var q=$(o).outerHeight()-$(".widget-head",o).outerHeight()-$("#gridhead"+l,o).outerHeight()-15;$("#grid"+l,o).grid({columns:e,height:q});break;case"chart":h.push($.p('<div class="widget-body align-center margin10 ">',[]));h.push($.p('<span id="$1"></span>',["chart"+l]));h.push($.p("</div>",[]));$(o).html(h.join(""));var b=$.val("chart_type",a);var q=$(o).outerHeight()-$(".widget-head",o).outerHeight()-$("#gridhead"+l,o).outerHeight()-15;$("#chart"+l).chart({width:"100%",height:q,padding:0,type:b});break;case"metric":h.push($.p('<div class="widget-body align-left margin10 ">',[]));h.push($.p('<span id="$1"></span>',["metric"+l]));h.push($.p("</div>",[]));$(o).html(h.join(""));break}$("#preset-selector"+l).dropdown({items:d,value:g,onchange:function(){$(o).widget_load()}});$("#customize"+l).gridsetting({onchange:function(s){var r=$(this).closest(".widget");var i=$(r).data("options");i=$.array_merge(i,s);$(r).data("options",i);$(o).widget_load()}});$(".icon-reload",o).click(function(){$(o).widget_load()});$(".icon-customize",o).click(function(){var t=$(this).closest(".widget");var r=$(t).data("options");var s=$.val("columns",r);var i=$.val("default_presets",r);$("#customize"+l).gridsetting_open({columns:s,presets:i,active_idx:0})});$(o).data("options",a);$(o).data("uid",l);$(o).widget_load()})},widget_load:function(){this.each(function(){var k=this;var m=$(k).data("options");var a=$.val("src",m);var j=$.val("type",m);var g=$.val("default_presets",m);var f=parseInt($.val("preset_idx",m,{d:0}));var h=$(k).data("uid");var c=$("#preset-selector"+h).dropdown_get();var l=null;var b=[];var e="";if($.type(g)=="array"){for(var d=0;d<g.length;d++){if(g[d]["text"]==c){e=g[d]["text"];l=g[d]}b.push({text:g[d]["text"],value:g[d]["text"]})}}switch(j){case"metric":$.api_post(a,l,function(i){$("#metric"+h).html("<h2>"+i.data+"</h2>")});break;case"grid":$.api_post(a,l,function(i){var n=$.val("data",i);$("#grid"+h,k).grid_set(n)});break;case"chart":$.api_post(a,l,function(i){$("#chart"+h).chart_set(i.data)});break}})}});$.extend({workspace_init:function(){$(".workspace").each(function(){var a=window.innerHeight-$(".header").outerHeight()-20;$(this).workspace_set({state:$(this).attr("data-state"),size:$(this).attr("data-size"),height:a});$.workspace_rtime;$.workspace_timeout=false;$.workspace_delta=200;$(window).resize(function(){$.workspace_rtime=new Date();if($.workspace_timeout===false){$.workspace_timeout=true;setTimeout($.workspace_resizeend,$.workspace_delta)}})})},workspace_resizeend:function(){if(new Date()-$.workspace_rtime<$.workspace_delta){setTimeout($.workspace_resizeend,$.workspace_delta)}else{$.workspace_timeout=false;$(".workspace").each(function(){var a=window.innerHeight-$(".header").outerHeight()-20;$($(this).children()[0]).css({height:a});$($(this).children()[1]).css({height:a});$($(this).children()[2]).css({height:a})})}}});$.fn.extend({workspace_set:function(a){if(typeof a=="undefined"||$.type(a)!="object"){return}$(this).each(function(){a=$.ksort(a);var b={};var j={flex:"1 1 auto"};var i={};for(var h in a){switch(h){case"size":var k=a[h];k=k.split(" ");var d=$.val(0,k,{d:300,t:"number"});var f=$.val(1,k,{d:400,t:"number"});b.flex="0 0 "+(d+"px");i.flex="0 0 "+(f+"px");$(this).data("left_size",d);$(this).data("right_size",f);break;case"height":b.height=a[h];j.height=a[h];i.height=a[h];break;case"state":var c=$.val("state",a,{d:""});c=c.split(" ");var g=$.val(0,c,{d:1,t:"number"});var e=$.val(2,c,{d:0,t:"number"});var d=g<1?"0":$(this).data("left_size");var f=e<1?"0":$(this).data("right_size");b.flex="0 0 "+(d+"px");i.flex="0 0 "+(f+"px");break}}if($(this).children().length==3){$($(this).children()[0]).css(b);$($(this).children()[1]).css(j);$($(this).children()[2]).css(i)}})}});$.fn.extend({autocomplete:function(h){var l=$.val("class",h,{d:""});var i=$.val("name",h,{d:""});var j=$.val("src",h,{d:""});var m=$.val("width",h);var k=$.val("placeholder",h,{d:""});var n={};if(m!=null){n.width=m}this.each(function(){var a=this;var b=[];b.push("<input type='text' placeholder=\""+k+'"/>');b.push("<span class='icon fa fa-search hoverable selectable'></span>");b.push("<span class='popup'></span>");$(a).addClass("autocomplete");$(a).addClass(l);$(a).html(b.join(""));$(a).css(n);$(a).attr("data-name",i);$(a).attr("data-type","autocomplete");$(a).data("options",h);$("input[type='text']",a).on("keyup",function(c){var d=$(this).closest(".autocomplete");if($(d).hasClass("readonly")){return}var e=$(d).data("options");var f=$.val("readonly",e);if(!f&&j.length>0){var g={};g.key=this.value;$.api_get(j,g,function(C){var x=$.val("data",C);var A=[];if($.type(x)=="array"){for(var B=0;B<x.length;B++){var z=x[B];var y=$.val("value",z,{d:""});var w=$.val("text",z,{d:y});A.push("<div class='item' data-value=\""+y+'">');A.push("<label>"+w+"</label>");A.push("</div>")}}$(".popup",d).html(A.join(""));$(".item",$(".popup",d)).on("click",function(){var p=this.getAttribute("data-value");var q=$("label",this).text();var o={value:p,text:q};$(d).autocomplete_val(o)});$.popup_open($(".popup",d),d,{min_width:$(d).outerWidth()})})}})})},autocomplete_val:function(f,e){if(typeof f=="undefined"){var d=[];$(this).each(function(){var b=$(this).data("options");var h=$.val("multiple",b,{d:false});if(h){$(".text",this).each(function(){d.push(this.getAttribute("data-value"))})}else{var a=$("input",this).val();var c=$(this).data("value");if(c==null){c=a}d.push(c)}});return d.length==1?d[0]:(d.length>1?d:"")}else{$(this).each(function(){var b=$(this).data("options");var c=$.val("multiple",b,{d:false});var a=d="";if($.type(f)=="object"){d=$.val("value",f,{d:""});a=$.val("text",f,{d:d})}else{a=d=f}if(c){var i=typeof e!="undefined"&&e===true?true:false;if(i){$(".text",this).remove()}var j=$(this).val();if(!$.in_array(d,j)&&d!==""){$("<span class='text' data-value=\""+d+'">'+a+"<span class='icon-remove glyphicons glyphicons-remove'></span></span>").insertBefore($("input",this));$(".glyphicons-remove",$("input",this).prev()).on("click",function(){$(this).parent().remove()})}$("input",this).val("")}else{$("input",this).val(a);$(this).data("value",d)}})}},autocomplete_readonly:function(b){if(typeof b=="undefined"){return $(this).hasClass("readonly")?true:false}else{if(b){$(this).addClass("readonly");$("input",this).attr("readonly",true);$("input",this).data("placeholder",$("input",this).attr("placeholder"));$("input",this).attr("placeholder","")}else{$(this).removeClass("readonly");$("input",this).attr("readonly",false);$("input",this).attr("placeholder",$("input",this).data("placeholder"))}}},autocomplete_reset:function(){$(this).autocomplete_val("",true)}});$.fn.extend({calendar:function(b){this.each(function(){var f=this;var e=$.val("value",b,{d:"2017-01-01"});e=$.date("j M Y",$.strtotime(e));var a=[];a.push("<input type='text' value='"+e+"' readonly/>");a.push("<span class='icon fa fa-calendar'></span>");a.push("<span class='popup'>Calendar</span>");$(f).addClass("calendar");$(f).html(a.join(""));$(f).attr("data-type","calendar");$(".icon",this).click(function(c){c.preventDefault();c.stopPropagation()});$(".popup",this).click(function(c){c.preventDefault();c.stopPropagation()})})}});$.extend({calendar_open:function(g){var e=g.refEl;var h=g.value;var f=$("#calendar");if(f.length==0){f=document.createElement("div");f.id="calendar";f.className="popup";document.body.appendChild(f);f=$("#calendar")}f=f[0];$(f).data("params",g);$.calendar_set(h);$.popup_open(f,e)},calendar_set:function(d){var f=$("#calendar").data("params");var e=$.val("type",f,{d:""});switch(e){case"range":$.calendar_set_range(d);break;default:$.calendar_set_single(d);break}},calendar_set_single:function(q){var C=$("#calendar");$(C).attr("data-value",q);var s=$.date("n",$.strtotime(q));var r=$.date("Y",$.strtotime(q));var A=$.date("j",$.strtotime(q));var t=$.start_day_of_month(r,s)%7;var j=$.last_date_of_month(r,s);var i=$.date("M Y",$.strtotime(q));var y=$(C).data("params");var z=y.onchange;var u=[];u.push("<table>");u.push("<tr>");u.push("<td><span class='calendar-prev fa fa-caret-left padding5'></span></td>");u.push("<td colspan='5'><span class='date-label'>"+i+"</span></td>");u.push("<td><span class='calendar-next fa fa-caret-right padding5'></span></td>");u.push("</tr>");u.push("<tr>");u.push("<td>Sun</td>");u.push("<td>Mon</td>");u.push("<td>Tue</td>");u.push("<td>Wed</td>");u.push("<td>Thu</td>");u.push("<td>Fri</td>");u.push("<td>Sun</td>");u.push("</tr>");var B=1;for(var w=0;w<6;w++){u.push("<tr>");for(var x=0;x<7;x++){if(t>0){u.push("<td></td>");t--}else{if(B<=j){u.push(B==A?"<td class='day active'>"+B+"</td>":"<td class='day'>"+B+"</td>");B++}else{u.push("<td></td>")}}}u.push("</tr>")}u.push("</table>");C.html(u.join(""));$(".day",C).click(function(d){d.preventDefault();d.stopPropagation();var c=$(this).closest("#calendar");var g=$(c).attr("data-value");var b=this.innerHTML;var e=parseInt($.date("n",$.strtotime(g)));var f=$.date("Y",$.strtotime(g));var a=$.date("j M Y",$.mktime(0,0,0,e,b,f));$.fire_event(z,[a],c);$.popup_close(c)});$(".calendar-prev",C).click(function(e){e.preventDefault();e.stopPropagation();var d=$(this).closest("#calendar");var b=$(d).attr("data-value");var f=parseInt($.date("n",$.strtotime(b)));var g=parseInt($.date("Y",$.strtotime(b)));var a=parseInt($("td.active",d).html());var c=$.date("Y-m-d",$.mktime(0,0,0,f-1,a,g));$.calendar_set(c)});$(".calendar-next",C).click(function(e){e.preventDefault();e.stopPropagation();var d=$(this).closest("#calendar");var b=$(d).attr("data-value");var f=parseInt($.date("n",$.strtotime(b)));var g=parseInt($.date("Y",$.strtotime(b)));var a=parseInt($("td.active",d).html());var c=$.date("Y-m-d",$.mktime(0,0,0,f+1,a,g));$.calendar_set(c)})},calendar_set_range:function(M,C,Q){var T=$("#calendar");$(T).attr("data-value",M);var j=$(T).data("params");var k=j.onchange;M=M.split("-");var U=M[0];var H=M[1];if($.date("Y",$.strtotime(U))=="1970"){U=$.date("Y-m-d")}if($.date("Y",$.strtotime(H))=="1970"){H=$.date("Y-m-d")}var B=[],L=[],F=[],R=[],D=[],S=[],N=[];var I=$.date("Y",$.strtotime(C))!="1970"?C:U;var K=$.date("Y",$.strtotime(Q))!="1970"?Q:H;if($.date("Ym",$.strtotime(K))==$.date("Ym",$.strtotime(I))){K=$.date("Y-m-d",$.mktime(0,0,0,parseInt($.date("n",$.strtotime(K)))+1,$.date("j",1,$.date("Y",$.strtotime(K)))))}B[0]=$.date("n",$.strtotime(I));L[0]=$.date("m",$.strtotime(I));F[0]=$.date("Y",$.strtotime(I));R[0]=$.date("j",$.strtotime(I));D[0]=$.start_day_of_month(F[0],B[0])%7;S[0]=$.last_date_of_month(F[0],B[0]);N[0]=$.date("M Y",$.strtotime(I));B[1]=$.date("n",$.strtotime(K));L[1]=$.date("m",$.strtotime(K));F[1]=$.date("Y",$.strtotime(K));R[1]=$.date("j",$.strtotime(K));D[1]=$.start_day_of_month(F[1],B[1])%7;S[1]=$.last_date_of_month(F[1],B[1]);N[1]=$.date("M Y",$.strtotime(K));var O=[];for(var E=0;E<2;E++){O.push("<table class='calendar-table range-"+E+"'>");O.push("<tr>");O.push($.p("<td><span class='calendar-prev fa fa-caret-left padding5' data-calendaridx='$i'></span></td>",[E]));O.push("<td colspan='5'><span class='date-label'>"+N[E]+"</span></td>");O.push($.p("<td><span class='calendar-next fa fa-caret-right padding5' data-calendaridx='$i'></span></td>",[E]));O.push("</tr>");O.push("<tr>");O.push("<td>Sun</td>");O.push("<td>Mon</td>");O.push("<td>Tue</td>");O.push("<td>Wed</td>");O.push("<td>Thu</td>");O.push("<td>Fri</td>");O.push("<td>Sun</td>");O.push("</tr>");var i=1;for(var G=0;G<6;G++){O.push("<tr>");for(var J=0;J<7;J++){if(D[E]>0){O.push("<td></td>");D[E]--}else{if(i<=S[E]){var P=$.date("Y-m-d",$.strtotime(F[E]+"-"+L[E]+"-"+$.str_pad(i,2,"0","STR_PAD_LEFT")));if($.strtotime(P)>=$.strtotime(U)&&$.strtotime(P)<=$.strtotime(H)){O.push("<td class='day active' data-date='"+P+"'>"+i+"</td>")}else{O.push("<td class='day' data-date='"+P+"'>"+i+"</td>")}i++}else{O.push("<td></td>")}}}O.push("</tr>")}O.push("</table>")}T.html(O.join(""));T.data("seq",0);$(".day",T).click(function(c){c.preventDefault();c.stopPropagation();console.log("value: "+1);var f=$(this).closest("#calendar");var d=$(f).attr("data-value");var e=this.innerHTML;var b=parseInt($.date("n",$.strtotime(d)));var o=$.date("Y",$.strtotime(d));var a=$.date("j M Y",$.mktime(0,0,0,b,e,o));var h=parseInt(f.data("seq"));if(h==0){$(".day.active-0").removeClass("active active-0");$(this).addClass("active active-0");var g=$(this).attr("data-date");var n=$(f).attr("data-value");n=n.split(",");var l=$.val(1,n,{d:g});$(".day",f).each(function(){var p=$(this).attr("data-date");if($.strtotime(p)>=$.strtotime(g)&&$.strtotime(p)<=$.strtotime(l)){$(this).addClass("active")}else{$(this).removeClass("active")}})}else{$(".day.active-1").removeClass("active active-1");$(this).addClass("active active-1")}f.data("seq",h+1);if(h==1){var g=$(".day.active-0").attr("data-date");var l=$(".day.active-1").attr("data-date");if($.strtotime(g)>$.strtotime(l)){var m=g;g=l;l=m}var n=$.date("Ymd",$.strtotime(g))+"-"+$.date("Ymd",$.strtotime(l));$.popup_close(f);$.fire_event(k,[n],f)}});$(".calendar-prev",T).click(function(a){var b=parseInt($(this).attr("data-calendaridx"));console.log(["prev",M,parseInt($(this).attr("data-calendaridx")),I,K]);a.preventDefault();a.stopPropagation();if(b==0){I=$.date("Y-m-d",$.mktime(0,0,0,parseInt($.date("n",$.strtotime(I)))-1,$.date("j",$.strtotime(I)),$.date("Y",$.strtotime(I))))}else{if(b==1){K=$.date("Y-m-d",$.mktime(0,0,0,parseInt($.date("n",$.strtotime(K)))-1,$.date("j",$.strtotime(K)),$.date("Y",$.strtotime(K))));if($.date("Ym",$.strtotime(I))>=$.date("Ym",$.strtotime(K))){I=$.date("Y-m-d",$.mktime(0,0,0,parseInt($.date("n",$.strtotime(I)))-1,$.date("j",$.strtotime(I)),$.date("Y",$.strtotime(I))))}}}$.calendar_set_range(M.join(","),I,K)});$(".calendar-next",T).click(function(a){var b=parseInt($(this).attr("data-calendaridx"));a.preventDefault();a.stopPropagation();if(b==0){I=$.date("Y-m-d",$.mktime(0,0,0,parseInt($.date("n",$.strtotime(I)))+1,$.date("j",$.strtotime(I)),$.date("Y",$.strtotime(I))));if($.date("Ym",$.strtotime(K))<=$.date("Ym",$.strtotime(I))){K=$.date("Y-m-d",$.mktime(0,0,0,parseInt($.date("n",$.strtotime(K)))+1,$.date("j",$.strtotime(K)),$.date("Y",$.strtotime(K))))}}else{if(b==1){K=$.date("Y-m-d",$.mktime(0,0,0,parseInt($.date("n",$.strtotime(K)))+1,$.date("j",$.strtotime(K)),$.date("Y",$.strtotime(K))))}}$.calendar_set_range(M.join(","),I,K)})}});$.fn.extend({chart:function(h){var e=$.val("name",h);var f=$.val("height",h);var g=$.val("width",h);this.each(function(){var a=this;var b={};b.height=f;b.width=g;var c=[];$(a).addClass("chart");$(this).html(c.join(""));$(this).css(b);$(a).attr("data-type","chart");$(a).attr("data-name",e);$(a).data("options",h)})},chart_set:function(b){this.each(function(){var e=this;var a=$(e).data("options");var f=$.val("type",a,{default_value:"line"});switch(f){case"bar":$(this).chart_bar_set(b);break;default:$(this).chart_line_set(b);break}})},chart_bar_set:function(b){this.each(function(){var ag=this;var ac=$(ag).data("options");var L=$(ag).outerHeight();var a=$(ag).outerWidth();var N=$.val("padding",ac,{default_value:10});var T=$.array_key_count(b);var aa=$.object_value_min(b);var P=$.object_value_max(b);var J=N;var Y=a-N;var K=Y-J;var R=(a*0.8)/T;var ab=(K-(R*T))/(T+1);var w=L-N;var h=10;var af=w-h;var Z=af/(P-aa);var S=[];S.push($.p('<svg width="$1" height="$2">',[a,L]));var M=J;var O=Y;var ad=w,ae=w;S.push($.p('<line x1="$x1" y1="$y1" x2="$x2" y2="$y2" style="stroke:rgb(0,0,0);stroke-width:1" />',[M,ad,O,ae]));var W=0;for(var x in b){var y=b[x];var U=R;var Q=Z*y;if(Q<5){Q=5}var V=W*(ab+R)+ab;var X=w-Q;S.push($.p('<rect x="$1" y="$1" width="$1" height="$1" stroke="#4A89DC" stroke-width="2" fill="rgba(74, 137, 220, .2)" data-key="$1" data-value="$1" onmouseover="$1" onmouseout="$1"/>',[V,X,U,Q,x,y,"$.chart_line_mouseover.call(this)","$.chart_line_mouseout.call(this)"]));W++}S.push("</svg>");$(ag).html(S.join(""))})},chart_line_set:function(b){this.each(function(){var ac=this;var W=$(ac).data("options");var N=$(ac).outerHeight();var I=$(ac).outerWidth();var H=$.array_key_count(b);var V=$.object_value_min(b);var Q=$.object_value_max(b);var P=$.val("padding",W,{default_value:10});var L=P;var T=I-P;var d=T-L;var a=d/(H-1);var K=N-P;var J=10;var ab=K-J;var U=ab/(Q-V);var R=[];R.push($.p('<svg width="$1" height="$2">',[I,N]));var F=L;var G=T;var X=K,Z=K;R.push($.p('<line x1="$x1" y1="$y1" x2="$x2" y2="$y2" style="stroke:rgb(0,0,0);stroke-width:1" />',[F,X,G,Z]));var S=1;for(var M in b){var Y=Math.round(L+(S*a));R.push($.p('<line x1="$1" y1="$1" x2="$1" y2="$1" style="stroke:rgba(0, 0, 0, .05);stroke-width:1" />',[Y,K,Y,J]));S++}var S=0;var E=[];E.push($.p("M$1 $2",[Math.round(L+(S*a)),K]));for(var M in b){var O=b[M];var Y=Math.round(L+(S*a));var aa=Math.round(K-(O*U));E.push($.p("L$1 $2",[Y,aa]));S++}E.push($.p("M$1 $2 Z",[Y,K]));R.push($.p('<path d="$1" stroke-width="0" stroke="transparent" fill="rgba(74, 137, 220, .2)"/>',[E.join(" ")]));var S=0;var E=[];for(var M in b){var O=b[M];var Y=Math.round(L+(S*a));var aa=Math.round(K-(O*U));if(S==0){E.push($.p("M$1 $2",[Y,aa]))}else{E.push($.p("L$1 $2",[Y,aa]))}S++}R.push($.p('<path d="$1" stroke-width="2" stroke="#4A89DC" fill="transparent"/>',[E.join(" ")]));var S=0;for(var M in b){var O=b[M];var Y=L+(S*a);var aa=K-(O*U);R.push($.p('<circle cx="$1" cy="$1" r="1" stroke="#4A89DC" stroke-width="2" fill="#4A89DC" onmouseover="$1" onmouseout="$1" data-key="$1" data-value="$1"/>',[Y,aa,"$.chart_line_mouseover.call(this)","$.chart_line_mouseout.call(this)",M,O]));S++}R.push("</svg>");$(ac).html(R.join(""))})}});$.extend({chart_line_mouseover:function(){$(this).attr({r:2});var d=$(this).attr("data-key");var c=$(this).attr("data-value");$.tooltip(this,d+"<br />"+c)},chart_line_mouseout:function(){$(this).attr({r:1});$.tooltip_remove()}});$.fn.extend({checkbox:function(b){this.each(function(){var j=$.val("class",b,{d:""});var a=$.val("items",b,{d:null});var k=[];if($.type(a)=="array"){$(a).each(function(){var c=$.val("text",this,{d:""});var d=$.val("value",this,{d:""});var e="checkbox-"+$.uniqid();k.push("<span class='item'><input id='"+e+"' type='checkbox' value=\""+d+"\"/><label for='"+e+"'>"+c+"</label></span>")})}else{var h=$.val("text",b,{d:""});var i="";var l="checkbox-"+$.uniqid();k.push("<span class='item'><input id='"+l+"' type='checkbox' value=\""+i+"\"/><label for='"+l+"'>"+h+"</label></span>")}$(this).addClass("checkbox");$(this).addClass(j);$(this).html(k.join(""));$(this).data("options",b)})}});$.fn.extend({checklist:function(b){$(this).each(function(){var a=this;var d=[];d.push("<div class='checklist-body'>");d.push("<div class='checklist-item'>");d.push("<input type='checkbox' />");d.push("<input type='text' />");d.push("<span class='iconbar'>");d.push("<span class='checklist-remove fa fa-times padding5 selectable'></span>");d.push("</span>");d.push("</div>");d.push("</div>");d.push("<div class='checklist-foot'>");d.push("<span class='checklist-add fa fa-plus-circle padding5 selectable hoverable'></span>");d.push("</div>");$(this).addClass("checklist");$(this).html(d.join(""));$(".checklist-add",this).click(function(){$(a).checklist_add()});$(".checklist-remove",this).on("click.checklist",function(){$(this).closest(".checklist-item").remove()})})},checklist_add:function(){$(this).each(function(){var b=[];b.push("<div class='checklist-item'>");b.push("<input type='checkbox' />");b.push("<input type='text' />");b.push("<span class='iconbar'>");b.push("<span class='checklist-remove fa fa-times padding5 selectable hoverable'></span>");b.push("</span>");b.push("</div>");$(".checklist-body",this).append(b.join(""));$(".checklist-remove",$(".checklist-body",this)).on("click.checklist",function(){$(this).closest(".checklist-item").remove()})})},checklist_get:function(){var b=[];$(this).each(function(){$(".checklist-item",this).each(function(){var a=$("input[type='checkbox']",this)[0].checked;var d=$("input[type='text']",this).val();if(d.length>0){b.push({checked:a,text:d})}})});return b.length==0?null:b},checklist_set:function(b){$(this).checklist_attr({value:b})},checklist_attr:function(b){if($.type(b)!="object"){return}$(this).each(function(){for(var m in b){var j=b[m];switch(m){case"readonly":if(j){$("input[type='checkbox']",this).attr("disabled",true);$("input[type='text']",this).attr("readonly",true);$(".checklist-remove",this).addClass("hidden");$(".checklist-add",this).addClass("hidden")}else{$("input[type='checkbox']",this).attr("disabled",false);$("input[type='text']",this).attr("readonly",false);$(".checklist-remove",this).removeClass("hidden");$(".checklist-add",this).removeClass("hidden")}break;case"value":var n=[];if($.type(j)=="array"){for(var a=0;a<j.length;a++){var k=j[a];var i=$.val("text",k,{d:""});var l=$.val("checked",k,{d:false});if(i==""){continue}n.push("<div class='checklist-item'>");n.push("<input type='checkbox'"+(l?" checked":"")+"/>");n.push("<input type='text' value=\""+i+'" />');n.push("<span class='iconbar'>");n.push("<span class='checklist-remove fa fa-times padding5 selectable hoverable'></span>");n.push("</span>");n.push("</div>")}}n.push("<div class='checklist-item'>");n.push("<input type='checkbox'/>");n.push("<input type='text'/>");n.push("<span class='iconbar'>");n.push("<span class='checklist-remove fa fa-times padding5 selectable hoverable'></span>");n.push("</span>");n.push("</div>");$(".checklist-body",this).html(n.join(""));$(".checklist-remove",$(".checklist-body",this)).on("click.checklist",function(){$(this).closest(".checklist-item").remove()});break}}})}});$.fn.extend({choice:function(b){$(this).each(function(){var l=$.val("class",b,{d:""});var a=$.val("items",b,{d:[],datatype:"array"});var m=[];if($.type(a)=="array"){for(var n=0;n<a.length;n++){var k=a[n];var j=$.val("value",k,{d:""});var i=$.val("text",k,{d:j});if(j.length==0){continue}m.push($.p('<span class="item">'));m.push($.p("</span>"))}}$(this).addClass("choice");$(this).addClass(l)})}});$.fn.extend({codeeditor:function(j){var g=$.val("height",j,{d:"200px"});var i=$.val("width",j,{d:"300px"});var f=$.val("name",j,{d:""});var h=$.val("value",j,{d:"300px"});this.each(function(){var b=$.uniqid();var c=[];c.push($.p('<textarea id="$1""></textarea>',["codeeditor-text-"+b]));$(this).addClass("codeeditor");$(this).html(c.join(""));$(this).css({width:i,height:g});$(this).codeeditor_attr({name:f});var a=CodeMirror.fromTextArea(document.getElementById("codeeditor-text-"+b),{lineNumbers:true,mode:"text/x-mariadb",indentWithTabs:true,smartIndent:true,matchBrackets:true,autofocus:true})})},codeeditor_get:function(){var b=[];$(this).each(function(){b.push($("textarea",this).val())});return b.length==1?b[0]:(b.length>1?b:"")},codeeditor_set:function(b){$(this).each(function(){$("textarea",this).val(b)})},codeeditor_attr:function(b){this.each(function(){var i={};var h={};var a={};for(var j in a){var g=a[j];switch(j){case"name":a.name=g}}$(this).attr(a);$(this).css(i);$("textarea",this).css(h)})}});$.fn.extend({codefield:function(l){var i=$.val("placeholder",l,{d:""});var g=$.val("name",l,{d:""});var h=$.val("height",l);var j=$.val("width",l);var k={width:j,height:h};this.each(function(){var a=this;var b=[];b.push("<pre style='height:"+h+";'>"+JSON.stringify({name:"andy"},null,2)+"</pre>");b.push("<span class='icon fa hidden'></span>");$(a).addClass("codefield");$(a).css(k);$(a).html(b.join(""));$(a).attr("data-type","codefield");$(a).attr("data-name",g);$(a).data("options",l)})},codefield_get:function(){var b=[];this.each(function(){var a=$("pre",this).html();b.push(a)});return b.length>1?b:(b.length==1?b[0]:"")},codefield_set:function(b){this.each(function(){$("pre",this).html(b)})}});$.fn.extend({commentlist:function(c){var d=$.val("onsubmit",c);$(this).each(function(){var b=this;var a=[];a.push("<div class='commentlist-write'>");a.push("<input type='text' placeholder='Write comment here...' />");a.push("</div>");a.push("<div class='commentlist-list'></div>");$(this).addClass("commentlist");$(this).html(a.join(""));$(this).data("options",c);$("input[type='text']",this).on("keyup",function(e){if(e.keyCode==13){if(e.shiftKey){}else{if(this.value!=""){$.fire_event(d,[this.value],b);this.value="";$(this).blur()}}}})})},commentlist_add:function(b){$(this).each(function(){var p=$(this).data("options");var n=$.val("onremove",p);var j=$.val("id",b);var k=$.val("comment",b);var l=$.val("full_name",b);var m=$.val("createdon",b);var a=$.val("removable",b,{d:0});if(!k||!l){return}var o=[];o.push("<div class='commentlist-item' data-id='"+j+"'>");o.push("<p style='word-wrap: break-word;'><b>"+l+"</b> "+k+"</p>");o.push("<div class='commentlist-item-footer'>");o.push("<label class=''>"+m+"</label>");if(a){o.push("<span class='width5 height5'>&nbsp;</span>");o.push("<span class='comment-item-remove selectable hoverable'>Remove</span>")}o.push("</div>");o.push("</div>");$(".commentlist-list",this).append(o.join(""));$(".comment-item-remove",$(".commentlist-list",this)).on("click",function(){var c=$(this).closest(".commentlist-item").attr("data-id");$.fire_event(n,[c],this)})})},commentlist_set:function(b){$(this).each(function(){var a=$(this).data("options");var q=$.val("onremove",a);var o=[];if($.type(b)=="array"){for(var p=0;p<b.length;p++){var r=b[p];var s=$.val("id",r);var n=$.val("comment",r);var m=$.val("full_name",r);var i=$.val("createdon",r);var t=$.val("removable",r,{d:0});if(!n||!m){continue}o.push("<div class='commentlist-item' data-id='"+s+"'>");o.push("<p style='word-wrap: break-word;'><b>"+m+"</b> "+n+"</p>");o.push("<div class='commentlist-item-footer'>");o.push("<label class=''>"+i+"</label>");if(t){o.push("<span class='width5 height5'>&nbsp;</span>");o.push("<span class='comment-item-remove selectable hoverable'>Remove</span>")}o.push("</div>");o.push("</div>")}}$(".commentlist-list",this).html(o.join(""));$(".comment-item-remove",$(".commentlist-list",this)).on("click",function(){var c=$(this).closest(".commentlist-item").attr("data-id");$.fire_event(q,[c],this)})})}});$.fn.extend({container_val:function(b){if(typeof b=="undefined"){result={};$("*[data-type]",this).each(function(){var a=this.getAttribute("data-name");if(a!=null&&a!=""){var d=$(this).val();result[a]=d}});return result}else{$("*[data-type]",this).each(function(){var a=this.getAttribute("data-name");if(a!=null&&a!=""){var d=$.val(a,b,{d:""});$(this).val(d)}})}},container_reset:function(){$("*[data-type]",this).each(function(){var b=$(this).attr("data-type");if(b!=null&&typeof $(this)[b+"_reset"]!="undefined"){$(this)[b+"_reset"].apply(this,arguments)}})}});$.fn.extend({datepicker:function(d){var c=$.val("type",d);this.each(function(){var a=this;var b=[];b.push("<input type='text' readonly/>");b.push("<span class='icon fa fa-calendar'></span>");$(a).addClass("datepicker");$(a).html(b.join(""));$(a).attr("data-type","datepicker");$(a).data("options",d);$(".icon",this).click(function(e){e.preventDefault();e.stopPropagation();var j=$(this).closest(".datepicker");var k=$(j).data("options");var l=$.val("readonly",k,{d:false});if(l=="0"||l==false){$.calendar_open({refEl:j,value:$(j).data("value"),type:c,onchange:function(f){$(j).datepicker_val(f)}})}});$(".popup",this).click(function(e){e.preventDefault();e.stopPropagation()});$(this).datepicker_val($.val("value",d,{d:"20170101"}))})},datepicker_val:function(b){if(typeof b=="undefined"){var b=[];$(this).each(function(){var a=$(this).data("value");b.push(a)});return b.length==1?b[0]:(b.length==0?null:b)}else{$(this).each(function(){var d="";b=$.date_parse(b);if(b.indexOf("-")>=0){var g=b.split("-");var h=$.date("M j, Y",$.strtotime(g[0]));var a=$.date("M j, Y",$.strtotime(g[1]));d=h+" - "+a}else{var g=$.date("M j, Y",$.strtotime(b));d=g}$("input",this).val(d);$(this).data("value",b)})}}});$.fn.extend({dropdown:function(k){var p=$.val("class",k,{d:""});var s=$.val("name",k,{d:""});var l=$.val("defaultvalue",k,{d:""});var m=$.val("value",k,{d:l});var o=$.val("items",k,{d:[]});var r=$.val("width",k,{d:[]});var t=$.val("src",k,{d:""});var n=$.val("placeholder",k,{d:""});var q=[];q.push("<input class='text' type='text' placeholder=\""+n+'" readonly/>');q.push("<span class='icon fa fa-caret-down hoverable'></span>");q.push("<span class='popup'></span>");this.each(function(){var a=this;$(a).addClass("dropdown");$(a).addClass(p);$(a).html(q.join(""));$(a).data("options",k);$(a).attr("data-type","dropdown");$(a).attr("data-name",s);$(a).dropdown_attr(k);$(".icon, .text",a).click(function(d){d.preventDefault();d.stopPropagation();var e=$(this).closest(".dropdown");var b=$(e).data("options");var c=$.val("readonly",b);if(!c){if($(".popup",e).hasClass("on")){$.popup_close($(".popup",e))}else{$.popup_open($(".popup",e),e,{min_width:$(e).outerWidth()});$(".search-item input",$(".popup",e)).val("");$(".search-item input",$(".popup",e)).focus();$(".item",$(".popup",e)).show()}}});if(m!=""){$(a).dropdown_val()}if(t.length>0){$(this).dropdown_load()}})},dropdown_val:function(f,d){if(typeof f=="undefined"){var e=[];this.each(function(){var c=this;var b=$(c).attr("data-value");var a=$("input",c).length==1?$("input",c).val():$(".text",c).html();b=b==null?a:b;e.push(b)});return e.length==1?e[0]:(e.length>1?e:null)}else{this.each(function(){var k=$(this).data("options");var l=$.val("items",k,{d:[]});var a="";var b="";if($.type(f)=="object"){b=$.val("value",f);a=$.val("text",f,{d:b})}else{if($.type(b)=="string"){a=b=f}}if($.type(l)=="array"){for(var i=0;i<l.length;i++){var c=l[i];if(c.value==b){a=c.text;b=c.value;break}}}$(this).attr("data-value",b);$("input",this).val(a);$(".text",this).html(a)})}},dropdown_items:function(d){if(typeof d=="undefined"){var c=[];this.each(function(){var a=this;var b=$(a).data("options");var f=$.val("items",b,{d:[]});$(f).each(function(){if($.type(this)=="object"){c.push(this)}})});return c}else{this.each(function(){var y=this;var b=$(y).data("options");var s=$.val("searchable",b,{d:false});var a=$.val("multiple",b,{d:false});var x=$.val("onchange",b);var u=[];if(s==true){u.push("<div class='search-item'>");u.push("<input type='text' placeholder='Search'/>");u.push("</div>")}if($.type(d)=="array"){for(var w=0;w<d.length;w++){var p=d[w];var q=p.text;var r=p.value;var i=(q+" "+r).toLowerCase();var t=$.uniqid();u.push("<div class='item' data-value=\""+r+'" data-search="'+i+'">');if(a){u.push("<input type='checkbox' id='dropdown_item_checkbox_"+t+"'/>")}u.push("<label for='dropdown_item_checkbox_"+t+"'>"+q+"</label>");u.push("</div>")}}u=u.join("");$(".popup",y).html(u);$(y).data("options",b);$(".item",$(".popup",y)).click(function(m){if(a){m.stopPropagation()}var j=$("label",this).html();var k=$(this).attr("data-value");var n=-1;var f=null;for(var e=0;e<d.length;e++){var h=d[e];var l=$.val("text",h);var g=$.val("value",h);if(g==k||l==j){n=e;f=h;break}}if(f){f._index=n}$("input",y).val(j);$(".text",y).html(j);$(y).attr("data-value",k);$.fire_event(x,[m,f],y)});$(".item>input[type='checkbox']",$(".popup",y)).on("change",function(){var f=this.nextElementSibling.innerHTML;var e=this.parentNode.getAttribute("data-value");$(y).dropdown_val({text:f,value:e},true)});$(".popup .search-item input",y).click(function(e){e.preventDefault();e.stopPropagation()});$(".popup .search-item input",y).keyup(function(f){var g=this.value;var e=$(this).closest(".popup");$(".item",e).show();if(g.length>0){$(".item:not([data-search*='"+g+"'])",e).hide()}});b.items=d;$(y).data("options",b);$(y).dropdown_val("*")})}},dropdown_attr:function(b){this.each(function(){var a=$(this).data("options");if($.type(b)=="object"){for(var g in b){var f=b[g];var h={};switch(g){case"items":$(this).dropdown_items(f);break;case"readonly":if(f){$(this).addClass("readonly");a.readonly=true}else{$(this).removeClass("readonly");a.readonly=false}break;case"value":$(this).dropdown_val(f);break;case"width":h.width=parseInt(f);break}$(this).css(h)}}$(this).data("options",a)})},dropdown_load:function(){this.each(function(){var d=this;var e=$(d).data("options");var f=$.val("src",e,{d:""});$.api_post(f,{},function(b){var a=$.val("data",b);if($.type(a)=="array"){$(d).dropdown_items(a)}})})},dropdown_reset:function(){$(this).each(function(){var d=$(this).data("options");var c=$.val("defaultvalue",d,{d:""});$(this).dropdown_val(c)})},dropdown_readonly:function(b){$(this).each(function(){if($.istrue(b)){$(this).addClass("readonly")}else{$(this).removeClass("readonly")}})}});$.fn.extend({feed:function(b){$(this).each(function(){var h=$.val("class",b,{d:""});var f=$.val("src",b,{d:""});var g=$.val("autoload",b,{d:false});var a=[];a.push("<div class='feed-content'></div>");a.push("<div class='feed-footer'></div>");$(this).addClass("feed");$(this).addClass(h);$(this).html(a.join(""));$(this).data("options",b);if(g){$(this).feed_load()}})},feed_val:function(c,d){if(typeof c=="undefined"){}else{$(this).each(function(){var a=$(this).data("options");var r=$.val("src",a,{d:""});var b=$.val("template",a,{d:""});if($.type(c)=="array"&&c.length>0){var m="feed_group_"+$.uniqid();var i=document.createElement("div");i.setAttribute("data-feed-group-id",m);var n=[];for(var o=0;o<c.length;o++){n.push("<div class='feed-item'></div>")}i.innerHTML=n.join("");$(".feed-content",this).append(i);for(var o=0;o<c.length;o++){var p=c[o];var q=i.childNodes[o];$.fire_event(b,[p],q)}}})}},feed_load:function(b){$(this).each(function(){if(!$(this).hasClass("feed")){return}var a=this;var f=$(this).data("options");var e=$.val("src",f,{d:""});if(e!=""){$.api_post(e,[],function(j){var c=$.val("data",j,{d:[]});var d=$.val("page",j,{d:1});var k=d==1?false:true;$(a).feed_val(c,k);var l=$.val("max_page",j,{d:d});if(l>=d+1){$(".feed-footer",a).html("<div class='load-more align-center padding10'>Load More...</div>");$(".load-more",a).on("click",function(){$(a).feed_load({page:d+1})})}else{$(".feed-footer",a).html("")}})}})}});$.extend({foldedpane_toggle:function(f){var e=$(f);if(typeof e[0]=="undefined"){return}var d=$(".toggler",e);if(e[0].classList.contains("folded")){e[0].classList.remove("folded");if(d.length==1){d.html("<span class='fa fa-caret-up'></span>")}}else{e[0].classList.add("folded");if(d.length==1){d.html("<span class='fa fa-caret-down'></span>")}}},foldedpane_init:function(){var e=document.body.querySelectorAll(".folded-pane");for(var f=0;f<e.length;f++){var h=e[f];var g=h.querySelector(".toggler");if(g!=null){g.addEventListener("click",function(){$.foldedpane_toggle(h)})}}}});$.fn.extend({grid:function(p){var m=$.val("autoload",p,{d:true});var o=$.val("columns",p,{d:[]});var n=$.val("class",p,{d:null});var i=$.val("name",p,{d:""});var k=$.val("footer",p,{d:""});var l=$.val("value",p,{d:null});var j=$.val("height",p,{d:"auto"});p.page=0;p.row_per_page=12;this.each(function(){var a=this;var b=[];b.push("<table class='grid-body'>");b.push("<tbody class='grid-size'></tbody>");b.push("</table>");b.push("<div class='grid-footer'></div>");$(a).attr("data-type","grid");$(a).addClass("grid");$(a).addClass(n);if(i!=""){$(a).attr("data-name",i)}$(a).data("options",p);$(a).attr("data-type","grid");$(a).html(b.join(""));$.fire_event(k,[],$(".grid-footer",a));$(this).grid_set_columns(o);if(l!=null){$(a).grid_set(l)}if(m){$(a).grid_load()}})},grid_add:function(b){this.each(function(){var J=this;var i=J.querySelector(".grid-body");var F=$(J).data("options");var K=$.val("columns",F,{d:[]});var z=[];if($(".grid-size",i).length==0){var C=[];C.push("<tr class='grid-size'>");for(var w=0;w<K.length;w++){var G=K[w];var B=$.val("width",G,{d:""});C.push("<td style='width:"+B+";'></td>");C.push("<td class='separator'></td>")}C.push("<td style='width:100%'></td>");C.push("</tr>");z.push(C.join(""))}z.push("<tr>");for(var x=0;x<K.length;x++){var G=K[x];var H=$.val("type",G,{d:"text"});var D=$.val("datatype",G,{d:"text"});var a=$.val("name",G,{d:""});var B=$.val("width",G,{d:""});var y=$.val("align",G,{d:""});var E="";var I="";var A="";switch(H){case"index":A=w+1;E="right";I="label";break;case"html":gridtypecoord=0+","+x;break;default:switch(D){case"number":case"money":E="right";A=$.val(a,b,{d:0});break;case"enum":var j=$.val("enums",G,{d:{}});A=$.val(a,b,{d:"-"});A=$.val(A,j,{d:"-"});break;default:A=$.val(a,b,{d:"-"});break}I="label";break}if(y!=""){E=y}z.push("<td data-gridtype='"+H+"' data-gridtypecoord='"+gridtypecoord+"' class='"+I+"' style='text-align:"+E+"'>"+A+"</td>");z.push("<td class='separator'></td>")}z.push("<td></td>");z.push("</tr>");$("tbody",i).append(z.join(""));$("td[data-gridtype='html']",$("tr",$("tbody",i)).last()).each(function(){var f=$(this).attr("data-gridtypecoord").split(",");var e=parseInt(f[1]);var d=K[e];var c=$.val("html",d,{d:""});$.fire_event(c,[b,d],this)})})},grid_remove:function(c){var d=this;$(c).each(function(){var a=$(this).closest(".grid");a=typeof a[0]!="undefined"?a[0]:-2;var b=typeof d[0]!="undefined"?d[0]:-1;if(a==b){$(this).remove()}})},grid_set_columns:function(b){$(this).each(function(){if(!$(this).hasClass("grid")){return}var n=$(this).data("options");n.columns=b;$(this).data("options",n);var l=[];l.push("<tr>");for(var m=0;m<b.length;m++){var j=b[m];var a=$.val("name",j);var k=$.val("width",j);var i=$.val("active",j,{d:1});if(i==1){l.push($.p("<td class='grid-size-label' style='width:$1' data-key='"+a+"'></td>",[k]))}else{l.push($.p("<td class='grid-size-label inactive' style='width:$1' data-key='"+a+"'></td>",[k]))}}l.push("<td style='width:100%'></td>");l.push("</tr>");$(".grid-size",this).html(l.join(""))})},grid_append:function(c,d){this.each(function(){var x=this;var b=x.querySelector(".grid-body");var a=$(x).data("options");var y=$.val("src",a,{d:""});var p=$.val("onselect",a);var w=$.val("columns",a,{d:[]});var q=$.val("page",c,{d:1});var i=$.val("row_per_page",c,{d:10});var u=$.val("max_page",c,{d:q});var r=$.val("data",c);if(typeof a.data=="undefined"){a.data=[]}var s=document.createElement("tbody");$(s).html($.grid_html(r,w,a.data.length));$(b).append(s);$("td[data-gridtype='html']",s).each(function(){var e=$(this).attr("data-gridtypecoord").split(",");var j=parseInt(e[0]);var k=parseInt(e[1]);var g=r[j];var h=w[k];var f=$.val("html",h,{d:""});$.fire_event(f,[g,h],this)});$("tr",s).click(function(){var g=$(this).closest("table");$(".active",g).removeClass("active");$(this).addClass("active");var e=$(this).attr("data-idx");var f=a.data[e];$.fire_event(p,[f],x)});$(".grid-more",x).remove();if(u>q){$(x).append("<div class='grid-more' data-page='"+q+"'><label class='cl-gray'>Load more...</label></div>");$(".grid-more",x).click(function(){var f=parseInt($(this).attr("data-page"));var e=$.val("onloadmore",a);$(this).html("<i class='fa fa-circle-o-notch fa-spin fa-fw cl-gray'></i>");if(y!=""){$(x).grid_load()}$.fire_event(e,[{page:f}],x)});$(".grid-more",x).appear(function(){var f=parseInt($(this).attr("data-page"));var e=$.val("onloadmore",a);$(this).html("<i class='fa fa-circle-o-notch fa-spinfa-fw cl-gray'></i>");if(y!=""){$(x).grid_load()}$.fire_event(e,[{page:f}],x)})}for(var t=0;t<r.length;t++){a.data.push(r[t])}$(x).data("options",a)})},grid_load:function(b){this.each(function(){var a=this;var o=$(a).data("options");var k=$.val("src",o,{d:""});var j=$.val("method",o,{d:"post"});if(k.length>0){var l=$.val("page",b,{d:1});var m=$.val("row_per_page",b,{d:10});var n=$.val("columns",o);var p={page:l,row_per_page:m,columns:n};if(j.toString().toLowerCase()=="get"){$.api_get(k,p,function(e){var g=$.val("data",e,{d:[]});var c=$.val("page",e,{d:1});var f=c==1?false:true;$(a).grid_val(g,f);var d=$.val("next_page",e,{d:c});if(d>c){$(".grid-footer",a).html("<div class='load-more align-center padding10'>Load More...</div>");$(".load-more",a).on("click",function(){$(a).grid_load({page:d})})}else{$(".grid-footer",a).html("")}})}else{$.api_post(k,p,function(e){var g=$.val("data",e,{d:[]});var c=$.val("page",e,{d:1});var f=c==1?false:true;$(a).grid_val(g,f);var d=$.val("next_page",e,{d:c});if(d>c){$(".grid-footer",a).html("<div class='load-more align-center padding10'>Load More...</div>");$(".load-more",a).on("click",function(){$(a).grid_load({page:d})})}else{$(".grid-footer",a).html("")}})}$(".grid-footer",this).html("<div class='align-center padding10'>Loading...</div>")}})},grid_val:function(c,d){if(typeof c=="undefined"){var c=[];this.each(function(){var b=this;var a=b.querySelector(".grid-body");var f=$("tbody",a);$(f).children().each(function(){if(this.classList.contains("grid-size")){}else{var h=$(this).attr("data-idx");var e=$.el_get(this);if(JSON.stringify(e).length>3){c.push(e)}}})});return c}else{this.each(function(){var b=this;var a=$(b).data("options");var r=$.val("onselect",a);var y=$.val("columns",a,{d:[]});var t=document.createElement("tbody");t.className="grid-content";t.innerHTML=$.grid_html(c,y);if(typeof d=="undefined"||d!==true){$(".grid-content",b).remove()}$(".grid-body",b).append(t);for(var u=0;u<t.childNodes.length;u++){var i=t.childNodes[u];var w=c[u];for(var x=0;x<i.childNodes.length;x++){var z=i.childNodes[x];var j=z.getAttribute("data-column-type");if(j=="html"){var A=y[x];var s=$.val("html",A,{d:""});$.fire_event(s,[w,A],z)}}}$("tr",t).on("click.gridrow",function(e){var f=$(this).closest("table");$(".active",f).removeClass("active");$(this).addClass("active");$.fire_event(r,[e,this],b)})})}},grid_get_selected_value:function(){var b=null;$(this).each(function(){var f=$(this).data("options");var e=$.val("data",f);var a=$("tr[class='active']").attr("data-idx");b=$.val(a,e)});return b}});$.extend({grid_html:function(y,B){if(!y){return}var w=[];for(var x=0;x<y.length;x++){var z=y[x];w.push("<tr>");for(var A=0;A<B.length;A++){var C=B[A];var s=$.val("type",C,{d:"text"});var E=$.val("datatype",C,{d:"text"});var F=$.val("name",C,{d:""});var D=$.val("align",C,{d:""});var t="";var i="";var u="";switch(s){case"html":break;default:switch(E){case"number":case"money":t="right";u=$.val(F,z,{d:0});u=$.number_format(u);break;case"enum":var j=$.val("enums",C,{d:{}});u=$.val(F,z,{d:"-"});u=$.val(u,j,{d:"-"});break;default:u=$.val(F,z,{d:"-"});break}var G=$.val("lettercase",C,{d:""});switch(G){case"capitalize":u=u.toString().capitalize();break;case"lowercase":u=u.toString().toLowerCase();break;case"uppercase":u=u.toString().toUpperCase();break}i="label";break}if(D!=""){t=D}w.push("<td data-column-type='"+s+"' class='"+i+"' style='text-align:"+t+"'>"+u+"</td>")}w.push("<td></td>");w.push("</tr>")}return w.join("")}});$.fn.extend({gridhead:function(n){var j=$.val("autoload",n,{d:true});var l=$.val("columns",n,{d:[]});var k=$.val("class",n,{d:null});var h=$.val("name",n,{d:""});var m=$.val("grid",n,{d:null});var i=$.val("height",n,{d:null});this.each(function(){var a=this;$(a).addClass("gridhead");$(a).addClass(k);$(a).attr("data-type","gridhead");if(h!=""){$(a).attr("data-name",h)}$(a).data("options",n);$(a).attr("data-type","gridhead");$(a).gridhead_attr({height:i});$(this).gridhead_set(l)})},gridhead_set:function(b){$(this).each(function(){var A=this;var a=$(this).data("options");var E=$.val("grid",a,{d:null});var r=$.val("oncolumnclick",a);a.columns=b;var w=[];w.push("<table class='grid-head'><tr>");for(var x=0;x<b.length;x++){var y=b[x];var D=$.val("name",y,{d:""});var B=$.val("active",y,{d:1});var i=$.val("text",y,{d:"-"});var s=$.val("width",y,{d:""});var C=$.val("datatype",y,{d:"text"});var z=$.val("align",y,{d:""});var u="";switch(C){case"number":case"money":u="right";break;case"enum":break;default:break}if(z!=""){u=z}var t="label"+(!B?" inactive":"");w.push("<td class='"+t+"' style='width:"+s+";text-align:"+u+"' data-key=\""+D+'">'+i+"<span class='separator'></span></span></td>")}w.push("<td style='width:100%'></td>");w.push("</tr></table>");$(A).html(w.join(""));$(".separator",A).mousedown(function(d){d.preventDefault();d.stopPropagation();var f=this.parentNode;var e=f.parentNode;var c=d.clientX;$(window).on("mousemove.gridhead",function(g){g.preventDefault();g.stopPropagation();var h=g.clientX-c;f.style.width=(parseInt(f.style.width)+h)+"px";c=g.clientX});$(window).on("mouseup.gridhead",function(l){l.preventDefault();l.stopPropagation();var h=$(E);var n=$(".grid-size",h);if(n.length==1){var j=-1;for(var m=0;m<e.childNodes.length;m++){if(e.childNodes[m]==f){j=m;break}}j=parseInt(j);$(".grid-size-label:eq("+(j)+")",n).css({width:$(f).outerWidth()});var k=$(A).data("options");k.columns[j]["width"]=$(f).outerWidth();var g=$.val("oncolumnresize",k);$.fire_event(g,[{index:j,width:$(f).outerWidth()}],A)}$(window).off("mousemove.gridhead");$(window).off("mouseup.gridhead")})});$(".separator",A).click(function(c){c.preventDefault();c.stopPropagation()});$(".label",A).on("click",function(d){d.preventDefault();d.stopPropagation();var e=$(this).attr("data-key");var c=$(this).attr("data-sorttype");if(c=="asc"){c="desc"}else{if(c=="desc"){c="asc"}else{c="asc"}}$(this).attr("data-sorttype",c);$.fire_event(r,[[{key:e,type:c}]],A)})})},gridhead_attr:function(b){$(this).each(function(){for(var a in b){var d=b[a];switch(a){case"height":$(this).css({height:d});break}}})},gridhead_modify_column:function(b){$(this).each(function(){if(!$(this).hasClass("gridhead")){return}var a=$(this).data("options");var w=$.val("grid",a);var i=$.val("columns",a);for(var o=0;o<i.length;o++){var s=i[o];var j=$.val("name",s,{d:""});var t=$.val("width",s,{d:""});if(j==""){continue}for(var p=0;p<b.length;p++){var q=b[p];var u=$.val("name",q,{d:""});var r=$.val("active",q,{d:1});if(j==u){if(r){$(".label[data-key='"+u+"']",this).removeClass("inactive");$(".grid-size-label[data-key='"+u+"']",$(w)).removeClass("inactive")}else{$(".label[data-key='"+u+"']",this).addClass("inactive");$(".grid-size-label[data-key='"+u+"']",$(w)).addClass("inactive")}a.columns[o]["active"]=r;column_exists=true}}}$(this).data("options",a)})}});$.fn.extend({gridsetting:function(c){var d=$.val("onchange",c);this.each(function(){var a=this;var b=[];b.push("<div class='modal-head'>");b.push("<div class='align-center padding10'>");b.push("<ul class='tab'>");b.push("<li class='active' data-value='presets'>Presets</li>");b.push("<li data-value='columns'>Columns</li>");b.push("<li data-value='filters'>Filters</li>");b.push("</ul>");b.push("</div>");b.push("</div>");b.push("<div class='modal-body padding20'>");b.push("<div class='cont12 space10 gridsetting-presets'>");b.push("<div class='lg12'><button class='blue preset-add-btn'><span class='fa fa-plus'></span> Add Preset...</button></div>");b.push("<div class='lg12'><span class='preset-grid'></span></div>");b.push("</div>");b.push("<div class='cont12 space10 gridsetting-columns' style='display:none'>");b.push("<div class='lg12'>");b.push("<button class='blue column-up-btn'><span class='fa fa-caret-up'></span>Up</button>");b.push("&nbsp;");b.push("<button class='blue column-down-btn'><span class='fa fa-caret-down'></span>Down</button>");b.push("</div>");b.push("<div class='lg6'><span class='column-grid'></span></div>");b.push("<div class='lg6'>");b.push("<div class='cont12 space10 gridsetting-column-detail'>");b.push("<div class='lg3 align-right'><label class='padding10'>Align</label></div>");b.push("<div class='lg9'><span class='gridsetting-column-align'></span></div>");b.push("<div class='lg3 align-right'><label class='padding10'>Name</label></div>");b.push("<div class='lg9'><label class='gridsetting-column-name padding10'></label></div>");b.push("<div class='lg3 align-right'><label class='padding10'>Text</label></div>");b.push("<div class='lg9'><span class='gridsetting-column-text'></span></div>");b.push("<div class='lg3 align-right'><label class='padding10'>Width</label></div>");b.push("<div class='lg9'><span class='gridsetting-column-width'></span></div>");b.push("</div>");b.push("</div>");b.push("</div>");b.push("<div class='cont12 space10 gridsetting-filters' style='display:none'>");b.push("<div class='lg12'><button class='blue filter-add-btn'><span class='fa fa-plus'></span> Add Filter...</button></div>");b.push("<div class='lg12'><span class='filter-grid'></span></div>");b.push("</div>");b.push("</div>");b.push("<div class='modal-foot'>");b.push("<button class='blue apply-btn'><span class='fa fa-save'></span> Apply Filter</button>");b.push("&nbsp;");b.push("<button class='close-btn'><span class='fa fa-times'></span> Close</button>");b.push("</div>");$(a).addClass("modal width800 gridsetting");$(a).html(b.join(""));$(".tab",a).tab({onchange:function(f){$(".modal-body",a).children().hide();$(".gridsetting-"+f.value,a).show()}});$(".preset-add-btn").click(function(){});$(".preset-grid",a).grid({"class":"transparent",columns:[{text:"",type:"html",html:"$.gridsetting_preset_option",width:"50px"},{text:"Preset Name",name:"text",width:"150px"}]});$(".column-grid",a).grid({"class":"transparent",columns:[{text:"Column Name",name:"text",width:"150px"},{text:"Width",name:"width",width:"100px"}],onselect:function(h){var j=$(this).closest(".gridsetting-columns");var i=$(".gridsetting-column-detail",j);$.el_set(i,h);$(".gridsetting-column-name",i).html($.val("name",h,{d:""}))}});$(".gridsetting-column-align",a).dropdown({name:"align",items:[{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]});$(".gridsetting-column-name",a).html("");$(".gridsetting-column-text",a).textbox({name:"text",onchange:function(i){var n=$(a).data("params");var k=$(this).closest(".gridsetting-column-detail");var m=$(".gridsetting-column-name",k).html();for(var l=0;l<n.presets[n.active_idx]["columns"].length;l++){if(n.presets[n.active_idx]["columns"][l]["name"]==m){n.presets[n.active_idx]["columns"][l]["text"]=i}}$(a).data("presets",n)}});$(".gridsetting-column-width",a).textbox({name:"width",onchange:function(i){var n=$(a).data("params");var k=$(this).closest(".gridsetting-column-detail");var m=$(".gridsetting-column-name",k).html();for(var l=0;l<n.presets[n.active_idx]["columns"].length;l++){if(n.presets[n.active_idx]["columns"][l]["name"]==m){n.presets[n.active_idx]["columns"][l]["width"]=i}}$(a).data("presets",n)}});$(".filter-add-btn",a).click(function(){$(".filter-grid",a).grid_add()});$(".filter-grid",a).grid({"class":"transparent",columns:[{text:"",type:"html",html:"$.gridsetting_grid_option",width:"50px"},{text:"Key",type:"html",html:"$.gridsetting_grid_key",width:"150px"},{text:"Operator",type:"html",html:"$.gridsetting_grid_opt",width:"150px"},{text:"Value",type:"html",html:"$.gridsetting_grid_val",width:"150px"}]});$(".apply-btn",a).click(function(){var j=$(".filter-grid",a).grid_value();var h=$(a).data("params");var i=parseInt($.val("active_idx",h,{d:0}));h.presets[i]["filters"]=j;$.fire_event(d,[h],a);$(a).modal_close()});$(".close-btn",a).click(function(){$(a).modal_close()})})},gridsetting_close:function(){$(this).modal_close()},gridsetting_open:function(c,d){this.each(function(){var h=$.val("presets",c);var a=c.presets[c.active_idx];var g=$.val("columns",c);var b=$.val("filters",c);$(this).data("params",c);$(this).data("columns",g);$(".preset-grid",this).grid_set(h);$(".column-grid",this).grid_set(g);$(".filter-grid",this).grid_set(b);$(this).modal_open({height:window.innerHeight*0.8})})}});$.extend({gridsetting_preset_option:function(b){$(this).html("<button class='preset-grid-options'><span class='fa fa-times'></span></button>");$(".preset-grid-options",this).click(function(){$(this).closest("tr").remove()})},gridsetting_grid_option:function(b){$(this).html("<button class='filter-grid-options'><span class='fa fa-times'></span></button>");$(".filter-grid-options",this).click(function(){$(this).closest("tr").remove()})},gridsetting_grid_type:function(b){$(this).html("<span class='filter-grid-type'></span>");$(".filter-grid-type",this).textbox({name:"type",value:$.val("type",b,{d:null})})},gridsetting_grid_key:function(o,q){var s=$(this).closest(".gridsetting");var p=$(s).data("params");var i=p.presets[p.active_idx];var q=p.columns;var m=[];if($.type(q)=="array"){for(var n=0;n<q.length;n++){var r=q[n];var t=$.val("name",r,{d:""});var l=$.val("text",r,{d:t});if(t.length>0){m.push({text:l,value:t})}}}$(this).html("<span class='filter-grid-key'></span>");$(".filter-grid-key",this).dropdown({name:"key",items:m,value:$.val("key",o,{d:null})})},gridsetting_grid_opt:function(b){$(this).html("<span class='filter-grid-opt'></span>");$(".filter-grid-opt",this).dropdown({name:"operator",items:[{text:"Contains",value:"contains"},{text:"Equals",value:"equals"}],value:$.val("operator",b,{d:null})})},gridsetting_grid_val:function(b){$(this).html("<span class='filter-grid-val'></span>");$(".filter-grid-val",this).textbox({name:"value",value:$.val("value",b,{d:null})})}});$.fn.extend({hidden:function(c){var d=$.val("name",c,{d:""});$(this).each(function(){var a=[];$(this).html(a.join(""));$(this).attr("data-type","hidden");$(this).attr("data-name",d);$(this).addClass("hidden");$(this).data("options",c)})},hidden_val:function(c){if(typeof c=="undefined"){var d=[];$(this).each(function(){d.push($(this).data("value"))});return d.length>1?d:(d.length==1?d[0]:"")}else{$(this).each(function(){$(this).data("value",c)})}}});$.fn.extend({image:function(l){var j=$.val("class",l,{d:""});var h=$.val("height",l,{d:"50px"});var g=$.val("name",l,{d:""});var i=$.val("value",l,{d:""});var k=$.val("width",l,{d:"50px"});this.each(function(){var a=this;var b=[];b.push('<img src="'+i+'"/>');$(a).attr("data-type","image");$(a).attr("data-name",g);$(a).addClass("image");$(a).addClass(j);$(a).html(b.join(""));$(a).data("options",l);$("img",a).css({width:k,height:h})})},image_val:function(c){if(typeof c=="undefined"){var d=[];this.each(function(){d.push($("img",this).attr("src"))});return d.length>1?d:(d.length==1?d[0]:"")}else{this.each(function(){$("img",this).attr("src",c)})}}});$.extend({layout_resize:function(){$(".layout-sidebar, .layout-main, .layout-ext",$(".layout")).css({height:window.innerHeight-$(".header").outerHeight()})}});$.fn.extend({layout:function(f){var i=$.val("class",f,{d:""});var j=$.val("size",f,{d:{}});var h=$.val("large",j,{d:"300px auto 400px"});var g=h.split(" ");$(this).each(function(){var c=$.val(0,g,{d:"200px"});var a="100%";var b=$.val(2,g,{d:"300px"});$(this).addClass("layout");$(this).addClass(i);$(".layout-sidebar",this).css({flex:"0 0 "+c});$(".layout-main",this).css({flex:"1 1 "+a});$(".layout-ext",this).css({flex:"0 0 "+b});$(".layout-sidebar, .layout-main, .layout-ext",this).css({height:window.innerHeight-$(".header").outerHeight()})});$(window).on("resize.layout",function(){$.layout_resize()})}});$.extend({layout2_resize:function(){$(".layout2").layout2_resize()}});$.fn.extend({layout2:function(f){var h=$.val("class",f,{d:""});var e=$.val("size",f,{d:"300px auto 400px"});var g=e.split(" ");$(this).each(function(){$(this).addClass("layout2");$(this).addClass(h);$(this).data("options",f);$(this).layout2_resize()});$(window).on("resize.layout",function(){$.layout2_resize()})},layout2_resize:function(){$(this).each(function(){var j=$(this).data("options");var r=$.val("onresize",j);var o=$.val("ext_hidden",j);var k=$.val("size",j,{d:"300px auto 400px"});var l=k.split(" ");var n=window.innerHeight-$(".header").outerHeight();var q=$.val(0,l,{d:"200px"});var p=$.val(2,l,{d:"300px"});var n=window.innerHeight-$(".header").outerHeight();p=$.calc_size(p,n);var m=n-p;$(".layout-sidebar",this).css({flex:"0 0 "+q,height:n});$(".layout-content",this).css({flex:"1 1 auto"});if(o==0){$(this).removeClass("ext-hidden");$(".layout-main",this).css({height:p});$(".layout-ext",this).css({height:m})}else{$(this).addClass("ext-hidden");$(".layout-main",this).css({height:n});$(".layout-ext",this).css({height:0})}$.fire_event(r,[],this)})},layout2_toggleext:function(b){$(this).each(function(){if(!$(this).hasClass("layout2")){return}var a=$(this).data("options");a.ext_hidden=b?0:1;$(this).data("options",a);$(this).layout2_resize()})},layout2_ext_state:function(){var b=0;$(this).each(function(){var a=$(this).data("options");b=$.val("ext_hidden",a,{d:-1})>0?0:1});return b}});$.fn.extend({modal_open:function(b){this.each(function(){var a=this;$(a).addClass("on");$(document.body).css({overflow:"hidden"});var f=$(a).outerHeight()-5-($(".modal-head",a).outerHeight()+$(".modal-foot",a).outerHeight());if(!isNaN(f)){$(".modal-body",a).css({height:f})}var h=$.val("reset",b,{d:false});if(h===true){$(a).reset()}var g=$.val("value",b,{d:null});if(g!=null){$(a).val(b.value)}})},modal_close:function(c,d){this.each(function(){var a=this;$(a).removeClass("on");$(".modal-bg").removeClass("on")});if($(".modal.on").length==0){$(document.body).css({overflow:""})}}});$.extend({popup_close:function(b){$(b).removeClass("on")},popup_open:function(r,q,j){$.popup_close_all();$(r).addClass("on");var n={};var o=$(q).offset();var k=o.left+r.clientWidth;var l=o.top-$(window).scrollTop()+$(q).outerHeight()+1;var m=window.innerHeight-l-10;n.top=l;n["max-height"]=m;if(k>window.innerWidth){o.left=window.innerWidth-r.clientWidth}n.left=o.left;var p=$.val("min_width",j);if(!isNaN(parseInt(p))){n["min-width"]=p}$(r).css(n)},popup_toggle:function(f,e,d){if(f.classList.contains("on")){$.popup_close(f,e,d)}else{$.popup_open(f,e,d)}},popup_close_all:function(){var d=document.body.querySelectorAll(".popup");for(var c=0;c<d.length;c++){$.popup_close(d[c])}}});$.fn.extend({radio:function(b){$(this).each(function(){var u=$.val("items",b,{d:null});var w=$.val("class",b,{d:""});var i=$.val("text",b,{d:""});var A=$.val("name",b,{d:""});var s=$.val("value",b,{d:""});var y=[];if($.type(u)=="array"){var a="radio-name-"+$.uniqid();for(var z=0;z<u.length;z++){var p=u[z];var q=p.text;var r=p.value;var t=s!=""&&s==r?true:false;var x="radio-"+$.uniqid();y.push("<input type='radio' id='"+x+"' value=\""+r+"\" name='"+a+"'"+(t?" checked":"")+"/>");y.push("<label for='"+x+"'>"+q+"</label>")}}else{var t=parseInt(s)==1||s===true?true:false;var x="radio-"+$.uniqid();y.push("<input type='radio' id='"+x+"'"+(t?" checked":"")+"/>");y.push("<label for='"+x+"'>"+i+"</label>")}$(this).addClass("radio");$(this).addClass(w);$(this).attr({"data-type":"radio"});$(this).html(y.join(""))})},radio_val:function(c){if(typeof c=="undefined"){var d=[];$(this).each(function(){var b=this.querySelectorAll("input");if(b.length==1){d.push(b[0].checked?1:0)}else{for(var a=0;a<b.length;a++){if(b[a].checked){d.push(b[a].value)}}}});d=d.join(",");return d}else{$(this).each(function(){var f=this.querySelectorAll("input");if(f.length==1){f[0].checked=(parseInt(c)==1||c===true)?true:false}else{var a=false;for(var b=0;b<f.length;b++){if(f[b].value==c){f[b].checked=true;a=true;break}}if(!a){$("input",this).attr("checked",false)}}})}}});$.extend({role_init:function(c){var d=typeof c!="undefined"&&c instanceof HTMLElement?c:document.body;$("*[data-role]",d).each(function(){var a=this.getAttribute("data-role");switch(a){case"modal.close":$(this).click(function(){$(this).closest(".modal").modal_close()});break;case"url.open":var b=$(this).attr("data-role-value");$(this).click(function(){window.location=b});break}})}});$.fn.extend({autocomplete:function(h){var l=$.val("class",h,{d:""});var i=$.val("name",h,{d:""});var j=$.val("src",h,{d:""});var m=$.val("width",h);var k=$.val("placeholder",h,{d:""});var n={};if(m!=null){n.width=m}this.each(function(){var a=this;var b=[];b.push("<input type='text' placeholder=\""+k+'"/>');b.push("<span class='icon fa fa-search hoverable selectable'></span>");b.push("<span class='popup'></span>");$(a).addClass("autocomplete");$(a).addClass(l);$(a).html(b.join(""));$(a).css(n);$(a).attr("data-name",i);$(a).attr("data-type","autocomplete");$(a).data("options",h);$("input[type='text']",a).on("keyup",function(c){var d=$(this).closest(".autocomplete");if($(d).hasClass("readonly")){return}var e=$(d).data("options");var f=$.val("readonly",e);if(!f&&j.length>0){var g={};g.key=this.value;$.api_get(j,g,function(C){var x=$.val("data",C);var A=[];if($.type(x)=="array"){for(var B=0;B<x.length;B++){var z=x[B];var y=$.val("value",z,{d:""});var w=$.val("text",z,{d:y});A.push("<div class='item' data-value=\""+y+'">');A.push("<label>"+w+"</label>");A.push("</div>")}}$(".popup",d).html(A.join(""));$(".item",$(".popup",d)).on("click",function(){var p=this.getAttribute("data-value");var q=$("label",this).text();var o={value:p,text:q};$(d).autocomplete_val(o)});$.popup_open($(".popup",d),d,{min_width:$(d).outerWidth()})})}})})},autocomplete_val:function(f,e){if(typeof f=="undefined"){var d=[];$(this).each(function(){var b=$(this).data("options");var h=$.val("multiple",b,{d:false});if(h){$(".text",this).each(function(){d.push(this.getAttribute("data-value"))})}else{var a=$("input",this).val();var c=$(this).data("value");if(c==null){c=a}d.push(c)}});return d.length==1?d[0]:(d.length>1?d:"")}else{$(this).each(function(){var b=$(this).data("options");var c=$.val("multiple",b,{d:false});var a=d="";if($.type(f)=="object"){d=$.val("value",f,{d:""});a=$.val("text",f,{d:d})}else{a=d=f}if(c){var i=typeof e!="undefined"&&e===true?true:false;if(i){$(".text",this).remove()}var j=$(this).val();if(!$.in_array(d,j)&&d!==""){$("<span class='text' data-value=\""+d+'">'+a+"<span class='icon-remove glyphicons glyphicons-remove'></span></span>").insertBefore($("input",this));$(".glyphicons-remove",$("input",this).prev()).on("click",function(){$(this).parent().remove()})}$("input",this).val("")}else{$("input",this).val(a);$(this).data("value",d)}})}},autocomplete_readonly:function(b){if(typeof b=="undefined"){return $(this).hasClass("readonly")?true:false}else{if(b){$(this).addClass("readonly");$("input",this).attr("readonly",true);$("input",this).data("placeholder",$("input",this).attr("placeholder"));$("input",this).attr("placeholder","")}else{$(this).removeClass("readonly");$("input",this).attr("readonly",false);$("input",this).attr("placeholder",$("input",this).data("placeholder"))}}},autocomplete_reset:function(){$(this).autocomplete_val("",true)}});$.fn.extend({calendar:function(b){this.each(function(){var f=this;var e=$.val("value",b,{d:"2017-01-01"});e=$.date("j M Y",$.strtotime(e));var a=[];a.push("<input type='text' value='"+e+"' readonly/>");a.push("<span class='icon fa fa-calendar'></span>");a.push("<span class='popup'>Calendar</span>");$(f).addClass("calendar");$(f).html(a.join(""));$(f).attr("data-type","calendar");$(".icon",this).click(function(c){c.preventDefault();c.stopPropagation()});$(".popup",this).click(function(c){c.preventDefault();c.stopPropagation()})})}});$.extend({calendar_open:function(g){var e=g.refEl;var h=g.value;var f=$("#calendar");if(f.length==0){f=document.createElement("div");f.id="calendar";f.className="popup";document.body.appendChild(f);f=$("#calendar")}f=f[0];$(f).data("params",g);$.calendar_set(h);$.popup_open(f,e)},calendar_set:function(d){var f=$("#calendar").data("params");var e=$.val("type",f,{d:""});switch(e){case"range":$.calendar_set_range(d);break;default:$.calendar_set_single(d);break}},calendar_set_single:function(q){var C=$("#calendar");$(C).attr("data-value",q);var s=$.date("n",$.strtotime(q));var r=$.date("Y",$.strtotime(q));var A=$.date("j",$.strtotime(q));var t=$.start_day_of_month(r,s)%7;var j=$.last_date_of_month(r,s);var i=$.date("M Y",$.strtotime(q));var y=$(C).data("params");var z=y.onchange;var u=[];u.push("<table>");u.push("<tr>");u.push("<td><span class='calendar-prev fa fa-caret-left padding5'></span></td>");u.push("<td colspan='5'><span class='date-label'>"+i+"</span></td>");u.push("<td><span class='calendar-next fa fa-caret-right padding5'></span></td>");u.push("</tr>");u.push("<tr>");u.push("<td>Sun</td>");u.push("<td>Mon</td>");u.push("<td>Tue</td>");u.push("<td>Wed</td>");u.push("<td>Thu</td>");u.push("<td>Fri</td>");u.push("<td>Sun</td>");u.push("</tr>");var B=1;for(var w=0;w<6;w++){u.push("<tr>");for(var x=0;x<7;x++){if(t>0){u.push("<td></td>");t--}else{if(B<=j){u.push(B==A?"<td class='day active'>"+B+"</td>":"<td class='day'>"+B+"</td>");B++}else{u.push("<td></td>")}}}u.push("</tr>")}u.push("</table>");C.html(u.join(""));$(".day",C).click(function(d){d.preventDefault();d.stopPropagation();var c=$(this).closest("#calendar");var g=$(c).attr("data-value");var b=this.innerHTML;var e=parseInt($.date("n",$.strtotime(g)));var f=$.date("Y",$.strtotime(g));var a=$.date("j M Y",$.mktime(0,0,0,e,b,f));$.fire_event(z,[a],c);$.popup_close(c)});$(".calendar-prev",C).click(function(e){e.preventDefault();e.stopPropagation();var d=$(this).closest("#calendar");var b=$(d).attr("data-value");var f=parseInt($.date("n",$.strtotime(b)));var g=parseInt($.date("Y",$.strtotime(b)));var a=parseInt($("td.active",d).html());var c=$.date("Y-m-d",$.mktime(0,0,0,f-1,a,g));$.calendar_set(c)});$(".calendar-next",C).click(function(e){e.preventDefault();e.stopPropagation();var d=$(this).closest("#calendar");var b=$(d).attr("data-value");var f=parseInt($.date("n",$.strtotime(b)));var g=parseInt($.date("Y",$.strtotime(b)));var a=parseInt($("td.active",d).html());var c=$.date("Y-m-d",$.mktime(0,0,0,f+1,a,g));$.calendar_set(c)})},calendar_set_range:function(M,C,Q){var T=$("#calendar");$(T).attr("data-value",M);var j=$(T).data("params");var k=j.onchange;M=M.split("-");var U=M[0];var H=M[1];if($.date("Y",$.strtotime(U))=="1970"){U=$.date("Y-m-d")}if($.date("Y",$.strtotime(H))=="1970"){H=$.date("Y-m-d")}var B=[],L=[],F=[],R=[],D=[],S=[],N=[];var I=$.date("Y",$.strtotime(C))!="1970"?C:U;var K=$.date("Y",$.strtotime(Q))!="1970"?Q:H;if($.date("Ym",$.strtotime(K))==$.date("Ym",$.strtotime(I))){K=$.date("Y-m-d",$.mktime(0,0,0,parseInt($.date("n",$.strtotime(K)))+1,$.date("j",1,$.date("Y",$.strtotime(K)))))}B[0]=$.date("n",$.strtotime(I));L[0]=$.date("m",$.strtotime(I));F[0]=$.date("Y",$.strtotime(I));R[0]=$.date("j",$.strtotime(I));D[0]=$.start_day_of_month(F[0],B[0])%7;S[0]=$.last_date_of_month(F[0],B[0]);N[0]=$.date("M Y",$.strtotime(I));B[1]=$.date("n",$.strtotime(K));L[1]=$.date("m",$.strtotime(K));F[1]=$.date("Y",$.strtotime(K));R[1]=$.date("j",$.strtotime(K));D[1]=$.start_day_of_month(F[1],B[1])%7;S[1]=$.last_date_of_month(F[1],B[1]);N[1]=$.date("M Y",$.strtotime(K));var O=[];for(var E=0;E<2;E++){O.push("<table class='calendar-table range-"+E+"'>");O.push("<tr>");O.push($.p("<td><span class='calendar-prev fa fa-caret-left padding5' data-calendaridx='$i'></span></td>",[E]));O.push("<td colspan='5'><span class='date-label'>"+N[E]+"</span></td>");O.push($.p("<td><span class='calendar-next fa fa-caret-right padding5' data-calendaridx='$i'></span></td>",[E]));O.push("</tr>");O.push("<tr>");O.push("<td>Sun</td>");O.push("<td>Mon</td>");O.push("<td>Tue</td>");O.push("<td>Wed</td>");O.push("<td>Thu</td>");O.push("<td>Fri</td>");O.push("<td>Sun</td>");O.push("</tr>");var i=1;for(var G=0;G<6;G++){O.push("<tr>");for(var J=0;J<7;J++){if(D[E]>0){O.push("<td></td>");D[E]--}else{if(i<=S[E]){var P=$.date("Y-m-d",$.strtotime(F[E]+"-"+L[E]+"-"+$.str_pad(i,2,"0","STR_PAD_LEFT")));if($.strtotime(P)>=$.strtotime(U)&&$.strtotime(P)<=$.strtotime(H)){O.push("<td class='day active' data-date='"+P+"'>"+i+"</td>")}else{O.push("<td class='day' data-date='"+P+"'>"+i+"</td>")}i++}else{O.push("<td></td>")}}}O.push("</tr>")}O.push("</table>")}T.html(O.join(""));T.data("seq",0);$(".day",T).click(function(c){c.preventDefault();c.stopPropagation();console.log("value: "+1);var f=$(this).closest("#calendar");var d=$(f).attr("data-value");var e=this.innerHTML;var b=parseInt($.date("n",$.strtotime(d)));var o=$.date("Y",$.strtotime(d));var a=$.date("j M Y",$.mktime(0,0,0,b,e,o));var h=parseInt(f.data("seq"));if(h==0){$(".day.active-0").removeClass("active active-0");$(this).addClass("active active-0");var g=$(this).attr("data-date");var n=$(f).attr("data-value");n=n.split(",");var l=$.val(1,n,{d:g});$(".day",f).each(function(){var p=$(this).attr("data-date");if($.strtotime(p)>=$.strtotime(g)&&$.strtotime(p)<=$.strtotime(l)){$(this).addClass("active")}else{$(this).removeClass("active")}})}else{$(".day.active-1").removeClass("active active-1");$(this).addClass("active active-1")}f.data("seq",h+1);if(h==1){var g=$(".day.active-0").attr("data-date");var l=$(".day.active-1").attr("data-date");if($.strtotime(g)>$.strtotime(l)){var m=g;g=l;l=m}var n=$.date("Ymd",$.strtotime(g))+"-"+$.date("Ymd",$.strtotime(l));$.popup_close(f);$.fire_event(k,[n],f)}});$(".calendar-prev",T).click(function(a){var b=parseInt($(this).attr("data-calendaridx"));console.log(["prev",M,parseInt($(this).attr("data-calendaridx")),I,K]);a.preventDefault();a.stopPropagation();if(b==0){I=$.date("Y-m-d",$.mktime(0,0,0,parseInt($.date("n",$.strtotime(I)))-1,$.date("j",$.strtotime(I)),$.date("Y",$.strtotime(I))))}else{if(b==1){K=$.date("Y-m-d",$.mktime(0,0,0,parseInt($.date("n",$.strtotime(K)))-1,$.date("j",$.strtotime(K)),$.date("Y",$.strtotime(K))));if($.date("Ym",$.strtotime(I))>=$.date("Ym",$.strtotime(K))){I=$.date("Y-m-d",$.mktime(0,0,0,parseInt($.date("n",$.strtotime(I)))-1,$.date("j",$.strtotime(I)),$.date("Y",$.strtotime(I))))}}}$.calendar_set_range(M.join(","),I,K)});$(".calendar-next",T).click(function(a){var b=parseInt($(this).attr("data-calendaridx"));a.preventDefault();a.stopPropagation();if(b==0){I=$.date("Y-m-d",$.mktime(0,0,0,parseInt($.date("n",$.strtotime(I)))+1,$.date("j",$.strtotime(I)),$.date("Y",$.strtotime(I))));if($.date("Ym",$.strtotime(K))<=$.date("Ym",$.strtotime(I))){K=$.date("Y-m-d",$.mktime(0,0,0,parseInt($.date("n",$.strtotime(K)))+1,$.date("j",$.strtotime(K)),$.date("Y",$.strtotime(K))))}}else{if(b==1){K=$.date("Y-m-d",$.mktime(0,0,0,parseInt($.date("n",$.strtotime(K)))+1,$.date("j",$.strtotime(K)),$.date("Y",$.strtotime(K))))}}$.calendar_set_range(M.join(","),I,K)})}});$.fn.extend({chart:function(h){var e=$.val("name",h);var f=$.val("height",h);var g=$.val("width",h);this.each(function(){var a=this;var b={};b.height=f;b.width=g;var c=[];$(a).addClass("chart");$(this).html(c.join(""));$(this).css(b);$(a).attr("data-type","chart");$(a).attr("data-name",e);$(a).data("options",h)})},chart_set:function(b){this.each(function(){var e=this;var a=$(e).data("options");var f=$.val("type",a,{default_value:"line"});switch(f){case"bar":$(this).chart_bar_set(b);break;default:$(this).chart_line_set(b);break}})},chart_bar_set:function(b){this.each(function(){var ag=this;var ac=$(ag).data("options");var L=$(ag).outerHeight();var a=$(ag).outerWidth();var N=$.val("padding",ac,{default_value:10});var T=$.array_key_count(b);var aa=$.object_value_min(b);var P=$.object_value_max(b);var J=N;var Y=a-N;var K=Y-J;var R=(a*0.8)/T;var ab=(K-(R*T))/(T+1);var w=L-N;var h=10;var af=w-h;var Z=af/(P-aa);var S=[];S.push($.p('<svg width="$1" height="$2">',[a,L]));var M=J;var O=Y;var ad=w,ae=w;S.push($.p('<line x1="$x1" y1="$y1" x2="$x2" y2="$y2" style="stroke:rgb(0,0,0);stroke-width:1" />',[M,ad,O,ae]));var W=0;for(var x in b){var y=b[x];var U=R;var Q=Z*y;if(Q<5){Q=5}var V=W*(ab+R)+ab;var X=w-Q;S.push($.p('<rect x="$1" y="$1" width="$1" height="$1" stroke="#4A89DC" stroke-width="2" fill="rgba(74, 137, 220, .2)" data-key="$1" data-value="$1" onmouseover="$1" onmouseout="$1"/>',[V,X,U,Q,x,y,"$.chart_line_mouseover.call(this)","$.chart_line_mouseout.call(this)"]));W++}S.push("</svg>");$(ag).html(S.join(""))})},chart_line_set:function(b){this.each(function(){var ac=this;var W=$(ac).data("options");var N=$(ac).outerHeight();var I=$(ac).outerWidth();var H=$.array_key_count(b);var V=$.object_value_min(b);var Q=$.object_value_max(b);var P=$.val("padding",W,{default_value:10});var L=P;var T=I-P;var d=T-L;var a=d/(H-1);var K=N-P;var J=10;var ab=K-J;var U=ab/(Q-V);var R=[];R.push($.p('<svg width="$1" height="$2">',[I,N]));var F=L;var G=T;var X=K,Z=K;R.push($.p('<line x1="$x1" y1="$y1" x2="$x2" y2="$y2" style="stroke:rgb(0,0,0);stroke-width:1" />',[F,X,G,Z]));var S=1;for(var M in b){var Y=Math.round(L+(S*a));R.push($.p('<line x1="$1" y1="$1" x2="$1" y2="$1" style="stroke:rgba(0, 0, 0, .05);stroke-width:1" />',[Y,K,Y,J]));S++}var S=0;var E=[];E.push($.p("M$1 $2",[Math.round(L+(S*a)),K]));for(var M in b){var O=b[M];var Y=Math.round(L+(S*a));var aa=Math.round(K-(O*U));E.push($.p("L$1 $2",[Y,aa]));S++}E.push($.p("M$1 $2 Z",[Y,K]));R.push($.p('<path d="$1" stroke-width="0" stroke="transparent" fill="rgba(74, 137, 220, .2)"/>',[E.join(" ")]));var S=0;var E=[];for(var M in b){var O=b[M];var Y=Math.round(L+(S*a));var aa=Math.round(K-(O*U));if(S==0){E.push($.p("M$1 $2",[Y,aa]))}else{E.push($.p("L$1 $2",[Y,aa]))}S++}R.push($.p('<path d="$1" stroke-width="2" stroke="#4A89DC" fill="transparent"/>',[E.join(" ")]));var S=0;for(var M in b){var O=b[M];var Y=L+(S*a);var aa=K-(O*U);R.push($.p('<circle cx="$1" cy="$1" r="1" stroke="#4A89DC" stroke-width="2" fill="#4A89DC" onmouseover="$1" onmouseout="$1" data-key="$1" data-value="$1"/>',[Y,aa,"$.chart_line_mouseover.call(this)","$.chart_line_mouseout.call(this)",M,O]));S++}R.push("</svg>");$(ac).html(R.join(""))})}});$.extend({chart_line_mouseover:function(){$(this).attr({r:2});var d=$(this).attr("data-key");var c=$(this).attr("data-value");$.tooltip(this,d+"<br />"+c)},chart_line_mouseout:function(){$(this).attr({r:1});$.tooltip_remove()}});$.fn.extend({checkbox:function(b){this.each(function(){var j=$.val("class",b,{d:""});var a=$.val("items",b,{d:null});var k=[];if($.type(a)=="array"){$(a).each(function(){var c=$.val("text",this,{d:""});var d=$.val("value",this,{d:""});var e="checkbox-"+$.uniqid();k.push("<span class='item'><input id='"+e+"' type='checkbox' value=\""+d+"\"/><label for='"+e+"'>"+c+"</label></span>")})}else{var h=$.val("text",b,{d:""});var i="";var l="checkbox-"+$.uniqid();k.push("<span class='item'><input id='"+l+"' type='checkbox' value=\""+i+"\"/><label for='"+l+"'>"+h+"</label></span>")}$(this).addClass("checkbox");$(this).addClass(j);$(this).html(k.join(""));$(this).data("options",b)})}});$.fn.extend({checklist:function(b){$(this).each(function(){var a=this;var d=[];d.push("<div class='checklist-body'>");d.push("<div class='checklist-item'>");d.push("<input type='checkbox' />");d.push("<input type='text' />");d.push("<span class='iconbar'>");d.push("<span class='checklist-remove fa fa-times padding5 selectable'></span>");d.push("</span>");d.push("</div>");d.push("</div>");d.push("<div class='checklist-foot'>");d.push("<span class='checklist-add fa fa-plus-circle padding5 selectable hoverable'></span>");d.push("</div>");$(this).addClass("checklist");$(this).html(d.join(""));$(".checklist-add",this).click(function(){$(a).checklist_add()});$(".checklist-remove",this).on("click.checklist",function(){$(this).closest(".checklist-item").remove()})})},checklist_add:function(){$(this).each(function(){var b=[];b.push("<div class='checklist-item'>");b.push("<input type='checkbox' />");b.push("<input type='text' />");b.push("<span class='iconbar'>");b.push("<span class='checklist-remove fa fa-times padding5 selectable hoverable'></span>");b.push("</span>");b.push("</div>");$(".checklist-body",this).append(b.join(""));$(".checklist-remove",$(".checklist-body",this)).on("click.checklist",function(){$(this).closest(".checklist-item").remove()})})},checklist_get:function(){var b=[];$(this).each(function(){$(".checklist-item",this).each(function(){var a=$("input[type='checkbox']",this)[0].checked;var d=$("input[type='text']",this).val();if(d.length>0){b.push({checked:a,text:d})}})});return b.length==0?null:b},checklist_set:function(b){$(this).checklist_attr({value:b})},checklist_attr:function(b){if($.type(b)!="object"){return}$(this).each(function(){for(var m in b){var j=b[m];switch(m){case"readonly":if(j){$("input[type='checkbox']",this).attr("disabled",true);$("input[type='text']",this).attr("readonly",true);$(".checklist-remove",this).addClass("hidden");$(".checklist-add",this).addClass("hidden")}else{$("input[type='checkbox']",this).attr("disabled",false);$("input[type='text']",this).attr("readonly",false);$(".checklist-remove",this).removeClass("hidden");$(".checklist-add",this).removeClass("hidden")}break;case"value":var n=[];if($.type(j)=="array"){for(var a=0;a<j.length;a++){var k=j[a];var i=$.val("text",k,{d:""});var l=$.val("checked",k,{d:false});if(i==""){continue}n.push("<div class='checklist-item'>");n.push("<input type='checkbox'"+(l?" checked":"")+"/>");n.push("<input type='text' value=\""+i+'" />');n.push("<span class='iconbar'>");n.push("<span class='checklist-remove fa fa-times padding5 selectable hoverable'></span>");n.push("</span>");n.push("</div>")}}n.push("<div class='checklist-item'>");n.push("<input type='checkbox'/>");n.push("<input type='text'/>");n.push("<span class='iconbar'>");n.push("<span class='checklist-remove fa fa-times padding5 selectable hoverable'></span>");n.push("</span>");n.push("</div>");$(".checklist-body",this).html(n.join(""));$(".checklist-remove",$(".checklist-body",this)).on("click.checklist",function(){$(this).closest(".checklist-item").remove()});break}}})}});$.fn.extend({choice:function(b){$(this).each(function(){var l=$.val("class",b,{d:""});var a=$.val("items",b,{d:[],datatype:"array"});var m=[];if($.type(a)=="array"){for(var n=0;n<a.length;n++){var k=a[n];var j=$.val("value",k,{d:""});var i=$.val("text",k,{d:j});if(j.length==0){continue}m.push($.p('<span class="item">'));m.push($.p("</span>"))}}$(this).addClass("choice");$(this).addClass(l)})}});$.fn.extend({codeeditor:function(j){var g=$.val("height",j,{d:"200px"});var i=$.val("width",j,{d:"300px"});var f=$.val("name",j,{d:""});var h=$.val("value",j,{d:"300px"});this.each(function(){var b=$.uniqid();var c=[];c.push($.p('<textarea id="$1""></textarea>',["codeeditor-text-"+b]));$(this).addClass("codeeditor");$(this).html(c.join(""));$(this).css({width:i,height:g});$(this).codeeditor_attr({name:f});var a=CodeMirror.fromTextArea(document.getElementById("codeeditor-text-"+b),{lineNumbers:true,mode:"text/x-mariadb",indentWithTabs:true,smartIndent:true,matchBrackets:true,autofocus:true})})},codeeditor_get:function(){var b=[];$(this).each(function(){b.push($("textarea",this).val())});return b.length==1?b[0]:(b.length>1?b:"")},codeeditor_set:function(b){$(this).each(function(){$("textarea",this).val(b)})},codeeditor_attr:function(b){this.each(function(){var i={};var h={};var a={};for(var j in a){var g=a[j];switch(j){case"name":a.name=g}}$(this).attr(a);$(this).css(i);$("textarea",this).css(h)})}});$.fn.extend({codefield:function(l){var i=$.val("placeholder",l,{d:""});var g=$.val("name",l,{d:""});var h=$.val("height",l);var j=$.val("width",l);var k={width:j,height:h};this.each(function(){var a=this;var b=[];b.push("<pre style='height:"+h+";'>"+JSON.stringify({name:"andy"},null,2)+"</pre>");b.push("<span class='icon fa hidden'></span>");$(a).addClass("codefield");$(a).css(k);$(a).html(b.join(""));$(a).attr("data-type","codefield");$(a).attr("data-name",g);$(a).data("options",l)})},codefield_get:function(){var b=[];this.each(function(){var a=$("pre",this).html();b.push(a)});return b.length>1?b:(b.length==1?b[0]:"")},codefield_set:function(b){this.each(function(){$("pre",this).html(b)})}});$.fn.extend({commentlist:function(c){var d=$.val("onsubmit",c);$(this).each(function(){var b=this;var a=[];a.push("<div class='commentlist-write'>");a.push("<input type='text' placeholder='Write comment here...' />");a.push("</div>");a.push("<div class='commentlist-list'></div>");$(this).addClass("commentlist");$(this).html(a.join(""));$(this).data("options",c);$("input[type='text']",this).on("keyup",function(e){if(e.keyCode==13){if(e.shiftKey){}else{if(this.value!=""){$.fire_event(d,[this.value],b);this.value="";$(this).blur()}}}})})},commentlist_add:function(b){$(this).each(function(){var p=$(this).data("options");var n=$.val("onremove",p);var j=$.val("id",b);var k=$.val("comment",b);var l=$.val("full_name",b);var m=$.val("createdon",b);var a=$.val("removable",b,{d:0});if(!k||!l){return}var o=[];o.push("<div class='commentlist-item' data-id='"+j+"'>");o.push("<p style='word-wrap: break-word;'><b>"+l+"</b> "+k+"</p>");o.push("<div class='commentlist-item-footer'>");o.push("<label class=''>"+m+"</label>");if(a){o.push("<span class='width5 height5'>&nbsp;</span>");o.push("<span class='comment-item-remove selectable hoverable'>Remove</span>")}o.push("</div>");o.push("</div>");$(".commentlist-list",this).append(o.join(""));$(".comment-item-remove",$(".commentlist-list",this)).on("click",function(){var c=$(this).closest(".commentlist-item").attr("data-id");$.fire_event(n,[c],this)})})},commentlist_set:function(b){$(this).each(function(){var a=$(this).data("options");var q=$.val("onremove",a);var o=[];if($.type(b)=="array"){for(var p=0;p<b.length;p++){var r=b[p];var s=$.val("id",r);var n=$.val("comment",r);var m=$.val("full_name",r);var i=$.val("createdon",r);var t=$.val("removable",r,{d:0});if(!n||!m){continue}o.push("<div class='commentlist-item' data-id='"+s+"'>");o.push("<p style='word-wrap: break-word;'><b>"+m+"</b> "+n+"</p>");o.push("<div class='commentlist-item-footer'>");o.push("<label class=''>"+i+"</label>");if(t){o.push("<span class='width5 height5'>&nbsp;</span>");o.push("<span class='comment-item-remove selectable hoverable'>Remove</span>")}o.push("</div>");o.push("</div>")}}$(".commentlist-list",this).html(o.join(""));$(".comment-item-remove",$(".commentlist-list",this)).on("click",function(){var c=$(this).closest(".commentlist-item").attr("data-id");$.fire_event(q,[c],this)})})}});$.fn.extend({container_val:function(b){if(typeof b=="undefined"){result={};$("*[data-type]",this).each(function(){var a=this.getAttribute("data-name");if(a!=null&&a!=""){var d=$(this).val();result[a]=d}});return result}else{$("*[data-type]",this).each(function(){var a=this.getAttribute("data-name");if(a!=null&&a!=""){var d=$.val(a,b,{d:""});$(this).val(d)}})}},container_reset:function(){$("*[data-type]",this).each(function(){var b=$(this).attr("data-type");if(b!=null&&typeof $(this)[b+"_reset"]!="undefined"){$(this)[b+"_reset"].apply(this,arguments)}})}});$.fn.extend({datepicker:function(d){var c=$.val("type",d);this.each(function(){var a=this;var b=[];b.push("<input type='text' readonly/>");b.push("<span class='icon fa fa-calendar'></span>");$(a).addClass("datepicker");$(a).html(b.join(""));$(a).attr("data-type","datepicker");$(a).data("options",d);$(".icon",this).click(function(e){e.preventDefault();e.stopPropagation();var j=$(this).closest(".datepicker");var k=$(j).data("options");var l=$.val("readonly",k,{d:false});if(l=="0"||l==false){$.calendar_open({refEl:j,value:$(j).data("value"),type:c,onchange:function(f){$(j).datepicker_val(f)}})}});$(".popup",this).click(function(e){e.preventDefault();e.stopPropagation()});$(this).datepicker_val($.val("value",d,{d:"20170101"}))})},datepicker_val:function(b){if(typeof b=="undefined"){var b=[];$(this).each(function(){var a=$(this).data("value");b.push(a)});return b.length==1?b[0]:(b.length==0?null:b)}else{$(this).each(function(){var d="";b=$.date_parse(b);if(b.indexOf("-")>=0){var g=b.split("-");var h=$.date("M j, Y",$.strtotime(g[0]));var a=$.date("M j, Y",$.strtotime(g[1]));d=h+" - "+a}else{var g=$.date("M j, Y",$.strtotime(b));d=g}$("input",this).val(d);$(this).data("value",b)})}}});$.fn.extend({dropdown:function(k){var p=$.val("class",k,{d:""});var s=$.val("name",k,{d:""});var l=$.val("defaultvalue",k,{d:""});var m=$.val("value",k,{d:l});var o=$.val("items",k,{d:[]});var r=$.val("width",k,{d:[]});var t=$.val("src",k,{d:""});var n=$.val("placeholder",k,{d:""});var q=[];q.push("<input class='text' type='text' placeholder=\""+n+'" readonly/>');q.push("<span class='icon fa fa-caret-down hoverable'></span>");q.push("<span class='popup'></span>");this.each(function(){var a=this;$(a).addClass("dropdown");$(a).addClass(p);$(a).html(q.join(""));$(a).data("options",k);$(a).attr("data-type","dropdown");$(a).attr("data-name",s);$(a).dropdown_attr(k);$(".icon, .text",a).click(function(d){d.preventDefault();d.stopPropagation();var e=$(this).closest(".dropdown");var b=$(e).data("options");var c=$.val("readonly",b);if(!c){if($(".popup",e).hasClass("on")){$.popup_close($(".popup",e))}else{$.popup_open($(".popup",e),e,{min_width:$(e).outerWidth()});$(".search-item input",$(".popup",e)).val("");$(".search-item input",$(".popup",e)).focus();$(".item",$(".popup",e)).show()}}});if(m!=""){$(a).dropdown_val()}if(t.length>0){$(this).dropdown_load()}})},dropdown_val:function(f,d){if(typeof f=="undefined"){var e=[];this.each(function(){var c=this;var b=$(c).attr("data-value");var a=$("input",c).length==1?$("input",c).val():$(".text",c).html();b=b==null?a:b;e.push(b)});return e.length==1?e[0]:(e.length>1?e:null)}else{this.each(function(){var k=$(this).data("options");var l=$.val("items",k,{d:[]});var a="";var b="";if($.type(f)=="object"){b=$.val("value",f);a=$.val("text",f,{d:b})}else{if($.type(b)=="string"){a=b=f}}if($.type(l)=="array"){for(var i=0;i<l.length;i++){var c=l[i];if(c.value==b){a=c.text;b=c.value;break}}}$(this).attr("data-value",b);$("input",this).val(a);$(".text",this).html(a)})}},dropdown_items:function(d){if(typeof d=="undefined"){var c=[];this.each(function(){var a=this;var b=$(a).data("options");var f=$.val("items",b,{d:[]});$(f).each(function(){if($.type(this)=="object"){c.push(this)}})});return c}else{this.each(function(){var y=this;var b=$(y).data("options");var s=$.val("searchable",b,{d:false});var a=$.val("multiple",b,{d:false});var x=$.val("onchange",b);var u=[];if(s==true){u.push("<div class='search-item'>");u.push("<input type='text' placeholder='Search'/>");u.push("</div>")}if($.type(d)=="array"){for(var w=0;w<d.length;w++){var p=d[w];var q=p.text;var r=p.value;var i=(q+" "+r).toLowerCase();var t=$.uniqid();u.push("<div class='item' data-value=\""+r+'" data-search="'+i+'">');if(a){u.push("<input type='checkbox' id='dropdown_item_checkbox_"+t+"'/>")}u.push("<label for='dropdown_item_checkbox_"+t+"'>"+q+"</label>");u.push("</div>")}}u=u.join("");$(".popup",y).html(u);$(y).data("options",b);$(".item",$(".popup",y)).click(function(m){if(a){m.stopPropagation()}var j=$("label",this).html();var k=$(this).attr("data-value");var n=-1;var f=null;for(var e=0;e<d.length;e++){var h=d[e];var l=$.val("text",h);var g=$.val("value",h);if(g==k||l==j){n=e;f=h;break}}if(f){f._index=n}$("input",y).val(j);$(".text",y).html(j);$(y).attr("data-value",k);$.fire_event(x,[m,f],y)});$(".item>input[type='checkbox']",$(".popup",y)).on("change",function(){var f=this.nextElementSibling.innerHTML;var e=this.parentNode.getAttribute("data-value");$(y).dropdown_val({text:f,value:e},true)});$(".popup .search-item input",y).click(function(e){e.preventDefault();e.stopPropagation()});$(".popup .search-item input",y).keyup(function(f){var g=this.value;var e=$(this).closest(".popup");$(".item",e).show();if(g.length>0){$(".item:not([data-search*='"+g+"'])",e).hide()}});b.items=d;$(y).data("options",b);$(y).dropdown_val("*")})}},dropdown_attr:function(b){this.each(function(){var a=$(this).data("options");if($.type(b)=="object"){for(var g in b){var f=b[g];var h={};switch(g){case"items":$(this).dropdown_items(f);break;case"readonly":if(f){$(this).addClass("readonly");a.readonly=true}else{$(this).removeClass("readonly");a.readonly=false}break;case"value":$(this).dropdown_val(f);break;case"width":h.width=parseInt(f);break}$(this).css(h)}}$(this).data("options",a)})},dropdown_load:function(){this.each(function(){var d=this;var e=$(d).data("options");var f=$.val("src",e,{d:""});$.api_post(f,{},function(b){var a=$.val("data",b);if($.type(a)=="array"){$(d).dropdown_items(a)}})})},dropdown_reset:function(){$(this).each(function(){var d=$(this).data("options");var c=$.val("defaultvalue",d,{d:""});$(this).dropdown_val(c)})},dropdown_readonly:function(b){$(this).each(function(){if($.istrue(b)){$(this).addClass("readonly")}else{$(this).removeClass("readonly")}})}});$.fn.extend({feed:function(b){$(this).each(function(){var h=$.val("class",b,{d:""});var f=$.val("src",b,{d:""});var g=$.val("autoload",b,{d:false});var a=[];a.push("<div class='feed-content'></div>");a.push("<div class='feed-footer'></div>");$(this).addClass("feed");$(this).addClass(h);$(this).html(a.join(""));$(this).data("options",b);if(g){$(this).feed_load()}})},feed_val:function(c,d){if(typeof c=="undefined"){}else{$(this).each(function(){var a=$(this).data("options");var r=$.val("src",a,{d:""});var b=$.val("template",a,{d:""});if($.type(c)=="array"&&c.length>0){var m="feed_group_"+$.uniqid();var i=document.createElement("div");i.setAttribute("data-feed-group-id",m);var n=[];for(var o=0;o<c.length;o++){n.push("<div class='feed-item'></div>")}i.innerHTML=n.join("");$(".feed-content",this).append(i);for(var o=0;o<c.length;o++){var p=c[o];var q=i.childNodes[o];$.fire_event(b,[p],q)}}})}},feed_load:function(b){$(this).each(function(){if(!$(this).hasClass("feed")){return}var a=this;var f=$(this).data("options");var e=$.val("src",f,{d:""});if(e!=""){$.api_post(e,[],function(j){var c=$.val("data",j,{d:[]});var d=$.val("page",j,{d:1});var k=d==1?false:true;$(a).feed_val(c,k);var l=$.val("max_page",j,{d:d});if(l>=d+1){$(".feed-footer",a).html("<div class='load-more align-center padding10'>Load More...</div>");$(".load-more",a).on("click",function(){$(a).feed_load({page:d+1})})}else{$(".feed-footer",a).html("")}})}})}});$.extend({foldedpane_toggle:function(f){var e=$(f);if(typeof e[0]=="undefined"){return}var d=$(".toggler",e);if(e[0].classList.contains("folded")){e[0].classList.remove("folded");if(d.length==1){d.html("<span class='fa fa-caret-up'></span>")}}else{e[0].classList.add("folded");if(d.length==1){d.html("<span class='fa fa-caret-down'></span>")}}},foldedpane_init:function(){var e=document.body.querySelectorAll(".folded-pane");for(var f=0;f<e.length;f++){var h=e[f];var g=h.querySelector(".toggler");if(g!=null){g.addEventListener("click",function(){$.foldedpane_toggle(h)})}}}});$.fn.extend({grid:function(p){var m=$.val("autoload",p,{d:true});var o=$.val("columns",p,{d:[]});var n=$.val("class",p,{d:null});var i=$.val("name",p,{d:""});var k=$.val("footer",p,{d:""});var l=$.val("value",p,{d:null});var j=$.val("height",p,{d:"auto"});p.page=0;p.row_per_page=12;this.each(function(){var a=this;var b=[];b.push("<table class='grid-body'>");b.push("<tbody class='grid-size'></tbody>");b.push("</table>");b.push("<div class='grid-footer'></div>");$(a).attr("data-type","grid");$(a).addClass("grid");$(a).addClass(n);if(i!=""){$(a).attr("data-name",i)}$(a).data("options",p);$(a).attr("data-type","grid");$(a).html(b.join(""));$.fire_event(k,[],$(".grid-footer",a));$(this).grid_set_columns(o);if(l!=null){$(a).grid_set(l)}if(m){$(a).grid_load()}})},grid_add:function(b){this.each(function(){var J=this;var i=J.querySelector(".grid-body");var F=$(J).data("options");var K=$.val("columns",F,{d:[]});var z=[];if($(".grid-size",i).length==0){var C=[];C.push("<tr class='grid-size'>");for(var w=0;w<K.length;w++){var G=K[w];var B=$.val("width",G,{d:""});C.push("<td style='width:"+B+";'></td>");C.push("<td class='separator'></td>")}C.push("<td style='width:100%'></td>");C.push("</tr>");z.push(C.join(""))}z.push("<tr>");for(var x=0;x<K.length;x++){var G=K[x];var H=$.val("type",G,{d:"text"});var D=$.val("datatype",G,{d:"text"});var a=$.val("name",G,{d:""});var B=$.val("width",G,{d:""});var y=$.val("align",G,{d:""});var E="";var I="";var A="";switch(H){case"index":A=w+1;E="right";I="label";break;case"html":gridtypecoord=0+","+x;break;default:switch(D){case"number":case"money":E="right";A=$.val(a,b,{d:0});break;case"enum":var j=$.val("enums",G,{d:{}});A=$.val(a,b,{d:"-"});A=$.val(A,j,{d:"-"});break;default:A=$.val(a,b,{d:"-"});break}I="label";break}if(y!=""){E=y}z.push("<td data-gridtype='"+H+"' data-gridtypecoord='"+gridtypecoord+"' class='"+I+"' style='text-align:"+E+"'>"+A+"</td>");z.push("<td class='separator'></td>")}z.push("<td></td>");z.push("</tr>");$("tbody",i).append(z.join(""));$("td[data-gridtype='html']",$("tr",$("tbody",i)).last()).each(function(){var f=$(this).attr("data-gridtypecoord").split(",");var e=parseInt(f[1]);var d=K[e];var c=$.val("html",d,{d:""});$.fire_event(c,[b,d],this)})})},grid_remove:function(c){var d=this;$(c).each(function(){var a=$(this).closest(".grid");a=typeof a[0]!="undefined"?a[0]:-2;var b=typeof d[0]!="undefined"?d[0]:-1;if(a==b){$(this).remove()}})},grid_set_columns:function(b){$(this).each(function(){if(!$(this).hasClass("grid")){return}var n=$(this).data("options");n.columns=b;$(this).data("options",n);var l=[];l.push("<tr>");for(var m=0;m<b.length;m++){var j=b[m];var a=$.val("name",j);var k=$.val("width",j);var i=$.val("active",j,{d:1});if(i==1){l.push($.p("<td class='grid-size-label' style='width:$1' data-key='"+a+"'></td>",[k]))}else{l.push($.p("<td class='grid-size-label inactive' style='width:$1' data-key='"+a+"'></td>",[k]))}}l.push("<td style='width:100%'></td>");l.push("</tr>");$(".grid-size",this).html(l.join(""))})},grid_append:function(c,d){this.each(function(){var x=this;var b=x.querySelector(".grid-body");var a=$(x).data("options");var y=$.val("src",a,{d:""});var p=$.val("onselect",a);var w=$.val("columns",a,{d:[]});var q=$.val("page",c,{d:1});var i=$.val("row_per_page",c,{d:10});var u=$.val("max_page",c,{d:q});var r=$.val("data",c);if(typeof a.data=="undefined"){a.data=[]}var s=document.createElement("tbody");$(s).html($.grid_html(r,w,a.data.length));$(b).append(s);$("td[data-gridtype='html']",s).each(function(){var e=$(this).attr("data-gridtypecoord").split(",");var j=parseInt(e[0]);var k=parseInt(e[1]);var g=r[j];var h=w[k];var f=$.val("html",h,{d:""});$.fire_event(f,[g,h],this)});$("tr",s).click(function(){var g=$(this).closest("table");$(".active",g).removeClass("active");$(this).addClass("active");var e=$(this).attr("data-idx");var f=a.data[e];$.fire_event(p,[f],x)});$(".grid-more",x).remove();if(u>q){$(x).append("<div class='grid-more' data-page='"+q+"'><label class='cl-gray'>Load more...</label></div>");$(".grid-more",x).click(function(){var f=parseInt($(this).attr("data-page"));var e=$.val("onloadmore",a);$(this).html("<i class='fa fa-circle-o-notch fa-spin fa-fw cl-gray'></i>");if(y!=""){$(x).grid_load()}$.fire_event(e,[{page:f}],x)});$(".grid-more",x).appear(function(){var f=parseInt($(this).attr("data-page"));var e=$.val("onloadmore",a);$(this).html("<i class='fa fa-circle-o-notch fa-spinfa-fw cl-gray'></i>");if(y!=""){$(x).grid_load()}$.fire_event(e,[{page:f}],x)})}for(var t=0;t<r.length;t++){a.data.push(r[t])}$(x).data("options",a)})},grid_load:function(b){this.each(function(){var a=this;var o=$(a).data("options");var k=$.val("src",o,{d:""});var j=$.val("method",o,{d:"post"});if(k.length>0){var l=$.val("page",b,{d:1});var m=$.val("row_per_page",b,{d:10});var n=$.val("columns",o);var p={page:l,row_per_page:m,columns:n};if(j.toString().toLowerCase()=="get"){$.api_get(k,p,function(e){var g=$.val("data",e,{d:[]});var c=$.val("page",e,{d:1});var f=c==1?false:true;$(a).grid_val(g,f);var d=$.val("next_page",e,{d:c});if(d>c){$(".grid-footer",a).html("<div class='load-more align-center padding10'>Load More...</div>");$(".load-more",a).on("click",function(){$(a).grid_load({page:d})})}else{$(".grid-footer",a).html("")}})}else{$.api_post(k,p,function(e){var g=$.val("data",e,{d:[]});var c=$.val("page",e,{d:1});var f=c==1?false:true;$(a).grid_val(g,f);var d=$.val("next_page",e,{d:c});if(d>c){$(".grid-footer",a).html("<div class='load-more align-center padding10'>Load More...</div>");$(".load-more",a).on("click",function(){$(a).grid_load({page:d})})}else{$(".grid-footer",a).html("")}})}$(".grid-footer",this).html("<div class='align-center padding10'>Loading...</div>")}})},grid_val:function(c,d){if(typeof c=="undefined"){var c=[];this.each(function(){var b=this;var a=b.querySelector(".grid-body");var f=$("tbody",a);$(f).children().each(function(){if(this.classList.contains("grid-size")){}else{var h=$(this).attr("data-idx");var e=$.el_get(this);if(JSON.stringify(e).length>3){c.push(e)}}})});return c}else{this.each(function(){var b=this;var a=$(b).data("options");var r=$.val("onselect",a);var y=$.val("columns",a,{d:[]});var t=document.createElement("tbody");t.className="grid-content";t.innerHTML=$.grid_html(c,y);if(typeof d=="undefined"||d!==true){$(".grid-content",b).remove()}$(".grid-body",b).append(t);for(var u=0;u<t.childNodes.length;u++){var i=t.childNodes[u];var w=c[u];for(var x=0;x<i.childNodes.length;x++){var z=i.childNodes[x];var j=z.getAttribute("data-column-type");if(j=="html"){var A=y[x];var s=$.val("html",A,{d:""});$.fire_event(s,[w,A],z)}}}$("tr",t).on("click.gridrow",function(e){var f=$(this).closest("table");$(".active",f).removeClass("active");$(this).addClass("active");$.fire_event(r,[e,this],b)})})}},grid_get_selected_value:function(){var b=null;$(this).each(function(){var f=$(this).data("options");var e=$.val("data",f);var a=$("tr[class='active']").attr("data-idx");b=$.val(a,e)});return b}});$.extend({grid_html:function(y,B){if(!y){return}var w=[];for(var x=0;x<y.length;x++){var z=y[x];w.push("<tr>");for(var A=0;A<B.length;A++){var C=B[A];var s=$.val("type",C,{d:"text"});var E=$.val("datatype",C,{d:"text"});var F=$.val("name",C,{d:""});var D=$.val("align",C,{d:""});var t="";var i="";var u="";switch(s){case"html":break;default:switch(E){case"number":case"money":t="right";u=$.val(F,z,{d:0});u=$.number_format(u);break;case"enum":var j=$.val("enums",C,{d:{}});u=$.val(F,z,{d:"-"});u=$.val(u,j,{d:"-"});break;default:u=$.val(F,z,{d:"-"});break}var G=$.val("lettercase",C,{d:""});switch(G){case"capitalize":u=u.toString().capitalize();break;case"lowercase":u=u.toString().toLowerCase();break;case"uppercase":u=u.toString().toUpperCase();break}i="label";break}if(D!=""){t=D}w.push("<td data-column-type='"+s+"' class='"+i+"' style='text-align:"+t+"'>"+u+"</td>")}w.push("<td></td>");w.push("</tr>")}return w.join("")}});$.fn.extend({gridhead:function(n){var j=$.val("autoload",n,{d:true});var l=$.val("columns",n,{d:[]});var k=$.val("class",n,{d:null});var h=$.val("name",n,{d:""});var m=$.val("grid",n,{d:null});var i=$.val("height",n,{d:null});this.each(function(){var a=this;$(a).addClass("gridhead");$(a).addClass(k);$(a).attr("data-type","gridhead");if(h!=""){$(a).attr("data-name",h)}$(a).data("options",n);$(a).attr("data-type","gridhead");$(a).gridhead_attr({height:i});$(this).gridhead_set(l)})},gridhead_set:function(b){$(this).each(function(){var A=this;var a=$(this).data("options");var E=$.val("grid",a,{d:null});var r=$.val("oncolumnclick",a);a.columns=b;var w=[];w.push("<table class='grid-head'><tr>");for(var x=0;x<b.length;x++){var y=b[x];var D=$.val("name",y,{d:""});var B=$.val("active",y,{d:1});var i=$.val("text",y,{d:"-"});var s=$.val("width",y,{d:""});var C=$.val("datatype",y,{d:"text"});var z=$.val("align",y,{d:""});var u="";switch(C){case"number":case"money":u="right";break;case"enum":break;default:break}if(z!=""){u=z}var t="label"+(!B?" inactive":"");w.push("<td class='"+t+"' style='width:"+s+";text-align:"+u+"' data-key=\""+D+'">'+i+"<span class='separator'></span></span></td>")}w.push("<td style='width:100%'></td>");w.push("</tr></table>");$(A).html(w.join(""));$(".separator",A).mousedown(function(d){d.preventDefault();d.stopPropagation();var f=this.parentNode;var e=f.parentNode;var c=d.clientX;$(window).on("mousemove.gridhead",function(g){g.preventDefault();g.stopPropagation();var h=g.clientX-c;f.style.width=(parseInt(f.style.width)+h)+"px";c=g.clientX});$(window).on("mouseup.gridhead",function(l){l.preventDefault();l.stopPropagation();var h=$(E);var n=$(".grid-size",h);if(n.length==1){var j=-1;for(var m=0;m<e.childNodes.length;m++){if(e.childNodes[m]==f){j=m;break}}j=parseInt(j);$(".grid-size-label:eq("+(j)+")",n).css({width:$(f).outerWidth()});var k=$(A).data("options");k.columns[j]["width"]=$(f).outerWidth();var g=$.val("oncolumnresize",k);$.fire_event(g,[{index:j,width:$(f).outerWidth()}],A)}$(window).off("mousemove.gridhead");$(window).off("mouseup.gridhead")})});$(".separator",A).click(function(c){c.preventDefault();c.stopPropagation()});$(".label",A).on("click",function(d){d.preventDefault();d.stopPropagation();var e=$(this).attr("data-key");var c=$(this).attr("data-sorttype");if(c=="asc"){c="desc"}else{if(c=="desc"){c="asc"}else{c="asc"}}$(this).attr("data-sorttype",c);$.fire_event(r,[[{key:e,type:c}]],A)})})},gridhead_attr:function(b){$(this).each(function(){for(var a in b){var d=b[a];switch(a){case"height":$(this).css({height:d});break}}})},gridhead_modify_column:function(b){$(this).each(function(){if(!$(this).hasClass("gridhead")){return}var a=$(this).data("options");var w=$.val("grid",a);var i=$.val("columns",a);for(var o=0;o<i.length;o++){var s=i[o];var j=$.val("name",s,{d:""});var t=$.val("width",s,{d:""});if(j==""){continue}for(var p=0;p<b.length;p++){var q=b[p];var u=$.val("name",q,{d:""});var r=$.val("active",q,{d:1});if(j==u){if(r){$(".label[data-key='"+u+"']",this).removeClass("inactive");$(".grid-size-label[data-key='"+u+"']",$(w)).removeClass("inactive")}else{$(".label[data-key='"+u+"']",this).addClass("inactive");$(".grid-size-label[data-key='"+u+"']",$(w)).addClass("inactive")}a.columns[o]["active"]=r;column_exists=true}}}$(this).data("options",a)})}});$.fn.extend({gridsetting:function(c){var d=$.val("onchange",c);this.each(function(){var a=this;var b=[];b.push("<div class='modal-head'>");b.push("<div class='align-center padding10'>");b.push("<ul class='tab'>");b.push("<li class='active' data-value='presets'>Presets</li>");b.push("<li data-value='columns'>Columns</li>");b.push("<li data-value='filters'>Filters</li>");b.push("</ul>");b.push("</div>");b.push("</div>");b.push("<div class='modal-body padding20'>");b.push("<div class='cont12 space10 gridsetting-presets'>");b.push("<div class='lg12'><button class='blue preset-add-btn'><span class='fa fa-plus'></span> Add Preset...</button></div>");b.push("<div class='lg12'><span class='preset-grid'></span></div>");b.push("</div>");b.push("<div class='cont12 space10 gridsetting-columns' style='display:none'>");b.push("<div class='lg12'>");b.push("<button class='blue column-up-btn'><span class='fa fa-caret-up'></span>Up</button>");b.push("&nbsp;");b.push("<button class='blue column-down-btn'><span class='fa fa-caret-down'></span>Down</button>");b.push("</div>");b.push("<div class='lg6'><span class='column-grid'></span></div>");b.push("<div class='lg6'>");b.push("<div class='cont12 space10 gridsetting-column-detail'>");b.push("<div class='lg3 align-right'><label class='padding10'>Align</label></div>");b.push("<div class='lg9'><span class='gridsetting-column-align'></span></div>");b.push("<div class='lg3 align-right'><label class='padding10'>Name</label></div>");b.push("<div class='lg9'><label class='gridsetting-column-name padding10'></label></div>");b.push("<div class='lg3 align-right'><label class='padding10'>Text</label></div>");b.push("<div class='lg9'><span class='gridsetting-column-text'></span></div>");b.push("<div class='lg3 align-right'><label class='padding10'>Width</label></div>");b.push("<div class='lg9'><span class='gridsetting-column-width'></span></div>");b.push("</div>");b.push("</div>");b.push("</div>");b.push("<div class='cont12 space10 gridsetting-filters' style='display:none'>");b.push("<div class='lg12'><button class='blue filter-add-btn'><span class='fa fa-plus'></span> Add Filter...</button></div>");b.push("<div class='lg12'><span class='filter-grid'></span></div>");b.push("</div>");b.push("</div>");b.push("<div class='modal-foot'>");b.push("<button class='blue apply-btn'><span class='fa fa-save'></span> Apply Filter</button>");b.push("&nbsp;");b.push("<button class='close-btn'><span class='fa fa-times'></span> Close</button>");b.push("</div>");$(a).addClass("modal width800 gridsetting");$(a).html(b.join(""));$(".tab",a).tab({onchange:function(f){$(".modal-body",a).children().hide();$(".gridsetting-"+f.value,a).show()}});$(".preset-add-btn").click(function(){});$(".preset-grid",a).grid({"class":"transparent",columns:[{text:"",type:"html",html:"$.gridsetting_preset_option",width:"50px"},{text:"Preset Name",name:"text",width:"150px"}]});$(".column-grid",a).grid({"class":"transparent",columns:[{text:"Column Name",name:"text",width:"150px"},{text:"Width",name:"width",width:"100px"}],onselect:function(h){var j=$(this).closest(".gridsetting-columns");var i=$(".gridsetting-column-detail",j);$.el_set(i,h);$(".gridsetting-column-name",i).html($.val("name",h,{d:""}))}});$(".gridsetting-column-align",a).dropdown({name:"align",items:[{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]});$(".gridsetting-column-name",a).html("");$(".gridsetting-column-text",a).textbox({name:"text",onchange:function(i){var n=$(a).data("params");var k=$(this).closest(".gridsetting-column-detail");var m=$(".gridsetting-column-name",k).html();for(var l=0;l<n.presets[n.active_idx]["columns"].length;l++){if(n.presets[n.active_idx]["columns"][l]["name"]==m){n.presets[n.active_idx]["columns"][l]["text"]=i}}$(a).data("presets",n)}});$(".gridsetting-column-width",a).textbox({name:"width",onchange:function(i){var n=$(a).data("params");var k=$(this).closest(".gridsetting-column-detail");var m=$(".gridsetting-column-name",k).html();for(var l=0;l<n.presets[n.active_idx]["columns"].length;l++){if(n.presets[n.active_idx]["columns"][l]["name"]==m){n.presets[n.active_idx]["columns"][l]["width"]=i}}$(a).data("presets",n)}});$(".filter-add-btn",a).click(function(){$(".filter-grid",a).grid_add()});$(".filter-grid",a).grid({"class":"transparent",columns:[{text:"",type:"html",html:"$.gridsetting_grid_option",width:"50px"},{text:"Key",type:"html",html:"$.gridsetting_grid_key",width:"150px"},{text:"Operator",type:"html",html:"$.gridsetting_grid_opt",width:"150px"},{text:"Value",type:"html",html:"$.gridsetting_grid_val",width:"150px"}]});$(".apply-btn",a).click(function(){var j=$(".filter-grid",a).grid_value();var h=$(a).data("params");var i=parseInt($.val("active_idx",h,{d:0}));h.presets[i]["filters"]=j;$.fire_event(d,[h],a);$(a).modal_close()});$(".close-btn",a).click(function(){$(a).modal_close()})})},gridsetting_close:function(){$(this).modal_close()},gridsetting_open:function(c,d){this.each(function(){var h=$.val("presets",c);var a=c.presets[c.active_idx];var g=$.val("columns",c);var b=$.val("filters",c);$(this).data("params",c);$(this).data("columns",g);$(".preset-grid",this).grid_set(h);$(".column-grid",this).grid_set(g);$(".filter-grid",this).grid_set(b);$(this).modal_open({height:window.innerHeight*0.8})})}});$.extend({gridsetting_preset_option:function(b){$(this).html("<button class='preset-grid-options'><span class='fa fa-times'></span></button>");$(".preset-grid-options",this).click(function(){$(this).closest("tr").remove()})},gridsetting_grid_option:function(b){$(this).html("<button class='filter-grid-options'><span class='fa fa-times'></span></button>");$(".filter-grid-options",this).click(function(){$(this).closest("tr").remove()})},gridsetting_grid_type:function(b){$(this).html("<span class='filter-grid-type'></span>");$(".filter-grid-type",this).textbox({name:"type",value:$.val("type",b,{d:null})})},gridsetting_grid_key:function(o,q){var s=$(this).closest(".gridsetting");var p=$(s).data("params");var i=p.presets[p.active_idx];var q=p.columns;var m=[];if($.type(q)=="array"){for(var n=0;n<q.length;n++){var r=q[n];var t=$.val("name",r,{d:""});var l=$.val("text",r,{d:t});if(t.length>0){m.push({text:l,value:t})}}}$(this).html("<span class='filter-grid-key'></span>");$(".filter-grid-key",this).dropdown({name:"key",items:m,value:$.val("key",o,{d:null})})},gridsetting_grid_opt:function(b){$(this).html("<span class='filter-grid-opt'></span>");$(".filter-grid-opt",this).dropdown({name:"operator",items:[{text:"Contains",value:"contains"},{text:"Equals",value:"equals"}],value:$.val("operator",b,{d:null})})},gridsetting_grid_val:function(b){$(this).html("<span class='filter-grid-val'></span>");$(".filter-grid-val",this).textbox({name:"value",value:$.val("value",b,{d:null})})}});$.fn.extend({hidden:function(c){var d=$.val("name",c,{d:""});$(this).each(function(){var a=[];$(this).html(a.join(""));$(this).attr("data-type","hidden");$(this).attr("data-name",d);$(this).addClass("hidden");$(this).data("options",c)})},hidden_val:function(c){if(typeof c=="undefined"){var d=[];$(this).each(function(){d.push($(this).data("value"))});return d.length>1?d:(d.length==1?d[0]:"")}else{$(this).each(function(){$(this).data("value",c)})}}});$.fn.extend({image:function(l){var j=$.val("class",l,{d:""});var h=$.val("height",l,{d:"50px"});var g=$.val("name",l,{d:""});var i=$.val("value",l,{d:""});var k=$.val("width",l,{d:"50px"});this.each(function(){var a=this;var b=[];b.push('<img src="'+i+'"/>');$(a).attr("data-type","image");$(a).attr("data-name",g);$(a).addClass("image");$(a).addClass(j);$(a).html(b.join(""));$(a).data("options",l);$("img",a).css({width:k,height:h})})},image_val:function(c){if(typeof c=="undefined"){var d=[];this.each(function(){d.push($("img",this).attr("src"))});return d.length>1?d:(d.length==1?d[0]:"")}else{this.each(function(){$("img",this).attr("src",c)})}}});$.extend({layout_resize:function(){$(".layout-sidebar, .layout-main, .layout-ext",$(".layout")).css({height:window.innerHeight-$(".header").outerHeight()})}});$.fn.extend({layout:function(f){var i=$.val("class",f,{d:""});var j=$.val("size",f,{d:{}});var h=$.val("large",j,{d:"300px auto 400px"});var g=h.split(" ");$(this).each(function(){var c=$.val(0,g,{d:"200px"});var a="100%";var b=$.val(2,g,{d:"300px"});$(this).addClass("layout");$(this).addClass(i);$(".layout-sidebar",this).css({flex:"0 0 "+c});$(".layout-main",this).css({flex:"1 1 "+a});$(".layout-ext",this).css({flex:"0 0 "+b});$(".layout-sidebar, .layout-main, .layout-ext",this).css({height:window.innerHeight-$(".header").outerHeight()})});$(window).on("resize.layout",function(){$.layout_resize()})}});$.extend({layout2_resize:function(){$(".layout2").layout2_resize()}});$.fn.extend({layout2:function(f){var h=$.val("class",f,{d:""});var e=$.val("size",f,{d:"300px auto 400px"});var g=e.split(" ");$(this).each(function(){$(this).addClass("layout2");$(this).addClass(h);$(this).data("options",f);$(this).layout2_resize()});$(window).on("resize.layout",function(){$.layout2_resize()})},layout2_resize:function(){$(this).each(function(){var j=$(this).data("options");var r=$.val("onresize",j);var o=$.val("ext_hidden",j);var k=$.val("size",j,{d:"300px auto 400px"});var l=k.split(" ");var n=window.innerHeight-$(".header").outerHeight();var q=$.val(0,l,{d:"200px"});var p=$.val(2,l,{d:"300px"});var n=window.innerHeight-$(".header").outerHeight();p=$.calc_size(p,n);var m=n-p;$(".layout-sidebar",this).css({flex:"0 0 "+q,height:n});$(".layout-content",this).css({flex:"1 1 auto"});if(o==0){$(this).removeClass("ext-hidden");$(".layout-main",this).css({height:p});$(".layout-ext",this).css({height:m})}else{$(this).addClass("ext-hidden");$(".layout-main",this).css({height:n});$(".layout-ext",this).css({height:0})}$.fire_event(r,[],this)})},layout2_toggleext:function(b){$(this).each(function(){if(!$(this).hasClass("layout2")){return}var a=$(this).data("options");a.ext_hidden=b?0:1;$(this).data("options",a);$(this).layout2_resize()})},layout2_ext_state:function(){var b=0;$(this).each(function(){var a=$(this).data("options");b=$.val("ext_hidden",a,{d:-1})>0?0:1});return b}});$.fn.extend({modal_open:function(b){this.each(function(){var a=this;$(a).addClass("on");$(document.body).css({overflow:"hidden"});var f=$(a).outerHeight()-5-($(".modal-head",a).outerHeight()+$(".modal-foot",a).outerHeight());if(!isNaN(f)){$(".modal-body",a).css({height:f})}var h=$.val("reset",b,{d:false});if(h===true){$(a).reset()}var g=$.val("value",b,{d:null});if(g!=null){$(a).val(b.value)}})},modal_close:function(c,d){this.each(function(){var a=this;$(a).removeClass("on");$(".modal-bg").removeClass("on")});if($(".modal.on").length==0){$(document.body).css({overflow:""})}}});$.extend({popup_close:function(b){$(b).removeClass("on")},popup_open:function(r,q,j){$.popup_close_all();$(r).addClass("on");var n={};var o=$(q).offset();var k=o.left+r.clientWidth;var l=o.top-$(window).scrollTop()+$(q).outerHeight()+1;var m=window.innerHeight-l-10;n.top=l;n["max-height"]=m;if(k>window.innerWidth){o.left=window.innerWidth-r.clientWidth}n.left=o.left;var p=$.val("min_width",j);if(!isNaN(parseInt(p))){n["min-width"]=p}$(r).css(n)},popup_toggle:function(f,e,d){if(f.classList.contains("on")){$.popup_close(f,e,d)}else{$.popup_open(f,e,d)}},popup_close_all:function(){var d=document.body.querySelectorAll(".popup");for(var c=0;c<d.length;c++){$.popup_close(d[c])}}});$.fn.extend({radio:function(b){$(this).each(function(){var u=$.val("items",b,{d:null});var w=$.val("class",b,{d:""});var i=$.val("text",b,{d:""});var A=$.val("name",b,{d:""});var s=$.val("value",b,{d:""});var y=[];if($.type(u)=="array"){var a="radio-name-"+$.uniqid();for(var z=0;z<u.length;z++){var p=u[z];var q=p.text;var r=p.value;var t=s!=""&&s==r?true:false;var x="radio-"+$.uniqid();y.push("<input type='radio' id='"+x+"' value=\""+r+"\" name='"+a+"'"+(t?" checked":"")+"/>");y.push("<label for='"+x+"'>"+q+"</label>")}}else{var t=parseInt(s)==1||s===true?true:false;var x="radio-"+$.uniqid();y.push("<input type='radio' id='"+x+"'"+(t?" checked":"")+"/>");y.push("<label for='"+x+"'>"+i+"</label>")}$(this).addClass("radio");$(this).addClass(w);$(this).attr({"data-type":"radio"});$(this).html(y.join(""))})},radio_val:function(c){if(typeof c=="undefined"){var d=[];$(this).each(function(){var b=this.querySelectorAll("input");if(b.length==1){d.push(b[0].checked?1:0)}else{for(var a=0;a<b.length;a++){if(b[a].checked){d.push(b[a].value)}}}});d=d.join(",");return d}else{$(this).each(function(){var f=this.querySelectorAll("input");if(f.length==1){f[0].checked=(parseInt(c)==1||c===true)?true:false}else{var a=false;for(var b=0;b<f.length;b++){if(f[b].value==c){f[b].checked=true;a=true;break}}if(!a){$("input",this).attr("checked",false)}}})}}});$.extend({role_init:function(c){var d=typeof c!="undefined"&&c instanceof HTMLElement?c:document.body;$("*[data-role]",d).each(function(){var a=this.getAttribute("data-role");switch(a){case"modal.close":$(this).click(function(){$(this).closest(".modal").modal_close()});break;case"url.open":var b=$(this).attr("data-role-value");$(this).click(function(){window.location=b});break}})}});$.fn.extend({spinner:function(d){var c=$.val("size",d,{defaultvalue:"20px"});this.each(function(){var a=[];a.push('<div class="sk-fading-circle" style="width:'+c+";height:"+c+';">');a.push('<div class="sk-circle1 sk-circle"></div>');a.push('<div class="sk-circle2 sk-circle"></div>');a.push('<div class="sk-circle3 sk-circle"></div>');a.push('<div class="sk-circle4 sk-circle"></div>');a.push('<div class="sk-circle5 sk-circle"></div>');a.push('<div class="sk-circle6 sk-circle"></div>');a.push('<div class="sk-circle7 sk-circle"></div>');a.push('<div class="sk-circle8 sk-circle"></div>');a.push('<div class="sk-circle9 sk-circle"></div>');a.push('<div class="sk-circle10 sk-circle"></div>');a.push('<div class="sk-circle11 sk-circle"></div>');a.push('<div class="sk-circle12 sk-circle"></div>');a.push("</div>");$(this).html(a.join(""))})}});$.fn.extend({tab:function(g){var f=$.val("container",g,{d:""});var h=$.val("name",g,{d:""});var e=$.val("onchange",g);this.each(function(){var a=this;$(a).attr("data-type","tab");$(a).attr("data-name",h);$(a).data("options",g);$("li",a).click(function(){if(this.classList.contains("active")){}else{$("li",this.parentNode).removeClass("active");$(this).addClass("active");var b=this.innerHTML;var c=this.getAttribute("data-value");if(c==null){c=$.slug(b)}var d=$(this).index();if($(f).length>0){$(f+">*").addClass("off");$(f+">*:eq("+d+")").removeClass("off")}$.fire_event(e,[{text:b,value:c}],a)}})})},tab_set:function(g){var h=this;var e=$(h).data("options");var f=$.val("onchange",e);$("li",this).removeClass("active");$("li",this).each(function(){var b=this.innerHTML;var a=this.getAttribute("data-value");if(a==null){a=$.slug(b)}if(a==g){$(this).addClass("active");$.fire_event(f,[{text:b,value:a}],h)}})}});$.fn.extend({textarea:function(m){var o=$.val("placeholder",m,{d:""});var r=$.val("class",m,{d:""});var x=$.val("name",m,{d:""});var n=$.val("height",m,{d:"1em"});var w=$.val("width",m);var u=$.val("maxlength",m,{d:""});var q=$.val("onblur",m);var y=$.val("onkeyup",m);var t=$.val("onchange",m);var p=$.val("value",m,{d:""});var s={width:w};this.each(function(){var b=this;var a=[];a.push("<textarea rows='1' placeholder='"+o+"' style='height:"+n+";' maxlength='"+u+"'></textarea>");a.push("<span class='icon fa hidden'></span>");$(b).addClass("textarea");$(b).addClass(r);$(b).css(s);$(b).html(a.join(""));$(b).attr("data-type","textarea");$(b).attr("data-name",x);$(b).data("options",m);$("textarea",b).blur(function(c){$(b).textarea_validate();$.fire_event(q,[],b)}).keyup(function(c){$.fire_event(y,[this.value],b);if($(this).data("last_value")!=this.value){$.fire_event(t,[this.value],b)}$(this).data("last_value",this.value)});$("textarea",b).each(function(){this.setAttribute("style","height:"+(this.scrollHeight<=0?"":this.scrollHeight)+"px;overflow-y:hidden;")}).on("input",function(){this.style.height="auto";this.style.height=(this.scrollHeight)+"px"});if(p!=""){$(this).textarea_val(p)}})},textarea_val:function(c){if(typeof c=="undefined"){var d=[];$(this).each(function(){d.push($("textarea",this).val())});return d.length>1?d:(d.length==1?d[0]:"")}else{$(this).each(function(){$("textarea",this).val(c).each(function(){this.style.height="auto";this.style.height=(this.scrollHeight)+"px"})})}},textarea_placeholder:function(c){if(typeof c=="undefined"){var d=[];$(this).each(function(){d.push($("input",this).attr("placeholder"))});return d.length>1?d:(d.length==1?d[0]:"")}else{$(this).each(function(){$("input",this).attr("placeholder",c)})}},textarea_reset:function(){$(this).textarea_val("")},textarea_validate:function(){$(this).each(function(){var j=$(this).data("options");var n=$.val("required",j,{d:false});var o=$.val("required_text",j,{d:"Field required."});var q=$.val("validation",j,{d:""});var p=$.val("validation_text",j,{d:"Validation error."});var l=$(this).textarea_val();var r=true;var k="";if(n){if(l.toString().trim()==""){r=false;k=o}else{if(q!=""){switch(q){default:var m=new RegExp(q);r=m.test(l);if(!r){k=p}break}}}}else{if(l.toString().length>0){switch(q){default:var m=new RegExp(q);r=m.test(l);if(!r){k=p}break}}}if(!r){$(this).addClass("invalid");console.warn(k)}else{$(this).removeClass("invalid")}})}});$.fn.extend({textbox:function(n){var p=$.val("placeholder",n,{d:""});var z=$.val("name",n,{d:""});var r=$.val("class",n,{d:""});var o=$.val("value",n,{d:""});var u=$.val("readonly",n,{d:false});var x=$.val("maxlength",n,{d:""});var s=$.val("mode",n,{d:"text"});var y=$.val("width",n);var q=$.val("onblur",n);var A=$.val("onkeyup",n);var w=$.val("onchange",n);var t={width:y};this.each(function(){var a=this;var b=[];b.push($.p('<input type="$1" placeholder="$1" maxlength="$1"/>',[s,p,x]));b.push("<span class='icon fa hidden'></span>");$(a).addClass("textbox");$(a).addClass(r);$(a).css(t);$(a).html(b.join(""));$(a).attr("data-type","textbox");$(a).attr("data-name",z);$(a).data("options",n);$("input",a).val(o);$("input",a).blur(function(c){$(a).textbox_validate();$.fire_event(q,[],a)}).keyup(function(c){$.fire_event(A,[this.value],a);if($(this).data("last_value")!=this.value){$.fire_event(w,[this.value],a)}$(this).data("last_value",this.value)})})},textbox_val:function(c){if(typeof c=="undefined"){var d=[];$(this).each(function(){d.push($("input",this).val())});return d.length>1?d:(d.length==1?d[0]:"")}else{$(this).each(function(){$("input",this).val(c)})}},textbox_placeholder:function(c){if(typeof c=="undefined"){var d=[];$(this).each(function(){d.push($("input",this).attr("placeholder"))});return d.length>1?d:(d.length==1?d[0]:"")}else{$(this).each(function(){$("input",this).attr("placeholder",c)})}},textbox_reset:function(){$(this).textbox_val("")},textbox_validate:function(){$(this).each(function(){var j=$(this).data("options");var n=$.val("required",j,{d:false});var o=$.val("required_text",j,{d:"Field required."});var q=$.val("validation",j,{d:""});var p=$.val("validation_text",j,{d:"Validation error."});var l=$(this).textbox_val();var r=true;var k="";if(n){if(l.toString().trim()==""){r=false;k=o}else{if(q!=""){switch(q){default:var m=new RegExp(q);r=m.test(l);if(!r){k=p}break}}}}else{if(l.toString().length>0){switch(q){default:var m=new RegExp(q);r=m.test(l);if(!r){k=p}break}}}if(!r){$(this).addClass("invalid");console.warn(k)}else{$(this).removeClass("invalid")}})}});$.fn.extend({toggle:function(e){var h=$.val("class",e,{d:""});var f=$.val("name",e,{d:""});var g=$.val("value",e,{d:false});this.each(function(){var a=this;var b=[];b.push("<span class='main-toggle'></span>");a.innerHTML=b.join("");$(this).addClass("toggle");$(this).addClass(h);$(a).attr("data-type","toggle");if(f!=""){$(a).attr("data-name",f)}a.querySelector(".main-toggle").addEventListener("click",function(){if(this.parentNode.classList.contains("on")){this.parentNode.classList.remove("on")}else{this.parentNode.classList.add("on")}});$(a).toggle_val(g);return a})},toggle_val:function(b){if(!$(this).hasClass("toggle")){return undefined}if(typeof b=="undefined"){return $(this).hasClass("on")?1:0}else{if(b==true||b==1){$(this).addClass("on")}else{$(this).removeClass("on")}}}});$.extend({tooltip:function(g,k){var h=$(".tooltip");if(h.length==0){$.warn("No tooltip defined.")}$(h).addClass("on");var i=g.getBoundingClientRect();var l={};var j=[];console.log(g);l.left=i.left;console.log([i.top,i.top+i.height+$(h).outerHeight()+10,window.innerHeight]);if(i.top+i.height+$(h).outerHeight()+10>window.innerHeight){l.top=i.top-$(h).outerHeight()-10;j.push("<div class='arrow-down'></div>")}else{l.top=i.top+i.height+10;j.push("<div class='arrow-up'></div>")}j.push(k);$(h).html(j.join(""));$(h).css(l)},tooltip_remove:function(){$(".tooltip").removeClass("on")}});$.extend({date:function(f,l){var m=this;var k,n;var o=["Sun","Mon","Tues","Wednes","Thurs","Fri","Satur","January","February","March","April","May","June","July","August","September","October","November","December"];var q=/\\?(.?)/gi;var r=function(b,a){return n[b]?n[b]():a};var p=function(a,b){a=String(a);while(a.length<b){a="0"+a}return a};n={d:function(){return p(n.j(),2)},D:function(){return n.l().slice(0,3)},j:function(){return k.getDate()},l:function(){return o[n.w()]+"day"},N:function(){return n.w()||7},S:function(){var b=n.j();var a=b%10;if(a<=3&&parseInt((b%100)/10,10)==1){a=0}return["st","nd","rd"][a-1]||"th"},w:function(){return k.getDay()},z:function(){var a=new Date(n.Y(),n.n()-1,n.j());var b=new Date(n.Y(),0,1);return Math.round((a-b)/86400000)},W:function(){var a=new Date(n.Y(),n.n()-1,n.j()-n.N()+3);var b=new Date(a.getFullYear(),0,4);return p(1+Math.round((a-b)/86400000/7),2)},F:function(){return o[6+n.n()]},m:function(){return p(n.n(),2)},M:function(){return n.F().slice(0,3)},n:function(){return k.getMonth()+1},t:function(){return(new Date(n.Y(),n.n(),0)).getDate()},L:function(){var a=n.Y();return a%4===0&a%100!==0|a%400===0},o:function(){var a=n.n();var c=n.W();var b=n.Y();return b+(a===12&&c<9?1:a===1&&c>9?-1:0)},Y:function(){return k.getFullYear()},y:function(){return n.Y().toString().slice(-2)},a:function(){return k.getHours()>11?"pm":"am"},A:function(){return n.a().toUpperCase()},B:function(){var b=k.getUTCHours()*3600;var c=k.getUTCMinutes()*60;var a=k.getUTCSeconds();return p(Math.floor((b+c+a+3600)/86.4)%1000,3)},g:function(){return n.G()%12||12},G:function(){return k.getHours()},h:function(){return p(n.g(),2)},H:function(){return p(n.G(),2)},i:function(){return p(k.getMinutes(),2)},s:function(){return p(k.getSeconds(),2)},u:function(){return p(k.getMilliseconds()*1000,6)},e:function(){throw"Not supported (see source code of date() for timezone on how to add support)"},I:function(){var c=new Date(n.Y(),0);var a=Date.UTC(n.Y(),0);var d=new Date(n.Y(),6);var b=Date.UTC(n.Y(),6);return((c-a)!==(d-b))?1:0},O:function(){var a=k.getTimezoneOffset();var b=Math.abs(a);return(a>0?"-":"+")+p(Math.floor(b/60)*100+b%60,4)},P:function(){var a=n.O();return(a.substr(0,3)+":"+a.substr(3,2))},T:function(){return"UTC"},Z:function(){return -k.getTimezoneOffset()*60},c:function(){return"Y-m-d\\TH:i:sP".replace(q,r)},r:function(){return"D, d M Y H:i:s O".replace(q,r)},U:function(){return k/1000|0}};this.date=function(a,b){m=this;k=(b===undefined?new Date():(b instanceof Date)?new Date(b):new Date(b*1000));return a.replace(q,r)};return this.date(f,l)},uniqid:function(){if(typeof $.__UNIQID=="undefined"){$.__UNIQID=0}return ++$.__UNIQID},val:function(l,q,i){if(typeof i=="undefined"||$.type(i)!="object"){i={}}var m=null;var k=typeof i.default_value!="undefined"?i.default_value:(typeof i.d!="undefined"?i.d:null);var p=typeof i.t!="undefined"?i.t:(typeof i.datatype!="undefined"?i.datatype:"string");var n=typeof i.required!="undefined"&&n==1?true:false;if($.type(q)=="object"){if($.type(l)=="array"){m=null;for(var o=0;o<l.length;o++){var r=l[o];v=$.val(r,q,{default_value:null});if(v!=null){m=v;break}}}else{if($.type(l)=="string"||$.type(l)=="number"){if(typeof q[l]!="undefined"){m=q[l]}}}}else{if($.type(q)=="array"){if(typeof q[l]!="undefined"){m=q[l]}}}if(n){if(m==null){}}else{m=m==null&&k!=null?k:m}switch(p){case"number":case"integer":case"float":case"double":m=parseFloat(m);break}return m},strtotime:function(i,D){var u,y,t,w,B,r,F,x,G,s,z,C=false;if(!i){return C}if(/^\d{8}$/.test(i)){i=i.substr(0,4)+"-"+i.substr(4,2)+"-"+i.substr(6,2)}i=i.replace(/^\s+|\s+$/g,"").replace(/\s{2,}/g," ").replace(/[\t\r\n]/g,"").toLowerCase();y=i.match(/^(\d{1,4})([\-\.\/\:])(\d{1,2})([\-\.\/\:])(\d{1,4})(?:\s(\d{1,2}):(\d{2})?:?(\d{2})?)?(?:\s([A-Z]+)?)?$/);if(y&&y[2]===y[4]){if(y[1]>1901){switch(y[2]){case"-":if(y[3]>12||y[5]>31){return C}return new Date(y[1],parseInt(y[3],10)-1,y[5],y[6]||0,y[7]||0,y[8]||0,y[9]||0)/1000;case".":return C;case"/":if(y[3]>12||y[5]>31){return C}return new Date(y[1],parseInt(y[3],10)-1,y[5],y[6]||0,y[7]||0,y[8]||0,y[9]||0)/1000}}else{if(y[5]>1901){switch(y[2]){case"-":if(y[3]>12||y[1]>31){return C}return new Date(y[5],parseInt(y[3],10)-1,y[1],y[6]||0,y[7]||0,y[8]||0,y[9]||0)/1000;case".":if(y[3]>12||y[1]>31){return C}return new Date(y[5],parseInt(y[3],10)-1,y[1],y[6]||0,y[7]||0,y[8]||0,y[9]||0)/1000;case"/":if(y[1]>12||y[3]>31){return C}return new Date(y[5],parseInt(y[1],10)-1,y[3],y[6]||0,y[7]||0,y[8]||0,y[9]||0)/1000}}else{switch(y[2]){case"-":if(y[3]>12||y[5]>31||(y[1]<70&&y[1]>38)){return C}w=y[1]>=0&&y[1]<=38?+y[1]+2000:y[1];return new Date(w,parseInt(y[3],10)-1,y[5],y[6]||0,y[7]||0,y[8]||0,y[9]||0)/1000;case".":if(y[5]>=70){if(y[3]>12||y[1]>31){return C}return new Date(y[5],parseInt(y[3],10)-1,y[1],y[6]||0,y[7]||0,y[8]||0,y[9]||0)/1000}if(y[5]<60&&!y[6]){if(y[1]>23||y[3]>59){return C}t=new Date();return new Date(t.getFullYear(),t.getMonth(),t.getDate(),y[1]||0,y[3]||0,y[5]||0,y[9]||0)/1000}return C;case"/":if(y[1]>12||y[3]>31||(y[5]<70&&y[5]>38)){return C}w=y[5]>=0&&y[5]<=38?+y[5]+2000:y[5];return new Date(w,parseInt(y[1],10)-1,y[3],y[6]||0,y[7]||0,y[8]||0,y[9]||0)/1000;case":":if(y[1]>23||y[3]>59||y[5]>59){return C}t=new Date();return new Date(t.getFullYear(),t.getMonth(),t.getDate(),y[1]||0,y[3]||0,y[5]||0)/1000}}}}if(i==="now"){return D===null||isNaN(D)?new Date().getTime()/1000|0:D|0}if(!isNaN(u=Date.parse(i))){return u/1000|0}B=D?new Date(D*1000):new Date();r={sun:0,mon:1,tue:2,wed:3,thu:4,fri:5,sat:6};F={yea:"FullYear",mon:"Month",day:"Date",hou:"Hours",min:"Minutes",sec:"Seconds"};function A(c,d,b){var a,e=r[d];if(typeof e!=="undefined"){a=e-B.getDay();if(a===0){a=7*b}else{if(a>0&&c==="last"){a-=7}else{if(a<0&&c==="next"){a+=7}}}B.setDate(B.getDate()+a)}}function E(b){var a=b.split(" "),e=a[0],d=a[1].substring(0,3),c=/\d+/.test(e),f=a[2]==="ago",g=(e==="last"?-1:1)*(f?-1:1);if(c){g*=parseInt(e,10)}if(F.hasOwnProperty(d)&&!a[1].match(/^mon(day|\.)?$/i)){return B["set"+F[d]](B["get"+F[d]]()+g)}if(d==="wee"){return B.setDate(B.getDate()+(g*7))}if(e==="next"||e==="last"){A(e,d,g)}else{if(!c){return false}}return true}G="(years?|months?|weeks?|days?|hours?|minutes?|min|seconds?|sec|sunday|sun\\.?|monday|mon\\.?|tuesday|tue\\.?|wednesday|wed\\.?|thursday|thu\\.?|friday|fri\\.?|saturday|sat\\.?)";s="([+-]?\\d+\\s"+G+"|(last|next)\\s"+G+")(\\sago)?";y=i.match(new RegExp(s,"gi"));if(!y){return C}for(z=0,x=y.length;z<x;z++){if(!E(y[z])){return C}}return(B.getTime()/1000)},mktime:function(){var g=new Date(),d=arguments,e=0,h=["Hours","Minutes","Seconds","Month","Date","FullYear"];for(e=0;e<h.length;e++){if(typeof d[e]==="undefined"){d[e]=g["get"+h[e]]();d[e]+=(e===3)}else{d[e]=parseInt(d[e],10);if(isNaN(d[e])){return false}}}d[5]+=(d[5]>=0?(d[5]<=69?2000:(d[5]<=100?1900:0)):0);g.setFullYear(d[5],d[3]-1,d[4]);g.setHours(d[0],d[1],d[2]);return(g.getTime()/1000>>0)-(g.getTime()<0)},date_parse:function(b){switch(b){case"this_month":b=$.date("Ym")+"01-"+$.date("Ymd",$.mktime(0,0,0,parseInt($.date("m"))+1,0,$.date("Y")));break}return b},start_day_of_month:function(e,d){var f=$.date("N",$.mktime(0,0,0,d,1,e));return f},last_date_of_month:function(d,h){var g=27;do{g++;var f=parseInt($.date("j",$.mktime(0,0,0,h,g,d)));if(f!=g){g--;break}}while(true);return g},api_get:function(l,j,i,g){var h=$.http_build_query(j);l+=h.length>0?"?"+h:"";var k=new XMLHttpRequest();k.open("GET",l,true);k.addEventListener("load",function(){if(this.readyState==4){var a=$.eval_as_object(this.responseText);var c=$.val("error",a,{d:0,datatype:"integer"});var b=$.val("error_message",a,{d:""});if(c>0){if(g!=null){$.fire_event(g,[this.responseText],k)}else{alert(b)}}else{$.fire_event(i,[a],k)}}});k.addEventListener("error",function(){if(typeof g!="undefined"||g!=null){$.fire_event(g)}else{console.log(this.responseText)}});k.send();return k},api_post:function(f,i,h,g){var j=new XMLHttpRequest();j.open("POST",f,true);j.addEventListener("load",function(){if(this.readyState==4){var a=$.eval_as_object(this.responseText);var c=$.val("error",a,{d:0,datatype:"integer"});var b=$.val("error_message",a,{d:""});if(parseInt(c)==0){$.fire_event(h,[a],j)}else{if(typeof g!="undefined"||g!=null){$.fire_event(g,[{error:c,error_message:b}])}else{alert(JSON.stringify(a,null,2))}}}});j.addEventListener("error",function(){if(typeof g!="undefined"||g!=null){$.fire_event(g)}else{console.log(this.responseText)}});j.send(JSON.stringify(i));return j},http_build_query:function(h,f,g){var e=[];if($.type(h)=="object"){Object.keys(h).forEach(function(a){var d=a;f&&!isNaN(d)?d=f+d:"";var d=encodeURIComponent(d.toString().replace(/[!'()*]/g,escape));g?d=g+"["+d+"]":"";if(typeof h[a]==="object"){var b=$.http_build_query(h[a],null,d);e.push(b)}else{var c=encodeURIComponent(h[a].toString().replace(/[!'()*]/g,escape));e.push(d+"="+c)}})}return e.join("&")},fire_event:function(callback,params,thisArg){if(typeof thisArg=="undefined"){thisArg=null}if($.type(callback)=="string"){callback=eval(callback)}if($.type(callback)=="function"){return callback.apply(thisArg,params)}},eval_as_object:function(exp){try{return eval("("+exp+")")}catch(e){return null}},ux:function(d){d=typeof d=="undefined"||!(d instanceof HTMLElement)?document.body:d;var c=d.querySelectorAll("*[data-type]");$(c).each(function(){var a=this.getAttribute("data-type");if(typeof $(this)[a]=="function"){var b=$.options_from_html(this);$(this)[a](b)}else{console.warn("Unknown ux "+a)}})},el_get:function(f){if($(f).attr("data-type")!=null){var h=$(f).attr("data-type");if(typeof $(f)[h+"_get"]=="function"){return $(f)[h+"_get"]()}return null}else{var g={};var e=$("*[data-type]",f);$(e).each(function(){var b=this;var a=$.el_get(b);var c=b.getAttribute("data-name");if(c==null){c="undefined"}g[c]=a});return g}},el_set:function(d,c){$("*[data-type]",d).each(function(){var b=this.getAttribute("data-type");var f=this.getAttribute("data-name");var a=$.val(f,c);if(typeof $(this)[b+"_set"]=="function"){$(this)[b+"_set"](a)}else{console.warn("unknown method")}})},options_from_html:function(el){var options=null;if(el.getAttribute("data-options")!=null){try{options=eval("("+el.getAttribute("data-options")+")")}catch(e){options=null}}else{var options={};for(var i=0;i<el.attributes.length;i++){options[el.attributes[i].nodeName.replace("data-","")]=el.attributes[i].nodeValue}}return options},cookie_getitem:function(b){if(!b){return null}return decodeURIComponent(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+encodeURIComponent(b).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1"))||null},cookie_setitem:function(m,j,n,h,i,l){if(!m||/^(?:expires|max\-age|path|domain|secure)$/i.test(m)){return false}var k="";if(n){switch(n.constructor){case Number:k=n===Infinity?"; expires=Fri, 31 Dec 9999 23:59:59 GMT":"; max-age="+n;break;case String:k="; expires="+n;break;case Date:k="; expires="+n.toUTCString();break}}document.cookie=encodeURIComponent(m)+"="+encodeURIComponent(j)+k+(i?"; domain="+i:"")+(h?"; path="+h:"")+(l?"; secure":"");return true},cookie_removeitem:function(f,d,e){if(!this.hasItem(f)){return false}document.cookie=encodeURIComponent(f)+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT"+(e?"; domain="+e:"")+(d?"; path="+d:"");return true},cookie_hasitem:function(b){if(!b){return false}return(new RegExp("(?:^|;\\s*)"+encodeURIComponent(b).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=")).test(document.cookie)},cookie_keys:function(){var e=document.cookie.replace(/((?:^|\s*;)[^\=]+)(?=;|$)|^\s*|\s*(?:\=[^;]*)?(?:\1|$)/g,"").split(/\s*(?:\=[^;]*)?;\s*/);for(var f=e.length,d=0;d<f;d++){e[d]=decodeURIComponent(e[d])}return e},slug:function(f){var d="";var e=$.trim(f);d=e.replace(/[^a-z0-9-]/gi,"-").replace(/-+/g,"-").replace(/^-|-$/g,"");return d.toLowerCase()},warn:function(b){console.warn(b)},array_merge:function(){var p=Array.prototype.slice.call(arguments);var k=p.length;var j;var u={};var w="";var i=0;var t=0;var r=0;var q=0;var o=Object.prototype.toString;var s=true;for(r=0;r<k;r++){if(o.call(p[r])!=="[object Array]"){s=false;break}}if(s){s=[];for(r=0;r<k;r++){s=s.concat(p[r])}return s}for(r=0,q=0;r<k;r++){j=p[r];if(o.call(j)==="[object Array]"){for(t=0,i=j.length;t<i;t++){u[q++]=j[t]}}else{for(w in j){if(j.hasOwnProperty(w)){if(parseInt(w,10)+""===w){u[q++]=j[w]}else{u[w]=j[w]}}}}}return u},in_array:function(h,i,j){var f="";var g=!!j;if(g){for(f in i){if(i[f]===h){return true}}}else{for(f in i){if(i[f]==h){return true}}}return false},number_format:function(p,r,m,n){p=(p+"").replace(/[^0-9+\-Ee.]/g,"");var s=!isFinite(+p)?0:+p;var t=!isFinite(+r)?0:Math.abs(r);var k=(typeof n==="undefined")?",":n;var q=(typeof m==="undefined")?".":m;var l="";var o=function(c,a){var b=Math.pow(10,a);return""+(Math.round(c*b)/b).toFixed(a)};l=(t?o(s,t):""+Math.round(s)).split(".");if(l[0].length>3){l[0]=l[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,k)}if((l[1]||"").length<t){l[1]=l[1]||"";l[1]+=new Array(t-l[1].length+1).join("0")}return l.join(q)},qs:(function(g){if(g==""){return{}}var h={};for(var b=0;b<g.length;++b){var a=g[b].split("=",2);if(a.length==1){h[a[0]]=""}else{h[a[0]]=decodeURIComponent(a[1].replace(/\+/g," "))}}return h})(window.location.search.substr(1).split("&")),p:function(j,k){var l=j.match(/\$\w+/g);if(l!=null){if($.type(k)=="array"){for(var n=0;n<l.length;n++){var i=l[n];var m=typeof k[n]!="undefined"?k[n]:"";j=j.replace(i,m)}}else{if($.type(k)=="object"){for(var n=0;n<l.length;n++){var i=l[n];var h=i.replace("$","");var m=typeof k[h]!="undefined"?k[h]:"";j=j.replace(i,m)}}}}return j},array_key_count:function(f){var d=0;for(var e in f){d++}return d},object_value_min:function(h){var e=-1;if($.type(h)=="object"){for(var f in h){var g=h[f];if(e==-1||parseFloat(g)<parseFloat(e)){e=g}}}return e},object_value_max:function(h){var e=-1;if($.type(h)=="object"){for(var f in h){var g=h[f];if(e==-1||parseFloat(g)>parseFloat(e)){e=g}}}return e},ksort:function(g){var h=Object.keys(g).sort(),f={};for(var e in h){f[h[e]]=g[h[e]]}return f},str_pad:function(h,k,m,j){var l="";var i;var n=function(b,c){var a="";while(a.length<c){a+=b}a=a.substr(0,c);return a};h+="";m=m!==undefined?m:" ";if(j!=="STR_PAD_LEFT"&&j!=="STR_PAD_RIGHT"&&j!=="STR_PAD_BOTH"){j="STR_PAD_RIGHT"}if((i=k-h.length)>0){if(j==="STR_PAD_LEFT"){h=n(m,i)+h}else{if(j==="STR_PAD_RIGHT"){h=h+n(m,i)}else{if(j==="STR_PAD_BOTH"){l=n(m,Math.ceil(i/2));h=l+h+l;h=h.substr(0,k)}}}}return h},template_parse:function(i,t){var q=i.match(/<!--IF.+?(?=-->)(.+)?(?=<!--END-->)<!--END-->/gi,"gi");if($.type(q)=="array"){for(var r=0;r<q.length;r++){var p=q[r];var q=p.match(/\(.+?(?=\))\)/gi,"gi");var m=q[0];m=m.substr(1,m.length-2);var o=new Function("obj","return "+m+";");if(!o(t)){i=i.replace(p,"","gi")}}}var q=i.match(/<!--IF_NOT_EMPTY.+?(?=-->)(.+)?(?=<!--END-->)<!--END-->/gi,"gi");if($.type(q)=="array"){for(var r=0;r<q.length;r++){var p=q[r];var q=p.match(/\(\w+\)/gi,"gi");var m=q[0];m=m.substr(1,m.length-2);if($.val(m,t,{d:""})==""){i=i.replace(p,"","gi")}}}var q=i.match(/{\w+(:\w+)*?(?=})}/gi,"gi");if($.type(q)=="array"){for(var r=0;r<q.length;r++){var p=q[r];var m=p.substr(1,p.length-2);var s="string";if(m.indexOf(":")>=0){var f=m.split(":");m=f[0];s=f[1]}var n=$.val(m,t,{d:"-"});n=$.convert_datatype(n,s);i=i.replace(p,n,"gi")}}return i},convert_datatype:function(c,d){switch(d){case"date":c=$.date("j M Y",$.strtotime(c));break}return c},calc_size:function(c,d){d=typeof d=="undefined"||!d?window.innerWidth:d;if(c.indexOf("%")>=0){c=c.replace("%","","gi");if(!isNaN(parseFloat(c))){c=parseFloat(c)/100*d}}return c},download:function(d){var a=document.createElement("a");a.href=d;a.setAttribute("download",d);document.body.appendChild(a);a.click();document.body.removeChild(a)},ux_init:function(b){b=typeof b=="undefined"||!(b instanceof HTMLElement)?document.body:b;$("*[data-type]",b).each(function(){var d=this.getAttribute("data-type");if(typeof $(this)[d]=="function"){var a=$.options_from_html(this);$(this)[d](a)}else{console.warn("Unknown ux "+d)}});$("*[data-action]",b).each(function(){switch(this.getAttribute("data-action")){case"modal.close":$(this).on("click.data-action",function(){$(this).closest(".modal").modal_close()});break}});$(window).on("click",$.popup_close_all).on("scroll",$.popup_close_all);$(window).on("keyup",function(a){switch(a.keyCode){case 27:$(".modal").modal_close();break}})},istrue:function(b){if(typeof b!="undefined"&&(parseInt(b)==1||b===true)){return true}return false}});var oldVal=$.fn.val;$.fn.val=function(c){var d=$(this).attr("data-type");if(d!=null&&typeof $(this)[d+"_val"]!="undefined"){return $(this)[d+"_val"].apply(this,arguments)}else{if($(this).hasClass("container")){return $(this).container_val.apply(this,arguments)}else{return oldVal.apply(this,arguments)}}};$.fn.placeholder=function(){var b=$(this).attr("data-type");if(b!=null&&typeof $(this)[b+"_placeholder"]!="undefined"){return $(this)[b+"_placeholder"].apply(this,arguments)}else{if($(this).hasClass("container")){return $(this).container_placeholder.apply(this,arguments)}}};$.fn.readonly=function(){var b=$(this).attr("data-type");if(b!=null&&typeof $(this)[b+"_readonly"]!="undefined"){return $(this)[b+"_readonly"].apply(this,arguments)}else{if($(this).hasClass("container")){return $(this).container_readonly.apply(this,arguments)}}};$.fn.reset=function(){var b=$(this).attr("data-type");if(b!=null&&typeof $(this)[b+"_reset"]!="undefined"){return $(this)[b+"_reset"].apply(this,arguments)}else{if($(this).hasClass("container")){return $(this).container_reset.apply(this,arguments)}}};String.prototype.capitalize=function(){return this.charAt(0).toUpperCase()+this.slice(1)};$($.ux_init);$.fn.extend({vfields:function(d){var c=$.val("value",d);$(this).each(function(){var a=this;$(a).addClass("vfields");$(a).data("options",d);if($.type(c)=="array"){$(a).form_set(c)}})},form_set:function(b){if(typeof b=="undefined"||$.type(b)!="array"){return}$(this).each(function(){var a=this;var e=$(this).data("options");var f=$.val("html_callback",e);$(b).each(function(){var d=this;var h=[];h.push("<table><tr><td class='vfields-col1' align='center' style='width:24px'>");h.push("<span class='fa fa-times-circle selectable vfields-remove hoverable'></span>");h.push("</td><td class='vfields-col2'></td></tr></table>");var c=document.createElement("div");c.className="vfields-item";c.innerHTML=h.join("");$(a).append(c);$.fire_event(f,[d],$(".vfields-col2",c))});$(".vfields-remove",a).click(function(){$(this).closest(".vfields-item").remove()})})},vfields_get:function(){var b=[];$(this).each(function(){var a=this;$(".vfields-col2",a).each(function(){var d=$.el_get(this);b.push(d)})});return b}});$.fn.extend({webeditor:function(c){var d=$.val("height",c);this.each(function(){var a=$.uniqid();var b=[];b.push($.p('<textarea id="$1"></textarea>',["webeditor"+a]));$(this).addClass("webeditor");$(this).html(b.join(""));$(this).data("options",c);CKEDITOR.replace("webeditor"+a,{height:d})})},webeditor_get:function(c){var d=[];this.each(function(){var a=$("textarea",this).attr("id");if(typeof CKEDITOR.instances[a]!="undefined"){var b=CKEDITOR.instances[a].getData();d.push(b)}});return d.length==1?d[0]:(d.length>1?d:null)},webeditor_set:function(b){this.each(function(){var a=$("textarea",this).attr("id");if(typeof CKEDITOR.instances[a]!="undefined"){CKEDITOR.instances[a].setData(b)}})}});$.fn.extend({widget:function(b){this.each(function(){var r=this;var t=$.val("type",b);var D=$.val("src",b);var s=$.val("title",b,{default_value:"Untitled"});var B=$.val("columns",b);var u=$.uniqid();var w=$.val("default_presets",b);var x=parseInt($.val("preset_idx",b,{d:0}));if(isNaN(x)){x=0}var y=[];y.push($.p('<div class="widget-head padding10">',[s]));y.push($.p("<table><tr>",[]));y.push($.p('<td style="width:100%">',[]));y.push($.p('<h5 class="padding10">$1</h5>',[s]));y.push($.p("</td>",[s]));y.push($.p("<td>",[]));y.push($.p('<span id="$1"></span>',["preset-selector"+u]));y.push($.p('<span class="icon icon-reload fa fa-refresh padding10 selectable"></span>',[]));y.push($.p('<span class="icon icon-customize fa fa-ellipsis-h padding10 selectable"></span>',[]));y.push($.p("</td>",[]));y.push($.p("</tr></table>",[]));y.push($.p("</div>",[]));y.push($.p('<div class="modal" id="$1"></div>',["customize"+u]));var i=null;var C=[];var z="";if($.type(w)=="array"){for(var A=0;A<w.length;A++){if(A==x){z=w[A]["text"];i=w[A]}C.push({text:w[A]["text"],value:w[A]["text"]})}}switch(t){case"grid":y.push($.p('<div class="widget-body align-center margin10 ">',[]));y.push($.p('<span id="$1"></span>',["gridhead"+u]));y.push($.p("<div></div>",[]));y.push($.p('<span id="$1"></span>',["grid"+u]));y.push($.p("</div>",[]));$(r).html(y.join(""));var B=$.val("columns",b);$("#gridhead"+u,r).gridhead({columns:B,grid:"#grid"+u});var a=$(r).outerHeight()-$(".widget-head",r).outerHeight()-$("#gridhead"+u,r).outerHeight()-15;$("#grid"+u,r).grid({columns:B,height:a});break;case"chart":y.push($.p('<div class="widget-body align-center margin10 ">',[]));y.push($.p('<span id="$1"></span>',["chart"+u]));y.push($.p("</div>",[]));$(r).html(y.join(""));var E=$.val("chart_type",b);var a=$(r).outerHeight()-$(".widget-head",r).outerHeight()-$("#gridhead"+u,r).outerHeight()-15;$("#chart"+u).chart({width:"100%",height:a,padding:0,type:E});break;case"metric":y.push($.p('<div class="widget-body align-left margin10 ">',[]));y.push($.p('<span id="$1"></span>',["metric"+u]));y.push($.p("</div>",[]));$(r).html(y.join(""));break}$("#preset-selector"+u).dropdown({items:C,value:z,onchange:function(){$(r).widget_load()}});$("#customize"+u).gridsetting({onchange:function(d){var e=$(this).closest(".widget");var c=$(e).data("options");c=$.array_merge(c,d);$(e).data("options",c);$(r).widget_load()}});$(".icon-reload",r).click(function(){$(r).widget_load()});$(".icon-customize",r).click(function(){var d=$(this).closest(".widget");var f=$(d).data("options");var e=$.val("columns",f);var c=$.val("default_presets",f);$("#customize"+u).gridsetting_open({columns:e,presets:c,active_idx:0})});$(r).data("options",b);$(r).data("uid",u);$(r).widget_load()})},widget_load:function(){this.each(function(){var o=this;var i=$(o).data("options");var y=$.val("src",i);var p=$.val("type",i);var r=$.val("default_presets",i);var s=parseInt($.val("preset_idx",i,{d:0}));var q=$(o).data("uid");var w=$("#preset-selector"+q).dropdown_get();var n=null;var x=[];var t="";if($.type(r)=="array"){for(var u=0;u<r.length;u++){if(r[u]["text"]==w){t=r[u]["text"];n=r[u]}x.push({text:r[u]["text"],value:r[u]["text"]})}}switch(p){case"metric":$.api_post(y,n,function(a){$("#metric"+q).html("<h2>"+a.data+"</h2>")});break;case"grid":$.api_post(y,n,function(a){var b=$.val("data",a);$("#grid"+q,o).grid_set(b)});break;case"chart":$.api_post(y,n,function(a){$("#chart"+q).chart_set(a.data)});break}})}});$.extend({workspace_init:function(){$(".workspace").each(function(){var b=window.innerHeight-$(".header").outerHeight()-20;$(this).workspace_set({state:$(this).attr("data-state"),size:$(this).attr("data-size"),height:b});$.workspace_rtime;$.workspace_timeout=false;$.workspace_delta=200;$(window).resize(function(){$.workspace_rtime=new Date();if($.workspace_timeout===false){$.workspace_timeout=true;setTimeout($.workspace_resizeend,$.workspace_delta)}})})},workspace_resizeend:function(){if(new Date()-$.workspace_rtime<$.workspace_delta){setTimeout($.workspace_resizeend,$.workspace_delta)}else{$.workspace_timeout=false;$(".workspace").each(function(){var b=window.innerHeight-$(".header").outerHeight()-20;$($(this).children()[0]).css({height:b});$($(this).children()[1]).css({height:b});$($(this).children()[2]).css({height:b})})}}});$.fn.extend({workspace_set:function(b){if(typeof b=="undefined"||$.type(b)!="object"){return}$(this).each(function(){b=$.ksort(b);var t={};var l={flex:"1 1 auto"};var m={};for(var n in b){switch(n){case"size":var a=b[n];a=a.split(" ");var r=$.val(0,a,{d:300,t:"number"});var p=$.val(1,a,{d:400,t:"number"});t.flex="0 0 "+(r+"px");m.flex="0 0 "+(p+"px");$(this).data("left_size",r);$(this).data("right_size",p);break;case"height":t.height=b[n];l.height=b[n];m.height=b[n];break;case"state":var s=$.val("state",b,{d:""});s=s.split(" ");var o=$.val(0,s,{d:1,t:"number"});var q=$.val(2,s,{d:0,t:"number"});var r=o<1?"0":$(this).data("left_size");var p=q<1?"0":$(this).data("right_size");t.flex="0 0 "+(r+"px");m.flex="0 0 "+(p+"px");break}}if($(this).children().length==3){$($(this).children()[0]).css(t);$($(this).children()[1]).css(l);$($(this).children()[2]).css(m)}})}});$.fn.extend({autocomplete:function(f){var b=$.val("class",f,{d:""});var e=$.val("name",f,{d:""});var d=$.val("src",f,{d:""});var a=$.val("width",f);var c=$.val("placeholder",f,{d:""});var g={};if(a!=null){g.width=a}this.each(function(){var i=this;var h=[];h.push("<input type='text' placeholder=\""+c+'"/>');h.push("<span class='icon fa fa-search hoverable selectable'></span>");h.push("<span class='popup'></span>");$(i).addClass("autocomplete");$(i).addClass(b);$(i).html(h.join(""));$(i).css(g);$(i).attr("data-name",e);$(i).attr("data-type","autocomplete");$(i).data("options",f);$("input[type='text']",i).on("keyup",function(n){var m=$(this).closest(".autocomplete");if($(m).hasClass("readonly")){return}var l=$(m).data("options");var k=$.val("readonly",l);if(!k&&d.length>0){var j={};j.key=this.value;$.api_get(d,j,function(s){var p=$.val("data",s);var o=[];if($.type(p)=="array"){for(var u=0;u<p.length;u++){var r=p[u];var t=$.val("value",r,{d:""});var q=$.val("text",r,{d:t});o.push("<div class='item' data-value=\""+t+'">');o.push("<label>"+q+"</label>");o.push("</div>")}}$(".popup",m).html(o.join(""));$(".item",$(".popup",m)).on("click",function(){var x=this.getAttribute("data-value");var w=$("label",this).text();var y={value:x,text:w};$(m).autocomplete_val(y)});$.popup_open($(".popup",m),m,{min_width:$(m).outerWidth()})})}})})},autocomplete_val:function(a,b){if(typeof a=="undefined"){var c=[];$(this).each(function(){var d=$(this).data("options");var f=$.val("multiple",d,{d:false});if(f){$(".text",this).each(function(){c.push(this.getAttribute("data-value"))})}else{var e=$("input",this).val();var g=$(this).data("value");if(g==null){g=e}c.push(g)}});return c.length==1?c[0]:(c.length>1?c:"")}else{$(this).each(function(){var d=$(this).data("options");var h=$.val("multiple",d,{d:false});var e=c="";if($.type(a)=="object"){c=$.val("value",a,{d:""});e=$.val("text",a,{d:c})}else{e=c=a}if(h){var g=typeof b!="undefined"&&b===true?true:false;if(g){$(".text",this).remove()}var f=$(this).val();if(!$.in_array(c,f)&&c!==""){$("<span class='text' data-value=\""+c+'">'+e+"<span class='icon-remove glyphicons glyphicons-remove'></span></span>").insertBefore($("input",this));$(".glyphicons-remove",$("input",this).prev()).on("click",function(){$(this).parent().remove()})}$("input",this).val("")}else{$("input",this).val(e);$(this).data("value",c)}})}},autocomplete_readonly:function(a){if(typeof a=="undefined"){return $(this).hasClass("readonly")?true:false}else{if(a){$(this).addClass("readonly");$("input",this).attr("readonly",true);$("input",this).data("placeholder",$("input",this).attr("placeholder"));$("input",this).attr("placeholder","")}else{$(this).removeClass("readonly");$("input",this).attr("readonly",false);$("input",this).attr("placeholder",$("input",this).data("placeholder"))}}},autocomplete_reset:function(){$(this).autocomplete_val("",true)}});$.fn.extend({calendar:function(a){this.each(function(){var c=this;var d=$.val("value",a,{d:"2017-01-01"});d=$.date("j M Y",$.strtotime(d));var b=[];b.push("<input type='text' value='"+d+"' readonly/>");b.push("<span class='icon fa fa-calendar'></span>");b.push("<span class='popup'>Calendar</span>");$(c).addClass("calendar");$(c).html(b.join(""));$(c).attr("data-type","calendar");$(".icon",this).click(function(e){e.preventDefault();e.stopPropagation()});$(".popup",this).click(function(e){e.preventDefault();e.stopPropagation()})})}});$.extend({calendar_open:function(b){var d=b.refEl;var a=b.value;var c=$("#calendar");if(c.length==0){c=document.createElement("div");c.id="calendar";c.className="popup";document.body.appendChild(c);c=$("#calendar")}c=c[0];$(c).data("params",b);$.calendar_set(a);$.popup_open(c,d)},calendar_set:function(c){var a=$("#calendar").data("params");var b=$.val("type",a,{d:""});switch(b){case"range":$.calendar_set_range(c);break;default:$.calendar_set_single(c);break}},calendar_set_single:function(c){var b=$("#calendar");$(b).attr("data-value",c);var p=$.date("n",$.strtotime(c));var a=$.date("Y",$.strtotime(c));var e=$.date("j",$.strtotime(c));var o=$.start_day_of_month(a,p)%7;var f=$.last_date_of_month(a,p);var g=$.date("M Y",$.strtotime(c));var k=$(b).data("params");var h=k.onchange;var n=[];n.push("<table>");n.push("<tr>");n.push("<td><span class='calendar-prev fa fa-caret-left padding5'></span></td>");n.push("<td colspan='5'><span class='date-label'>"+g+"</span></td>");n.push("<td><span class='calendar-next fa fa-caret-right padding5'></span></td>");n.push("</tr>");n.push("<tr>");n.push("<td>Sun</td>");n.push("<td>Mon</td>");n.push("<td>Tue</td>");n.push("<td>Wed</td>");n.push("<td>Thu</td>");n.push("<td>Fri</td>");n.push("<td>Sun</td>");n.push("</tr>");var d=1;for(var m=0;m<6;m++){n.push("<tr>");for(var l=0;l<7;l++){if(o>0){n.push("<td></td>");o--}else{if(d<=f){n.push(d==e?"<td class='day active'>"+d+"</td>":"<td class='day'>"+d+"</td>");d++}else{n.push("<td></td>")}}}n.push("</tr>")}n.push("</table>");b.html(n.join(""));$(".day",b).click(function(t){t.preventDefault();t.stopPropagation();var u=$(this).closest("#calendar");var q=$(u).attr("data-value");var i=this.innerHTML;var s=parseInt($.date("n",$.strtotime(q)));var r=$.date("Y",$.strtotime(q));var j=$.date("j M Y",$.mktime(0,0,0,s,i,r));$.fire_event(h,[j],u);$.popup_close(u)});$(".calendar-prev",b).click(function(s){s.preventDefault();s.stopPropagation();var t=$(this).closest("#calendar");var i=$(t).attr("data-value");var r=parseInt($.date("n",$.strtotime(i)));var q=parseInt($.date("Y",$.strtotime(i)));var j=parseInt($("td.active",t).html());var u=$.date("Y-m-d",$.mktime(0,0,0,r-1,j,q));$.calendar_set(u)});$(".calendar-next",b).click(function(s){s.preventDefault();s.stopPropagation();var t=$(this).closest("#calendar");var i=$(t).attr("data-value");var r=parseInt($.date("n",$.strtotime(i)));var q=parseInt($.date("Y",$.strtotime(i)));var j=parseInt($("td.active",t).html());var u=$.date("Y-m-d",$.mktime(0,0,0,r+1,j,q));$.calendar_set(u)})},calendar_set_range:function(l,w,e){var b=$("#calendar");$(b).attr("data-value",l);var z=$(b).data("params");var y=z.onchange;l=l.split("-");var a=l[0];var q=l[1];if($.date("Y",$.strtotime(a))=="1970"){a=$.date("Y-m-d")}if($.date("Y",$.strtotime(q))=="1970"){q=$.date("Y-m-d")}var x=[],m=[],s=[],d=[],u=[],c=[],h=[];var p=$.date("Y",$.strtotime(w))!="1970"?w:a;var n=$.date("Y",$.strtotime(e))!="1970"?e:q;if($.date("Ym",$.strtotime(n))==$.date("Ym",$.strtotime(p))){n=$.date("Y-m-d",$.mktime(0,0,0,parseInt($.date("n",$.strtotime(n)))+1,$.date("j",1,$.date("Y",$.strtotime(n)))))}x[0]=$.date("n",$.strtotime(p));m[0]=$.date("m",$.strtotime(p));s[0]=$.date("Y",$.strtotime(p));d[0]=$.date("j",$.strtotime(p));u[0]=$.start_day_of_month(s[0],x[0])%7;c[0]=$.last_date_of_month(s[0],x[0]);h[0]=$.date("M Y",$.strtotime(p));x[1]=$.date("n",$.strtotime(n));m[1]=$.date("m",$.strtotime(n));s[1]=$.date("Y",$.strtotime(n));d[1]=$.date("j",$.strtotime(n));u[1]=$.start_day_of_month(s[1],x[1])%7;c[1]=$.last_date_of_month(s[1],x[1]);h[1]=$.date("M Y",$.strtotime(n));var g=[];for(var t=0;t<2;t++){g.push("<table class='calendar-table range-"+t+"'>");g.push("<tr>");g.push($.p("<td><span class='calendar-prev fa fa-caret-left padding5' data-calendaridx='$i'></span></td>",[t]));g.push("<td colspan='5'><span class='date-label'>"+h[t]+"</span></td>");g.push($.p("<td><span class='calendar-next fa fa-caret-right padding5' data-calendaridx='$i'></span></td>",[t]));g.push("</tr>");g.push("<tr>");g.push("<td>Sun</td>");g.push("<td>Mon</td>");g.push("<td>Tue</td>");g.push("<td>Wed</td>");g.push("<td>Thu</td>");g.push("<td>Fri</td>");g.push("<td>Sun</td>");g.push("</tr>");var A=1;for(var r=0;r<6;r++){g.push("<tr>");for(var o=0;o<7;o++){if(u[t]>0){g.push("<td></td>");u[t]--}else{if(A<=c[t]){var f=$.date("Y-m-d",$.strtotime(s[t]+"-"+m[t]+"-"+$.str_pad(A,2,"0","STR_PAD_LEFT")));if($.strtotime(f)>=$.strtotime(a)&&$.strtotime(f)<=$.strtotime(q)){g.push("<td class='day active' data-date='"+f+"'>"+A+"</td>")}else{g.push("<td class='day' data-date='"+f+"'>"+A+"</td>")}A++}else{g.push("<td></td>")}}}g.push("</tr>")}g.push("</table>")}b.html(g.join(""));b.data("seq",0);$(".day",b).click(function(H){H.preventDefault();H.stopPropagation();console.log("value: "+1);var E=$(this).closest("#calendar");var G=$(E).attr("data-value");var F=this.innerHTML;var I=parseInt($.date("n",$.strtotime(G)));var i=$.date("Y",$.strtotime(G));var J=$.date("j M Y",$.mktime(0,0,0,I,F,i));var C=parseInt(E.data("seq"));if(C==0){$(".day.active-0").removeClass("active active-0");$(this).addClass("active active-0");var D=$(this).attr("data-date");var j=$(E).attr("data-value");j=j.split(",");var B=$.val(1,j,{d:D});$(".day",E).each(function(){var K=$(this).attr("data-date");if($.strtotime(K)>=$.strtotime(D)&&$.strtotime(K)<=$.strtotime(B)){$(this).addClass("active")}else{$(this).removeClass("active")}})}else{$(".day.active-1").removeClass("active active-1");$(this).addClass("active active-1")}E.data("seq",C+1);if(C==1){var D=$(".day.active-0").attr("data-date");var B=$(".day.active-1").attr("data-date");if($.strtotime(D)>$.strtotime(B)){var k=D;D=B;B=k}var j=$.date("Ymd",$.strtotime(D))+"-"+$.date("Ymd",$.strtotime(B));$.popup_close(E);$.fire_event(y,[j],E)}});$(".calendar-prev",b).click(function(j){var i=parseInt($(this).attr("data-calendaridx"));console.log(["prev",l,parseInt($(this).attr("data-calendaridx")),p,n]);j.preventDefault();j.stopPropagation();if(i==0){p=$.date("Y-m-d",$.mktime(0,0,0,parseInt($.date("n",$.strtotime(p)))-1,$.date("j",$.strtotime(p)),$.date("Y",$.strtotime(p))))}else{if(i==1){n=$.date("Y-m-d",$.mktime(0,0,0,parseInt($.date("n",$.strtotime(n)))-1,$.date("j",$.strtotime(n)),$.date("Y",$.strtotime(n))));if($.date("Ym",$.strtotime(p))>=$.date("Ym",$.strtotime(n))){p=$.date("Y-m-d",$.mktime(0,0,0,parseInt($.date("n",$.strtotime(p)))-1,$.date("j",$.strtotime(p)),$.date("Y",$.strtotime(p))))}}}$.calendar_set_range(l.join(","),p,n)});$(".calendar-next",b).click(function(j){var i=parseInt($(this).attr("data-calendaridx"));j.preventDefault();j.stopPropagation();if(i==0){p=$.date("Y-m-d",$.mktime(0,0,0,parseInt($.date("n",$.strtotime(p)))+1,$.date("j",$.strtotime(p)),$.date("Y",$.strtotime(p))));if($.date("Ym",$.strtotime(n))<=$.date("Ym",$.strtotime(p))){n=$.date("Y-m-d",$.mktime(0,0,0,parseInt($.date("n",$.strtotime(n)))+1,$.date("j",$.strtotime(n)),$.date("Y",$.strtotime(n))))}}else{if(i==1){n=$.date("Y-m-d",$.mktime(0,0,0,parseInt($.date("n",$.strtotime(n)))+1,$.date("j",$.strtotime(n)),$.date("Y",$.strtotime(n))))}}$.calendar_set_range(l.join(","),p,n)})}});$.fn.extend({chart:function(a){var d=$.val("name",a);var c=$.val("height",a);var b=$.val("width",a);this.each(function(){var f=this;var e={};e.height=c;e.width=b;var g=[];$(f).addClass("chart");$(this).html(g.join(""));$(this).css(e);$(f).attr("data-type","chart");$(f).attr("data-name",d);$(f).data("options",a)})},chart_set:function(a){this.each(function(){var d=this;var b=$(d).data("options");var c=$.val("type",b,{default_value:"line"});switch(c){case"bar":$(this).chart_bar_set(a);break;default:$(this).chart_line_set(a);break}})},chart_bar_set:function(a){this.each(function(){var B=this;var F=$(B).data("options");var q=$(B).outerHeight();var H=$(B).outerWidth();var o=$.val("padding",F,{default_value:10});var i=$.array_key_count(a);var I=$.object_value_min(a);var m=$.object_value_max(a);var t=o;var c=H-o;var r=c-t;var k=(H*0.8)/i;var G=(r-(k*i))/(i+1);var z=q-o;var A=10;var C=z-A;var b=C/(m-I);var j=[];j.push($.p('<svg width="$1" height="$2">',[H,q]));var p=t;var n=c;var E=z,D=z;j.push($.p('<line x1="$x1" y1="$y1" x2="$x2" y2="$y2" style="stroke:rgb(0,0,0);stroke-width:1" />',[p,E,n,D]));var e=0;for(var u in a){var s=a[u];var g=k;var l=b*s;if(l<5){l=5}var f=e*(G+k)+G;var d=z-l;j.push($.p('<rect x="$1" y="$1" width="$1" height="$1" stroke="#4A89DC" stroke-width="2" fill="rgba(74, 137, 220, .2)" data-key="$1" data-value="$1" onmouseover="$1" onmouseout="$1"/>',[f,d,g,l,u,s,"$.chart_line_mouseover.call(this)","$.chart_line_mouseout.call(this)"]));e++}j.push("</svg>");$(B).html(j.join(""))})},chart_line_set:function(a){this.each(function(){var A=this;var f=$(A).data("options");var o=$(A).outerHeight();var t=$(A).outerWidth();var u=$.array_key_count(a);var g=$.object_value_min(a);var l=$.object_value_max(a);var m=$.val("padding",f,{default_value:10});var q=m;var i=t-m;var z=i-q;var C=z/(u-1);var r=o-m;var s=10;var B=r-s;var h=B/(l-g);var k=[];k.push($.p('<svg width="$1" height="$2">',[t,o]));var x=q;var w=i;var e=r,b=r;k.push($.p('<line x1="$x1" y1="$y1" x2="$x2" y2="$y2" style="stroke:rgb(0,0,0);stroke-width:1" />',[x,e,w,b]));var j=1;for(var p in a){var c=Math.round(q+(j*C));k.push($.p('<line x1="$1" y1="$1" x2="$1" y2="$1" style="stroke:rgba(0, 0, 0, .05);stroke-width:1" />',[c,r,c,s]));j++}var j=0;var y=[];y.push($.p("M$1 $2",[Math.round(q+(j*C)),r]));for(var p in a){var n=a[p];var c=Math.round(q+(j*C));var D=Math.round(r-(n*h));y.push($.p("L$1 $2",[c,D]));j++}y.push($.p("M$1 $2 Z",[c,r]));k.push($.p('<path d="$1" stroke-width="0" stroke="transparent" fill="rgba(74, 137, 220, .2)"/>',[y.join(" ")]));var j=0;var y=[];for(var p in a){var n=a[p];var c=Math.round(q+(j*C));var D=Math.round(r-(n*h));if(j==0){y.push($.p("M$1 $2",[c,D]))}else{y.push($.p("L$1 $2",[c,D]))}j++}k.push($.p('<path d="$1" stroke-width="2" stroke="#4A89DC" fill="transparent"/>',[y.join(" ")]));var j=0;for(var p in a){var n=a[p];var c=q+(j*C);var D=r-(n*h);k.push($.p('<circle cx="$1" cy="$1" r="1" stroke="#4A89DC" stroke-width="2" fill="#4A89DC" onmouseover="$1" onmouseout="$1" data-key="$1" data-value="$1"/>',[c,D,"$.chart_line_mouseover.call(this)","$.chart_line_mouseout.call(this)",p,n]));j++}k.push("</svg>");$(A).html(k.join(""))})}});$.extend({chart_line_mouseover:function(){$(this).attr({r:2});var a=$(this).attr("data-key");var b=$(this).attr("data-value");$.tooltip(this,a+"<br />"+b)},chart_line_mouseout:function(){$(this).attr({r:1});$.tooltip_remove()}});$.fn.extend({checkbox:function(a){this.each(function(){var e=$.val("class",a,{d:""});var c=$.val("items",a,{d:null});var d=[];if($.type(c)=="array"){$(c).each(function(){var j=$.val("text",this,{d:""});var i=$.val("value",this,{d:""});var h="checkbox-"+$.uniqid();d.push("<span class='item'><input id='"+h+"' type='checkbox' value=\""+i+"\"/><label for='"+h+"'>"+j+"</label></span>")})}else{var g=$.val("text",a,{d:""});var f="";var b="checkbox-"+$.uniqid();d.push("<span class='item'><input id='"+b+"' type='checkbox' value=\""+f+"\"/><label for='"+b+"'>"+g+"</label></span>")}$(this).addClass("checkbox");$(this).addClass(e);$(this).html(d.join(""));$(this).data("options",a)})}});$.fn.extend({checklist:function(a){$(this).each(function(){var b=this;var c=[];c.push("<div class='checklist-body'>");c.push("<div class='checklist-item'>");c.push("<input type='checkbox' />");c.push("<input type='text' />");c.push("<span class='iconbar'>");c.push("<span class='checklist-remove fa fa-times padding5 selectable'></span>");c.push("</span>");c.push("</div>");c.push("</div>");c.push("<div class='checklist-foot'>");c.push("<span class='checklist-add fa fa-plus-circle padding5 selectable hoverable'></span>");c.push("</div>");$(this).addClass("checklist");$(this).html(c.join(""));$(".checklist-add",this).click(function(){$(b).checklist_add()});$(".checklist-remove",this).on("click.checklist",function(){$(this).closest(".checklist-item").remove()})})},checklist_add:function(){$(this).each(function(){var a=[];a.push("<div class='checklist-item'>");a.push("<input type='checkbox' />");a.push("<input type='text' />");a.push("<span class='iconbar'>");a.push("<span class='checklist-remove fa fa-times padding5 selectable hoverable'></span>");a.push("</span>");a.push("</div>");$(".checklist-body",this).append(a.join(""));$(".checklist-remove",$(".checklist-body",this)).on("click.checklist",function(){$(this).closest(".checklist-item").remove()})})},checklist_get:function(){var a=[];$(this).each(function(){$(".checklist-item",this).each(function(){var b=$("input[type='checkbox']",this)[0].checked;var c=$("input[type='text']",this).val();if(c.length>0){a.push({checked:b,text:c})}})});return a.length==0?null:a},checklist_set:function(a){$(this).checklist_attr({value:a})},checklist_attr:function(a){if($.type(a)!="object"){return}$(this).each(function(){for(var b in a){var f=a[b];switch(b){case"readonly":if(f){$("input[type='checkbox']",this).attr("disabled",true);$("input[type='text']",this).attr("readonly",true);$(".checklist-remove",this).addClass("hidden");$(".checklist-add",this).addClass("hidden")}else{$("input[type='checkbox']",this).attr("disabled",false);$("input[type='text']",this).attr("readonly",false);$(".checklist-remove",this).removeClass("hidden");$(".checklist-add",this).removeClass("hidden")}break;case"value":var h=[];if($.type(f)=="array"){for(var d=0;d<f.length;d++){var e=f[d];var g=$.val("text",e,{d:""});var c=$.val("checked",e,{d:false});if(g==""){continue}h.push("<div class='checklist-item'>");h.push("<input type='checkbox'"+(c?" checked":"")+"/>");h.push("<input type='text' value=\""+g+'" />');h.push("<span class='iconbar'>");h.push("<span class='checklist-remove fa fa-times padding5 selectable hoverable'></span>");h.push("</span>");h.push("</div>")}}h.push("<div class='checklist-item'>");h.push("<input type='checkbox'/>");h.push("<input type='text'/>");h.push("<span class='iconbar'>");h.push("<span class='checklist-remove fa fa-times padding5 selectable hoverable'></span>");h.push("</span>");h.push("</div>");$(".checklist-body",this).html(h.join(""));$(".checklist-remove",$(".checklist-body",this)).on("click.checklist",function(){$(this).closest(".checklist-item").remove()});break}}})}});$.fn.extend({choice:function(a){$(this).each(function(){var d=$.val("class",a,{d:""});var c=$.val("items",a,{d:[],datatype:"array"});var b=[];if($.type(c)=="array"){for(var h=0;h<c.length;h++){var e=c[h];var f=$.val("value",e,{d:""});var g=$.val("text",e,{d:f});if(f.length==0){continue}b.push($.p('<span class="item">'));b.push($.p("</span>"))}}$(this).addClass("choice");$(this).addClass(d)})}});$.fn.extend({codeeditor:function(a){var d=$.val("height",a,{d:"200px"});var b=$.val("width",a,{d:"300px"});var e=$.val("name",a,{d:""});var c=$.val("value",a,{d:"300px"});this.each(function(){var f=$.uniqid();var h=[];h.push($.p('<textarea id="$1""></textarea>',["codeeditor-text-"+f]));$(this).addClass("codeeditor");$(this).html(h.join(""));$(this).css({width:b,height:d});$(this).codeeditor_attr({name:e});var g=CodeMirror.fromTextArea(document.getElementById("codeeditor-text-"+f),{lineNumbers:true,mode:"text/x-mariadb",indentWithTabs:true,smartIndent:true,matchBrackets:true,autofocus:true})})},codeeditor_get:function(){var a=[];$(this).each(function(){a.push($("textarea",this).val())});return a.length==1?a[0]:(a.length>1?a:"")},codeeditor_set:function(a){$(this).each(function(){$("textarea",this).val(a)})},codeeditor_attr:function(a){this.each(function(){var d={};var e={};var b={};for(var c in b){var f=b[c];switch(c){case"name":b.name=f}}$(this).attr(b);$(this).css(d);$("textarea",this).css(e)})}});$.fn.extend({codefield:function(a){var d=$.val("placeholder",a,{d:""});var f=$.val("name",a,{d:""});var e=$.val("height",a);var c=$.val("width",a);var b={width:c,height:e};this.each(function(){var h=this;var g=[];g.push("<pre style='height:"+e+";'>"+JSON.stringify({name:"andy"},null,2)+"</pre>");g.push("<span class='icon fa hidden'></span>");$(h).addClass("codefield");$(h).css(b);$(h).html(g.join(""));$(h).attr("data-type","codefield");$(h).attr("data-name",f);$(h).data("options",a)})},codefield_get:function(){var a=[];this.each(function(){var b=$("pre",this).html();a.push(b)});return a.length>1?a:(a.length==1?a[0]:"")},codefield_set:function(a){this.each(function(){$("pre",this).html(a)})}});$.fn.extend({commentlist:function(b){var a=$.val("onsubmit",b);$(this).each(function(){var c=this;var d=[];d.push("<div class='commentlist-write'>");d.push("<input type='text' placeholder='Write comment here...' />");d.push("</div>");d.push("<div class='commentlist-list'></div>");$(this).addClass("commentlist");$(this).html(d.join(""));$(this).data("options",b);$("input[type='text']",this).on("keyup",function(f){if(f.keyCode==13){if(f.shiftKey){}else{if(this.value!=""){$.fire_event(a,[this.value],c);this.value="";$(this).blur()}}}})})},commentlist_add:function(a){$(this).each(function(){var g=$(this).data("options");var i=$.val("onremove",g);var f=$.val("id",a);var e=$.val("comment",a);var d=$.val("full_name",a);var b=$.val("createdon",a);var c=$.val("removable",a,{d:0});if(!e||!d){return}var h=[];h.push("<div class='commentlist-item' data-id='"+f+"'>");h.push("<p style='word-wrap: break-word;'><b>"+d+"</b> "+e+"</p>");h.push("<div class='commentlist-item-footer'>");h.push("<label class=''>"+b+"</label>");if(c){h.push("<span class='width5 height5'>&nbsp;</span>");h.push("<span class='comment-item-remove selectable hoverable'>Remove</span>")}h.push("</div>");h.push("</div>");$(".commentlist-list",this).append(h.join(""));$(".comment-item-remove",$(".commentlist-list",this)).on("click",function(){var j=$(this).closest(".commentlist-item").attr("data-id");$.fire_event(i,[j],this)})})},commentlist_set:function(a){$(this).each(function(){var j=$(this).data("options");var c=$.val("onremove",j);var e=[];if($.type(a)=="array"){for(var d=0;d<a.length;d++){var b=a[d];var l=$.val("id",b);var f=$.val("comment",b);var g=$.val("full_name",b);var h=$.val("createdon",b);var k=$.val("removable",b,{d:0});if(!f||!g){continue}e.push("<div class='commentlist-item' data-id='"+l+"'>");e.push("<p style='word-wrap: break-word;'><b>"+g+"</b> "+f+"</p>");e.push("<div class='commentlist-item-footer'>");e.push("<label class=''>"+h+"</label>");if(k){e.push("<span class='width5 height5'>&nbsp;</span>");e.push("<span class='comment-item-remove selectable hoverable'>Remove</span>")}e.push("</div>");e.push("</div>")}}$(".commentlist-list",this).html(e.join(""));$(".comment-item-remove",$(".commentlist-list",this)).on("click",function(){var i=$(this).closest(".commentlist-item").attr("data-id");$.fire_event(c,[i],this)})})}});$.fn.extend({container_val:function(a){if(typeof a=="undefined"){result={};$("*[data-type]",this).each(function(){var b=this.getAttribute("data-name");if(b!=null&&b!=""){var c=$(this).val();result[b]=c}});return result}else{$("*[data-type]",this).each(function(){var b=this.getAttribute("data-name");if(b!=null&&b!=""){var c=$.val(b,a,{d:""});$(this).val(c)}})}},container_reset:function(){$("*[data-type]",this).each(function(){var a=$(this).attr("data-type");if(a!=null&&typeof $(this)[a+"_reset"]!="undefined"){$(this)[a+"_reset"].apply(this,arguments)}})}});$.fn.extend({datepicker:function(a){var b=$.val("type",a);this.each(function(){var d=this;var c=[];c.push("<input type='text' readonly/>");c.push("<span class='icon fa fa-calendar'></span>");$(d).addClass("datepicker");$(d).html(c.join(""));$(d).attr("data-type","datepicker");$(d).data("options",a);$(".icon",this).click(function(i){i.preventDefault();i.stopPropagation();var h=$(this).closest(".datepicker");var g=$(h).data("options");var f=$.val("readonly",g,{d:false});if(f=="0"||f==false){$.calendar_open({refEl:h,value:$(h).data("value"),type:b,onchange:function(e){$(h).datepicker_val(e)}})}});$(".popup",this).click(function(f){f.preventDefault();f.stopPropagation()});$(this).datepicker_val($.val("value",a,{d:"20170101"}))})},datepicker_val:function(a){if(typeof a=="undefined"){var a=[];$(this).each(function(){var b=$(this).data("value");a.push(b)});return a.length==1?a[0]:(a.length==0?null:a)}else{$(this).each(function(){var f="";a=$.date_parse(a);if(a.indexOf("-")>=0){var e=a.split("-");var c=$.date("M j, Y",$.strtotime(e[0]));var b=$.date("M j, Y",$.strtotime(e[1]));f=c+" - "+b}else{var e=$.date("M j, Y",$.strtotime(a));f=e}$("input",this).val(f);$(this).data("value",a)})}}});$.fn.extend({dropdown:function(h){var c=$.val("class",h,{d:""});var j=$.val("name",h,{d:""});var g=$.val("defaultvalue",h,{d:""});var f=$.val("value",h,{d:g});var d=$.val("items",h,{d:[]});var a=$.val("width",h,{d:[]});var i=$.val("src",h,{d:""});var e=$.val("placeholder",h,{d:""});var b=[];b.push("<input class='text' type='text' placeholder=\""+e+'" readonly/>');b.push("<span class='icon fa fa-caret-down hoverable'></span>");b.push("<span class='popup'></span>");this.each(function(){var k=this;$(k).addClass("dropdown");$(k).addClass(c);$(k).html(b.join(""));$(k).data("options",h);$(k).attr("data-type","dropdown");$(k).attr("data-name",j);$(k).dropdown_attr(h);$(".icon, .text",k).click(function(n){n.preventDefault();n.stopPropagation();var m=$(this).closest(".dropdown");var l=$(m).data("options");var o=$.val("readonly",l);if(!o){if($(".popup",m).hasClass("on")){$.popup_close($(".popup",m))}else{$.popup_open($(".popup",m),m,{min_width:$(m).outerWidth()});$(".search-item input",$(".popup",m)).val("");$(".search-item input",$(".popup",m)).focus();$(".item",$(".popup",m)).show()}}});if(f!=""){$(k).dropdown_val()}if(i.length>0){$(this).dropdown_load()}})},dropdown_val:function(a,c){if(typeof a=="undefined"){var b=[];this.each(function(){var f=this;var d=$(f).attr("data-value");var e=$("input",f).length==1?$("input",f).val():$(".text",f).html();d=d==null?e:d;b.push(d)});return b.length==1?b[0]:(b.length>1?b:null)}else{this.each(function(){var g=$(this).data("options");var f=$.val("items",g,{d:[]});var e="";var d="";if($.type(a)=="object"){d=$.val("value",a);e=$.val("text",a,{d:d})}else{if($.type(d)=="string"){e=d=a}}if($.type(f)=="array"){for(var h=0;h<f.length;h++){var j=f[h];if(j.value==d){e=j.text;d=j.value;break}}}$(this).attr("data-value",d);$("input",this).val(e);$(".text",this).html(e)})}},dropdown_items:function(a){if(typeof a=="undefined"){var b=[];this.each(function(){var d=this;var c=$(d).data("options");var e=$.val("items",c,{d:[]});$(e).each(function(){if($.type(this)=="object"){b.push(this)}})});return b}else{this.each(function(){var g=this;var h=$(g).data("options");var o=$.val("searchable",h,{d:false});var j=$.val("multiple",h,{d:false});var k=$.val("onchange",h);var m=[];if(o==true){m.push("<div class='search-item'>");m.push("<input type='text' placeholder='Search'/>");m.push("</div>")}if($.type(a)=="array"){for(var l=0;l<a.length;l++){var e=a[l];var d=e.text;var c=e.value;var f=(d+" "+c).toLowerCase();var n=$.uniqid();m.push("<div class='item' data-value=\""+c+'" data-search="'+f+'">');if(j){m.push("<input type='checkbox' id='dropdown_item_checkbox_"+n+"'/>")}m.push("<label for='dropdown_item_checkbox_"+n+"'>"+d+"</label>");m.push("</div>")}}m=m.join("");$(".popup",g).html(m);$(g).data("options",h);$(".item",$(".popup",g)).click(function(p){if(j){p.stopPropagation()}var s=$("label",this).html();var r=$(this).attr("data-value");var i=-1;var w=null;for(var x=0;x<a.length;x++){var t=a[x];var q=$.val("text",t);var u=$.val("value",t);if(u==r||q==s){i=x;w=t;break}}if(w){w._index=i}$("input",g).val(s);$(".text",g).html(s);$(g).attr("data-value",r);$.fire_event(k,[p,w],g)});$(".item>input[type='checkbox']",$(".popup",g)).on("change",function(){var i=this.nextElementSibling.innerHTML;var p=this.parentNode.getAttribute("data-value");$(g).dropdown_val({text:i,value:p},true)});$(".popup .search-item input",g).click(function(i){i.preventDefault();i.stopPropagation()});$(".popup .search-item input",g).keyup(function(p){var i=this.value;var q=$(this).closest(".popup");$(".item",q).show();if(i.length>0){$(".item:not([data-search*='"+i+"'])",q).hide()}});h.items=a;$(g).data("options",h);$(g).dropdown_val("*")})}},dropdown_attr:function(a){this.each(function(){var b=$(this).data("options");if($.type(a)=="object"){for(var d in a){var e=a[d];var c={};switch(d){case"items":$(this).dropdown_items(e);break;case"readonly":if(e){$(this).addClass("readonly");b.readonly=true}else{$(this).removeClass("readonly");b.readonly=false}break;case"value":$(this).dropdown_val(e);break;case"width":c.width=parseInt(e);break}$(this).css(c)}}$(this).data("options",b)})},dropdown_load:function(){this.each(function(){var c=this;var b=$(c).data("options");var a=$.val("src",b,{d:""});$.api_post(a,{},function(d){var e=$.val("data",d);if($.type(e)=="array"){$(c).dropdown_items(e)}})})},dropdown_reset:function(){$(this).each(function(){var a=$(this).data("options");var b=$.val("defaultvalue",a,{d:""});$(this).dropdown_val(b)})},dropdown_readonly:function(a){$(this).each(function(){if($.istrue(a)){$(this).addClass("readonly")}else{$(this).removeClass("readonly")}})}});$.fn.extend({feed:function(a){$(this).each(function(){var c=$.val("class",a,{d:""});var e=$.val("src",a,{d:""});var d=$.val("autoload",a,{d:false});var b=[];b.push("<div class='feed-content'></div>");b.push("<div class='feed-footer'></div>");$(this).addClass("feed");$(this).addClass(c);$(this).html(b.join(""));$(this).data("options",a);if(d){$(this).feed_load()}})},feed_val:function(b,a){if(typeof b=="undefined"){}else{$(this).each(function(){var l=$(this).data("options");var c=$.val("src",l,{d:""});var k=$.val("template",l,{d:""});if($.type(b)=="array"&&b.length>0){var h="feed_group_"+$.uniqid();var j=document.createElement("div");j.setAttribute("data-feed-group-id",h);var g=[];for(var f=0;f<b.length;f++){g.push("<div class='feed-item'></div>")}j.innerHTML=g.join("");$(".feed-content",this).append(j);for(var f=0;f<b.length;f++){var e=b[f];var d=j.childNodes[f];$.fire_event(k,[e],d)}}})}},feed_load:function(a){$(this).each(function(){if(!$(this).hasClass("feed")){return}var b=this;var c=$(this).data("options");var d=$.val("src",c,{d:""});if(d!=""){$.api_post(d,[],function(g){var i=$.val("data",g,{d:[]});var h=$.val("page",g,{d:1});var f=h==1?false:true;$(b).feed_val(i,f);var e=$.val("max_page",g,{d:h});if(e>=h+1){$(".feed-footer",b).html("<div class='load-more align-center padding10'>Load More...</div>");$(".load-more",b).on("click",function(){$(b).feed_load({page:h+1})})}else{$(".feed-footer",b).html("")}})}})}});$.extend({foldedpane_toggle:function(a){var b=$(a);if(typeof b[0]=="undefined"){return}var c=$(".toggler",b);if(b[0].classList.contains("folded")){b[0].classList.remove("folded");if(c.length==1){c.html("<span class='fa fa-caret-up'></span>")}}else{b[0].classList.add("folded");if(c.length==1){c.html("<span class='fa fa-caret-down'></span>")}}},foldedpane_init:function(){var d=document.body.querySelectorAll(".folded-pane");for(var c=0;c<d.length;c++){var a=d[c];var b=a.querySelector(".toggler");if(b!=null){b.addEventListener("click",function(){$.foldedpane_toggle(a)})}}}});$.fn.extend({grid:function(f){var a=$.val("autoload",f,{d:true});var g=$.val("columns",f,{d:[]});var h=$.val("class",f,{d:null});var e=$.val("name",f,{d:""});var c=$.val("footer",f,{d:""});var b=$.val("value",f,{d:null});var d=$.val("height",f,{d:"auto"});f.page=0;f.row_per_page=12;this.each(function(){var j=this;var i=[];i.push("<table class='grid-body'>");i.push("<tbody class='grid-size'></tbody>");i.push("</table>");i.push("<div class='grid-footer'></div>");$(j).attr("data-type","grid");$(j).addClass("grid");$(j).addClass(h);if(e!=""){$(j).attr("data-name",e)}$(j).data("options",f);$(j).attr("data-type","grid");$(j).html(i.join(""));$.fire_event(c,[],$(".grid-footer",j));$(this).grid_set_columns(g);if(b!=null){$(j).grid_set(b)}if(a){$(j).grid_load()}})},grid_add:function(a){this.each(function(){var d=this;var t=d.querySelector(".grid-body");var m=$(d).data("options");var b=$.val("columns",m,{d:[]});var c=[];if($(".grid-size",t).length==0){var p=[];p.push("<tr class='grid-size'>");for(var k=0;k<b.length;k++){var l=b[k];var q=$.val("width",l,{d:""});p.push("<td style='width:"+q+";'></td>");p.push("<td class='separator'></td>")}p.push("<td style='width:100%'></td>");p.push("</tr>");c.push(p.join(""))}c.push("<tr>");for(var g=0;g<b.length;g++){var l=b[g];var h=$.val("type",l,{d:"text"});var o=$.val("datatype",l,{d:"text"});var u=$.val("name",l,{d:""});var q=$.val("width",l,{d:""});var e=$.val("align",l,{d:""});var n="";var f="";var r="";switch(h){case"index":r=k+1;n="right";f="label";break;case"html":gridtypecoord=0+","+g;break;default:switch(o){case"number":case"money":n="right";r=$.val(u,a,{d:0});break;case"enum":var s=$.val("enums",l,{d:{}});r=$.val(u,a,{d:"-"});r=$.val(r,s,{d:"-"});break;default:r=$.val(u,a,{d:"-"});break}f="label";break}if(e!=""){n=e}c.push("<td data-gridtype='"+h+"' data-gridtypecoord='"+gridtypecoord+"' class='"+f+"' style='text-align:"+n+"'>"+r+"</td>");c.push("<td class='separator'></td>")}c.push("<td></td>");c.push("</tr>");$("tbody",t).append(c.join(""));$("td[data-gridtype='html']",$("tr",$("tbody",t)).last()).each(function(){var i=$(this).attr("data-gridtypecoord").split(",");var j=parseInt(i[1]);var w=b[j];var x=$.val("html",w,{d:""});$.fire_event(x,[a,w],this)})})},grid_remove:function(b){var a=this;$(b).each(function(){var d=$(this).closest(".grid");d=typeof d[0]!="undefined"?d[0]:-2;var c=typeof a[0]!="undefined"?a[0]:-1;if(d==c){$(this).remove()}})},grid_set_columns:function(a){$(this).each(function(){if(!$(this).hasClass("grid")){return}var h=$(this).data("options");h.columns=a;$(this).data("options",h);var d=[];d.push("<tr>");for(var b=0;b<a.length;b++){var f=a[b];var c=$.val("name",f);var e=$.val("width",f);var g=$.val("active",f,{d:1});if(g==1){d.push($.p("<td class='grid-size-label' style='width:$1' data-key='"+c+"'></td>",[e]))}else{d.push($.p("<td class='grid-size-label inactive' style='width:$1' data-key='"+c+"'></td>",[e]))}}d.push("<td style='width:100%'></td>");d.push("</tr>");$(".grid-size",this).html(d.join(""))})},grid_append:function(b,a){this.each(function(){var k=this;var h=k.querySelector(".grid-body");var j=$(k).data("options");var g=$.val("src",j,{d:""});var e=$.val("onselect",j);var l=$.val("columns",j,{d:[]});var d=$.val("page",b,{d:1});var f=$.val("row_per_page",b,{d:10});var m=$.val("max_page",b,{d:d});var c=$.val("data",b);if(typeof j.data=="undefined"){j.data=[]}var o=document.createElement("tbody");$(o).html($.grid_html(c,l,j.data.length));$(h).append(o);$("td[data-gridtype='html']",o).each(function(){var t=$(this).attr("data-gridtypecoord").split(",");var p=parseInt(t[0]);var i=parseInt(t[1]);var r=c[p];var q=l[i];var s=$.val("html",q,{d:""});$.fire_event(s,[r,q],this)});$("tr",o).click(function(){var i=$(this).closest("table");$(".active",i).removeClass("active");$(this).addClass("active");var q=$(this).attr("data-idx");var p=j.data[q];$.fire_event(e,[p],k)});$(".grid-more",k).remove();if(m>d){$(k).append("<div class='grid-more' data-page='"+d+"'><label class='cl-gray'>Load more...</label></div>");$(".grid-more",k).click(function(){var i=parseInt($(this).attr("data-page"));var p=$.val("onloadmore",j);$(this).html("<i class='fa fa-circle-o-notch fa-spin fa-fw cl-gray'></i>");if(g!=""){$(k).grid_load()}$.fire_event(p,[{page:i}],k)});$(".grid-more",k).appear(function(){var i=parseInt($(this).attr("data-page"));var p=$.val("onloadmore",j);$(this).html("<i class='fa fa-circle-o-notch fa-spinfa-fw cl-gray'></i>");if(g!=""){$(k).grid_load()}$.fire_event(p,[{page:i}],k)})}for(var n=0;n<c.length;n++){j.data.push(c[n])}$(k).data("options",j)})},grid_load:function(a){this.each(function(){var d=this;var h=$(d).data("options");var e=$.val("src",h,{d:""});var f=$.val("method",h,{d:"post"});if(e.length>0){var c=$.val("page",a,{d:1});var b=$.val("row_per_page",a,{d:10});var i=$.val("columns",h);var g={page:c,row_per_page:b,columns:i};if(f.toString().toLowerCase()=="get"){$.api_get(e,g,function(l){var j=$.val("data",l,{d:[]});var n=$.val("page",l,{d:1});var k=n==1?false:true;$(d).grid_val(j,k);var m=$.val("next_page",l,{d:n});if(m>n){$(".grid-footer",d).html("<div class='load-more align-center padding10'>Load More...</div>");$(".load-more",d).on("click",function(){$(d).grid_load({page:m})})}else{$(".grid-footer",d).html("")}})}else{$.api_post(e,g,function(l){var j=$.val("data",l,{d:[]});var n=$.val("page",l,{d:1});var k=n==1?false:true;$(d).grid_val(j,k);var m=$.val("next_page",l,{d:n});if(m>n){$(".grid-footer",d).html("<div class='load-more align-center padding10'>Load More...</div>");$(".load-more",d).on("click",function(){$(d).grid_load({page:m})})}else{$(".grid-footer",d).html("")}})}$(".grid-footer",this).html("<div class='align-center padding10'>Loading...</div>")}})},grid_val:function(b,a){if(typeof b=="undefined"){var b=[];this.each(function(){var c=this;var d=c.querySelector(".grid-body");var e=$("tbody",d);$(e).children().each(function(){if(this.classList.contains("grid-size")){}else{var f=$(this).attr("data-idx");var g=$.el_get(this);if(JSON.stringify(g).length>3){b.push(g)}}})});return b}else{this.each(function(){var k=this;var m=$(k).data("options");var c=$.val("onselect",m);var h=$.val("columns",m,{d:[]});var p=document.createElement("tbody");p.className="grid-content";p.innerHTML=$.grid_html(b,h);if(typeof a=="undefined"||a!==true){$(".grid-content",k).remove()}$(".grid-body",k).append(p);for(var o=0;o<p.childNodes.length;o++){var f=p.childNodes[o];var n=b[o];for(var l=0;l<f.childNodes.length;l++){var g=f.childNodes[l];var e=g.getAttribute("data-column-type");if(e=="html"){var d=h[l];var q=$.val("html",d,{d:""});$.fire_event(q,[n,d],g)}}}$("tr",p).on("click.gridrow",function(j){var i=$(this).closest("table");$(".active",i).removeClass("active");$(this).addClass("active");$.fire_event(c,[j,this],k)})})}},grid_get_selected_value:function(){var a=null;$(this).each(function(){var c=$(this).data("options");var d=$.val("data",c);var b=$("tr[class='active']").attr("data-idx");a=$.val(b,d)});return a}});$.extend({grid_html:function(h,c){if(!h){return}var l=[];for(var k=0;k<h.length;k++){var g=h[k];l.push("<tr>");for(var d=0;d<c.length;d++){var b=c[d];var r=$.val("type",b,{d:"text"});var q=$.val("datatype",b,{d:"text"});var p=$.val("name",b,{d:""});var a=$.val("align",b,{d:""});var o="";var f="";var n="";switch(r){case"html":break;default:switch(q){case"number":case"money":o="right";n=$.val(p,g,{d:0});n=$.number_format(n);break;case"enum":var e=$.val("enums",b,{d:{}});n=$.val(p,g,{d:"-"});n=$.val(n,e,{d:"-"});break;default:n=$.val(p,g,{d:"-"});break}var m=$.val("lettercase",b,{d:""});switch(m){case"capitalize":n=n.toString().capitalize();break;case"lowercase":n=n.toString().toLowerCase();break;case"uppercase":n=n.toString().toUpperCase();break}f="label";break}if(a!=""){o=a}l.push("<td data-column-type='"+r+"' class='"+f+"' style='text-align:"+o+"'>"+n+"</td>")}l.push("<td></td>");l.push("</tr>")}return l.join("")}});$.fn.extend({gridhead:function(g){var d=$.val("autoload",g,{d:true});var b=$.val("columns",g,{d:[]});var c=$.val("class",g,{d:null});var f=$.val("name",g,{d:""});var a=$.val("grid",g,{d:null});var e=$.val("height",g,{d:null});this.each(function(){var h=this;$(h).addClass("gridhead");$(h).addClass(c);$(h).attr("data-type","gridhead");if(f!=""){$(h).attr("data-name",f)}$(h).data("options",g);$(h).attr("data-type","gridhead");$(h).gridhead_attr({height:e});$(this).gridhead_set(b)})},gridhead_set:function(a){$(this).each(function(){var f=this;var k=$(this).data("options");var q=$.val("grid",k,{d:null});var c=$.val("oncolumnclick",k);k.columns=a;var m=[];m.push("<table class='grid-head'><tr>");for(var l=0;l<a.length;l++){var j=a[l];var b=$.val("name",j,{d:""});var e=$.val("active",j,{d:1});var g=$.val("text",j,{d:"-"});var p=$.val("width",j,{d:""});var d=$.val("datatype",j,{d:"text"});var h=$.val("align",j,{d:""});var n="";switch(d){case"number":case"money":n="right";break;case"enum":break;default:break}if(h!=""){n=h}var o="label"+(!e?" inactive":"");m.push("<td class='"+o+"' style='width:"+p+";text-align:"+n+"' data-key=\""+b+'">'+g+"<span class='separator'></span></span></td>")}m.push("<td style='width:100%'></td>");m.push("</tr></table>");$(f).html(m.join(""));$(".separator",f).mousedown(function(s){s.preventDefault();s.stopPropagation();var i=this.parentNode;var r=i.parentNode;var t=s.clientX;$(window).on("mousemove.gridhead",function(w){w.preventDefault();w.stopPropagation();var u=w.clientX-t;i.style.width=(parseInt(i.style.width)+u)+"px";t=w.clientX});$(window).on("mouseup.gridhead",function(w){w.preventDefault();w.stopPropagation();var z=$(q);var B=$(".grid-size",z);if(B.length==1){var y=-1;for(var u=0;u<r.childNodes.length;u++){if(r.childNodes[u]==i){y=u;break}}y=parseInt(y);$(".grid-size-label:eq("+(y)+")",B).css({width:$(i).outerWidth()});var x=$(f).data("options");x.columns[y]["width"]=$(i).outerWidth();var A=$.val("oncolumnresize",x);$.fire_event(A,[{index:y,width:$(i).outerWidth()}],f)}$(window).off("mousemove.gridhead");$(window).off("mouseup.gridhead")})});$(".separator",f).click(function(i){i.preventDefault();i.stopPropagation()});$(".label",f).on("click",function(r){r.preventDefault();r.stopPropagation();var i=$(this).attr("data-key");var s=$(this).attr("data-sorttype");if(s=="asc"){s="desc"}else{if(s=="desc"){s="asc"}else{s="asc"}}$(this).attr("data-sorttype",s);$.fire_event(c,[[{key:i,type:s}]],f)})})},gridhead_attr:function(a){$(this).each(function(){for(var b in a){var c=a[b];switch(b){case"height":$(this).css({height:c});break}}})},gridhead_modify_column:function(a){$(this).each(function(){if(!$(this).hasClass("gridhead")){return}var h=$(this).data("options");var k=$.val("grid",h);var g=$.val("columns",h);for(var e=0;e<g.length;e++){var n=g[e];var f=$.val("name",n,{d:""});var m=$.val("width",n,{d:""});if(f==""){continue}for(var d=0;d<a.length;d++){var c=a[d];var l=$.val("name",c,{d:""});var b=$.val("active",c,{d:1});if(f==l){if(b){$(".label[data-key='"+l+"']",this).removeClass("inactive");$(".grid-size-label[data-key='"+l+"']",$(k)).removeClass("inactive")}else{$(".label[data-key='"+l+"']",this).addClass("inactive");$(".grid-size-label[data-key='"+l+"']",$(k)).addClass("inactive")}h.columns[e]["active"]=b;column_exists=true}}}$(this).data("options",h)})}});$.fn.extend({gridsetting:function(b){var a=$.val("onchange",b);this.each(function(){var d=this;var c=[];c.push("<div class='modal-head'>");c.push("<div class='align-center padding10'>");c.push("<ul class='tab'>");c.push("<li class='active' data-value='presets'>Presets</li>");c.push("<li data-value='columns'>Columns</li>");c.push("<li data-value='filters'>Filters</li>");c.push("</ul>");c.push("</div>");c.push("</div>");c.push("<div class='modal-body padding20'>");c.push("<div class='cont12 space10 gridsetting-presets'>");c.push("<div class='lg12'><button class='blue preset-add-btn'><span class='fa fa-plus'></span> Add Preset...</button></div>");c.push("<div class='lg12'><span class='preset-grid'></span></div>");c.push("</div>");c.push("<div class='cont12 space10 gridsetting-columns' style='display:none'>");c.push("<div class='lg12'>");c.push("<button class='blue column-up-btn'><span class='fa fa-caret-up'></span>Up</button>");c.push("&nbsp;");c.push("<button class='blue column-down-btn'><span class='fa fa-caret-down'></span>Down</button>");c.push("</div>");c.push("<div class='lg6'><span class='column-grid'></span></div>");c.push("<div class='lg6'>");c.push("<div class='cont12 space10 gridsetting-column-detail'>");c.push("<div class='lg3 align-right'><label class='padding10'>Align</label></div>");c.push("<div class='lg9'><span class='gridsetting-column-align'></span></div>");c.push("<div class='lg3 align-right'><label class='padding10'>Name</label></div>");c.push("<div class='lg9'><label class='gridsetting-column-name padding10'></label></div>");c.push("<div class='lg3 align-right'><label class='padding10'>Text</label></div>");c.push("<div class='lg9'><span class='gridsetting-column-text'></span></div>");c.push("<div class='lg3 align-right'><label class='padding10'>Width</label></div>");c.push("<div class='lg9'><span class='gridsetting-column-width'></span></div>");c.push("</div>");c.push("</div>");c.push("</div>");c.push("<div class='cont12 space10 gridsetting-filters' style='display:none'>");c.push("<div class='lg12'><button class='blue filter-add-btn'><span class='fa fa-plus'></span> Add Filter...</button></div>");c.push("<div class='lg12'><span class='filter-grid'></span></div>");c.push("</div>");c.push("</div>");c.push("<div class='modal-foot'>");c.push("<button class='blue apply-btn'><span class='fa fa-save'></span> Apply Filter</button>");c.push("&nbsp;");c.push("<button class='close-btn'><span class='fa fa-times'></span> Close</button>");c.push("</div>");$(d).addClass("modal width800 gridsetting");$(d).html(c.join(""));$(".tab",d).tab({onchange:function(e){$(".modal-body",d).children().hide();$(".gridsetting-"+e.value,d).show()}});$(".preset-add-btn").click(function(){});$(".preset-grid",d).grid({"class":"transparent",columns:[{text:"",type:"html",html:"$.gridsetting_preset_option",width:"50px"},{text:"Preset Name",name:"text",width:"150px"}]});$(".column-grid",d).grid({"class":"transparent",columns:[{text:"Column Name",name:"text",width:"150px"},{text:"Width",name:"width",width:"100px"}],onselect:function(g){var e=$(this).closest(".gridsetting-columns");var f=$(".gridsetting-column-detail",e);$.el_set(f,g);$(".gridsetting-column-name",f).html($.val("name",g,{d:""}))}});$(".gridsetting-column-align",d).dropdown({name:"align",items:[{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]});$(".gridsetting-column-name",d).html("");$(".gridsetting-column-text",d).textbox({name:"text",onchange:function(h){var j=$(d).data("params");var g=$(this).closest(".gridsetting-column-detail");var e=$(".gridsetting-column-name",g).html();for(var f=0;f<j.presets[j.active_idx]["columns"].length;f++){if(j.presets[j.active_idx]["columns"][f]["name"]==e){j.presets[j.active_idx]["columns"][f]["text"]=h}}$(d).data("presets",j)}});$(".gridsetting-column-width",d).textbox({name:"width",onchange:function(h){var j=$(d).data("params");var g=$(this).closest(".gridsetting-column-detail");var e=$(".gridsetting-column-name",g).html();for(var f=0;f<j.presets[j.active_idx]["columns"].length;f++){if(j.presets[j.active_idx]["columns"][f]["name"]==e){j.presets[j.active_idx]["columns"][f]["width"]=h}}$(d).data("presets",j)}});$(".filter-add-btn",d).click(function(){$(".filter-grid",d).grid_add()});$(".filter-grid",d).grid({"class":"transparent",columns:[{text:"",type:"html",html:"$.gridsetting_grid_option",width:"50px"},{text:"Key",type:"html",html:"$.gridsetting_grid_key",width:"150px"},{text:"Operator",type:"html",html:"$.gridsetting_grid_opt",width:"150px"},{text:"Value",type:"html",html:"$.gridsetting_grid_val",width:"150px"}]});$(".apply-btn",d).click(function(){var e=$(".filter-grid",d).grid_value();var g=$(d).data("params");var f=parseInt($.val("active_idx",g,{d:0}));g.presets[f]["filters"]=e;$.fire_event(a,[g],d);$(d).modal_close()});$(".close-btn",d).click(function(){$(d).modal_close()})})},gridsetting_close:function(){$(this).modal_close()},gridsetting_open:function(b,a){this.each(function(){var e=$.val("presets",b);var d=b.presets[b.active_idx];var f=$.val("columns",b);var c=$.val("filters",b);$(this).data("params",b);$(this).data("columns",f);$(".preset-grid",this).grid_set(e);$(".column-grid",this).grid_set(f);$(".filter-grid",this).grid_set(c);$(this).modal_open({height:window.innerHeight*0.8})})}});$.extend({gridsetting_preset_option:function(a){$(this).html("<button class='preset-grid-options'><span class='fa fa-times'></span></button>");$(".preset-grid-options",this).click(function(){$(this).closest("tr").remove()})},gridsetting_grid_option:function(a){$(this).html("<button class='filter-grid-options'><span class='fa fa-times'></span></button>");$(".filter-grid-options",this).click(function(){$(this).closest("tr").remove()})},gridsetting_grid_type:function(a){$(this).html("<span class='filter-grid-type'></span>");$(".filter-grid-type",this).textbox({name:"type",value:$.val("type",a,{d:null})})},gridsetting_grid_key:function(d,b){var k=$(this).closest(".gridsetting");var c=$(k).data("params");var h=c.presets[c.active_idx];var b=c.columns;var f=[];if($.type(b)=="array"){for(var e=0;e<b.length;e++){var a=b[e];var j=$.val("name",a,{d:""});var g=$.val("text",a,{d:j});if(j.length>0){f.push({text:g,value:j})}}}$(this).html("<span class='filter-grid-key'></span>");$(".filter-grid-key",this).dropdown({name:"key",items:f,value:$.val("key",d,{d:null})})},gridsetting_grid_opt:function(a){$(this).html("<span class='filter-grid-opt'></span>");$(".filter-grid-opt",this).dropdown({name:"operator",items:[{text:"Contains",value:"contains"},{text:"Equals",value:"equals"}],value:$.val("operator",a,{d:null})})},gridsetting_grid_val:function(a){$(this).html("<span class='filter-grid-val'></span>");$(".filter-grid-val",this).textbox({name:"value",value:$.val("value",a,{d:null})})}});$.fn.extend({hidden:function(b){var a=$.val("name",b,{d:""});$(this).each(function(){var c=[];$(this).html(c.join(""));$(this).attr("data-type","hidden");$(this).attr("data-name",a);$(this).addClass("hidden");$(this).data("options",b)})},hidden_val:function(b){if(typeof b=="undefined"){var a=[];$(this).each(function(){a.push($(this).data("value"))});return a.length>1?a:(a.length==1?a[0]:"")}else{$(this).each(function(){$(this).data("value",b)})}}});$.fn.extend({image:function(a){var c=$.val("class",a,{d:""});var e=$.val("height",a,{d:"50px"});var f=$.val("name",a,{d:""});var d=$.val("value",a,{d:""});var b=$.val("width",a,{d:"50px"});this.each(function(){var h=this;var g=[];g.push('<img src="'+d+'"/>');$(h).attr("data-type","image");$(h).attr("data-name",f);$(h).addClass("image");$(h).addClass(c);$(h).html(g.join(""));$(h).data("options",a);$("img",h).css({width:b,height:e})})},image_val:function(b){if(typeof b=="undefined"){var a=[];this.each(function(){a.push($("img",this).attr("src"))});return a.length>1?a:(a.length==1?a[0]:"")}else{this.each(function(){$("img",this).attr("src",b)})}}});$.extend({layout_resize:function(){$(".layout-sidebar, .layout-main, .layout-ext",$(".layout")).css({height:window.innerHeight-$(".header").outerHeight()})}});$.fn.extend({layout:function(e){var b=$.val("class",e,{d:""});var a=$.val("size",e,{d:{}});var c=$.val("large",a,{d:"300px auto 400px"});var d=c.split(" ");$(this).each(function(){var h=$.val(0,d,{d:"200px"});var g="100%";var f=$.val(2,d,{d:"300px"});$(this).addClass("layout");$(this).addClass(b);$(".layout-sidebar",this).css({flex:"0 0 "+h});$(".layout-main",this).css({flex:"1 1 "+g});$(".layout-ext",this).css({flex:"0 0 "+f});$(".layout-sidebar, .layout-main, .layout-ext",this).css({height:window.innerHeight-$(".header").outerHeight()})});$(window).on("resize.layout",function(){$.layout_resize()})}});$.extend({layout2_resize:function(){$(".layout2").layout2_resize()}});$.fn.extend({layout2:function(c){var a=$.val("class",c,{d:""});var d=$.val("size",c,{d:"300px auto 400px"});var b=d.split(" ");$(this).each(function(){$(this).addClass("layout2");$(this).addClass(a);$(this).data("options",c);$(this).layout2_resize()});$(window).on("resize.layout",function(){$.layout2_resize()})},layout2_resize:function(){$(this).each(function(){var i=$(this).data("options");var a=$.val("onresize",i);var d=$.val("ext_hidden",i);var h=$.val("size",i,{d:"300px auto 400px"});var g=h.split(" ");var e=window.innerHeight-$(".header").outerHeight();var b=$.val(0,g,{d:"200px"});var c=$.val(2,g,{d:"300px"});var e=window.innerHeight-$(".header").outerHeight();c=$.calc_size(c,e);var f=e-c;$(".layout-sidebar",this).css({flex:"0 0 "+b,height:e});$(".layout-content",this).css({flex:"1 1 auto"});if(d==0){$(this).removeClass("ext-hidden");$(".layout-main",this).css({height:c});$(".layout-ext",this).css({height:f})}else{$(this).addClass("ext-hidden");$(".layout-main",this).css({height:e});$(".layout-ext",this).css({height:0})}$.fire_event(a,[],this)})},layout2_toggleext:function(a){$(this).each(function(){if(!$(this).hasClass("layout2")){return}var b=$(this).data("options");b.ext_hidden=a?0:1;$(this).data("options",b);$(this).layout2_resize()})},layout2_ext_state:function(){var a=0;$(this).each(function(){var b=$(this).data("options");a=$.val("ext_hidden",b,{d:-1})>0?0:1});return a}});$.fn.extend({modal_open:function(a){this.each(function(){var b=this;$(b).addClass("on");$(document.body).css({overflow:"hidden"});var e=$(b).outerHeight()-5-($(".modal-head",b).outerHeight()+$(".modal-foot",b).outerHeight());if(!isNaN(e)){$(".modal-body",b).css({height:e})}var c=$.val("reset",a,{d:false});if(c===true){$(b).reset()}var d=$.val("value",a,{d:null});if(d!=null){$(b).val(a.value)}})},modal_close:function(b,a){this.each(function(){var c=this;$(c).removeClass("on");$(".modal-bg").removeClass("on")});if($(".modal.on").length==0){$(document.body).css({overflow:""})}}});$.extend({popup_close:function(a){$(a).removeClass("on")},popup_open:function(a,b,i){$.popup_close_all();$(a).addClass("on");var e={};var d=$(b).offset();var h=d.left+a.clientWidth;var g=d.top-$(window).scrollTop()+$(b).outerHeight()+1;var f=window.innerHeight-g-10;e.top=g;e["max-height"]=f;if(h>window.innerWidth){d.left=window.innerWidth-a.clientWidth}e.left=d.left;var c=$.val("min_width",i);if(!isNaN(parseInt(c))){e["min-width"]=c}$(a).css(e)},popup_toggle:function(a,b,c){if(a.classList.contains("on")){$.popup_close(a,b,c)}else{$.popup_open(a,b,c)}},popup_close_all:function(){var a=document.body.querySelectorAll(".popup");for(var b=0;b<a.length;b++){$.popup_close(a[b])}}});$.fn.extend({radio:function(a){$(this).each(function(){var m=$.val("items",a,{d:null});var l=$.val("class",a,{d:""});var f=$.val("text",a,{d:""});var e=$.val("name",a,{d:""});var o=$.val("value",a,{d:""});var h=[];if($.type(m)=="array"){var k="radio-name-"+$.uniqid();for(var g=0;g<m.length;g++){var d=m[g];var c=d.text;var b=d.value;var n=o!=""&&o==b?true:false;var j="radio-"+$.uniqid();h.push("<input type='radio' id='"+j+"' value=\""+b+"\" name='"+k+"'"+(n?" checked":"")+"/>");h.push("<label for='"+j+"'>"+c+"</label>")}}else{var n=parseInt(o)==1||o===true?true:false;var j="radio-"+$.uniqid();h.push("<input type='radio' id='"+j+"'"+(n?" checked":"")+"/>");h.push("<label for='"+j+"'>"+f+"</label>")}$(this).addClass("radio");$(this).addClass(l);$(this).attr({"data-type":"radio"});$(this).html(h.join(""))})},radio_val:function(b){if(typeof b=="undefined"){var a=[];$(this).each(function(){var c=this.querySelectorAll("input");if(c.length==1){a.push(c[0].checked?1:0)}else{for(var d=0;d<c.length;d++){if(c[d].checked){a.push(c[d].value)}}}});a=a.join(",");return a}else{$(this).each(function(){var e=this.querySelectorAll("input");if(e.length==1){e[0].checked=(parseInt(b)==1||b===true)?true:false}else{var d=false;for(var c=0;c<e.length;c++){if(e[c].value==b){e[c].checked=true;d=true;break}}if(!d){$("input",this).attr("checked",false)}}})}}});$.extend({role_init:function(b){var a=typeof b!="undefined"&&b instanceof HTMLElement?b:document.body;$("*[data-role]",a).each(function(){var d=this.getAttribute("data-role");switch(d){case"modal.close":$(this).click(function(){$(this).closest(".modal").modal_close()});break;case"url.open":var c=$(this).attr("data-role-value");$(this).click(function(){window.location=c});break}})}});$.fn.extend({autocomplete:function(f){var b=$.val("class",f,{d:""});var e=$.val("name",f,{d:""});var d=$.val("src",f,{d:""});var a=$.val("width",f);var c=$.val("placeholder",f,{d:""});var g={};if(a!=null){g.width=a}this.each(function(){var i=this;var h=[];h.push("<input type='text' placeholder=\""+c+'"/>');h.push("<span class='icon fa fa-search hoverable selectable'></span>");h.push("<span class='popup'></span>");$(i).addClass("autocomplete");$(i).addClass(b);$(i).html(h.join(""));$(i).css(g);$(i).attr("data-name",e);$(i).attr("data-type","autocomplete");$(i).data("options",f);$("input[type='text']",i).on("keyup",function(n){var m=$(this).closest(".autocomplete");if($(m).hasClass("readonly")){return}var l=$(m).data("options");var k=$.val("readonly",l);if(!k&&d.length>0){var j={};j.key=this.value;$.api_get(d,j,function(s){var p=$.val("data",s);var o=[];if($.type(p)=="array"){for(var u=0;u<p.length;u++){var r=p[u];var t=$.val("value",r,{d:""});var q=$.val("text",r,{d:t});o.push("<div class='item' data-value=\""+t+'">');o.push("<label>"+q+"</label>");o.push("</div>")}}$(".popup",m).html(o.join(""));$(".item",$(".popup",m)).on("click",function(){var x=this.getAttribute("data-value");var w=$("label",this).text();var y={value:x,text:w};$(m).autocomplete_val(y)});$.popup_open($(".popup",m),m,{min_width:$(m).outerWidth()})})}})})},autocomplete_val:function(a,b){if(typeof a=="undefined"){var c=[];$(this).each(function(){var d=$(this).data("options");var f=$.val("multiple",d,{d:false});if(f){$(".text",this).each(function(){c.push(this.getAttribute("data-value"))})}else{var e=$("input",this).val();var g=$(this).data("value");if(g==null){g=e}c.push(g)}});return c.length==1?c[0]:(c.length>1?c:"")}else{$(this).each(function(){var d=$(this).data("options");var h=$.val("multiple",d,{d:false});var e=c="";if($.type(a)=="object"){c=$.val("value",a,{d:""});e=$.val("text",a,{d:c})}else{e=c=a}if(h){var g=typeof b!="undefined"&&b===true?true:false;if(g){$(".text",this).remove()}var f=$(this).val();if(!$.in_array(c,f)&&c!==""){$("<span class='text' data-value=\""+c+'">'+e+"<span class='icon-remove glyphicons glyphicons-remove'></span></span>").insertBefore($("input",this));$(".glyphicons-remove",$("input",this).prev()).on("click",function(){$(this).parent().remove()})}$("input",this).val("")}else{$("input",this).val(e);$(this).data("value",c)}})}},autocomplete_readonly:function(a){if(typeof a=="undefined"){return $(this).hasClass("readonly")?true:false}else{if(a){$(this).addClass("readonly");$("input",this).attr("readonly",true);$("input",this).data("placeholder",$("input",this).attr("placeholder"));$("input",this).attr("placeholder","")}else{$(this).removeClass("readonly");$("input",this).attr("readonly",false);$("input",this).attr("placeholder",$("input",this).data("placeholder"))}}},autocomplete_reset:function(){$(this).autocomplete_val("",true)}});$.fn.extend({calendar:function(a){this.each(function(){var c=this;var d=$.val("value",a,{d:"2017-01-01"});d=$.date("j M Y",$.strtotime(d));var b=[];b.push("<input type='text' value='"+d+"' readonly/>");b.push("<span class='icon fa fa-calendar'></span>");b.push("<span class='popup'>Calendar</span>");$(c).addClass("calendar");$(c).html(b.join(""));$(c).attr("data-type","calendar");$(".icon",this).click(function(e){e.preventDefault();e.stopPropagation()});$(".popup",this).click(function(e){e.preventDefault();e.stopPropagation()})})}});$.extend({calendar_open:function(b){var d=b.refEl;var a=b.value;var c=$("#calendar");if(c.length==0){c=document.createElement("div");c.id="calendar";c.className="popup";document.body.appendChild(c);c=$("#calendar")}c=c[0];$(c).data("params",b);$.calendar_set(a);$.popup_open(c,d)},calendar_set:function(c){var a=$("#calendar").data("params");var b=$.val("type",a,{d:""});switch(b){case"range":$.calendar_set_range(c);break;default:$.calendar_set_single(c);break}},calendar_set_single:function(c){var b=$("#calendar");$(b).attr("data-value",c);var p=$.date("n",$.strtotime(c));var a=$.date("Y",$.strtotime(c));var e=$.date("j",$.strtotime(c));var o=$.start_day_of_month(a,p)%7;var f=$.last_date_of_month(a,p);var g=$.date("M Y",$.strtotime(c));var k=$(b).data("params");var h=k.onchange;var n=[];n.push("<table>");n.push("<tr>");n.push("<td><span class='calendar-prev fa fa-caret-left padding5'></span></td>");n.push("<td colspan='5'><span class='date-label'>"+g+"</span></td>");n.push("<td><span class='calendar-next fa fa-caret-right padding5'></span></td>");n.push("</tr>");n.push("<tr>");n.push("<td>Sun</td>");n.push("<td>Mon</td>");n.push("<td>Tue</td>");n.push("<td>Wed</td>");n.push("<td>Thu</td>");n.push("<td>Fri</td>");n.push("<td>Sun</td>");n.push("</tr>");var d=1;for(var m=0;m<6;m++){n.push("<tr>");for(var l=0;l<7;l++){if(o>0){n.push("<td></td>");o--}else{if(d<=f){n.push(d==e?"<td class='day active'>"+d+"</td>":"<td class='day'>"+d+"</td>");d++}else{n.push("<td></td>")}}}n.push("</tr>")}n.push("</table>");b.html(n.join(""));$(".day",b).click(function(t){t.preventDefault();t.stopPropagation();var u=$(this).closest("#calendar");var q=$(u).attr("data-value");var i=this.innerHTML;var s=parseInt($.date("n",$.strtotime(q)));var r=$.date("Y",$.strtotime(q));var j=$.date("j M Y",$.mktime(0,0,0,s,i,r));$.fire_event(h,[j],u);$.popup_close(u)});$(".calendar-prev",b).click(function(s){s.preventDefault();s.stopPropagation();var t=$(this).closest("#calendar");var i=$(t).attr("data-value");var r=parseInt($.date("n",$.strtotime(i)));var q=parseInt($.date("Y",$.strtotime(i)));var j=parseInt($("td.active",t).html());var u=$.date("Y-m-d",$.mktime(0,0,0,r-1,j,q));$.calendar_set(u)});$(".calendar-next",b).click(function(s){s.preventDefault();s.stopPropagation();var t=$(this).closest("#calendar");var i=$(t).attr("data-value");var r=parseInt($.date("n",$.strtotime(i)));var q=parseInt($.date("Y",$.strtotime(i)));var j=parseInt($("td.active",t).html());var u=$.date("Y-m-d",$.mktime(0,0,0,r+1,j,q));$.calendar_set(u)})},calendar_set_range:function(l,w,e){var b=$("#calendar");$(b).attr("data-value",l);var z=$(b).data("params");var y=z.onchange;l=l.split("-");var a=l[0];var q=l[1];if($.date("Y",$.strtotime(a))=="1970"){a=$.date("Y-m-d")}if($.date("Y",$.strtotime(q))=="1970"){q=$.date("Y-m-d")}var x=[],m=[],s=[],d=[],u=[],c=[],h=[];var p=$.date("Y",$.strtotime(w))!="1970"?w:a;var n=$.date("Y",$.strtotime(e))!="1970"?e:q;if($.date("Ym",$.strtotime(n))==$.date("Ym",$.strtotime(p))){n=$.date("Y-m-d",$.mktime(0,0,0,parseInt($.date("n",$.strtotime(n)))+1,$.date("j",1,$.date("Y",$.strtotime(n)))))}x[0]=$.date("n",$.strtotime(p));m[0]=$.date("m",$.strtotime(p));s[0]=$.date("Y",$.strtotime(p));d[0]=$.date("j",$.strtotime(p));u[0]=$.start_day_of_month(s[0],x[0])%7;c[0]=$.last_date_of_month(s[0],x[0]);h[0]=$.date("M Y",$.strtotime(p));x[1]=$.date("n",$.strtotime(n));m[1]=$.date("m",$.strtotime(n));s[1]=$.date("Y",$.strtotime(n));d[1]=$.date("j",$.strtotime(n));u[1]=$.start_day_of_month(s[1],x[1])%7;c[1]=$.last_date_of_month(s[1],x[1]);h[1]=$.date("M Y",$.strtotime(n));var g=[];for(var t=0;t<2;t++){g.push("<table class='calendar-table range-"+t+"'>");g.push("<tr>");g.push($.p("<td><span class='calendar-prev fa fa-caret-left padding5' data-calendaridx='$i'></span></td>",[t]));g.push("<td colspan='5'><span class='date-label'>"+h[t]+"</span></td>");g.push($.p("<td><span class='calendar-next fa fa-caret-right padding5' data-calendaridx='$i'></span></td>",[t]));g.push("</tr>");g.push("<tr>");g.push("<td>Sun</td>");g.push("<td>Mon</td>");g.push("<td>Tue</td>");g.push("<td>Wed</td>");g.push("<td>Thu</td>");g.push("<td>Fri</td>");g.push("<td>Sun</td>");g.push("</tr>");var A=1;for(var r=0;r<6;r++){g.push("<tr>");for(var o=0;o<7;o++){if(u[t]>0){g.push("<td></td>");u[t]--}else{if(A<=c[t]){var f=$.date("Y-m-d",$.strtotime(s[t]+"-"+m[t]+"-"+$.str_pad(A,2,"0","STR_PAD_LEFT")));if($.strtotime(f)>=$.strtotime(a)&&$.strtotime(f)<=$.strtotime(q)){g.push("<td class='day active' data-date='"+f+"'>"+A+"</td>")}else{g.push("<td class='day' data-date='"+f+"'>"+A+"</td>")}A++}else{g.push("<td></td>")}}}g.push("</tr>")}g.push("</table>")}b.html(g.join(""));b.data("seq",0);$(".day",b).click(function(H){H.preventDefault();H.stopPropagation();console.log("value: "+1);var E=$(this).closest("#calendar");var G=$(E).attr("data-value");var F=this.innerHTML;var I=parseInt($.date("n",$.strtotime(G)));var i=$.date("Y",$.strtotime(G));var J=$.date("j M Y",$.mktime(0,0,0,I,F,i));var C=parseInt(E.data("seq"));if(C==0){$(".day.active-0").removeClass("active active-0");$(this).addClass("active active-0");var D=$(this).attr("data-date");var j=$(E).attr("data-value");j=j.split(",");var B=$.val(1,j,{d:D});$(".day",E).each(function(){var K=$(this).attr("data-date");if($.strtotime(K)>=$.strtotime(D)&&$.strtotime(K)<=$.strtotime(B)){$(this).addClass("active")}else{$(this).removeClass("active")}})}else{$(".day.active-1").removeClass("active active-1");$(this).addClass("active active-1")}E.data("seq",C+1);if(C==1){var D=$(".day.active-0").attr("data-date");var B=$(".day.active-1").attr("data-date");if($.strtotime(D)>$.strtotime(B)){var k=D;D=B;B=k}var j=$.date("Ymd",$.strtotime(D))+"-"+$.date("Ymd",$.strtotime(B));$.popup_close(E);$.fire_event(y,[j],E)}});$(".calendar-prev",b).click(function(j){var i=parseInt($(this).attr("data-calendaridx"));console.log(["prev",l,parseInt($(this).attr("data-calendaridx")),p,n]);j.preventDefault();j.stopPropagation();if(i==0){p=$.date("Y-m-d",$.mktime(0,0,0,parseInt($.date("n",$.strtotime(p)))-1,$.date("j",$.strtotime(p)),$.date("Y",$.strtotime(p))))}else{if(i==1){n=$.date("Y-m-d",$.mktime(0,0,0,parseInt($.date("n",$.strtotime(n)))-1,$.date("j",$.strtotime(n)),$.date("Y",$.strtotime(n))));if($.date("Ym",$.strtotime(p))>=$.date("Ym",$.strtotime(n))){p=$.date("Y-m-d",$.mktime(0,0,0,parseInt($.date("n",$.strtotime(p)))-1,$.date("j",$.strtotime(p)),$.date("Y",$.strtotime(p))))}}}$.calendar_set_range(l.join(","),p,n)});$(".calendar-next",b).click(function(j){var i=parseInt($(this).attr("data-calendaridx"));j.preventDefault();j.stopPropagation();if(i==0){p=$.date("Y-m-d",$.mktime(0,0,0,parseInt($.date("n",$.strtotime(p)))+1,$.date("j",$.strtotime(p)),$.date("Y",$.strtotime(p))));if($.date("Ym",$.strtotime(n))<=$.date("Ym",$.strtotime(p))){n=$.date("Y-m-d",$.mktime(0,0,0,parseInt($.date("n",$.strtotime(n)))+1,$.date("j",$.strtotime(n)),$.date("Y",$.strtotime(n))))}}else{if(i==1){n=$.date("Y-m-d",$.mktime(0,0,0,parseInt($.date("n",$.strtotime(n)))+1,$.date("j",$.strtotime(n)),$.date("Y",$.strtotime(n))))}}$.calendar_set_range(l.join(","),p,n)})}});$.fn.extend({chart:function(a){var d=$.val("name",a);var c=$.val("height",a);var b=$.val("width",a);this.each(function(){var f=this;var e={};e.height=c;e.width=b;var g=[];$(f).addClass("chart");$(this).html(g.join(""));$(this).css(e);$(f).attr("data-type","chart");$(f).attr("data-name",d);$(f).data("options",a)})},chart_set:function(a){this.each(function(){var d=this;var b=$(d).data("options");var c=$.val("type",b,{default_value:"line"});switch(c){case"bar":$(this).chart_bar_set(a);break;default:$(this).chart_line_set(a);break}})},chart_bar_set:function(a){this.each(function(){var B=this;var F=$(B).data("options");var q=$(B).outerHeight();var H=$(B).outerWidth();var o=$.val("padding",F,{default_value:10});var i=$.array_key_count(a);var I=$.object_value_min(a);var m=$.object_value_max(a);var t=o;var c=H-o;var r=c-t;var k=(H*0.8)/i;var G=(r-(k*i))/(i+1);var z=q-o;var A=10;var C=z-A;var b=C/(m-I);var j=[];j.push($.p('<svg width="$1" height="$2">',[H,q]));var p=t;var n=c;var E=z,D=z;j.push($.p('<line x1="$x1" y1="$y1" x2="$x2" y2="$y2" style="stroke:rgb(0,0,0);stroke-width:1" />',[p,E,n,D]));var e=0;for(var u in a){var s=a[u];var g=k;var l=b*s;if(l<5){l=5}var f=e*(G+k)+G;var d=z-l;j.push($.p('<rect x="$1" y="$1" width="$1" height="$1" stroke="#4A89DC" stroke-width="2" fill="rgba(74, 137, 220, .2)" data-key="$1" data-value="$1" onmouseover="$1" onmouseout="$1"/>',[f,d,g,l,u,s,"$.chart_line_mouseover.call(this)","$.chart_line_mouseout.call(this)"]));e++}j.push("</svg>");$(B).html(j.join(""))})},chart_line_set:function(a){this.each(function(){var A=this;var f=$(A).data("options");var o=$(A).outerHeight();var t=$(A).outerWidth();var u=$.array_key_count(a);var g=$.object_value_min(a);var l=$.object_value_max(a);var m=$.val("padding",f,{default_value:10});var q=m;var i=t-m;var z=i-q;var C=z/(u-1);var r=o-m;var s=10;var B=r-s;var h=B/(l-g);var k=[];k.push($.p('<svg width="$1" height="$2">',[t,o]));var x=q;var w=i;var e=r,b=r;k.push($.p('<line x1="$x1" y1="$y1" x2="$x2" y2="$y2" style="stroke:rgb(0,0,0);stroke-width:1" />',[x,e,w,b]));var j=1;for(var p in a){var c=Math.round(q+(j*C));k.push($.p('<line x1="$1" y1="$1" x2="$1" y2="$1" style="stroke:rgba(0, 0, 0, .05);stroke-width:1" />',[c,r,c,s]));j++}var j=0;var y=[];y.push($.p("M$1 $2",[Math.round(q+(j*C)),r]));for(var p in a){var n=a[p];var c=Math.round(q+(j*C));var D=Math.round(r-(n*h));y.push($.p("L$1 $2",[c,D]));j++}y.push($.p("M$1 $2 Z",[c,r]));k.push($.p('<path d="$1" stroke-width="0" stroke="transparent" fill="rgba(74, 137, 220, .2)"/>',[y.join(" ")]));var j=0;var y=[];for(var p in a){var n=a[p];var c=Math.round(q+(j*C));var D=Math.round(r-(n*h));if(j==0){y.push($.p("M$1 $2",[c,D]))}else{y.push($.p("L$1 $2",[c,D]))}j++}k.push($.p('<path d="$1" stroke-width="2" stroke="#4A89DC" fill="transparent"/>',[y.join(" ")]));var j=0;for(var p in a){var n=a[p];var c=q+(j*C);var D=r-(n*h);k.push($.p('<circle cx="$1" cy="$1" r="1" stroke="#4A89DC" stroke-width="2" fill="#4A89DC" onmouseover="$1" onmouseout="$1" data-key="$1" data-value="$1"/>',[c,D,"$.chart_line_mouseover.call(this)","$.chart_line_mouseout.call(this)",p,n]));j++}k.push("</svg>");$(A).html(k.join(""))})}});$.extend({chart_line_mouseover:function(){$(this).attr({r:2});var a=$(this).attr("data-key");var b=$(this).attr("data-value");$.tooltip(this,a+"<br />"+b)},chart_line_mouseout:function(){$(this).attr({r:1});$.tooltip_remove()}});$.fn.extend({checkbox:function(a){this.each(function(){var e=$.val("class",a,{d:""});var c=$.val("items",a,{d:null});var d=[];if($.type(c)=="array"){$(c).each(function(){var j=$.val("text",this,{d:""});var i=$.val("value",this,{d:""});var h="checkbox-"+$.uniqid();d.push("<span class='item'><input id='"+h+"' type='checkbox' value=\""+i+"\"/><label for='"+h+"'>"+j+"</label></span>")})}else{var g=$.val("text",a,{d:""});var f="";var b="checkbox-"+$.uniqid();d.push("<span class='item'><input id='"+b+"' type='checkbox' value=\""+f+"\"/><label for='"+b+"'>"+g+"</label></span>")}$(this).addClass("checkbox");$(this).addClass(e);$(this).html(d.join(""));$(this).data("options",a)})}});$.fn.extend({checklist:function(a){$(this).each(function(){var b=this;var c=[];c.push("<div class='checklist-body'>");c.push("<div class='checklist-item'>");c.push("<input type='checkbox' />");c.push("<input type='text' />");c.push("<span class='iconbar'>");c.push("<span class='checklist-remove fa fa-times padding5 selectable'></span>");c.push("</span>");c.push("</div>");c.push("</div>");c.push("<div class='checklist-foot'>");c.push("<span class='checklist-add fa fa-plus-circle padding5 selectable hoverable'></span>");c.push("</div>");$(this).addClass("checklist");$(this).html(c.join(""));$(".checklist-add",this).click(function(){$(b).checklist_add()});$(".checklist-remove",this).on("click.checklist",function(){$(this).closest(".checklist-item").remove()})})},checklist_add:function(){$(this).each(function(){var a=[];a.push("<div class='checklist-item'>");a.push("<input type='checkbox' />");a.push("<input type='text' />");a.push("<span class='iconbar'>");a.push("<span class='checklist-remove fa fa-times padding5 selectable hoverable'></span>");a.push("</span>");a.push("</div>");$(".checklist-body",this).append(a.join(""));$(".checklist-remove",$(".checklist-body",this)).on("click.checklist",function(){$(this).closest(".checklist-item").remove()})})},checklist_get:function(){var a=[];$(this).each(function(){$(".checklist-item",this).each(function(){var b=$("input[type='checkbox']",this)[0].checked;var c=$("input[type='text']",this).val();if(c.length>0){a.push({checked:b,text:c})}})});return a.length==0?null:a},checklist_set:function(a){$(this).checklist_attr({value:a})},checklist_attr:function(a){if($.type(a)!="object"){return}$(this).each(function(){for(var b in a){var f=a[b];switch(b){case"readonly":if(f){$("input[type='checkbox']",this).attr("disabled",true);$("input[type='text']",this).attr("readonly",true);$(".checklist-remove",this).addClass("hidden");$(".checklist-add",this).addClass("hidden")}else{$("input[type='checkbox']",this).attr("disabled",false);$("input[type='text']",this).attr("readonly",false);$(".checklist-remove",this).removeClass("hidden");$(".checklist-add",this).removeClass("hidden")}break;case"value":var h=[];if($.type(f)=="array"){for(var d=0;d<f.length;d++){var e=f[d];var g=$.val("text",e,{d:""});var c=$.val("checked",e,{d:false});if(g==""){continue}h.push("<div class='checklist-item'>");h.push("<input type='checkbox'"+(c?" checked":"")+"/>");h.push("<input type='text' value=\""+g+'" />');h.push("<span class='iconbar'>");h.push("<span class='checklist-remove fa fa-times padding5 selectable hoverable'></span>");h.push("</span>");h.push("</div>")}}h.push("<div class='checklist-item'>");h.push("<input type='checkbox'/>");h.push("<input type='text'/>");h.push("<span class='iconbar'>");h.push("<span class='checklist-remove fa fa-times padding5 selectable hoverable'></span>");h.push("</span>");h.push("</div>");$(".checklist-body",this).html(h.join(""));$(".checklist-remove",$(".checklist-body",this)).on("click.checklist",function(){$(this).closest(".checklist-item").remove()});break}}})}});$.fn.extend({choice:function(a){$(this).each(function(){var d=$.val("class",a,{d:""});var c=$.val("items",a,{d:[],datatype:"array"});var b=[];if($.type(c)=="array"){for(var h=0;h<c.length;h++){var e=c[h];var f=$.val("value",e,{d:""});var g=$.val("text",e,{d:f});if(f.length==0){continue}b.push($.p('<span class="item">'));b.push($.p("</span>"))}}$(this).addClass("choice");$(this).addClass(d)})}});$.fn.extend({codeeditor:function(a){var d=$.val("height",a,{d:"200px"});var b=$.val("width",a,{d:"300px"});var e=$.val("name",a,{d:""});var c=$.val("value",a,{d:"300px"});this.each(function(){var f=$.uniqid();var h=[];h.push($.p('<textarea id="$1""></textarea>',["codeeditor-text-"+f]));$(this).addClass("codeeditor");$(this).html(h.join(""));$(this).css({width:b,height:d});$(this).codeeditor_attr({name:e});var g=CodeMirror.fromTextArea(document.getElementById("codeeditor-text-"+f),{lineNumbers:true,mode:"text/x-mariadb",indentWithTabs:true,smartIndent:true,matchBrackets:true,autofocus:true})})},codeeditor_get:function(){var a=[];$(this).each(function(){a.push($("textarea",this).val())});return a.length==1?a[0]:(a.length>1?a:"")},codeeditor_set:function(a){$(this).each(function(){$("textarea",this).val(a)})},codeeditor_attr:function(a){this.each(function(){var d={};var e={};var b={};for(var c in b){var f=b[c];switch(c){case"name":b.name=f}}$(this).attr(b);$(this).css(d);$("textarea",this).css(e)})}});$.fn.extend({codefield:function(a){var d=$.val("placeholder",a,{d:""});var f=$.val("name",a,{d:""});var e=$.val("height",a);var c=$.val("width",a);var b={width:c,height:e};this.each(function(){var h=this;var g=[];g.push("<pre style='height:"+e+";'>"+JSON.stringify({name:"andy"},null,2)+"</pre>");g.push("<span class='icon fa hidden'></span>");$(h).addClass("codefield");$(h).css(b);$(h).html(g.join(""));$(h).attr("data-type","codefield");$(h).attr("data-name",f);$(h).data("options",a)})},codefield_get:function(){var a=[];this.each(function(){var b=$("pre",this).html();a.push(b)});return a.length>1?a:(a.length==1?a[0]:"")},codefield_set:function(a){this.each(function(){$("pre",this).html(a)})}});$.fn.extend({commentlist:function(b){var a=$.val("onsubmit",b);$(this).each(function(){var c=this;var d=[];d.push("<div class='commentlist-write'>");d.push("<input type='text' placeholder='Write comment here...' />");d.push("</div>");d.push("<div class='commentlist-list'></div>");$(this).addClass("commentlist");$(this).html(d.join(""));$(this).data("options",b);$("input[type='text']",this).on("keyup",function(f){if(f.keyCode==13){if(f.shiftKey){}else{if(this.value!=""){$.fire_event(a,[this.value],c);this.value="";$(this).blur()}}}})})},commentlist_add:function(a){$(this).each(function(){var g=$(this).data("options");var i=$.val("onremove",g);var f=$.val("id",a);var e=$.val("comment",a);var d=$.val("full_name",a);var b=$.val("createdon",a);var c=$.val("removable",a,{d:0});if(!e||!d){return}var h=[];h.push("<div class='commentlist-item' data-id='"+f+"'>");h.push("<p style='word-wrap: break-word;'><b>"+d+"</b> "+e+"</p>");h.push("<div class='commentlist-item-footer'>");h.push("<label class=''>"+b+"</label>");if(c){h.push("<span class='width5 height5'>&nbsp;</span>");h.push("<span class='comment-item-remove selectable hoverable'>Remove</span>")}h.push("</div>");h.push("</div>");$(".commentlist-list",this).append(h.join(""));$(".comment-item-remove",$(".commentlist-list",this)).on("click",function(){var j=$(this).closest(".commentlist-item").attr("data-id");$.fire_event(i,[j],this)})})},commentlist_set:function(a){$(this).each(function(){var j=$(this).data("options");var c=$.val("onremove",j);var e=[];if($.type(a)=="array"){for(var d=0;d<a.length;d++){var b=a[d];var l=$.val("id",b);var f=$.val("comment",b);var g=$.val("full_name",b);var h=$.val("createdon",b);var k=$.val("removable",b,{d:0});if(!f||!g){continue}e.push("<div class='commentlist-item' data-id='"+l+"'>");e.push("<p style='word-wrap: break-word;'><b>"+g+"</b> "+f+"</p>");e.push("<div class='commentlist-item-footer'>");e.push("<label class=''>"+h+"</label>");if(k){e.push("<span class='width5 height5'>&nbsp;</span>");e.push("<span class='comment-item-remove selectable hoverable'>Remove</span>")}e.push("</div>");e.push("</div>")}}$(".commentlist-list",this).html(e.join(""));$(".comment-item-remove",$(".commentlist-list",this)).on("click",function(){var i=$(this).closest(".commentlist-item").attr("data-id");$.fire_event(c,[i],this)})})}});$.fn.extend({container_val:function(a){if(typeof a=="undefined"){result={};$("*[data-type]",this).each(function(){var b=this.getAttribute("data-name");if(b!=null&&b!=""){var c=$(this).val();result[b]=c}});return result}else{$("*[data-type]",this).each(function(){var b=this.getAttribute("data-name");if(b!=null&&b!=""){var c=$.val(b,a,{d:""});$(this).val(c)}})}},container_reset:function(){$("*[data-type]",this).each(function(){var a=$(this).attr("data-type");if(a!=null&&typeof $(this)[a+"_reset"]!="undefined"){$(this)[a+"_reset"].apply(this,arguments)}})}});$.fn.extend({datepicker:function(a){var b=$.val("type",a);this.each(function(){var d=this;var c=[];c.push("<input type='text' readonly/>");c.push("<span class='icon fa fa-calendar'></span>");$(d).addClass("datepicker");$(d).html(c.join(""));$(d).attr("data-type","datepicker");$(d).data("options",a);$(".icon",this).click(function(i){i.preventDefault();i.stopPropagation();var h=$(this).closest(".datepicker");var g=$(h).data("options");var f=$.val("readonly",g,{d:false});if(f=="0"||f==false){$.calendar_open({refEl:h,value:$(h).data("value"),type:b,onchange:function(e){$(h).datepicker_val(e)}})}});$(".popup",this).click(function(f){f.preventDefault();f.stopPropagation()});$(this).datepicker_val($.val("value",a,{d:"20170101"}))})},datepicker_val:function(a){if(typeof a=="undefined"){var a=[];$(this).each(function(){var b=$(this).data("value");a.push(b)});return a.length==1?a[0]:(a.length==0?null:a)}else{$(this).each(function(){var f="";a=$.date_parse(a);if(a.indexOf("-")>=0){var e=a.split("-");var c=$.date("M j, Y",$.strtotime(e[0]));var b=$.date("M j, Y",$.strtotime(e[1]));f=c+" - "+b}else{var e=$.date("M j, Y",$.strtotime(a));f=e}$("input",this).val(f);$(this).data("value",a)})}}});$.fn.extend({dropdown:function(h){var c=$.val("class",h,{d:""});var j=$.val("name",h,{d:""});var g=$.val("defaultvalue",h,{d:""});var f=$.val("value",h,{d:g});var d=$.val("items",h,{d:[]});var a=$.val("width",h,{d:[]});var i=$.val("src",h,{d:""});var e=$.val("placeholder",h,{d:""});var b=[];b.push("<input class='text' type='text' placeholder=\""+e+'" readonly/>');b.push("<span class='icon fa fa-caret-down hoverable'></span>");b.push("<span class='popup'></span>");this.each(function(){var k=this;$(k).addClass("dropdown");$(k).addClass(c);$(k).html(b.join(""));$(k).data("options",h);$(k).attr("data-type","dropdown");$(k).attr("data-name",j);$(k).dropdown_attr(h);$(".icon, .text",k).click(function(n){n.preventDefault();n.stopPropagation();var m=$(this).closest(".dropdown");var l=$(m).data("options");var o=$.val("readonly",l);if(!o){if($(".popup",m).hasClass("on")){$.popup_close($(".popup",m))}else{$.popup_open($(".popup",m),m,{min_width:$(m).outerWidth()});$(".search-item input",$(".popup",m)).val("");$(".search-item input",$(".popup",m)).focus();$(".item",$(".popup",m)).show()}}});if(f!=""){$(k).dropdown_val()}if(i.length>0){$(this).dropdown_load()}})},dropdown_val:function(a,c){if(typeof a=="undefined"){var b=[];this.each(function(){var f=this;var d=$(f).attr("data-value");var e=$("input",f).length==1?$("input",f).val():$(".text",f).html();d=d==null?e:d;b.push(d)});return b.length==1?b[0]:(b.length>1?b:null)}else{this.each(function(){var g=$(this).data("options");var f=$.val("items",g,{d:[]});var e="";var d="";if($.type(a)=="object"){d=$.val("value",a);e=$.val("text",a,{d:d})}else{if($.type(d)=="string"){e=d=a}}if($.type(f)=="array"){for(var h=0;h<f.length;h++){var j=f[h];if(j.value==d){e=j.text;d=j.value;break}}}$(this).attr("data-value",d);$("input",this).val(e);$(".text",this).html(e)})}},dropdown_items:function(a){if(typeof a=="undefined"){var b=[];this.each(function(){var d=this;var c=$(d).data("options");var e=$.val("items",c,{d:[]});$(e).each(function(){if($.type(this)=="object"){b.push(this)}})});return b}else{this.each(function(){var g=this;var h=$(g).data("options");var o=$.val("searchable",h,{d:false});var j=$.val("multiple",h,{d:false});var k=$.val("onchange",h);var m=[];if(o==true){m.push("<div class='search-item'>");m.push("<input type='text' placeholder='Search'/>");m.push("</div>")}if($.type(a)=="array"){for(var l=0;l<a.length;l++){var e=a[l];var d=e.text;var c=e.value;var f=(d+" "+c).toLowerCase();var n=$.uniqid();m.push("<div class='item' data-value=\""+c+'" data-search="'+f+'">');if(j){m.push("<input type='checkbox' id='dropdown_item_checkbox_"+n+"'/>")}m.push("<label for='dropdown_item_checkbox_"+n+"'>"+d+"</label>");m.push("</div>")}}m=m.join("");$(".popup",g).html(m);$(g).data("options",h);$(".item",$(".popup",g)).click(function(p){if(j){p.stopPropagation()}var s=$("label",this).html();var r=$(this).attr("data-value");var i=-1;var w=null;for(var x=0;x<a.length;x++){var t=a[x];var q=$.val("text",t);var u=$.val("value",t);if(u==r||q==s){i=x;w=t;break}}if(w){w._index=i}$("input",g).val(s);$(".text",g).html(s);$(g).attr("data-value",r);$.fire_event(k,[p,w],g)});$(".item>input[type='checkbox']",$(".popup",g)).on("change",function(){var i=this.nextElementSibling.innerHTML;var p=this.parentNode.getAttribute("data-value");$(g).dropdown_val({text:i,value:p},true)});$(".popup .search-item input",g).click(function(i){i.preventDefault();i.stopPropagation()});$(".popup .search-item input",g).keyup(function(p){var i=this.value;var q=$(this).closest(".popup");$(".item",q).show();if(i.length>0){$(".item:not([data-search*='"+i+"'])",q).hide()}});h.items=a;$(g).data("options",h);$(g).dropdown_val("*")})}},dropdown_attr:function(a){this.each(function(){var b=$(this).data("options");if($.type(a)=="object"){for(var d in a){var e=a[d];var c={};switch(d){case"items":$(this).dropdown_items(e);break;case"readonly":if(e){$(this).addClass("readonly");b.readonly=true}else{$(this).removeClass("readonly");b.readonly=false}break;case"value":$(this).dropdown_val(e);break;case"width":c.width=parseInt(e);break}$(this).css(c)}}$(this).data("options",b)})},dropdown_load:function(){this.each(function(){var c=this;var b=$(c).data("options");var a=$.val("src",b,{d:""});$.api_post(a,{},function(d){var e=$.val("data",d);if($.type(e)=="array"){$(c).dropdown_items(e)}})})},dropdown_reset:function(){$(this).each(function(){var a=$(this).data("options");var b=$.val("defaultvalue",a,{d:""});$(this).dropdown_val(b)})},dropdown_readonly:function(a){$(this).each(function(){if($.istrue(a)){$(this).addClass("readonly")}else{$(this).removeClass("readonly")}})}});$.fn.extend({feed:function(a){$(this).each(function(){var c=$.val("class",a,{d:""});var e=$.val("src",a,{d:""});var d=$.val("autoload",a,{d:false});var b=[];b.push("<div class='feed-content'></div>");b.push("<div class='feed-footer'></div>");$(this).addClass("feed");$(this).addClass(c);$(this).html(b.join(""));$(this).data("options",a);if(d){$(this).feed_load()}})},feed_val:function(b,a){if(typeof b=="undefined"){}else{$(this).each(function(){var l=$(this).data("options");var c=$.val("src",l,{d:""});var k=$.val("template",l,{d:""});if($.type(b)=="array"&&b.length>0){var h="feed_group_"+$.uniqid();var j=document.createElement("div");j.setAttribute("data-feed-group-id",h);var g=[];for(var f=0;f<b.length;f++){g.push("<div class='feed-item'></div>")}j.innerHTML=g.join("");$(".feed-content",this).append(j);for(var f=0;f<b.length;f++){var e=b[f];var d=j.childNodes[f];$.fire_event(k,[e],d)}}})}},feed_load:function(a){$(this).each(function(){if(!$(this).hasClass("feed")){return}var b=this;var c=$(this).data("options");var d=$.val("src",c,{d:""});if(d!=""){$.api_post(d,[],function(g){var i=$.val("data",g,{d:[]});var h=$.val("page",g,{d:1});var f=h==1?false:true;$(b).feed_val(i,f);var e=$.val("max_page",g,{d:h});if(e>=h+1){$(".feed-footer",b).html("<div class='load-more align-center padding10'>Load More...</div>");$(".load-more",b).on("click",function(){$(b).feed_load({page:h+1})})}else{$(".feed-footer",b).html("")}})}})}});$.extend({foldedpane_toggle:function(a){var b=$(a);if(typeof b[0]=="undefined"){return}var c=$(".toggler",b);if(b[0].classList.contains("folded")){b[0].classList.remove("folded");if(c.length==1){c.html("<span class='fa fa-caret-up'></span>")}}else{b[0].classList.add("folded");if(c.length==1){c.html("<span class='fa fa-caret-down'></span>")}}},foldedpane_init:function(){var d=document.body.querySelectorAll(".folded-pane");for(var c=0;c<d.length;c++){var a=d[c];var b=a.querySelector(".toggler");if(b!=null){b.addEventListener("click",function(){$.foldedpane_toggle(a)})}}}});$.fn.extend({grid:function(f){var a=$.val("autoload",f,{d:true});var g=$.val("columns",f,{d:[]});var h=$.val("class",f,{d:null});var e=$.val("name",f,{d:""});var c=$.val("footer",f,{d:""});var b=$.val("value",f,{d:null});var d=$.val("height",f,{d:"auto"});f.page=0;f.row_per_page=12;this.each(function(){var j=this;var i=[];i.push("<table class='grid-body'>");i.push("<tbody class='grid-size'></tbody>");i.push("</table>");i.push("<div class='grid-footer'></div>");$(j).attr("data-type","grid");$(j).addClass("grid");$(j).addClass(h);if(e!=""){$(j).attr("data-name",e)}$(j).data("options",f);$(j).attr("data-type","grid");$(j).html(i.join(""));$.fire_event(c,[],$(".grid-footer",j));$(this).grid_set_columns(g);if(b!=null){$(j).grid_set(b)}if(a){$(j).grid_load()}})},grid_add:function(a){this.each(function(){var d=this;var t=d.querySelector(".grid-body");var m=$(d).data("options");var b=$.val("columns",m,{d:[]});var c=[];if($(".grid-size",t).length==0){var p=[];p.push("<tr class='grid-size'>");for(var k=0;k<b.length;k++){var l=b[k];var q=$.val("width",l,{d:""});p.push("<td style='width:"+q+";'></td>");p.push("<td class='separator'></td>")}p.push("<td style='width:100%'></td>");p.push("</tr>");c.push(p.join(""))}c.push("<tr>");for(var g=0;g<b.length;g++){var l=b[g];var h=$.val("type",l,{d:"text"});var o=$.val("datatype",l,{d:"text"});var u=$.val("name",l,{d:""});var q=$.val("width",l,{d:""});var e=$.val("align",l,{d:""});var n="";var f="";var r="";switch(h){case"index":r=k+1;n="right";f="label";break;case"html":gridtypecoord=0+","+g;break;default:switch(o){case"number":case"money":n="right";r=$.val(u,a,{d:0});break;case"enum":var s=$.val("enums",l,{d:{}});r=$.val(u,a,{d:"-"});r=$.val(r,s,{d:"-"});break;default:r=$.val(u,a,{d:"-"});break}f="label";break}if(e!=""){n=e}c.push("<td data-gridtype='"+h+"' data-gridtypecoord='"+gridtypecoord+"' class='"+f+"' style='text-align:"+n+"'>"+r+"</td>");c.push("<td class='separator'></td>")}c.push("<td></td>");c.push("</tr>");$("tbody",t).append(c.join(""));$("td[data-gridtype='html']",$("tr",$("tbody",t)).last()).each(function(){var i=$(this).attr("data-gridtypecoord").split(",");var j=parseInt(i[1]);var w=b[j];var x=$.val("html",w,{d:""});$.fire_event(x,[a,w],this)})})},grid_remove:function(b){var a=this;$(b).each(function(){var d=$(this).closest(".grid");d=typeof d[0]!="undefined"?d[0]:-2;var c=typeof a[0]!="undefined"?a[0]:-1;if(d==c){$(this).remove()}})},grid_set_columns:function(a){$(this).each(function(){if(!$(this).hasClass("grid")){return}var h=$(this).data("options");h.columns=a;$(this).data("options",h);var d=[];d.push("<tr>");for(var b=0;b<a.length;b++){var f=a[b];var c=$.val("name",f);var e=$.val("width",f);var g=$.val("active",f,{d:1});if(g==1){d.push($.p("<td class='grid-size-label' style='width:$1' data-key='"+c+"'></td>",[e]))}else{d.push($.p("<td class='grid-size-label inactive' style='width:$1' data-key='"+c+"'></td>",[e]))}}d.push("<td style='width:100%'></td>");d.push("</tr>");$(".grid-size",this).html(d.join(""))})},grid_append:function(b,a){this.each(function(){var k=this;var h=k.querySelector(".grid-body");var j=$(k).data("options");var g=$.val("src",j,{d:""});var e=$.val("onselect",j);var l=$.val("columns",j,{d:[]});var d=$.val("page",b,{d:1});var f=$.val("row_per_page",b,{d:10});var m=$.val("max_page",b,{d:d});var c=$.val("data",b);if(typeof j.data=="undefined"){j.data=[]}var o=document.createElement("tbody");$(o).html($.grid_html(c,l,j.data.length));$(h).append(o);$("td[data-gridtype='html']",o).each(function(){var t=$(this).attr("data-gridtypecoord").split(",");var p=parseInt(t[0]);var i=parseInt(t[1]);var r=c[p];var q=l[i];var s=$.val("html",q,{d:""});$.fire_event(s,[r,q],this)});$("tr",o).click(function(){var i=$(this).closest("table");$(".active",i).removeClass("active");$(this).addClass("active");var q=$(this).attr("data-idx");var p=j.data[q];$.fire_event(e,[p],k)});$(".grid-more",k).remove();if(m>d){$(k).append("<div class='grid-more' data-page='"+d+"'><label class='cl-gray'>Load more...</label></div>");$(".grid-more",k).click(function(){var i=parseInt($(this).attr("data-page"));var p=$.val("onloadmore",j);$(this).html("<i class='fa fa-circle-o-notch fa-spin fa-fw cl-gray'></i>");if(g!=""){$(k).grid_load()}$.fire_event(p,[{page:i}],k)});$(".grid-more",k).appear(function(){var i=parseInt($(this).attr("data-page"));var p=$.val("onloadmore",j);$(this).html("<i class='fa fa-circle-o-notch fa-spinfa-fw cl-gray'></i>");if(g!=""){$(k).grid_load()}$.fire_event(p,[{page:i}],k)})}for(var n=0;n<c.length;n++){j.data.push(c[n])}$(k).data("options",j)})},grid_load:function(a){this.each(function(){var d=this;var h=$(d).data("options");var e=$.val("src",h,{d:""});var f=$.val("method",h,{d:"post"});if(e.length>0){var c=$.val("page",a,{d:1});var b=$.val("row_per_page",a,{d:10});var i=$.val("columns",h);var g={page:c,row_per_page:b,columns:i};if(f.toString().toLowerCase()=="get"){$.api_get(e,g,function(l){var j=$.val("data",l,{d:[]});var n=$.val("page",l,{d:1});var k=n==1?false:true;$(d).grid_val(j,k);var m=$.val("next_page",l,{d:n});if(m>n){$(".grid-footer",d).html("<div class='load-more align-center padding10'>Load More...</div>");$(".load-more",d).on("click",function(){$(d).grid_load({page:m})})}else{$(".grid-footer",d).html("")}})}else{$.api_post(e,g,function(l){var j=$.val("data",l,{d:[]});var n=$.val("page",l,{d:1});var k=n==1?false:true;$(d).grid_val(j,k);var m=$.val("next_page",l,{d:n});if(m>n){$(".grid-footer",d).html("<div class='load-more align-center padding10'>Load More...</div>");$(".load-more",d).on("click",function(){$(d).grid_load({page:m})})}else{$(".grid-footer",d).html("")}})}$(".grid-footer",this).html("<div class='align-center padding10'>Loading...</div>")}})},grid_val:function(b,a){if(typeof b=="undefined"){var b=[];this.each(function(){var c=this;var d=c.querySelector(".grid-body");var e=$("tbody",d);$(e).children().each(function(){if(this.classList.contains("grid-size")){}else{var f=$(this).attr("data-idx");var g=$.el_get(this);if(JSON.stringify(g).length>3){b.push(g)}}})});return b}else{this.each(function(){var k=this;var m=$(k).data("options");var c=$.val("onselect",m);var h=$.val("columns",m,{d:[]});var p=document.createElement("tbody");p.className="grid-content";p.innerHTML=$.grid_html(b,h);if(typeof a=="undefined"||a!==true){$(".grid-content",k).remove()}$(".grid-body",k).append(p);for(var o=0;o<p.childNodes.length;o++){var f=p.childNodes[o];var n=b[o];for(var l=0;l<f.childNodes.length;l++){var g=f.childNodes[l];var e=g.getAttribute("data-column-type");if(e=="html"){var d=h[l];var q=$.val("html",d,{d:""});$.fire_event(q,[n,d],g)}}}$("tr",p).on("click.gridrow",function(j){var i=$(this).closest("table");$(".active",i).removeClass("active");$(this).addClass("active");$.fire_event(c,[j,this],k)})})}},grid_get_selected_value:function(){var a=null;$(this).each(function(){var c=$(this).data("options");var d=$.val("data",c);var b=$("tr[class='active']").attr("data-idx");a=$.val(b,d)});return a}});$.extend({grid_html:function(h,c){if(!h){return}var l=[];for(var k=0;k<h.length;k++){var g=h[k];l.push("<tr>");for(var d=0;d<c.length;d++){var b=c[d];var r=$.val("type",b,{d:"text"});var q=$.val("datatype",b,{d:"text"});var p=$.val("name",b,{d:""});var a=$.val("align",b,{d:""});var o="";var f="";var n="";switch(r){case"html":break;default:switch(q){case"number":case"money":o="right";n=$.val(p,g,{d:0});n=$.number_format(n);break;case"enum":var e=$.val("enums",b,{d:{}});n=$.val(p,g,{d:"-"});n=$.val(n,e,{d:"-"});break;default:n=$.val(p,g,{d:"-"});break}var m=$.val("lettercase",b,{d:""});switch(m){case"capitalize":n=n.toString().capitalize();break;case"lowercase":n=n.toString().toLowerCase();break;case"uppercase":n=n.toString().toUpperCase();break}f="label";break}if(a!=""){o=a}l.push("<td data-column-type='"+r+"' class='"+f+"' style='text-align:"+o+"'>"+n+"</td>")}l.push("<td></td>");l.push("</tr>")}return l.join("")}});$.fn.extend({gridhead:function(g){var d=$.val("autoload",g,{d:true});var b=$.val("columns",g,{d:[]});var c=$.val("class",g,{d:null});var f=$.val("name",g,{d:""});var a=$.val("grid",g,{d:null});var e=$.val("height",g,{d:null});this.each(function(){var h=this;$(h).addClass("gridhead");$(h).addClass(c);$(h).attr("data-type","gridhead");if(f!=""){$(h).attr("data-name",f)}$(h).data("options",g);$(h).attr("data-type","gridhead");$(h).gridhead_attr({height:e});$(this).gridhead_set(b)})},gridhead_set:function(a){$(this).each(function(){var f=this;var k=$(this).data("options");var q=$.val("grid",k,{d:null});var c=$.val("oncolumnclick",k);k.columns=a;var m=[];m.push("<table class='grid-head'><tr>");for(var l=0;l<a.length;l++){var j=a[l];var b=$.val("name",j,{d:""});var e=$.val("active",j,{d:1});var g=$.val("text",j,{d:"-"});var p=$.val("width",j,{d:""});var d=$.val("datatype",j,{d:"text"});var h=$.val("align",j,{d:""});var n="";switch(d){case"number":case"money":n="right";break;case"enum":break;default:break}if(h!=""){n=h}var o="label"+(!e?" inactive":"");m.push("<td class='"+o+"' style='width:"+p+";text-align:"+n+"' data-key=\""+b+'">'+g+"<span class='separator'></span></span></td>")}m.push("<td style='width:100%'></td>");m.push("</tr></table>");$(f).html(m.join(""));$(".separator",f).mousedown(function(s){s.preventDefault();s.stopPropagation();var i=this.parentNode;var r=i.parentNode;var t=s.clientX;$(window).on("mousemove.gridhead",function(w){w.preventDefault();w.stopPropagation();var u=w.clientX-t;i.style.width=(parseInt(i.style.width)+u)+"px";t=w.clientX});$(window).on("mouseup.gridhead",function(w){w.preventDefault();w.stopPropagation();var z=$(q);var B=$(".grid-size",z);if(B.length==1){var y=-1;for(var u=0;u<r.childNodes.length;u++){if(r.childNodes[u]==i){y=u;break}}y=parseInt(y);$(".grid-size-label:eq("+(y)+")",B).css({width:$(i).outerWidth()});var x=$(f).data("options");x.columns[y]["width"]=$(i).outerWidth();var A=$.val("oncolumnresize",x);$.fire_event(A,[{index:y,width:$(i).outerWidth()}],f)}$(window).off("mousemove.gridhead");$(window).off("mouseup.gridhead")})});$(".separator",f).click(function(i){i.preventDefault();i.stopPropagation()});$(".label",f).on("click",function(r){r.preventDefault();r.stopPropagation();var i=$(this).attr("data-key");var s=$(this).attr("data-sorttype");if(s=="asc"){s="desc"}else{if(s=="desc"){s="asc"}else{s="asc"}}$(this).attr("data-sorttype",s);$.fire_event(c,[[{key:i,type:s}]],f)})})},gridhead_attr:function(a){$(this).each(function(){for(var b in a){var c=a[b];switch(b){case"height":$(this).css({height:c});break}}})},gridhead_modify_column:function(a){$(this).each(function(){if(!$(this).hasClass("gridhead")){return}var h=$(this).data("options");var k=$.val("grid",h);var g=$.val("columns",h);for(var e=0;e<g.length;e++){var n=g[e];var f=$.val("name",n,{d:""});var m=$.val("width",n,{d:""});if(f==""){continue}for(var d=0;d<a.length;d++){var c=a[d];var l=$.val("name",c,{d:""});var b=$.val("active",c,{d:1});if(f==l){if(b){$(".label[data-key='"+l+"']",this).removeClass("inactive");$(".grid-size-label[data-key='"+l+"']",$(k)).removeClass("inactive")}else{$(".label[data-key='"+l+"']",this).addClass("inactive");$(".grid-size-label[data-key='"+l+"']",$(k)).addClass("inactive")}h.columns[e]["active"]=b;column_exists=true}}}$(this).data("options",h)})}});$.fn.extend({gridsetting:function(b){var a=$.val("onchange",b);this.each(function(){var d=this;var c=[];c.push("<div class='modal-head'>");c.push("<div class='align-center padding10'>");c.push("<ul class='tab'>");c.push("<li class='active' data-value='presets'>Presets</li>");c.push("<li data-value='columns'>Columns</li>");c.push("<li data-value='filters'>Filters</li>");c.push("</ul>");c.push("</div>");c.push("</div>");c.push("<div class='modal-body padding20'>");c.push("<div class='cont12 space10 gridsetting-presets'>");c.push("<div class='lg12'><button class='blue preset-add-btn'><span class='fa fa-plus'></span> Add Preset...</button></div>");c.push("<div class='lg12'><span class='preset-grid'></span></div>");c.push("</div>");c.push("<div class='cont12 space10 gridsetting-columns' style='display:none'>");c.push("<div class='lg12'>");c.push("<button class='blue column-up-btn'><span class='fa fa-caret-up'></span>Up</button>");c.push("&nbsp;");c.push("<button class='blue column-down-btn'><span class='fa fa-caret-down'></span>Down</button>");c.push("</div>");c.push("<div class='lg6'><span class='column-grid'></span></div>");c.push("<div class='lg6'>");c.push("<div class='cont12 space10 gridsetting-column-detail'>");c.push("<div class='lg3 align-right'><label class='padding10'>Align</label></div>");c.push("<div class='lg9'><span class='gridsetting-column-align'></span></div>");c.push("<div class='lg3 align-right'><label class='padding10'>Name</label></div>");c.push("<div class='lg9'><label class='gridsetting-column-name padding10'></label></div>");c.push("<div class='lg3 align-right'><label class='padding10'>Text</label></div>");c.push("<div class='lg9'><span class='gridsetting-column-text'></span></div>");c.push("<div class='lg3 align-right'><label class='padding10'>Width</label></div>");c.push("<div class='lg9'><span class='gridsetting-column-width'></span></div>");c.push("</div>");c.push("</div>");c.push("</div>");c.push("<div class='cont12 space10 gridsetting-filters' style='display:none'>");c.push("<div class='lg12'><button class='blue filter-add-btn'><span class='fa fa-plus'></span> Add Filter...</button></div>");c.push("<div class='lg12'><span class='filter-grid'></span></div>");c.push("</div>");c.push("</div>");c.push("<div class='modal-foot'>");c.push("<button class='blue apply-btn'><span class='fa fa-save'></span> Apply Filter</button>");c.push("&nbsp;");c.push("<button class='close-btn'><span class='fa fa-times'></span> Close</button>");c.push("</div>");$(d).addClass("modal width800 gridsetting");$(d).html(c.join(""));$(".tab",d).tab({onchange:function(e){$(".modal-body",d).children().hide();$(".gridsetting-"+e.value,d).show()}});$(".preset-add-btn").click(function(){});$(".preset-grid",d).grid({"class":"transparent",columns:[{text:"",type:"html",html:"$.gridsetting_preset_option",width:"50px"},{text:"Preset Name",name:"text",width:"150px"}]});$(".column-grid",d).grid({"class":"transparent",columns:[{text:"Column Name",name:"text",width:"150px"},{text:"Width",name:"width",width:"100px"}],onselect:function(g){var e=$(this).closest(".gridsetting-columns");var f=$(".gridsetting-column-detail",e);$.el_set(f,g);$(".gridsetting-column-name",f).html($.val("name",g,{d:""}))}});$(".gridsetting-column-align",d).dropdown({name:"align",items:[{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]});$(".gridsetting-column-name",d).html("");$(".gridsetting-column-text",d).textbox({name:"text",onchange:function(h){var j=$(d).data("params");var g=$(this).closest(".gridsetting-column-detail");var e=$(".gridsetting-column-name",g).html();for(var f=0;f<j.presets[j.active_idx]["columns"].length;f++){if(j.presets[j.active_idx]["columns"][f]["name"]==e){j.presets[j.active_idx]["columns"][f]["text"]=h}}$(d).data("presets",j)}});$(".gridsetting-column-width",d).textbox({name:"width",onchange:function(h){var j=$(d).data("params");var g=$(this).closest(".gridsetting-column-detail");var e=$(".gridsetting-column-name",g).html();for(var f=0;f<j.presets[j.active_idx]["columns"].length;f++){if(j.presets[j.active_idx]["columns"][f]["name"]==e){j.presets[j.active_idx]["columns"][f]["width"]=h}}$(d).data("presets",j)}});$(".filter-add-btn",d).click(function(){$(".filter-grid",d).grid_add()});$(".filter-grid",d).grid({"class":"transparent",columns:[{text:"",type:"html",html:"$.gridsetting_grid_option",width:"50px"},{text:"Key",type:"html",html:"$.gridsetting_grid_key",width:"150px"},{text:"Operator",type:"html",html:"$.gridsetting_grid_opt",width:"150px"},{text:"Value",type:"html",html:"$.gridsetting_grid_val",width:"150px"}]});$(".apply-btn",d).click(function(){var e=$(".filter-grid",d).grid_value();var g=$(d).data("params");var f=parseInt($.val("active_idx",g,{d:0}));g.presets[f]["filters"]=e;$.fire_event(a,[g],d);$(d).modal_close()});$(".close-btn",d).click(function(){$(d).modal_close()})})},gridsetting_close:function(){$(this).modal_close()},gridsetting_open:function(b,a){this.each(function(){var e=$.val("presets",b);var d=b.presets[b.active_idx];var f=$.val("columns",b);var c=$.val("filters",b);$(this).data("params",b);$(this).data("columns",f);$(".preset-grid",this).grid_set(e);$(".column-grid",this).grid_set(f);$(".filter-grid",this).grid_set(c);$(this).modal_open({height:window.innerHeight*0.8})})}});$.extend({gridsetting_preset_option:function(a){$(this).html("<button class='preset-grid-options'><span class='fa fa-times'></span></button>");$(".preset-grid-options",this).click(function(){$(this).closest("tr").remove()})},gridsetting_grid_option:function(a){$(this).html("<button class='filter-grid-options'><span class='fa fa-times'></span></button>");$(".filter-grid-options",this).click(function(){$(this).closest("tr").remove()})},gridsetting_grid_type:function(a){$(this).html("<span class='filter-grid-type'></span>");$(".filter-grid-type",this).textbox({name:"type",value:$.val("type",a,{d:null})})},gridsetting_grid_key:function(d,b){var k=$(this).closest(".gridsetting");var c=$(k).data("params");var h=c.presets[c.active_idx];var b=c.columns;var f=[];if($.type(b)=="array"){for(var e=0;e<b.length;e++){var a=b[e];var j=$.val("name",a,{d:""});var g=$.val("text",a,{d:j});if(j.length>0){f.push({text:g,value:j})}}}$(this).html("<span class='filter-grid-key'></span>");$(".filter-grid-key",this).dropdown({name:"key",items:f,value:$.val("key",d,{d:null})})},gridsetting_grid_opt:function(a){$(this).html("<span class='filter-grid-opt'></span>");$(".filter-grid-opt",this).dropdown({name:"operator",items:[{text:"Contains",value:"contains"},{text:"Equals",value:"equals"}],value:$.val("operator",a,{d:null})})},gridsetting_grid_val:function(a){$(this).html("<span class='filter-grid-val'></span>");$(".filter-grid-val",this).textbox({name:"value",value:$.val("value",a,{d:null})})}});$.fn.extend({hidden:function(b){var a=$.val("name",b,{d:""});$(this).each(function(){var c=[];$(this).html(c.join(""));$(this).attr("data-type","hidden");$(this).attr("data-name",a);$(this).addClass("hidden");$(this).data("options",b)})},hidden_val:function(b){if(typeof b=="undefined"){var a=[];$(this).each(function(){a.push($(this).data("value"))});return a.length>1?a:(a.length==1?a[0]:"")}else{$(this).each(function(){$(this).data("value",b)})}}});$.fn.extend({image:function(a){var c=$.val("class",a,{d:""});var e=$.val("height",a,{d:"50px"});var f=$.val("name",a,{d:""});var d=$.val("value",a,{d:""});var b=$.val("width",a,{d:"50px"});this.each(function(){var h=this;var g=[];g.push('<img src="'+d+'"/>');$(h).attr("data-type","image");$(h).attr("data-name",f);$(h).addClass("image");$(h).addClass(c);$(h).html(g.join(""));$(h).data("options",a);$("img",h).css({width:b,height:e})})},image_val:function(b){if(typeof b=="undefined"){var a=[];this.each(function(){a.push($("img",this).attr("src"))});return a.length>1?a:(a.length==1?a[0]:"")}else{this.each(function(){$("img",this).attr("src",b)})}}});$.extend({layout_resize:function(){$(".layout-sidebar, .layout-main, .layout-ext",$(".layout")).css({height:window.innerHeight-$(".header").outerHeight()})}});$.fn.extend({layout:function(e){var b=$.val("class",e,{d:""});var a=$.val("size",e,{d:{}});var c=$.val("large",a,{d:"300px auto 400px"});var d=c.split(" ");$(this).each(function(){var h=$.val(0,d,{d:"200px"});var g="100%";var f=$.val(2,d,{d:"300px"});$(this).addClass("layout");$(this).addClass(b);$(".layout-sidebar",this).css({flex:"0 0 "+h});$(".layout-main",this).css({flex:"1 1 "+g});$(".layout-ext",this).css({flex:"0 0 "+f});$(".layout-sidebar, .layout-main, .layout-ext",this).css({height:window.innerHeight-$(".header").outerHeight()})});$(window).on("resize.layout",function(){$.layout_resize()})}});$.extend({layout2_resize:function(){$(".layout2").layout2_resize()}});$.fn.extend({layout2:function(c){var a=$.val("class",c,{d:""});var d=$.val("size",c,{d:"300px auto 400px"});var b=d.split(" ");$(this).each(function(){$(this).addClass("layout2");$(this).addClass(a);$(this).data("options",c);$(this).layout2_resize()});$(window).on("resize.layout",function(){$.layout2_resize()})},layout2_resize:function(){$(this).each(function(){var i=$(this).data("options");var a=$.val("onresize",i);var d=$.val("ext_hidden",i);var h=$.val("size",i,{d:"300px auto 400px"});var g=h.split(" ");var e=window.innerHeight-$(".header").outerHeight();var b=$.val(0,g,{d:"200px"});var c=$.val(2,g,{d:"300px"});var e=window.innerHeight-$(".header").outerHeight();c=$.calc_size(c,e);var f=e-c;$(".layout-sidebar",this).css({flex:"0 0 "+b,height:e});$(".layout-content",this).css({flex:"1 1 auto"});if(d==0){$(this).removeClass("ext-hidden");$(".layout-main",this).css({height:c});$(".layout-ext",this).css({height:f})}else{$(this).addClass("ext-hidden");$(".layout-main",this).css({height:e});$(".layout-ext",this).css({height:0})}$.fire_event(a,[],this)})},layout2_toggleext:function(a){$(this).each(function(){if(!$(this).hasClass("layout2")){return}var b=$(this).data("options");b.ext_hidden=a?0:1;$(this).data("options",b);$(this).layout2_resize()})},layout2_ext_state:function(){var a=0;$(this).each(function(){var b=$(this).data("options");a=$.val("ext_hidden",b,{d:-1})>0?0:1});return a}});$.fn.extend({modal_open:function(a){this.each(function(){var b=this;$(b).addClass("on");$(document.body).css({overflow:"hidden"});var e=$(b).outerHeight()-5-($(".modal-head",b).outerHeight()+$(".modal-foot",b).outerHeight());if(!isNaN(e)){$(".modal-body",b).css({height:e})}var c=$.val("reset",a,{d:false});if(c===true){$(b).reset()}var d=$.val("value",a,{d:null});if(d!=null){$(b).val(a.value)}})},modal_close:function(b,a){this.each(function(){var c=this;$(c).removeClass("on");$(".modal-bg").removeClass("on")});if($(".modal.on").length==0){$(document.body).css({overflow:""})}}});$.extend({popup_close:function(a){$(a).removeClass("on")},popup_open:function(a,b,i){$.popup_close_all();$(a).addClass("on");var e={};var d=$(b).offset();var h=d.left+a.clientWidth;var g=d.top-$(window).scrollTop()+$(b).outerHeight()+1;var f=window.innerHeight-g-10;e.top=g;e["max-height"]=f;if(h>window.innerWidth){d.left=window.innerWidth-a.clientWidth}e.left=d.left;var c=$.val("min_width",i);if(!isNaN(parseInt(c))){e["min-width"]=c}$(a).css(e)},popup_toggle:function(a,b,c){if(a.classList.contains("on")){$.popup_close(a,b,c)}else{$.popup_open(a,b,c)}},popup_close_all:function(){var a=document.body.querySelectorAll(".popup");for(var b=0;b<a.length;b++){$.popup_close(a[b])}}});$.fn.extend({radio:function(a){$(this).each(function(){var m=$.val("items",a,{d:null});var l=$.val("class",a,{d:""});var f=$.val("text",a,{d:""});var e=$.val("name",a,{d:""});var o=$.val("value",a,{d:""});var h=[];if($.type(m)=="array"){var k="radio-name-"+$.uniqid();for(var g=0;g<m.length;g++){var d=m[g];var c=d.text;var b=d.value;var n=o!=""&&o==b?true:false;var j="radio-"+$.uniqid();h.push("<input type='radio' id='"+j+"' value=\""+b+"\" name='"+k+"'"+(n?" checked":"")+"/>");h.push("<label for='"+j+"'>"+c+"</label>")}}else{var n=parseInt(o)==1||o===true?true:false;var j="radio-"+$.uniqid();h.push("<input type='radio' id='"+j+"'"+(n?" checked":"")+"/>");h.push("<label for='"+j+"'>"+f+"</label>")}$(this).addClass("radio");$(this).addClass(l);$(this).attr({"data-type":"radio"});$(this).html(h.join(""))})},radio_val:function(b){if(typeof b=="undefined"){var a=[];$(this).each(function(){var c=this.querySelectorAll("input");if(c.length==1){a.push(c[0].checked?1:0)}else{for(var d=0;d<c.length;d++){if(c[d].checked){a.push(c[d].value)}}}});a=a.join(",");return a}else{$(this).each(function(){var e=this.querySelectorAll("input");if(e.length==1){e[0].checked=(parseInt(b)==1||b===true)?true:false}else{var d=false;for(var c=0;c<e.length;c++){if(e[c].value==b){e[c].checked=true;d=true;break}}if(!d){$("input",this).attr("checked",false)}}})}}});$.extend({role_init:function(b){var a=typeof b!="undefined"&&b instanceof HTMLElement?b:document.body;$("*[data-role]",a).each(function(){var d=this.getAttribute("data-role");switch(d){case"modal.close":$(this).click(function(){$(this).closest(".modal").modal_close()});break;case"url.open":var c=$(this).attr("data-role-value");$(this).click(function(){window.location=c});break}})}});$.fn.extend({spinner:function(a){var b=$.val("size",a,{defaultvalue:"20px"});this.each(function(){var c=[];c.push('<div class="sk-fading-circle" style="width:'+b+";height:"+b+';">');c.push('<div class="sk-circle1 sk-circle"></div>');c.push('<div class="sk-circle2 sk-circle"></div>');c.push('<div class="sk-circle3 sk-circle"></div>');c.push('<div class="sk-circle4 sk-circle"></div>');c.push('<div class="sk-circle5 sk-circle"></div>');c.push('<div class="sk-circle6 sk-circle"></div>');c.push('<div class="sk-circle7 sk-circle"></div>');c.push('<div class="sk-circle8 sk-circle"></div>');c.push('<div class="sk-circle9 sk-circle"></div>');c.push('<div class="sk-circle10 sk-circle"></div>');c.push('<div class="sk-circle11 sk-circle"></div>');c.push('<div class="sk-circle12 sk-circle"></div>');c.push("</div>");$(this).html(c.join(""))})}});$.fn.extend({tab:function(b){var c=$.val("container",b,{d:""});var a=$.val("name",b,{d:""});var d=$.val("onchange",b);this.each(function(){var e=this;$(e).attr("data-type","tab");$(e).attr("data-name",a);$(e).data("options",b);$("li",e).click(function(){if(this.classList.contains("active")){}else{$("li",this.parentNode).removeClass("active");$(this).addClass("active");var f=this.innerHTML;var h=this.getAttribute("data-value");if(h==null){h=$.slug(f)}var g=$(this).index();if($(c).length>0){$(c+">*").addClass("off");$(c+">*:eq("+g+")").removeClass("off")}$.fire_event(d,[{text:f,value:h}],e)}})})},tab_set:function(b){var a=this;var d=$(a).data("options");var c=$.val("onchange",d);$("li",this).removeClass("active");$("li",this).each(function(){var e=this.innerHTML;var f=this.getAttribute("data-value");if(f==null){f=$.slug(e)}if(f==b){$(this).addClass("active");$.fire_event(c,[{text:e,value:f}],a)}})}});$.fn.extend({textarea:function(f){var d=$.val("placeholder",f,{d:""});var a=$.val("class",f,{d:""});var h=$.val("name",f,{d:""});var e=$.val("height",f,{d:"1em"});var i=$.val("width",f);var j=$.val("maxlength",f,{d:""});var b=$.val("onblur",f);var g=$.val("onkeyup",f);var k=$.val("onchange",f);var c=$.val("value",f,{d:""});var l={width:i};this.each(function(){var m=this;var n=[];n.push("<textarea rows='1' placeholder='"+d+"' style='height:"+e+";' maxlength='"+j+"'></textarea>");n.push("<span class='icon fa hidden'></span>");$(m).addClass("textarea");$(m).addClass(a);$(m).css(l);$(m).html(n.join(""));$(m).attr("data-type","textarea");$(m).attr("data-name",h);$(m).data("options",f);$("textarea",m).blur(function(o){$(m).textarea_validate();$.fire_event(b,[],m)}).keyup(function(o){$.fire_event(g,[this.value],m);if($(this).data("last_value")!=this.value){$.fire_event(k,[this.value],m)}$(this).data("last_value",this.value)});$("textarea",m).each(function(){this.setAttribute("style","height:"+(this.scrollHeight<=0?"":this.scrollHeight)+"px;overflow-y:hidden;")}).on("input",function(){this.style.height="auto";this.style.height=(this.scrollHeight)+"px"});if(c!=""){$(this).textarea_val(c)}})},textarea_val:function(b){if(typeof b=="undefined"){var a=[];$(this).each(function(){a.push($("textarea",this).val())});return a.length>1?a:(a.length==1?a[0]:"")}else{$(this).each(function(){$("textarea",this).val(b).each(function(){this.style.height="auto";this.style.height=(this.scrollHeight)+"px"})})}},textarea_placeholder:function(b){if(typeof b=="undefined"){var a=[];$(this).each(function(){a.push($("input",this).attr("placeholder"))});return a.length>1?a:(a.length==1?a[0]:"")}else{$(this).each(function(){$("input",this).attr("placeholder",b)})}},textarea_reset:function(){$(this).textarea_val("")},textarea_validate:function(){$(this).each(function(){var i=$(this).data("options");var e=$.val("required",i,{d:false});var d=$.val("required_text",i,{d:"Field required."});var b=$.val("validation",i,{d:""});var c=$.val("validation_text",i,{d:"Validation error."});var g=$(this).textarea_val();var a=true;var h="";if(e){if(g.toString().trim()==""){a=false;h=d}else{if(b!=""){switch(b){default:var f=new RegExp(b);a=f.test(g);if(!a){h=c}break}}}}else{if(g.toString().length>0){switch(b){default:var f=new RegExp(b);a=f.test(g);if(!a){h=c}break}}}if(!a){$(this).addClass("invalid");console.warn(h)}else{$(this).removeClass("invalid")}})}});$.fn.extend({textbox:function(f){var c=$.val("placeholder",f,{d:""});var g=$.val("name",f,{d:""});var a=$.val("class",f,{d:""});var e=$.val("value",f,{d:""});var k=$.val("readonly",f,{d:false});var i=$.val("maxlength",f,{d:""});var m=$.val("mode",f,{d:"text"});var h=$.val("width",f);var b=$.val("onblur",f);var d=$.val("onkeyup",f);var j=$.val("onchange",f);var l={width:h};this.each(function(){var o=this;var n=[];n.push($.p('<input type="$1" placeholder="$1" maxlength="$1"/>',[m,c,i]));n.push("<span class='icon fa hidden'></span>");$(o).addClass("textbox");$(o).addClass(a);$(o).css(l);$(o).html(n.join(""));$(o).attr("data-type","textbox");$(o).attr("data-name",g);$(o).data("options",f);$("input",o).val(e);$("input",o).blur(function(p){$(o).textbox_validate();$.fire_event(b,[],o)}).keyup(function(p){$.fire_event(d,[this.value],o);if($(this).data("last_value")!=this.value){$.fire_event(j,[this.value],o)}$(this).data("last_value",this.value)})})},textbox_val:function(b){if(typeof b=="undefined"){var a=[];$(this).each(function(){a.push($("input",this).val())});return a.length>1?a:(a.length==1?a[0]:"")}else{$(this).each(function(){$("input",this).val(b)})}},textbox_placeholder:function(b){if(typeof b=="undefined"){var a=[];$(this).each(function(){a.push($("input",this).attr("placeholder"))});return a.length>1?a:(a.length==1?a[0]:"")}else{$(this).each(function(){$("input",this).attr("placeholder",b)})}},textbox_reset:function(){$(this).textbox_val("")},textbox_validate:function(){$(this).each(function(){var i=$(this).data("options");var e=$.val("required",i,{d:false});var d=$.val("required_text",i,{d:"Field required."});var b=$.val("validation",i,{d:""});var c=$.val("validation_text",i,{d:"Validation error."});var g=$(this).textbox_val();var a=true;var h="";if(e){if(g.toString().trim()==""){a=false;h=d}else{if(b!=""){switch(b){default:var f=new RegExp(b);a=f.test(g);if(!a){h=c}break}}}}else{if(g.toString().length>0){switch(b){default:var f=new RegExp(b);a=f.test(g);if(!a){h=c}break}}}if(!a){$(this).addClass("invalid");console.warn(h)}else{$(this).removeClass("invalid")}})}});$.fn.extend({toggle:function(d){var a=$.val("class",d,{d:""});var c=$.val("name",d,{d:""});var b=$.val("value",d,{d:false});this.each(function(){var f=this;var e=[];e.push("<span class='main-toggle'></span>");f.innerHTML=e.join("");$(this).addClass("toggle");$(this).addClass(a);$(f).attr("data-type","toggle");if(c!=""){$(f).attr("data-name",c)}f.querySelector(".main-toggle").addEventListener("click",function(){if(this.parentNode.classList.contains("on")){this.parentNode.classList.remove("on")}else{this.parentNode.classList.add("on")}});$(f).toggle_val(b);return f})},toggle_val:function(a){if(!$(this).hasClass("toggle")){return undefined}if(typeof a=="undefined"){return $(this).hasClass("on")?1:0}else{if(a==true||a==1){$(this).addClass("on")}else{$(this).removeClass("on")}}}});$.extend({tooltip:function(f,b){var e=$(".tooltip");if(e.length==0){$.warn("No tooltip defined.")}$(e).addClass("on");var d=f.getBoundingClientRect();var a={};var c=[];console.log(f);a.left=d.left;console.log([d.top,d.top+d.height+$(e).outerHeight()+10,window.innerHeight]);if(d.top+d.height+$(e).outerHeight()+10>window.innerHeight){a.top=d.top-$(e).outerHeight()-10;c.push("<div class='arrow-down'></div>")}else{a.top=d.top+d.height+10;c.push("<div class='arrow-up'></div>")}c.push(b);$(e).html(c.join(""));$(e).css(a)},tooltip_remove:function(){$(".tooltip").removeClass("on")}});$.extend({date:function(j,h){var g=this;var i,e;var d=["Sun","Mon","Tues","Wednes","Thurs","Fri","Satur","January","February","March","April","May","June","July","August","September","October","November","December"];var b=/\\?(.?)/gi;var a=function(f,k){return e[f]?e[f]():k};var c=function(k,f){k=String(k);while(k.length<f){k="0"+k}return k};e={d:function(){return c(e.j(),2)},D:function(){return e.l().slice(0,3)},j:function(){return i.getDate()},l:function(){return d[e.w()]+"day"},N:function(){return e.w()||7},S:function(){var f=e.j();var k=f%10;if(k<=3&&parseInt((f%100)/10,10)==1){k=0}return["st","nd","rd"][k-1]||"th"},w:function(){return i.getDay()},z:function(){var k=new Date(e.Y(),e.n()-1,e.j());var f=new Date(e.Y(),0,1);return Math.round((k-f)/86400000)},W:function(){var k=new Date(e.Y(),e.n()-1,e.j()-e.N()+3);var f=new Date(k.getFullYear(),0,4);return c(1+Math.round((k-f)/86400000/7),2)},F:function(){return d[6+e.n()]},m:function(){return c(e.n(),2)},M:function(){return e.F().slice(0,3)},n:function(){return i.getMonth()+1},t:function(){return(new Date(e.Y(),e.n(),0)).getDate()},L:function(){var f=e.Y();return f%4===0&f%100!==0|f%400===0},o:function(){var k=e.n();var l=e.W();var f=e.Y();return f+(k===12&&l<9?1:k===1&&l>9?-1:0)},Y:function(){return i.getFullYear()},y:function(){return e.Y().toString().slice(-2)},a:function(){return i.getHours()>11?"pm":"am"},A:function(){return e.a().toUpperCase()},B:function(){var f=i.getUTCHours()*3600;var l=i.getUTCMinutes()*60;var k=i.getUTCSeconds();return c(Math.floor((f+l+k+3600)/86.4)%1000,3)},g:function(){return e.G()%12||12},G:function(){return i.getHours()},h:function(){return c(e.g(),2)},H:function(){return c(e.G(),2)},i:function(){return c(i.getMinutes(),2)},s:function(){return c(i.getSeconds(),2)},u:function(){return c(i.getMilliseconds()*1000,6)},e:function(){throw"Not supported (see source code of date() for timezone on how to add support)"},I:function(){var m=new Date(e.Y(),0);var k=Date.UTC(e.Y(),0);var l=new Date(e.Y(),6);var f=Date.UTC(e.Y(),6);return((m-k)!==(l-f))?1:0},O:function(){var k=i.getTimezoneOffset();var f=Math.abs(k);return(k>0?"-":"+")+c(Math.floor(f/60)*100+f%60,4)},P:function(){var f=e.O();return(f.substr(0,3)+":"+f.substr(3,2))},T:function(){return"UTC"},Z:function(){return -i.getTimezoneOffset()*60},c:function(){return"Y-m-d\\TH:i:sP".replace(b,a)},r:function(){return"D, d M Y H:i:s O".replace(b,a)},U:function(){return i/1000|0}};this.date=function(k,f){g=this;i=(f===undefined?new Date():(f instanceof Date)?new Date(f):new Date(f*1000));return k.replace(b,a)};return this.date(j,h)},uniqid:function(){if(typeof $.__UNIQID=="undefined"){$.__UNIQID=0}return ++$.__UNIQID},val:function(g,b,j){if(typeof j=="undefined"||$.type(j)!="object"){j={}}var f=null;var h=typeof j.default_value!="undefined"?j.default_value:(typeof j.d!="undefined"?j.d:null);var c=typeof j.t!="undefined"?j.t:(typeof j.datatype!="undefined"?j.datatype:"string");var e=typeof j.required!="undefined"&&e==1?true:false;if($.type(b)=="object"){if($.type(g)=="array"){f=null;for(var d=0;d<g.length;d++){var a=g[d];v=$.val(a,b,{default_value:null});if(v!=null){f=v;break}}}else{if($.type(g)=="string"||$.type(g)=="number"){if(typeof b[g]!="undefined"){f=b[g]}}}}else{if($.type(b)=="array"){if(typeof b[g]!="undefined"){f=b[g]}}}if(e){if(f==null){}}else{f=f==null&&h!=null?h:f}switch(c){case"number":case"integer":case"float":case"double":f=parseFloat(f);break}return f},strtotime:function(f,a){var m,h,o,k,d,b,n,j,l,q,g,c=false;if(!f){return c}if(/^\d{8}$/.test(f)){f=f.substr(0,4)+"-"+f.substr(4,2)+"-"+f.substr(6,2)}f=f.replace(/^\s+|\s+$/g,"").replace(/\s{2,}/g," ").replace(/[\t\r\n]/g,"").toLowerCase();h=f.match(/^(\d{1,4})([\-\.\/\:])(\d{1,2})([\-\.\/\:])(\d{1,4})(?:\s(\d{1,2}):(\d{2})?:?(\d{2})?)?(?:\s([A-Z]+)?)?$/);if(h&&h[2]===h[4]){if(h[1]>1901){switch(h[2]){case"-":if(h[3]>12||h[5]>31){return c}return new Date(h[1],parseInt(h[3],10)-1,h[5],h[6]||0,h[7]||0,h[8]||0,h[9]||0)/1000;case".":return c;case"/":if(h[3]>12||h[5]>31){return c}return new Date(h[1],parseInt(h[3],10)-1,h[5],h[6]||0,h[7]||0,h[8]||0,h[9]||0)/1000}}else{if(h[5]>1901){switch(h[2]){case"-":if(h[3]>12||h[1]>31){return c}return new Date(h[5],parseInt(h[3],10)-1,h[1],h[6]||0,h[7]||0,h[8]||0,h[9]||0)/1000;case".":if(h[3]>12||h[1]>31){return c}return new Date(h[5],parseInt(h[3],10)-1,h[1],h[6]||0,h[7]||0,h[8]||0,h[9]||0)/1000;case"/":if(h[1]>12||h[3]>31){return c}return new Date(h[5],parseInt(h[1],10)-1,h[3],h[6]||0,h[7]||0,h[8]||0,h[9]||0)/1000}}else{switch(h[2]){case"-":if(h[3]>12||h[5]>31||(h[1]<70&&h[1]>38)){return c}k=h[1]>=0&&h[1]<=38?+h[1]+2000:h[1];return new Date(k,parseInt(h[3],10)-1,h[5],h[6]||0,h[7]||0,h[8]||0,h[9]||0)/1000;case".":if(h[5]>=70){if(h[3]>12||h[1]>31){return c}return new Date(h[5],parseInt(h[3],10)-1,h[1],h[6]||0,h[7]||0,h[8]||0,h[9]||0)/1000}if(h[5]<60&&!h[6]){if(h[1]>23||h[3]>59){return c}o=new Date();return new Date(o.getFullYear(),o.getMonth(),o.getDate(),h[1]||0,h[3]||0,h[5]||0,h[9]||0)/1000}return c;case"/":if(h[1]>12||h[3]>31||(h[5]<70&&h[5]>38)){return c}k=h[5]>=0&&h[5]<=38?+h[5]+2000:h[5];return new Date(k,parseInt(h[1],10)-1,h[3],h[6]||0,h[7]||0,h[8]||0,h[9]||0)/1000;case":":if(h[1]>23||h[3]>59||h[5]>59){return c}o=new Date();return new Date(o.getFullYear(),o.getMonth(),o.getDate(),h[1]||0,h[3]||0,h[5]||0)/1000}}}}if(f==="now"){return a===null||isNaN(a)?new Date().getTime()/1000|0:a|0}if(!isNaN(m=Date.parse(f))){return m/1000|0}d=a?new Date(a*1000):new Date();b={sun:0,mon:1,tue:2,wed:3,thu:4,fri:5,sat:6};n={yea:"FullYear",mon:"Month",day:"Date",hou:"Hours",min:"Minutes",sec:"Seconds"};function e(u,t,i){var r,s=b[t];if(typeof s!=="undefined"){r=s-d.getDay();if(r===0){r=7*i}else{if(r>0&&u==="last"){r-=7}else{if(r<0&&u==="next"){r+=7}}}d.setDate(d.getDate()+r)}}function p(i){var r=i.split(" "),u=r[0],w=r[1].substring(0,3),x=/\d+/.test(u),t=r[2]==="ago",s=(u==="last"?-1:1)*(t?-1:1);if(x){s*=parseInt(u,10)}if(n.hasOwnProperty(w)&&!r[1].match(/^mon(day|\.)?$/i)){return d["set"+n[w]](d["get"+n[w]]()+s)}if(w==="wee"){return d.setDate(d.getDate()+(s*7))}if(u==="next"||u==="last"){e(u,w,s)}else{if(!x){return false}}return true}l="(years?|months?|weeks?|days?|hours?|minutes?|min|seconds?|sec|sunday|sun\\.?|monday|mon\\.?|tuesday|tue\\.?|wednesday|wed\\.?|thursday|thu\\.?|friday|fri\\.?|saturday|sat\\.?)";q="([+-]?\\d+\\s"+l+"|(last|next)\\s"+l+")(\\sago)?";h=f.match(new RegExp(q,"gi"));if(!h){return c}for(g=0,j=h.length;g<j;g++){if(!p(h[g])){return c}}return(d.getTime()/1000)},mktime:function(){var b=new Date(),f=arguments,c=0,a=["Hours","Minutes","Seconds","Month","Date","FullYear"];for(c=0;c<a.length;c++){if(typeof f[c]==="undefined"){f[c]=b["get"+a[c]]();f[c]+=(c===3)}else{f[c]=parseInt(f[c],10);if(isNaN(f[c])){return false}}}f[5]+=(f[5]>=0?(f[5]<=69?2000:(f[5]<=100?1900:0)):0);b.setFullYear(f[5],f[3]-1,f[4]);b.setHours(f[0],f[1],f[2]);return(b.getTime()/1000>>0)-(b.getTime()<0)},date_parse:function(a){switch(a){case"this_month":a=$.date("Ym")+"01-"+$.date("Ymd",$.mktime(0,0,0,parseInt($.date("m"))+1,0,$.date("Y")));break}return a},start_day_of_month:function(b,c){var a=$.date("N",$.mktime(0,0,0,c,1,b));return a},last_date_of_month:function(e,a){var b=27;do{b++;var c=parseInt($.date("j",$.mktime(0,0,0,a,b,e)));if(c!=b){b--;break}}while(true);return b},api_get:function(a,c,d,f){var e=$.http_build_query(c);a+=e.length>0?"?"+e:"";var b=new XMLHttpRequest();b.open("GET",a,true);b.addEventListener("load",function(){if(this.readyState==4){var h=$.eval_as_object(this.responseText);var i=$.val("error",h,{d:0,datatype:"integer"});var g=$.val("error_message",h,{d:""});if(i>0){if(f!=null){$.fire_event(f,[this.responseText],b)}else{alert(g)}}else{$.fire_event(d,[h],b)}}});b.addEventListener("error",function(){if(typeof f!="undefined"||f!=null){$.fire_event(f)}else{console.log(this.responseText)}});b.send();return b},api_post:function(e,b,c,d){var a=new XMLHttpRequest();a.open("POST",e,true);a.addEventListener("load",function(){if(this.readyState==4){var g=$.eval_as_object(this.responseText);var h=$.val("error",g,{d:0,datatype:"integer"});var f=$.val("error_message",g,{d:""});if(parseInt(h)==0){$.fire_event(c,[g],a)}else{if(typeof d!="undefined"||d!=null){$.fire_event(d,[{error:h,error_message:f}])}else{alert(JSON.stringify(g,null,2))}}}});a.addEventListener("error",function(){if(typeof d!="undefined"||d!=null){$.fire_event(d)}else{console.log(this.responseText)}});a.send(JSON.stringify(b));return a},http_build_query:function(a,c,b){var d=[];if($.type(a)=="object"){Object.keys(a).forEach(function(f){var g=f;c&&!isNaN(g)?g=c+g:"";var g=encodeURIComponent(g.toString().replace(/[!'()*]/g,escape));b?g=b+"["+g+"]":"";if(typeof a[f]==="object"){var e=$.http_build_query(a[f],null,g);d.push(e)}else{var h=encodeURIComponent(a[f].toString().replace(/[!'()*]/g,escape));d.push(g+"="+h)}})}return d.join("&")},fire_event:function(callback,params,thisArg){if(typeof thisArg=="undefined"){thisArg=null}if($.type(callback)=="string"){callback=eval(callback)}if($.type(callback)=="function"){return callback.apply(thisArg,params)}},eval_as_object:function(exp){try{return eval("("+exp+")")}catch(e){return null}},ux:function(a){a=typeof a=="undefined"||!(a instanceof HTMLElement)?document.body:a;var b=a.querySelectorAll("*[data-type]");$(b).each(function(){var d=this.getAttribute("data-type");if(typeof $(this)[d]=="function"){var c=$.options_from_html(this);$(this)[d](c)}else{console.warn("Unknown ux "+d)}})},el_get:function(c){if($(c).attr("data-type")!=null){var a=$(c).attr("data-type");if(typeof $(c)[a+"_get"]=="function"){return $(c)[a+"_get"]()}return null}else{var b={};var d=$("*[data-type]",c);$(d).each(function(){var e=this;var f=$.el_get(e);var g=e.getAttribute("data-name");if(g==null){g="undefined"}b[g]=f});return b}},el_set:function(a,b){$("*[data-type]",a).each(function(){var c=this.getAttribute("data-type");var e=this.getAttribute("data-name");var d=$.val(e,b);if(typeof $(this)[c+"_set"]=="function"){$(this)[c+"_set"](d)}else{console.warn("unknown method")}})},options_from_html:function(el){var options=null;if(el.getAttribute("data-options")!=null){try{options=eval("("+el.getAttribute("data-options")+")")}catch(e){options=null}}else{var options={};for(var i=0;i<el.attributes.length;i++){options[el.attributes[i].nodeName.replace("data-","")]=el.attributes[i].nodeValue}}return options},cookie_getitem:function(a){if(!a){return null}return decodeURIComponent(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+encodeURIComponent(a).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1"))||null},cookie_setitem:function(a,d,g,f,e,b){if(!a||/^(?:expires|max\-age|path|domain|secure)$/i.test(a)){return false}var c="";if(g){switch(g.constructor){case Number:c=g===Infinity?"; expires=Fri, 31 Dec 9999 23:59:59 GMT":"; max-age="+g;break;case String:c="; expires="+g;break;case Date:c="; expires="+g.toUTCString();break}}document.cookie=encodeURIComponent(a)+"="+encodeURIComponent(d)+c+(e?"; domain="+e:"")+(f?"; path="+f:"")+(b?"; secure":"");return true},cookie_removeitem:function(a,c,b){if(!this.hasItem(a)){return false}document.cookie=encodeURIComponent(a)+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT"+(b?"; domain="+b:"")+(c?"; path="+c:"");return true},cookie_hasitem:function(a){if(!a){return false}return(new RegExp("(?:^|;\\s*)"+encodeURIComponent(a).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=")).test(document.cookie)},cookie_keys:function(){var b=document.cookie.replace(/((?:^|\s*;)[^\=]+)(?=;|$)|^\s*|\s*(?:\=[^;]*)?(?:\1|$)/g,"").split(/\s*(?:\=[^;]*)?;\s*/);for(var a=b.length,c=0;c<a;c++){b[c]=decodeURIComponent(b[c])}return b},slug:function(a){var c="";var b=$.trim(a);c=b.replace(/[^a-z0-9-]/gi,"-").replace(/-+/g,"-").replace(/^-|-$/g,"");return c.toLowerCase()},warn:function(a){console.warn(a)},array_merge:function(){var c=Array.prototype.slice.call(arguments);var e=c.length;var f;var l={};var h="";var g=0;var m=0;var a=0;var b=0;var d=Object.prototype.toString;var n=true;for(a=0;a<e;a++){if(d.call(c[a])!=="[object Array]"){n=false;break}}if(n){n=[];for(a=0;a<e;a++){n=n.concat(c[a])}return n}for(a=0,b=0;a<e;a++){f=c[a];if(d.call(f)==="[object Array]"){for(m=0,g=f.length;m<g;m++){l[b++]=f[m]}}else{for(h in f){if(f.hasOwnProperty(h)){if(parseInt(h,10)+""===h){l[b++]=f[h]}else{l[h]=f[h]}}}}}return l},in_array:function(c,b,a){var e="";var d=!!a;if(d){for(e in b){if(b[e]===c){return true}}}else{for(e in b){if(b[e]==c){return true}}}return false},number_format:function(c,a,f,e){c=(c+"").replace(/[^0-9+\-Ee.]/g,"");var j=!isFinite(+c)?0:+c;var i=!isFinite(+a)?0:Math.abs(a);var h=(typeof e==="undefined")?",":e;var b=(typeof f==="undefined")?".":f;var g="";var d=function(m,l){var k=Math.pow(10,l);return""+(Math.round(m*k)/k).toFixed(l)};g=(i?d(j,i):""+Math.round(j)).split(".");if(g[0].length>3){g[0]=g[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,h)}if((g[1]||"").length<i){g[1]=g[1]||"";g[1]+=new Array(i-g[1].length+1).join("0")}return g.join(b)},qs:(function(f){if(f==""){return{}}var e={};for(var c=0;c<f.length;++c){var d=f[c].split("=",2);if(d.length==1){e[d[0]]=""}else{e[d[0]]=decodeURIComponent(d[1].replace(/\+/g," "))}}return e})(window.location.search.substr(1).split("&")),p:function(d,c){var b=d.match(/\$\w+/g);if(b!=null){if($.type(c)=="array"){for(var g=0;g<b.length;g++){var e=b[g];var a=typeof c[g]!="undefined"?c[g]:"";d=d.replace(e,a)}}else{if($.type(c)=="object"){for(var g=0;g<b.length;g++){var e=b[g];var f=e.replace("$","");var a=typeof c[f]!="undefined"?c[f]:"";d=d.replace(e,a)}}}}return d},array_key_count:function(a){var c=0;for(var b in a){c++}return c},object_value_min:function(a){var d=-1;if($.type(a)=="object"){for(var c in a){var b=a[c];if(d==-1||parseFloat(b)<parseFloat(d)){d=b}}}return d},object_value_max:function(a){var d=-1;if($.type(a)=="object"){for(var c in a){var b=a[c];if(d==-1||parseFloat(b)>parseFloat(d)){d=b}}}return d},ksort:function(b){var a=Object.keys(b).sort(),c={};for(var d in a){c[a[d]]=b[a[d]]}return c},str_pad:function(f,c,a,d){var b="";var e;var g=function(h,j){var i="";while(i.length<j){i+=h}i=i.substr(0,j);return i};f+="";a=a!==undefined?a:" ";if(d!=="STR_PAD_LEFT"&&d!=="STR_PAD_RIGHT"&&d!=="STR_PAD_BOTH"){d="STR_PAD_RIGHT"}if((e=c-f.length)>0){if(d==="STR_PAD_LEFT"){f=g(a,e)+f}else{if(d==="STR_PAD_RIGHT"){f=f+g(a,e)}else{if(d==="STR_PAD_BOTH"){b=g(a,Math.ceil(e/2));f=b+f+b;f=f.substr(0,c)}}}}return f},template_parse:function(h,k){var b=h.match(/<!--IF.+?(?=-->)(.+)?(?=<!--END-->)<!--END-->/gi,"gi");if($.type(b)=="array"){for(var a=0;a<b.length;a++){var c=b[a];var b=c.match(/\(.+?(?=\))\)/gi,"gi");var g=b[0];g=g.substr(1,g.length-2);var d=new Function("obj","return "+g+";");if(!d(k)){h=h.replace(c,"","gi")}}}var b=h.match(/<!--IF_NOT_EMPTY.+?(?=-->)(.+)?(?=<!--END-->)<!--END-->/gi,"gi");if($.type(b)=="array"){for(var a=0;a<b.length;a++){var c=b[a];var b=c.match(/\(\w+\)/gi,"gi");var g=b[0];g=g.substr(1,g.length-2);if($.val(g,k,{d:""})==""){h=h.replace(c,"","gi")}}}var b=h.match(/{\w+(:\w+)*?(?=})}/gi,"gi");if($.type(b)=="array"){for(var a=0;a<b.length;a++){var c=b[a];var g=c.substr(1,c.length-2);var l="string";if(g.indexOf(":")>=0){var j=g.split(":");g=j[0];l=j[1]}var e=$.val(g,k,{d:"-"});e=$.convert_datatype(e,l);h=h.replace(c,e,"gi")}}return h},convert_datatype:function(b,a){switch(a){case"date":b=$.date("j M Y",$.strtotime(b));break}return b},calc_size:function(b,a){a=typeof a=="undefined"||!a?window.innerWidth:a;if(b.indexOf("%")>=0){b=b.replace("%","","gi");if(!isNaN(parseFloat(b))){b=parseFloat(b)/100*a}}return b},download:function(c){var b=document.createElement("a");b.href=c;b.setAttribute("download",c);document.body.appendChild(b);b.click();document.body.removeChild(b)},ux_init:function(a){a=typeof a=="undefined"||!(a instanceof HTMLElement)?document.body:a;$("*[data-type]",a).each(function(){var c=this.getAttribute("data-type");if(typeof $(this)[c]=="function"){var b=$.options_from_html(this);$(this)[c](b)}else{console.warn("Unknown ux "+c)}});$("*[data-action]",a).each(function(){switch(this.getAttribute("data-action")){case"modal.close":$(this).on("click.data-action",function(){$(this).closest(".modal").modal_close()});break}});$(window).on("click",$.popup_close_all).on("scroll",$.popup_close_all);$(window).on("keyup",function(b){switch(b.keyCode){case 27:$(".modal").modal_close();break}})},istrue:function(a){if(typeof a!="undefined"&&(parseInt(a)==1||a===true)){return true}return false}});var oldVal=$.fn.val;$.fn.val=function(b){var a=$(this).attr("data-type");if(a!=null&&typeof $(this)[a+"_val"]!="undefined"){return $(this)[a+"_val"].apply(this,arguments)}else{if($(this).hasClass("container")){return $(this).container_val.apply(this,arguments)}else{return oldVal.apply(this,arguments)}}};$.fn.placeholder=function(){var a=$(this).attr("data-type");if(a!=null&&typeof $(this)[a+"_placeholder"]!="undefined"){return $(this)[a+"_placeholder"].apply(this,arguments)}else{if($(this).hasClass("container")){return $(this).container_placeholder.apply(this,arguments)}}};$.fn.readonly=function(){var a=$(this).attr("data-type");if(a!=null&&typeof $(this)[a+"_readonly"]!="undefined"){return $(this)[a+"_readonly"].apply(this,arguments)}else{if($(this).hasClass("container")){return $(this).container_readonly.apply(this,arguments)}}};$.fn.reset=function(){var a=$(this).attr("data-type");if(a!=null&&typeof $(this)[a+"_reset"]!="undefined"){return $(this)[a+"_reset"].apply(this,arguments)}else{if($(this).hasClass("container")){return $(this).container_reset.apply(this,arguments)}}};String.prototype.capitalize=function(){return this.charAt(0).toUpperCase()+this.slice(1)};$($.ux_init);$.fn.extend({vfields:function(a){var b=$.val("value",a);$(this).each(function(){var c=this;$(c).addClass("vfields");$(c).data("options",a);if($.type(b)=="array"){$(c).form_set(b)}})},form_set:function(a){if(typeof a=="undefined"||$.type(a)!="array"){return}$(this).each(function(){var b=this;var d=$(this).data("options");var c=$.val("html_callback",d);$(a).each(function(){var f=this;var e=[];e.push("<table><tr><td class='vfields-col1' align='center' style='width:24px'>");e.push("<span class='fa fa-times-circle selectable vfields-remove hoverable'></span>");e.push("</td><td class='vfields-col2'></td></tr></table>");var g=document.createElement("div");g.className="vfields-item";g.innerHTML=e.join("");$(b).append(g);$.fire_event(c,[f],$(".vfields-col2",g))});$(".vfields-remove",b).click(function(){$(this).closest(".vfields-item").remove()})})},vfields_get:function(){var a=[];$(this).each(function(){var b=this;$(".vfields-col2",b).each(function(){var c=$.el_get(this);a.push(c)})});return a}});$.fn.extend({webeditor:function(b){var a=$.val("height",b);this.each(function(){var d=$.uniqid();var c=[];c.push($.p('<textarea id="$1"></textarea>',["webeditor"+d]));$(this).addClass("webeditor");$(this).html(c.join(""));$(this).data("options",b);CKEDITOR.replace("webeditor"+d,{height:a})})},webeditor_get:function(b){var a=[];this.each(function(){var d=$("textarea",this).attr("id");if(typeof CKEDITOR.instances[d]!="undefined"){var c=CKEDITOR.instances[d].getData();a.push(c)}});return a.length==1?a[0]:(a.length>1?a:null)},webeditor_set:function(a){this.each(function(){var b=$("textarea",this).attr("id");if(typeof CKEDITOR.instances[b]!="undefined"){CKEDITOR.instances[b].setData(a)}})}});$.fn.extend({widget:function(a){this.each(function(){var c=this;var o=$.val("type",a);var b=$.val("src",a);var q=$.val("title",a,{default_value:"Untitled"});var e=$.val("columns",a);var n=$.uniqid();var m=$.val("default_presets",a);var l=parseInt($.val("preset_idx",a,{d:0}));if(isNaN(l)){l=0}var j=[];j.push($.p('<div class="widget-head padding10">',[q]));j.push($.p("<table><tr>",[]));j.push($.p('<td style="width:100%">',[]));j.push($.p('<h5 class="padding10">$1</h5>',[q]));j.push($.p("</td>",[q]));j.push($.p("<td>",[]));j.push($.p('<span id="$1"></span>',["preset-selector"+n]));j.push($.p('<span class="icon icon-reload fa fa-refresh padding10 selectable"></span>',[]));j.push($.p('<span class="icon icon-customize fa fa-ellipsis-h padding10 selectable"></span>',[]));j.push($.p("</td>",[]));j.push($.p("</tr></table>",[]));j.push($.p("</div>",[]));j.push($.p('<div class="modal" id="$1"></div>',["customize"+n]));var g=null;var d=[];var h="";if($.type(m)=="array"){for(var f=0;f<m.length;f++){if(f==l){h=m[f]["text"];g=m[f]}d.push({text:m[f]["text"],value:m[f]["text"]})}}switch(o){case"grid":j.push($.p('<div class="widget-body align-center margin10 ">',[]));j.push($.p('<span id="$1"></span>',["gridhead"+n]));j.push($.p("<div></div>",[]));j.push($.p('<span id="$1"></span>',["grid"+n]));j.push($.p("</div>",[]));$(c).html(j.join(""));var e=$.val("columns",a);$("#gridhead"+n,c).gridhead({columns:e,grid:"#grid"+n});var k=$(c).outerHeight()-$(".widget-head",c).outerHeight()-$("#gridhead"+n,c).outerHeight()-15;$("#grid"+n,c).grid({columns:e,height:k});break;case"chart":j.push($.p('<div class="widget-body align-center margin10 ">',[]));j.push($.p('<span id="$1"></span>',["chart"+n]));j.push($.p("</div>",[]));$(c).html(j.join(""));var p=$.val("chart_type",a);var k=$(c).outerHeight()-$(".widget-head",c).outerHeight()-$("#gridhead"+n,c).outerHeight()-15;$("#chart"+n).chart({width:"100%",height:k,padding:0,type:p});break;case"metric":j.push($.p('<div class="widget-body align-left margin10 ">',[]));j.push($.p('<span id="$1"></span>',["metric"+n]));j.push($.p("</div>",[]));$(c).html(j.join(""));break}$("#preset-selector"+n).dropdown({items:d,value:h,onchange:function(){$(c).widget_load()}});$("#customize"+n).gridsetting({onchange:function(r){var i=$(this).closest(".widget");var s=$(i).data("options");s=$.array_merge(s,r);$(i).data("options",s);$(c).widget_load()}});$(".icon-reload",c).click(function(){$(c).widget_load()});$(".icon-customize",c).click(function(){var s=$(this).closest(".widget");var i=$(s).data("options");var r=$.val("columns",i);var t=$.val("default_presets",i);$("#customize"+n).gridsetting_open({columns:r,presets:t,active_idx:0})});$(c).data("options",a);$(c).data("uid",n);$(c).widget_load()})},widget_load:function(){this.each(function(){var d=this;var f=$(d).data("options");var g=$.val("src",f);var c=$.val("type",f);var a=$.val("default_presets",f);var m=parseInt($.val("preset_idx",f,{d:0}));var b=$(d).data("uid");var j=$("#preset-selector"+b).dropdown_get();var e=null;var h=[];var l="";if($.type(a)=="array"){for(var k=0;k<a.length;k++){if(a[k]["text"]==j){l=a[k]["text"];e=a[k]}h.push({text:a[k]["text"],value:a[k]["text"]})}}switch(c){case"metric":$.api_post(g,e,function(i){$("#metric"+b).html("<h2>"+i.data+"</h2>")});break;case"grid":$.api_post(g,e,function(n){var i=$.val("data",n);$("#grid"+b,d).grid_set(i)});break;case"chart":$.api_post(g,e,function(i){$("#chart"+b).chart_set(i.data)});break}})}});$.extend({workspace_init:function(){$(".workspace").each(function(){var a=window.innerHeight-$(".header").outerHeight()-20;$(this).workspace_set({state:$(this).attr("data-state"),size:$(this).attr("data-size"),height:a});$.workspace_rtime;$.workspace_timeout=false;$.workspace_delta=200;$(window).resize(function(){$.workspace_rtime=new Date();if($.workspace_timeout===false){$.workspace_timeout=true;setTimeout($.workspace_resizeend,$.workspace_delta)}})})},workspace_resizeend:function(){if(new Date()-$.workspace_rtime<$.workspace_delta){setTimeout($.workspace_resizeend,$.workspace_delta)}else{$.workspace_timeout=false;$(".workspace").each(function(){var a=window.innerHeight-$(".header").outerHeight()-20;$($(this).children()[0]).css({height:a});$($(this).children()[1]).css({height:a});$($(this).children()[2]).css({height:a})})}}});$.fn.extend({workspace_set:function(a){if(typeof a=="undefined"||$.type(a)!="object"){return}$(this).each(function(){a=$.ksort(a);var j={};var h={flex:"1 1 auto"};var g={};for(var f in a){switch(f){case"size":var i=a[f];i=i.split(" ");var b=$.val(0,i,{d:300,t:"number"});var d=$.val(1,i,{d:400,t:"number"});j.flex="0 0 "+(b+"px");g.flex="0 0 "+(d+"px");$(this).data("left_size",b);$(this).data("right_size",d);break;case"height":j.height=a[f];h.height=a[f];g.height=a[f];break;case"state":var k=$.val("state",a,{d:""});k=k.split(" ");var e=$.val(0,k,{d:1,t:"number"});var c=$.val(2,k,{d:0,t:"number"});var b=e<1?"0":$(this).data("left_size");var d=c<1?"0":$(this).data("right_size");j.flex="0 0 "+(b+"px");g.flex="0 0 "+(d+"px");break}}if($(this).children().length==3){$($(this).children()[0]).css(j);$($(this).children()[1]).css(h);$($(this).children()[2]).css(g)}})}});$.fn.extend({autocomplete:function(k){var h=$.val("class",k,{d:""});var l=$.val("name",k,{d:""});var m=$.val("src",k,{d:""});var i=$.val("width",k);var n=$.val("placeholder",k,{d:""});var j={};if(i!=null){j.width=i}this.each(function(){var a=this;var b=[];b.push("<input type='text' placeholder=\""+n+'"/>');b.push("<span class='icon fa fa-search hoverable selectable'></span>");b.push("<span class='popup'></span>");$(a).addClass("autocomplete");$(a).addClass(h);$(a).html(b.join(""));$(a).css(j);$(a).attr("data-name",l);$(a).attr("data-type","autocomplete");$(a).data("options",k);$("input[type='text']",a).on("keyup",function(g){var c=$(this).closest(".autocomplete");if($(c).hasClass("readonly")){return}var d=$(c).data("options");var e=$.val("readonly",d);if(!e&&m.length>0){var f={};f.key=this.value;$.api_get(m,f,function(y){var B=$.val("data",y);var C=[];if($.type(B)=="array"){for(var w=0;w<B.length;w++){var z=B[w];var x=$.val("value",z,{d:""});var A=$.val("text",z,{d:x});C.push("<div class='item' data-value=\""+x+'">');C.push("<label>"+A+"</label>");C.push("</div>")}}$(".popup",c).html(C.join(""));$(".item",$(".popup",c)).on("click",function(){var o=this.getAttribute("data-value");var p=$("label",this).text();var q={value:o,text:p};$(c).autocomplete_val(q)});$.popup_open($(".popup",c),c,{min_width:$(c).outerWidth()})})}})})},autocomplete_val:function(e,d){if(typeof e=="undefined"){var f=[];$(this).each(function(){var h=$(this).data("options");var b=$.val("multiple",h,{d:false});if(b){$(".text",this).each(function(){f.push(this.getAttribute("data-value"))})}else{var c=$("input",this).val();var a=$(this).data("value");if(a==null){a=c}f.push(a)}});return f.length==1?f[0]:(f.length>1?f:"")}else{$(this).each(function(){var j=$(this).data("options");var a=$.val("multiple",j,{d:false});var i=f="";if($.type(e)=="object"){f=$.val("value",e,{d:""});i=$.val("text",e,{d:f})}else{i=f=e}if(a){var b=typeof d!="undefined"&&d===true?true:false;if(b){$(".text",this).remove()}var c=$(this).val();if(!$.in_array(f,c)&&f!==""){$("<span class='text' data-value=\""+f+'">'+i+"<span class='icon-remove glyphicons glyphicons-remove'></span></span>").insertBefore($("input",this));$(".glyphicons-remove",$("input",this).prev()).on("click",function(){$(this).parent().remove()})}$("input",this).val("")}else{$("input",this).val(i);$(this).data("value",f)}})}},autocomplete_readonly:function(b){if(typeof b=="undefined"){return $(this).hasClass("readonly")?true:false}else{if(b){$(this).addClass("readonly");$("input",this).attr("readonly",true);$("input",this).data("placeholder",$("input",this).attr("placeholder"));$("input",this).attr("placeholder","")}else{$(this).removeClass("readonly");$("input",this).attr("readonly",false);$("input",this).attr("placeholder",$("input",this).data("placeholder"))}}},autocomplete_reset:function(){$(this).autocomplete_val("",true)}});$.fn.extend({calendar:function(b){this.each(function(){var f=this;var e=$.val("value",b,{d:"2017-01-01"});e=$.date("j M Y",$.strtotime(e));var a=[];a.push("<input type='text' value='"+e+"' readonly/>");a.push("<span class='icon fa fa-calendar'></span>");a.push("<span class='popup'>Calendar</span>");$(f).addClass("calendar");$(f).html(a.join(""));$(f).attr("data-type","calendar");$(".icon",this).click(function(c){c.preventDefault();c.stopPropagation()});$(".popup",this).click(function(c){c.preventDefault();c.stopPropagation()})})}});$.extend({calendar_open:function(e){var g=e.refEl;var f=e.value;var h=$("#calendar");if(h.length==0){h=document.createElement("div");h.id="calendar";h.className="popup";document.body.appendChild(h);h=$("#calendar")}h=h[0];$(h).data("params",e);$.calendar_set(f);$.popup_open(h,g)},calendar_set:function(f){var e=$("#calendar").data("params");var d=$.val("type",e,{d:""});switch(d){case"range":$.calendar_set_range(f);break;default:$.calendar_set_single(f);break}},calendar_set_single:function(A){var B=$("#calendar");$(B).attr("data-value",A);var i=$.date("n",$.strtotime(A));var C=$.date("Y",$.strtotime(A));var y=$.date("j",$.strtotime(A));var j=$.start_day_of_month(C,i)%7;var x=$.last_date_of_month(C,i);var w=$.date("M Y",$.strtotime(A));var t=$(B).data("params");var u=t.onchange;var q=[];q.push("<table>");q.push("<tr>");q.push("<td><span class='calendar-prev fa fa-caret-left padding5'></span></td>");q.push("<td colspan='5'><span class='date-label'>"+w+"</span></td>");q.push("<td><span class='calendar-next fa fa-caret-right padding5'></span></td>");q.push("</tr>");q.push("<tr>");q.push("<td>Sun</td>");q.push("<td>Mon</td>");q.push("<td>Tue</td>");q.push("<td>Wed</td>");q.push("<td>Thu</td>");q.push("<td>Fri</td>");q.push("<td>Sun</td>");q.push("</tr>");var z=1;for(var r=0;r<6;r++){q.push("<tr>");for(var s=0;s<7;s++){if(j>0){q.push("<td></td>");j--}else{if(z<=x){q.push(z==y?"<td class='day active'>"+z+"</td>":"<td class='day'>"+z+"</td>");z++}else{q.push("<td></td>")}}}q.push("</tr>")}q.push("</table>");B.html(q.join(""));$(".day",B).click(function(d){d.preventDefault();d.stopPropagation();var b=$(this).closest("#calendar");var g=$(b).attr("data-value");var c=this.innerHTML;var e=parseInt($.date("n",$.strtotime(g)));var f=$.date("Y",$.strtotime(g));var a=$.date("j M Y",$.mktime(0,0,0,e,c,f));$.fire_event(u,[a],b);$.popup_close(b)});$(".calendar-prev",B).click(function(e){e.preventDefault();e.stopPropagation();var d=$(this).closest("#calendar");var c=$(d).attr("data-value");var f=parseInt($.date("n",$.strtotime(c)));var g=parseInt($.date("Y",$.strtotime(c)));var b=parseInt($("td.active",d).html());var a=$.date("Y-m-d",$.mktime(0,0,0,f-1,b,g));$.calendar_set(a)});$(".calendar-next",B).click(function(e){e.preventDefault();e.stopPropagation();var d=$(this).closest("#calendar");var c=$(d).attr("data-value");var f=parseInt($.date("n",$.strtotime(c)));var g=parseInt($.date("Y",$.strtotime(c)));var b=parseInt($("td.active",d).html());var a=$.date("Y-m-d",$.mktime(0,0,0,f+1,b,g));$.calendar_set(a)})},calendar_set_range:function(M,B,Q){var T=$("#calendar");$(T).attr("data-value",M);var i=$(T).data("params");var j=i.onchange;M=M.split("-");var U=M[0];var G=M[1];if($.date("Y",$.strtotime(U))=="1970"){U=$.date("Y-m-d")}if($.date("Y",$.strtotime(G))=="1970"){G=$.date("Y-m-d")}var k=[],L=[],E=[],R=[],C=[],S=[],N=[];var I=$.date("Y",$.strtotime(B))!="1970"?B:U;var K=$.date("Y",$.strtotime(Q))!="1970"?Q:G;if($.date("Ym",$.strtotime(K))==$.date("Ym",$.strtotime(I))){K=$.date("Y-m-d",$.mktime(0,0,0,parseInt($.date("n",$.strtotime(K)))+1,$.date("j",1,$.date("Y",$.strtotime(K)))))}k[0]=$.date("n",$.strtotime(I));L[0]=$.date("m",$.strtotime(I));E[0]=$.date("Y",$.strtotime(I));R[0]=$.date("j",$.strtotime(I));C[0]=$.start_day_of_month(E[0],k[0])%7;S[0]=$.last_date_of_month(E[0],k[0]);N[0]=$.date("M Y",$.strtotime(I));k[1]=$.date("n",$.strtotime(K));L[1]=$.date("m",$.strtotime(K));E[1]=$.date("Y",$.strtotime(K));R[1]=$.date("j",$.strtotime(K));C[1]=$.start_day_of_month(E[1],k[1])%7;S[1]=$.last_date_of_month(E[1],k[1]);N[1]=$.date("M Y",$.strtotime(K));var O=[];for(var D=0;D<2;D++){O.push("<table class='calendar-table range-"+D+"'>");O.push("<tr>");O.push($.p("<td><span class='calendar-prev fa fa-caret-left padding5' data-calendaridx='$i'></span></td>",[D]));O.push("<td colspan='5'><span class='date-label'>"+N[D]+"</span></td>");O.push($.p("<td><span class='calendar-next fa fa-caret-right padding5' data-calendaridx='$i'></span></td>",[D]));O.push("</tr>");O.push("<tr>");O.push("<td>Sun</td>");O.push("<td>Mon</td>");O.push("<td>Tue</td>");O.push("<td>Wed</td>");O.push("<td>Thu</td>");O.push("<td>Fri</td>");O.push("<td>Sun</td>");O.push("</tr>");var H=1;for(var F=0;F<6;F++){O.push("<tr>");for(var J=0;J<7;J++){if(C[D]>0){O.push("<td></td>");C[D]--}else{if(H<=S[D]){var P=$.date("Y-m-d",$.strtotime(E[D]+"-"+L[D]+"-"+$.str_pad(H,2,"0","STR_PAD_LEFT")));if($.strtotime(P)>=$.strtotime(U)&&$.strtotime(P)<=$.strtotime(G)){O.push("<td class='day active' data-date='"+P+"'>"+H+"</td>")}else{O.push("<td class='day' data-date='"+P+"'>"+H+"</td>")}H++}else{O.push("<td></td>")}}}O.push("</tr>")}O.push("</table>")}T.html(O.join(""));T.data("seq",0);$(".day",T).click(function(l){l.preventDefault();l.stopPropagation();console.log("value: "+1);var o=$(this).closest("#calendar");var m=$(o).attr("data-value");var n=this.innerHTML;var h=parseInt($.date("n",$.strtotime(m)));var f=$.date("Y",$.strtotime(m));var g=$.date("j M Y",$.mktime(0,0,0,h,n,f));var b=parseInt(o.data("seq"));if(b==0){$(".day.active-0").removeClass("active active-0");$(this).addClass("active active-0");var a=$(this).attr("data-date");var e=$(o).attr("data-value");e=e.split(",");var c=$.val(1,e,{d:a});$(".day",o).each(function(){var p=$(this).attr("data-date");if($.strtotime(p)>=$.strtotime(a)&&$.strtotime(p)<=$.strtotime(c)){$(this).addClass("active")}else{$(this).removeClass("active")}})}else{$(".day.active-1").removeClass("active active-1");$(this).addClass("active active-1")}o.data("seq",b+1);if(b==1){var a=$(".day.active-0").attr("data-date");var c=$(".day.active-1").attr("data-date");if($.strtotime(a)>$.strtotime(c)){var d=a;a=c;c=d}var e=$.date("Ymd",$.strtotime(a))+"-"+$.date("Ymd",$.strtotime(c));$.popup_close(o);$.fire_event(j,[e],o)}});$(".calendar-prev",T).click(function(a){var b=parseInt($(this).attr("data-calendaridx"));console.log(["prev",M,parseInt($(this).attr("data-calendaridx")),I,K]);a.preventDefault();a.stopPropagation();if(b==0){I=$.date("Y-m-d",$.mktime(0,0,0,parseInt($.date("n",$.strtotime(I)))-1,$.date("j",$.strtotime(I)),$.date("Y",$.strtotime(I))))}else{if(b==1){K=$.date("Y-m-d",$.mktime(0,0,0,parseInt($.date("n",$.strtotime(K)))-1,$.date("j",$.strtotime(K)),$.date("Y",$.strtotime(K))));if($.date("Ym",$.strtotime(I))>=$.date("Ym",$.strtotime(K))){I=$.date("Y-m-d",$.mktime(0,0,0,parseInt($.date("n",$.strtotime(I)))-1,$.date("j",$.strtotime(I)),$.date("Y",$.strtotime(I))))}}}$.calendar_set_range(M.join(","),I,K)});$(".calendar-next",T).click(function(a){var b=parseInt($(this).attr("data-calendaridx"));a.preventDefault();a.stopPropagation();if(b==0){I=$.date("Y-m-d",$.mktime(0,0,0,parseInt($.date("n",$.strtotime(I)))+1,$.date("j",$.strtotime(I)),$.date("Y",$.strtotime(I))));if($.date("Ym",$.strtotime(K))<=$.date("Ym",$.strtotime(I))){K=$.date("Y-m-d",$.mktime(0,0,0,parseInt($.date("n",$.strtotime(K)))+1,$.date("j",$.strtotime(K)),$.date("Y",$.strtotime(K))))}}else{if(b==1){K=$.date("Y-m-d",$.mktime(0,0,0,parseInt($.date("n",$.strtotime(K)))+1,$.date("j",$.strtotime(K)),$.date("Y",$.strtotime(K))))}}$.calendar_set_range(M.join(","),I,K)})}});$.fn.extend({chart:function(f){var g=$.val("name",f);var h=$.val("height",f);var e=$.val("width",f);this.each(function(){var b=this;var c={};c.height=h;c.width=e;var a=[];$(b).addClass("chart");$(this).html(a.join(""));$(this).css(c);$(b).attr("data-type","chart");$(b).attr("data-name",g);$(b).data("options",f)})},chart_set:function(b){this.each(function(){var e=this;var a=$(e).data("options");var f=$.val("type",a,{default_value:"line"});switch(f){case"bar":$(this).chart_bar_set(b);break;default:$(this).chart_line_set(b);break}})},chart_bar_set:function(b){this.each(function(){var Q=this;var J=$(Q).data("options");var R=$(Q).outerHeight();var w=$(Q).outerWidth();var U=$.val("padding",J,{default_value:10});var aa=$.array_key_count(b);var h=$.object_value_min(b);var W=$.object_value_max(b);var L=U;var af=w-U;var P=af-L;var Y=(w*0.8)/aa;var x=(P-(Y*aa))/(aa+1);var a=R-U;var T=10;var O=a-T;var ag=O/(W-h);var Z=[];Z.push($.p('<svg width="$1" height="$2">',[w,R]));var S=L;var V=af;var K=a,N=a;Z.push($.p('<line x1="$x1" y1="$y1" x2="$x2" y2="$y2" style="stroke:rgb(0,0,0);stroke-width:1" />',[S,K,V,N]));var ad=0;for(var y in b){var M=b[y];var ab=Y;var X=ag*M;if(X<5){X=5}var ac=ad*(x+Y)+x;var ae=a-X;Z.push($.p('<rect x="$1" y="$1" width="$1" height="$1" stroke="#4A89DC" stroke-width="2" fill="rgba(74, 137, 220, .2)" data-key="$1" data-value="$1" onmouseover="$1" onmouseout="$1"/>',[ac,ae,ab,X,y,M,"$.chart_line_mouseover.call(this)","$.chart_line_mouseout.call(this)"]));ad++}Z.push("</svg>");$(Q).html(Z.join(""))})},chart_line_set:function(b){this.each(function(){var P=this;var Z=$(P).data("options");var Q=$(P).outerHeight();var H=$(P).outerWidth();var G=$.array_key_count(b);var Y=$.object_value_min(b);var T=$.object_value_max(b);var S=$.val("padding",Z,{default_value:10});var N=S;var W=H-S;var a=W-N;var K=a/(G-1);var L=Q-S;var J=10;var M=L-J;var X=M/(T-Y);var U=[];U.push($.p('<svg width="$1" height="$2">',[H,Q]));var E=N;var F=W;var aa=L,ac=L;U.push($.p('<line x1="$x1" y1="$y1" x2="$x2" y2="$y2" style="stroke:rgb(0,0,0);stroke-width:1" />',[E,aa,F,ac]));var V=1;for(var O in b){var ab=Math.round(N+(V*K));U.push($.p('<line x1="$1" y1="$1" x2="$1" y2="$1" style="stroke:rgba(0, 0, 0, .05);stroke-width:1" />',[ab,L,ab,J]));V++}var V=0;var d=[];d.push($.p("M$1 $2",[Math.round(N+(V*K)),L]));for(var O in b){var R=b[O];var ab=Math.round(N+(V*K));var I=Math.round(L-(R*X));d.push($.p("L$1 $2",[ab,I]));V++}d.push($.p("M$1 $2 Z",[ab,L]));U.push($.p('<path d="$1" stroke-width="0" stroke="transparent" fill="rgba(74, 137, 220, .2)"/>',[d.join(" ")]));var V=0;var d=[];for(var O in b){var R=b[O];var ab=Math.round(N+(V*K));var I=Math.round(L-(R*X));if(V==0){d.push($.p("M$1 $2",[ab,I]))}else{d.push($.p("L$1 $2",[ab,I]))}V++}U.push($.p('<path d="$1" stroke-width="2" stroke="#4A89DC" fill="transparent"/>',[d.join(" ")]));var V=0;for(var O in b){var R=b[O];var ab=N+(V*K);var I=L-(R*X);U.push($.p('<circle cx="$1" cy="$1" r="1" stroke="#4A89DC" stroke-width="2" fill="#4A89DC" onmouseover="$1" onmouseout="$1" data-key="$1" data-value="$1"/>',[ab,I,"$.chart_line_mouseover.call(this)","$.chart_line_mouseout.call(this)",O,R]));V++}U.push("</svg>");$(P).html(U.join(""))})}});$.extend({chart_line_mouseover:function(){$(this).attr({r:2});var d=$(this).attr("data-key");var c=$(this).attr("data-value");$.tooltip(this,d+"<br />"+c)},chart_line_mouseout:function(){$(this).attr({r:1});$.tooltip_remove()}});$.fn.extend({checkbox:function(b){this.each(function(){var j=$.val("class",b,{d:""});var l=$.val("items",b,{d:null});var k=[];if($.type(l)=="array"){$(l).each(function(){var c=$.val("text",this,{d:""});var d=$.val("value",this,{d:""});var e="checkbox-"+$.uniqid();k.push("<span class='item'><input id='"+e+"' type='checkbox' value=\""+d+"\"/><label for='"+e+"'>"+c+"</label></span>")})}else{var h=$.val("text",b,{d:""});var i="";var a="checkbox-"+$.uniqid();k.push("<span class='item'><input id='"+a+"' type='checkbox' value=\""+i+"\"/><label for='"+a+"'>"+h+"</label></span>")}$(this).addClass("checkbox");$(this).addClass(j);$(this).html(k.join(""));$(this).data("options",b)})}});$.fn.extend({checklist:function(b){$(this).each(function(){var a=this;var d=[];d.push("<div class='checklist-body'>");d.push("<div class='checklist-item'>");d.push("<input type='checkbox' />");d.push("<input type='text' />");d.push("<span class='iconbar'>");d.push("<span class='checklist-remove fa fa-times padding5 selectable'></span>");d.push("</span>");d.push("</div>");d.push("</div>");d.push("<div class='checklist-foot'>");d.push("<span class='checklist-add fa fa-plus-circle padding5 selectable hoverable'></span>");d.push("</div>");$(this).addClass("checklist");$(this).html(d.join(""));$(".checklist-add",this).click(function(){$(a).checklist_add()});$(".checklist-remove",this).on("click.checklist",function(){$(this).closest(".checklist-item").remove()})})},checklist_add:function(){$(this).each(function(){var b=[];b.push("<div class='checklist-item'>");b.push("<input type='checkbox' />");b.push("<input type='text' />");b.push("<span class='iconbar'>");b.push("<span class='checklist-remove fa fa-times padding5 selectable hoverable'></span>");b.push("</span>");b.push("</div>");$(".checklist-body",this).append(b.join(""));$(".checklist-remove",$(".checklist-body",this)).on("click.checklist",function(){$(this).closest(".checklist-item").remove()})})},checklist_get:function(){var b=[];$(this).each(function(){$(".checklist-item",this).each(function(){var a=$("input[type='checkbox']",this)[0].checked;var d=$("input[type='text']",this).val();if(d.length>0){b.push({checked:a,text:d})}})});return b.length==0?null:b},checklist_set:function(b){$(this).checklist_attr({value:b})},checklist_attr:function(b){if($.type(b)!="object"){return}$(this).each(function(){for(var a in b){var k=b[a];switch(a){case"readonly":if(k){$("input[type='checkbox']",this).attr("disabled",true);$("input[type='text']",this).attr("readonly",true);$(".checklist-remove",this).addClass("hidden");$(".checklist-add",this).addClass("hidden")}else{$("input[type='checkbox']",this).attr("disabled",false);$("input[type='text']",this).attr("readonly",false);$(".checklist-remove",this).removeClass("hidden");$(".checklist-add",this).removeClass("hidden")}break;case"value":var i=[];if($.type(k)=="array"){for(var m=0;m<k.length;m++){var l=k[m];var j=$.val("text",l,{d:""});var n=$.val("checked",l,{d:false});if(j==""){continue}i.push("<div class='checklist-item'>");i.push("<input type='checkbox'"+(n?" checked":"")+"/>");i.push("<input type='text' value=\""+j+'" />');i.push("<span class='iconbar'>");i.push("<span class='checklist-remove fa fa-times padding5 selectable hoverable'></span>");i.push("</span>");i.push("</div>")}}i.push("<div class='checklist-item'>");i.push("<input type='checkbox'/>");i.push("<input type='text'/>");i.push("<span class='iconbar'>");i.push("<span class='checklist-remove fa fa-times padding5 selectable hoverable'></span>");i.push("</span>");i.push("</div>");$(".checklist-body",this).html(i.join(""));$(".checklist-remove",$(".checklist-body",this)).on("click.checklist",function(){$(this).closest(".checklist-item").remove()});break}}})}});$.fn.extend({choice:function(b){$(this).each(function(){var m=$.val("class",b,{d:""});var n=$.val("items",b,{d:[],datatype:"array"});var a=[];if($.type(n)=="array"){for(var i=0;i<n.length;i++){var l=n[i];var k=$.val("value",l,{d:""});var j=$.val("text",l,{d:k});if(k.length==0){continue}a.push($.p('<span class="item">'));a.push($.p("</span>"))}}$(this).addClass("choice");$(this).addClass(m)})}});$.fn.extend({codeeditor:function(g){var i=$.val("height",g,{d:"200px"});var f=$.val("width",g,{d:"300px"});var h=$.val("name",g,{d:""});var j=$.val("value",g,{d:"300px"});this.each(function(){var c=$.uniqid();var a=[];a.push($.p('<textarea id="$1""></textarea>',["codeeditor-text-"+c]));$(this).addClass("codeeditor");$(this).html(a.join(""));$(this).css({width:f,height:i});$(this).codeeditor_attr({name:h});var b=CodeMirror.fromTextArea(document.getElementById("codeeditor-text-"+c),{lineNumbers:true,mode:"text/x-mariadb",indentWithTabs:true,smartIndent:true,matchBrackets:true,autofocus:true})})},codeeditor_get:function(){var b=[];$(this).each(function(){b.push($("textarea",this).val())});return b.length==1?b[0]:(b.length>1?b:"")},codeeditor_set:function(b){$(this).each(function(){$("textarea",this).val(b)})},codeeditor_attr:function(b){this.each(function(){var i={};var h={};var a={};for(var j in a){var g=a[j];switch(j){case"name":a.name=g}}$(this).attr(a);$(this).css(i);$("textarea",this).css(h)})}});$.fn.extend({codefield:function(h){var k=$.val("placeholder",h,{d:""});var i=$.val("name",h,{d:""});var j=$.val("height",h);var l=$.val("width",h);var g={width:l,height:j};this.each(function(){var a=this;var b=[];b.push("<pre style='height:"+j+";'>"+JSON.stringify({name:"andy"},null,2)+"</pre>");b.push("<span class='icon fa hidden'></span>");$(a).addClass("codefield");$(a).css(g);$(a).html(b.join(""));$(a).attr("data-type","codefield");$(a).attr("data-name",i);$(a).data("options",h)})},codefield_get:function(){var b=[];this.each(function(){var a=$("pre",this).html();b.push(a)});return b.length>1?b:(b.length==1?b[0]:"")},codefield_set:function(b){this.each(function(){$("pre",this).html(b)})}});$.fn.extend({commentlist:function(c){var d=$.val("onsubmit",c);$(this).each(function(){var b=this;var a=[];a.push("<div class='commentlist-write'>");a.push("<input type='text' placeholder='Write comment here...' />");a.push("</div>");a.push("<div class='commentlist-list'></div>");$(this).addClass("commentlist");$(this).html(a.join(""));$(this).data("options",c);$("input[type='text']",this).on("keyup",function(e){if(e.keyCode==13){if(e.shiftKey){}else{if(this.value!=""){$.fire_event(d,[this.value],b);this.value="";$(this).blur()}}}})})},commentlist_add:function(b){$(this).each(function(){var l=$(this).data("options");var j=$.val("onremove",l);var m=$.val("id",b);var n=$.val("comment",b);var o=$.val("full_name",b);var a=$.val("createdon",b);var p=$.val("removable",b,{d:0});if(!n||!o){return}var k=[];k.push("<div class='commentlist-item' data-id='"+m+"'>");k.push("<p style='word-wrap: break-word;'><b>"+o+"</b> "+n+"</p>");k.push("<div class='commentlist-item-footer'>");k.push("<label class=''>"+a+"</label>");if(p){k.push("<span class='width5 height5'>&nbsp;</span>");k.push("<span class='comment-item-remove selectable hoverable'>Remove</span>")}k.push("</div>");k.push("</div>");$(".commentlist-list",this).append(k.join(""));$(".comment-item-remove",$(".commentlist-list",this)).on("click",function(){var c=$(this).closest(".commentlist-item").attr("data-id");$.fire_event(j,[c],this)})})},commentlist_set:function(b){$(this).each(function(){var m=$(this).data("options");var s=$.val("onremove",m);var q=[];if($.type(b)=="array"){for(var r=0;r<b.length;r++){var t=b[r];var a=$.val("id",t);var p=$.val("comment",t);var o=$.val("full_name",t);var n=$.val("createdon",t);var i=$.val("removable",t,{d:0});if(!p||!o){continue}q.push("<div class='commentlist-item' data-id='"+a+"'>");q.push("<p style='word-wrap: break-word;'><b>"+o+"</b> "+p+"</p>");q.push("<div class='commentlist-item-footer'>");q.push("<label class=''>"+n+"</label>");if(i){q.push("<span class='width5 height5'>&nbsp;</span>");q.push("<span class='comment-item-remove selectable hoverable'>Remove</span>")}q.push("</div>");q.push("</div>")}}$(".commentlist-list",this).html(q.join(""));$(".comment-item-remove",$(".commentlist-list",this)).on("click",function(){var c=$(this).closest(".commentlist-item").attr("data-id");$.fire_event(s,[c],this)})})}});$.fn.extend({container_val:function(b){if(typeof b=="undefined"){result={};$("*[data-type]",this).each(function(){var a=this.getAttribute("data-name");if(a!=null&&a!=""){var d=$(this).val();result[a]=d}});return result}else{$("*[data-type]",this).each(function(){var a=this.getAttribute("data-name");if(a!=null&&a!=""){var d=$.val(a,b,{d:""});$(this).val(d)}})}},container_reset:function(){$("*[data-type]",this).each(function(){var b=$(this).attr("data-type");if(b!=null&&typeof $(this)[b+"_reset"]!="undefined"){$(this)[b+"_reset"].apply(this,arguments)}})}});$.fn.extend({datepicker:function(d){var c=$.val("type",d);this.each(function(){var a=this;var b=[];b.push("<input type='text' readonly/>");b.push("<span class='icon fa fa-calendar'></span>");$(a).addClass("datepicker");$(a).html(b.join(""));$(a).attr("data-type","datepicker");$(a).data("options",d);$(".icon",this).click(function(e){e.preventDefault();e.stopPropagation();var j=$(this).closest(".datepicker");var k=$(j).data("options");var l=$.val("readonly",k,{d:false});if(l=="0"||l==false){$.calendar_open({refEl:j,value:$(j).data("value"),type:c,onchange:function(f){$(j).datepicker_val(f)}})}});$(".popup",this).click(function(e){e.preventDefault();e.stopPropagation()});$(this).datepicker_val($.val("value",d,{d:"20170101"}))})},datepicker_val:function(b){if(typeof b=="undefined"){var b=[];$(this).each(function(){var a=$(this).data("value");b.push(a)});return b.length==1?b[0]:(b.length==0?null:b)}else{$(this).each(function(){var d="";b=$.date_parse(b);if(b.indexOf("-")>=0){var g=b.split("-");var h=$.date("M j, Y",$.strtotime(g[0]));var a=$.date("M j, Y",$.strtotime(g[1]));d=h+" - "+a}else{var g=$.date("M j, Y",$.strtotime(b));d=g}$("input",this).val(d);$(this).data("value",b)})}}});$.fn.extend({dropdown:function(m){var r=$.val("class",m,{d:""});var k=$.val("name",m,{d:""});var n=$.val("defaultvalue",m,{d:""});var o=$.val("value",m,{d:n});var q=$.val("items",m,{d:[]});var t=$.val("width",m,{d:[]});var l=$.val("src",m,{d:""});var p=$.val("placeholder",m,{d:""});var s=[];s.push("<input class='text' type='text' placeholder=\""+p+'" readonly/>');s.push("<span class='icon fa fa-caret-down hoverable'></span>");s.push("<span class='popup'></span>");this.each(function(){var a=this;$(a).addClass("dropdown");$(a).addClass(r);$(a).html(s.join(""));$(a).data("options",m);$(a).attr("data-type","dropdown");$(a).attr("data-name",k);$(a).dropdown_attr(m);$(".icon, .text",a).click(function(e){e.preventDefault();e.stopPropagation();var b=$(this).closest(".dropdown");var c=$(b).data("options");var d=$.val("readonly",c);if(!d){if($(".popup",b).hasClass("on")){$.popup_close($(".popup",b))}else{$.popup_open($(".popup",b),b,{min_width:$(b).outerWidth()});$(".search-item input",$(".popup",b)).val("");$(".search-item input",$(".popup",b)).focus();$(".item",$(".popup",b)).show()}}});if(o!=""){$(a).dropdown_val()}if(l.length>0){$(this).dropdown_load()}})},dropdown_val:function(e,f){if(typeof e=="undefined"){var d=[];this.each(function(){var a=this;var c=$(a).attr("data-value");var b=$("input",a).length==1?$("input",a).val():$(".text",a).html();c=c==null?b:c;d.push(c)});return d.length==1?d[0]:(d.length>1?d:null)}else{this.each(function(){var c=$(this).data("options");var i=$.val("items",c,{d:[]});var k="";var l="";if($.type(e)=="object"){l=$.val("value",e);k=$.val("text",e,{d:l})}else{if($.type(l)=="string"){k=l=e}}if($.type(i)=="array"){for(var b=0;b<i.length;b++){var a=i[b];if(a.value==l){k=a.text;l=a.value;break}}}$(this).attr("data-value",l);$("input",this).val(k);$(".text",this).html(k)})}},dropdown_items:function(d){if(typeof d=="undefined"){var c=[];this.each(function(){var b=this;var f=$(b).data("options");var a=$.val("items",f,{d:[]});$(a).each(function(){if($.type(this)=="object"){c.push(this)}})});return c}else{this.each(function(){var t=this;var s=$(t).data("options");var a=$.val("searchable",s,{d:false});var r=$.val("multiple",s,{d:false});var q=$.val("onchange",s);var i=[];if(a==true){i.push("<div class='search-item'>");i.push("<input type='text' placeholder='Search'/>");i.push("</div>")}if($.type(d)=="array"){for(var p=0;p<d.length;p++){var w=d[p];var x=w.text;var y=w.value;var u=(x+" "+y).toLowerCase();var b=$.uniqid();i.push("<div class='item' data-value=\""+y+'" data-search="'+u+'">');if(r){i.push("<input type='checkbox' id='dropdown_item_checkbox_"+b+"'/>")}i.push("<label for='dropdown_item_checkbox_"+b+"'>"+x+"</label>");i.push("</div>")}}i=i.join("");$(".popup",t).html(i);$(t).data("options",s);$(".item",$(".popup",t)).click(function(g){if(r){g.stopPropagation()}var n=$("label",this).html();var e=$(this).attr("data-value");var h=-1;var k=null;for(var j=0;j<d.length;j++){var m=d[j];var f=$.val("text",m);var l=$.val("value",m);if(l==e||f==n){h=j;k=m;break}}if(k){k._index=h}$("input",t).val(n);$(".text",t).html(n);$(t).attr("data-value",e);$.fire_event(q,[g,k],t)});$(".item>input[type='checkbox']",$(".popup",t)).on("change",function(){var e=this.nextElementSibling.innerHTML;var f=this.parentNode.getAttribute("data-value");$(t).dropdown_val({text:e,value:f},true)});$(".popup .search-item input",t).click(function(e){e.preventDefault();e.stopPropagation()});$(".popup .search-item input",t).keyup(function(g){var e=this.value;var f=$(this).closest(".popup");$(".item",f).show();if(e.length>0){$(".item:not([data-search*='"+e+"'])",f).hide()}});s.items=d;$(t).data("options",s);$(t).dropdown_val("*")})}},dropdown_attr:function(b){this.each(function(){var a=$(this).data("options");if($.type(b)=="object"){for(var g in b){var f=b[g];var h={};switch(g){case"items":$(this).dropdown_items(f);break;case"readonly":if(f){$(this).addClass("readonly");a.readonly=true}else{$(this).removeClass("readonly");a.readonly=false}break;case"value":$(this).dropdown_val(f);break;case"width":h.width=parseInt(f);break}$(this).css(h)}}$(this).data("options",a)})},dropdown_load:function(){this.each(function(){var f=this;var d=$(f).data("options");var e=$.val("src",d,{d:""});$.api_post(e,{},function(b){var a=$.val("data",b);if($.type(a)=="array"){$(f).dropdown_items(a)}})})},dropdown_reset:function(){$(this).each(function(){var d=$(this).data("options");var c=$.val("defaultvalue",d,{d:""});$(this).dropdown_val(c)})},dropdown_readonly:function(b){$(this).each(function(){if($.istrue(b)){$(this).addClass("readonly")}else{$(this).removeClass("readonly")}})}});$.fn.extend({feed:function(b){$(this).each(function(){var h=$.val("class",b,{d:""});var f=$.val("src",b,{d:""});var g=$.val("autoload",b,{d:false});var a=[];a.push("<div class='feed-content'></div>");a.push("<div class='feed-footer'></div>");$(this).addClass("feed");$(this).addClass(h);$(this).html(a.join(""));$(this).data("options",b);if(g){$(this).feed_load()}})},feed_val:function(c,d){if(typeof c=="undefined"){}else{$(this).each(function(){var a=$(this).data("options");var r=$.val("src",a,{d:""});var b=$.val("template",a,{d:""});if($.type(c)=="array"&&c.length>0){var m="feed_group_"+$.uniqid();var i=document.createElement("div");i.setAttribute("data-feed-group-id",m);var n=[];for(var o=0;o<c.length;o++){n.push("<div class='feed-item'></div>")}i.innerHTML=n.join("");$(".feed-content",this).append(i);for(var o=0;o<c.length;o++){var p=c[o];var q=i.childNodes[o];$.fire_event(b,[p],q)}}})}},feed_load:function(b){$(this).each(function(){if(!$(this).hasClass("feed")){return}var a=this;var f=$(this).data("options");var e=$.val("src",f,{d:""});if(e!=""){$.api_post(e,[],function(j){var c=$.val("data",j,{d:[]});var d=$.val("page",j,{d:1});var k=d==1?false:true;$(a).feed_val(c,k);var l=$.val("max_page",j,{d:d});if(l>=d+1){$(".feed-footer",a).html("<div class='load-more align-center padding10'>Load More...</div>");$(".load-more",a).on("click",function(){$(a).feed_load({page:d+1})})}else{$(".feed-footer",a).html("")}})}})}});$.extend({foldedpane_toggle:function(e){var d=$(e);if(typeof d[0]=="undefined"){return}var f=$(".toggler",d);if(d[0].classList.contains("folded")){d[0].classList.remove("folded");if(f.length==1){f.html("<span class='fa fa-caret-up'></span>")}}else{d[0].classList.add("folded");if(f.length==1){f.html("<span class='fa fa-caret-down'></span>")}}},foldedpane_init:function(){var g=document.body.querySelectorAll(".folded-pane");for(var h=0;h<g.length;h++){var f=g[h];var e=f.querySelector(".toggler");if(e!=null){e.addEventListener("click",function(){$.foldedpane_toggle(f)})}}}});$.fn.extend({grid:function(m){var j=$.val("autoload",m,{d:true});var l=$.val("columns",m,{d:[]});var k=$.val("class",m,{d:null});var n=$.val("name",m,{d:""});var p=$.val("footer",m,{d:""});var i=$.val("value",m,{d:null});var o=$.val("height",m,{d:"auto"});m.page=0;m.row_per_page=12;this.each(function(){var a=this;var b=[];b.push("<table class='grid-body'>");b.push("<tbody class='grid-size'></tbody>");b.push("</table>");b.push("<div class='grid-footer'></div>");$(a).attr("data-type","grid");$(a).addClass("grid");$(a).addClass(k);if(n!=""){$(a).attr("data-name",n)}$(a).data("options",m);$(a).attr("data-type","grid");$(a).html(b.join(""));$.fire_event(p,[],$(".grid-footer",a));$(this).grid_set_columns(l);if(i!=null){$(a).grid_set(i)}if(j){$(a).grid_load()}})},grid_add:function(b){this.each(function(){var I=this;var i=I.querySelector(".grid-body");var B=$(I).data("options");var K=$.val("columns",B,{d:[]});var J=[];if($(".grid-size",i).length==0){var y=[];y.push("<tr class='grid-size'>");for(var D=0;D<K.length;D++){var C=K[D];var x=$.val("width",C,{d:""});y.push("<td style='width:"+x+";'></td>");y.push("<td class='separator'></td>")}y.push("<td style='width:100%'></td>");y.push("</tr>");J.push(y.join(""))}J.push("<tr>");for(var F=0;F<K.length;F++){var C=K[F];var E=$.val("type",C,{d:"text"});var z=$.val("datatype",C,{d:"text"});var a=$.val("name",C,{d:""});var x=$.val("width",C,{d:""});var H=$.val("align",C,{d:""});var A="";var G="";var w="";switch(E){case"index":w=D+1;A="right";G="label";break;case"html":gridtypecoord=0+","+F;break;default:switch(z){case"number":case"money":A="right";w=$.val(a,b,{d:0});break;case"enum":var j=$.val("enums",C,{d:{}});w=$.val(a,b,{d:"-"});w=$.val(w,j,{d:"-"});break;default:w=$.val(a,b,{d:"-"});break}G="label";break}if(H!=""){A=H}J.push("<td data-gridtype='"+E+"' data-gridtypecoord='"+gridtypecoord+"' class='"+G+"' style='text-align:"+A+"'>"+w+"</td>");J.push("<td class='separator'></td>")}J.push("<td></td>");J.push("</tr>");$("tbody",i).append(J.join(""));$("td[data-gridtype='html']",$("tr",$("tbody",i)).last()).each(function(){var f=$(this).attr("data-gridtypecoord").split(",");var e=parseInt(f[1]);var d=K[e];var c=$.val("html",d,{d:""});$.fire_event(c,[b,d],this)})})},grid_remove:function(c){var d=this;$(c).each(function(){var a=$(this).closest(".grid");a=typeof a[0]!="undefined"?a[0]:-2;var b=typeof d[0]!="undefined"?d[0]:-1;if(a==b){$(this).remove()}})},grid_set_columns:function(b){$(this).each(function(){if(!$(this).hasClass("grid")){return}var i=$(this).data("options");i.columns=b;$(this).data("options",i);var m=[];m.push("<tr>");for(var a=0;a<b.length;a++){var k=b[a];var n=$.val("name",k);var l=$.val("width",k);var j=$.val("active",k,{d:1});if(j==1){m.push($.p("<td class='grid-size-label' style='width:$1' data-key='"+n+"'></td>",[l]))}else{m.push($.p("<td class='grid-size-label inactive' style='width:$1' data-key='"+n+"'></td>",[l]))}}m.push("<td style='width:100%'></td>");m.push("</tr>");$(".grid-size",this).html(m.join(""))})},grid_append:function(c,d){this.each(function(){var q=this;var s=q.querySelector(".grid-body");var r=$(q).data("options");var t=$.val("src",r,{d:""});var w=$.val("onselect",r);var p=$.val("columns",r,{d:[]});var x=$.val("page",c,{d:1});var u=$.val("row_per_page",c,{d:10});var i=$.val("max_page",c,{d:x});var y=$.val("data",c);if(typeof r.data=="undefined"){r.data=[]}var a=document.createElement("tbody");$(a).html($.grid_html(y,p,r.data.length));$(s).append(a);$("td[data-gridtype='html']",a).each(function(){var f=$(this).attr("data-gridtypecoord").split(",");var k=parseInt(f[0]);var e=parseInt(f[1]);var h=y[k];var j=p[e];var g=$.val("html",j,{d:""});$.fire_event(g,[h,j],this)});$("tr",a).click(function(){var e=$(this).closest("table");$(".active",e).removeClass("active");$(this).addClass("active");var f=$(this).attr("data-idx");var g=r.data[f];$.fire_event(w,[g],q)});$(".grid-more",q).remove();if(i>x){$(q).append("<div class='grid-more' data-page='"+x+"'><label class='cl-gray'>Load more...</label></div>");$(".grid-more",q).click(function(){var e=parseInt($(this).attr("data-page"));var f=$.val("onloadmore",r);$(this).html("<i class='fa fa-circle-o-notch fa-spin fa-fw cl-gray'></i>");if(t!=""){$(q).grid_load()}$.fire_event(f,[{page:e}],q)});$(".grid-more",q).appear(function(){var e=parseInt($(this).attr("data-page"));var f=$.val("onloadmore",r);$(this).html("<i class='fa fa-circle-o-notch fa-spinfa-fw cl-gray'></i>");if(t!=""){$(q).grid_load()}$.fire_event(f,[{page:e}],q)})}for(var b=0;b<y.length;b++){r.data.push(y[b])}$(q).data("options",r)})},grid_load:function(b){this.each(function(){var o=this;var k=$(o).data("options");var n=$.val("src",k,{d:""});var m=$.val("method",k,{d:"post"});if(n.length>0){var p=$.val("page",b,{d:1});var a=$.val("row_per_page",b,{d:10});var j=$.val("columns",k);var l={page:p,row_per_page:a,columns:j};if(m.toString().toLowerCase()=="get"){$.api_get(n,l,function(d){var f=$.val("data",d,{d:[]});var g=$.val("page",d,{d:1});var e=g==1?false:true;$(o).grid_val(f,e);var c=$.val("next_page",d,{d:g});if(c>g){$(".grid-footer",o).html("<div class='load-more align-center padding10'>Load More...</div>");$(".load-more",o).on("click",function(){$(o).grid_load({page:c})})}else{$(".grid-footer",o).html("")}})}else{$.api_post(n,l,function(d){var f=$.val("data",d,{d:[]});var g=$.val("page",d,{d:1});var e=g==1?false:true;$(o).grid_val(f,e);var c=$.val("next_page",d,{d:g});if(c>g){$(".grid-footer",o).html("<div class='load-more align-center padding10'>Load More...</div>");$(".load-more",o).on("click",function(){$(o).grid_load({page:c})})}else{$(".grid-footer",o).html("")}})}$(".grid-footer",this).html("<div class='align-center padding10'>Loading...</div>")}})},grid_val:function(c,d){if(typeof c=="undefined"){var c=[];this.each(function(){var f=this;var b=f.querySelector(".grid-body");var a=$("tbody",b);$(a).children().each(function(){if(this.classList.contains("grid-size")){}else{var h=$(this).attr("data-idx");var e=$.el_get(this);if(JSON.stringify(e).length>3){c.push(e)}}})});return c}else{this.each(function(){var t=this;var r=$(t).data("options");var A=$.val("onselect",r);var u=$.val("columns",r,{d:[]});var b=document.createElement("tbody");b.className="grid-content";b.innerHTML=$.grid_html(c,u);if(typeof d=="undefined"||d!==true){$(".grid-content",t).remove()}$(".grid-body",t).append(b);for(var i=0;i<b.childNodes.length;i++){var x=b.childNodes[i];var j=c[i];for(var s=0;s<x.childNodes.length;s++){var w=x.childNodes[s];var y=w.getAttribute("data-column-type");if(y=="html"){var z=u[s];var a=$.val("html",z,{d:""});$.fire_event(a,[j,z],w)}}}$("tr",b).on("click.gridrow",function(e){var f=$(this).closest("table");$(".active",f).removeClass("active");$(this).addClass("active");$.fire_event(A,[e,this],t)})})}},grid_get_selected_value:function(){var b=null;$(this).each(function(){var f=$(this).data("options");var e=$.val("data",f);var a=$("tr[class='active']").attr("data-idx");b=$.val(a,e)});return b}});$.extend({grid_html:function(z,E){if(!z){return}var x=[];for(var y=0;y<z.length;y++){var A=z[y];x.push("<tr>");for(var D=0;D<E.length;D++){var F=E[D];var i=$.val("type",F,{d:"text"});var j=$.val("datatype",F,{d:"text"});var s=$.val("name",F,{d:""});var G=$.val("align",F,{d:""});var t="";var B="";var u="";switch(i){case"html":break;default:switch(j){case"number":case"money":t="right";u=$.val(s,A,{d:0});u=$.number_format(u);break;case"enum":var C=$.val("enums",F,{d:{}});u=$.val(s,A,{d:"-"});u=$.val(u,C,{d:"-"});break;default:u=$.val(s,A,{d:"-"});break}var w=$.val("lettercase",F,{d:""});switch(w){case"capitalize":u=u.toString().capitalize();break;case"lowercase":u=u.toString().toLowerCase();break;case"uppercase":u=u.toString().toUpperCase();break}B="label";break}if(G!=""){t=G}x.push("<td data-column-type='"+i+"' class='"+B+"' style='text-align:"+t+"'>"+u+"</td>")}x.push("<td></td>");x.push("</tr>")}return x.join("")}});$.fn.extend({gridhead:function(j){var m=$.val("autoload",j,{d:true});var h=$.val("columns",j,{d:[]});var n=$.val("class",j,{d:null});var k=$.val("name",j,{d:""});var i=$.val("grid",j,{d:null});var l=$.val("height",j,{d:null});this.each(function(){var a=this;$(a).addClass("gridhead");$(a).addClass(n);$(a).attr("data-type","gridhead");if(k!=""){$(a).attr("data-name",k)}$(a).data("options",j);$(a).attr("data-type","gridhead");$(a).gridhead_attr({height:l});$(this).gridhead_set(h)})},gridhead_set:function(b){$(this).each(function(){var A=this;var w=$(this).data("options");var a=$.val("grid",w,{d:null});var D=$.val("oncolumnclick",w);w.columns=b;var t=[];t.push("<table class='grid-head'><tr>");for(var u=0;u<b.length;u++){var x=b[u];var E=$.val("name",x,{d:""});var B=$.val("active",x,{d:1});var z=$.val("text",x,{d:"-"});var i=$.val("width",x,{d:""});var C=$.val("datatype",x,{d:"text"});var y=$.val("align",x,{d:""});var s="";switch(C){case"number":case"money":s="right";break;case"enum":break;default:break}if(y!=""){s=y}var r="label"+(!B?" inactive":"");t.push("<td class='"+r+"' style='width:"+i+";text-align:"+s+"' data-key=\""+E+'">'+z+"<span class='separator'></span></span></td>")}t.push("<td style='width:100%'></td>");t.push("</tr></table>");$(A).html(t.join(""));$(".separator",A).mousedown(function(e){e.preventDefault();e.stopPropagation();var d=this.parentNode;var f=d.parentNode;var c=e.clientX;$(window).on("mousemove.gridhead",function(g){g.preventDefault();g.stopPropagation();var h=g.clientX-c;d.style.width=(parseInt(d.style.width)+h)+"px";c=g.clientX});$(window).on("mouseup.gridhead",function(j){j.preventDefault();j.stopPropagation();var l=$(a);var n=$(".grid-size",l);if(n.length==1){var m=-1;for(var k=0;k<f.childNodes.length;k++){if(f.childNodes[k]==d){m=k;break}}m=parseInt(m);$(".grid-size-label:eq("+(m)+")",n).css({width:$(d).outerWidth()});var h=$(A).data("options");h.columns[m]["width"]=$(d).outerWidth();var g=$.val("oncolumnresize",h);$.fire_event(g,[{index:m,width:$(d).outerWidth()}],A)}$(window).off("mousemove.gridhead");$(window).off("mouseup.gridhead")})});$(".separator",A).click(function(c){c.preventDefault();c.stopPropagation()});$(".label",A).on("click",function(e){e.preventDefault();e.stopPropagation();var c=$(this).attr("data-key");var d=$(this).attr("data-sorttype");if(d=="asc"){d="desc"}else{if(d=="desc"){d="asc"}else{d="asc"}}$(this).attr("data-sorttype",d);$.fire_event(D,[[{key:c,type:d}]],A)})})},gridhead_attr:function(b){$(this).each(function(){for(var a in b){var d=b[a];switch(a){case"height":$(this).css({height:d});break}}})},gridhead_modify_column:function(b){$(this).each(function(){if(!$(this).hasClass("gridhead")){return}var p=$(this).data("options");var o=$.val("grid",p);var q=$.val("columns",p);for(var s=0;s<q.length;s++){var a=q[s];var r=$.val("name",a,{d:""});var i=$.val("width",a,{d:""});if(r==""){continue}for(var t=0;t<b.length;t++){var u=b[t];var j=$.val("name",u,{d:""});var w=$.val("active",u,{d:1});if(r==j){if(w){$(".label[data-key='"+j+"']",this).removeClass("inactive");$(".grid-size-label[data-key='"+j+"']",$(o)).removeClass("inactive")}else{$(".label[data-key='"+j+"']",this).addClass("inactive");$(".grid-size-label[data-key='"+j+"']",$(o)).addClass("inactive")}p.columns[s]["active"]=w;column_exists=true}}}$(this).data("options",p)})}});$.fn.extend({gridsetting:function(c){var d=$.val("onchange",c);this.each(function(){var a=this;var b=[];b.push("<div class='modal-head'>");b.push("<div class='align-center padding10'>");b.push("<ul class='tab'>");b.push("<li class='active' data-value='presets'>Presets</li>");b.push("<li data-value='columns'>Columns</li>");b.push("<li data-value='filters'>Filters</li>");b.push("</ul>");b.push("</div>");b.push("</div>");b.push("<div class='modal-body padding20'>");b.push("<div class='cont12 space10 gridsetting-presets'>");b.push("<div class='lg12'><button class='blue preset-add-btn'><span class='fa fa-plus'></span> Add Preset...</button></div>");b.push("<div class='lg12'><span class='preset-grid'></span></div>");b.push("</div>");b.push("<div class='cont12 space10 gridsetting-columns' style='display:none'>");b.push("<div class='lg12'>");b.push("<button class='blue column-up-btn'><span class='fa fa-caret-up'></span>Up</button>");b.push("&nbsp;");b.push("<button class='blue column-down-btn'><span class='fa fa-caret-down'></span>Down</button>");b.push("</div>");b.push("<div class='lg6'><span class='column-grid'></span></div>");b.push("<div class='lg6'>");b.push("<div class='cont12 space10 gridsetting-column-detail'>");b.push("<div class='lg3 align-right'><label class='padding10'>Align</label></div>");b.push("<div class='lg9'><span class='gridsetting-column-align'></span></div>");b.push("<div class='lg3 align-right'><label class='padding10'>Name</label></div>");b.push("<div class='lg9'><label class='gridsetting-column-name padding10'></label></div>");b.push("<div class='lg3 align-right'><label class='padding10'>Text</label></div>");b.push("<div class='lg9'><span class='gridsetting-column-text'></span></div>");b.push("<div class='lg3 align-right'><label class='padding10'>Width</label></div>");b.push("<div class='lg9'><span class='gridsetting-column-width'></span></div>");b.push("</div>");b.push("</div>");b.push("</div>");b.push("<div class='cont12 space10 gridsetting-filters' style='display:none'>");b.push("<div class='lg12'><button class='blue filter-add-btn'><span class='fa fa-plus'></span> Add Filter...</button></div>");b.push("<div class='lg12'><span class='filter-grid'></span></div>");b.push("</div>");b.push("</div>");b.push("<div class='modal-foot'>");b.push("<button class='blue apply-btn'><span class='fa fa-save'></span> Apply Filter</button>");b.push("&nbsp;");b.push("<button class='close-btn'><span class='fa fa-times'></span> Close</button>");b.push("</div>");$(a).addClass("modal width800 gridsetting");$(a).html(b.join(""));$(".tab",a).tab({onchange:function(f){$(".modal-body",a).children().hide();$(".gridsetting-"+f.value,a).show()}});$(".preset-add-btn").click(function(){});$(".preset-grid",a).grid({"class":"transparent",columns:[{text:"",type:"html",html:"$.gridsetting_preset_option",width:"50px"},{text:"Preset Name",name:"text",width:"150px"}]});$(".column-grid",a).grid({"class":"transparent",columns:[{text:"Column Name",name:"text",width:"150px"},{text:"Width",name:"width",width:"100px"}],onselect:function(h){var j=$(this).closest(".gridsetting-columns");var i=$(".gridsetting-column-detail",j);$.el_set(i,h);$(".gridsetting-column-name",i).html($.val("name",h,{d:""}))}});$(".gridsetting-column-align",a).dropdown({name:"align",items:[{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]});$(".gridsetting-column-name",a).html("");$(".gridsetting-column-text",a).textbox({name:"text",onchange:function(k){var i=$(a).data("params");var l=$(this).closest(".gridsetting-column-detail");var n=$(".gridsetting-column-name",l).html();for(var m=0;m<i.presets[i.active_idx]["columns"].length;m++){if(i.presets[i.active_idx]["columns"][m]["name"]==n){i.presets[i.active_idx]["columns"][m]["text"]=k}}$(a).data("presets",i)}});$(".gridsetting-column-width",a).textbox({name:"width",onchange:function(k){var i=$(a).data("params");var l=$(this).closest(".gridsetting-column-detail");var n=$(".gridsetting-column-name",l).html();for(var m=0;m<i.presets[i.active_idx]["columns"].length;m++){if(i.presets[i.active_idx]["columns"][m]["name"]==n){i.presets[i.active_idx]["columns"][m]["width"]=k}}$(a).data("presets",i)}});$(".filter-add-btn",a).click(function(){$(".filter-grid",a).grid_add()});$(".filter-grid",a).grid({"class":"transparent",columns:[{text:"",type:"html",html:"$.gridsetting_grid_option",width:"50px"},{text:"Key",type:"html",html:"$.gridsetting_grid_key",width:"150px"},{text:"Operator",type:"html",html:"$.gridsetting_grid_opt",width:"150px"},{text:"Value",type:"html",html:"$.gridsetting_grid_val",width:"150px"}]});$(".apply-btn",a).click(function(){var j=$(".filter-grid",a).grid_value();var h=$(a).data("params");var i=parseInt($.val("active_idx",h,{d:0}));h.presets[i]["filters"]=j;$.fire_event(d,[h],a);$(a).modal_close()});$(".close-btn",a).click(function(){$(a).modal_close()})})},gridsetting_close:function(){$(this).modal_close()},gridsetting_open:function(c,d){this.each(function(){var b=$.val("presets",c);var g=c.presets[c.active_idx];var a=$.val("columns",c);var h=$.val("filters",c);$(this).data("params",c);$(this).data("columns",a);$(".preset-grid",this).grid_set(b);$(".column-grid",this).grid_set(a);$(".filter-grid",this).grid_set(h);$(this).modal_open({height:window.innerHeight*0.8})})}});$.extend({gridsetting_preset_option:function(b){$(this).html("<button class='preset-grid-options'><span class='fa fa-times'></span></button>");$(".preset-grid-options",this).click(function(){$(this).closest("tr").remove()})},gridsetting_grid_option:function(b){$(this).html("<button class='filter-grid-options'><span class='fa fa-times'></span></button>");$(".filter-grid-options",this).click(function(){$(this).closest("tr").remove()})},gridsetting_grid_type:function(b){$(this).html("<span class='filter-grid-type'></span>");$(".filter-grid-type",this).textbox({name:"type",value:$.val("type",b,{d:null})})},gridsetting_grid_key:function(q,s){var i=$(this).closest(".gridsetting");var r=$(i).data("params");var m=r.presets[r.active_idx];var s=r.columns;var o=[];if($.type(s)=="array"){for(var p=0;p<s.length;p++){var t=s[p];var l=$.val("name",t,{d:""});var n=$.val("text",t,{d:l});if(l.length>0){o.push({text:n,value:l})}}}$(this).html("<span class='filter-grid-key'></span>");$(".filter-grid-key",this).dropdown({name:"key",items:o,value:$.val("key",q,{d:null})})},gridsetting_grid_opt:function(b){$(this).html("<span class='filter-grid-opt'></span>");$(".filter-grid-opt",this).dropdown({name:"operator",items:[{text:"Contains",value:"contains"},{text:"Equals",value:"equals"}],value:$.val("operator",b,{d:null})})},gridsetting_grid_val:function(b){$(this).html("<span class='filter-grid-val'></span>");$(".filter-grid-val",this).textbox({name:"value",value:$.val("value",b,{d:null})})}});$.fn.extend({hidden:function(c){var d=$.val("name",c,{d:""});$(this).each(function(){var a=[];$(this).html(a.join(""));$(this).attr("data-type","hidden");$(this).attr("data-name",d);$(this).addClass("hidden");$(this).data("options",c)})},hidden_val:function(c){if(typeof c=="undefined"){var d=[];$(this).each(function(){d.push($(this).data("value"))});return d.length>1?d:(d.length==1?d[0]:"")}else{$(this).each(function(){$(this).data("value",c)})}}});$.fn.extend({image:function(h){var l=$.val("class",h,{d:""});var j=$.val("height",h,{d:"50px"});var i=$.val("name",h,{d:""});var k=$.val("value",h,{d:""});var g=$.val("width",h,{d:"50px"});this.each(function(){var a=this;var b=[];b.push('<img src="'+k+'"/>');$(a).attr("data-type","image");$(a).attr("data-name",i);$(a).addClass("image");$(a).addClass(l);$(a).html(b.join(""));$(a).data("options",h);$("img",a).css({width:g,height:j})})},image_val:function(c){if(typeof c=="undefined"){var d=[];this.each(function(){d.push($("img",this).attr("src"))});return d.length>1?d:(d.length==1?d[0]:"")}else{this.each(function(){$("img",this).attr("src",c)})}}});$.extend({layout_resize:function(){$(".layout-sidebar, .layout-main, .layout-ext",$(".layout")).css({height:window.innerHeight-$(".header").outerHeight()})}});$.fn.extend({layout:function(h){var f=$.val("class",h,{d:""});var g=$.val("size",h,{d:{}});var j=$.val("large",g,{d:"300px auto 400px"});var i=j.split(" ");$(this).each(function(){var a=$.val(0,i,{d:"200px"});var b="100%";var c=$.val(2,i,{d:"300px"});$(this).addClass("layout");$(this).addClass(f);$(".layout-sidebar",this).css({flex:"0 0 "+a});$(".layout-main",this).css({flex:"1 1 "+b});$(".layout-ext",this).css({flex:"0 0 "+c});$(".layout-sidebar, .layout-main, .layout-ext",this).css({height:window.innerHeight-$(".header").outerHeight()})});$(window).on("resize.layout",function(){$.layout_resize()})}});$.extend({layout2_resize:function(){$(".layout2").layout2_resize()}});$.fn.extend({layout2:function(h){var f=$.val("class",h,{d:""});var g=$.val("size",h,{d:"300px auto 400px"});var e=g.split(" ");$(this).each(function(){$(this).addClass("layout2");$(this).addClass(f);$(this).data("options",h);$(this).layout2_resize()});$(window).on("resize.layout",function(){$.layout2_resize()})},layout2_resize:function(){$(this).each(function(){var j=$(this).data("options");var r=$.val("onresize",j);var o=$.val("ext_hidden",j);var k=$.val("size",j,{d:"300px auto 400px"});var l=k.split(" ");var n=window.innerHeight-$(".header").outerHeight();var q=$.val(0,l,{d:"200px"});var p=$.val(2,l,{d:"300px"});var n=window.innerHeight-$(".header").outerHeight();p=$.calc_size(p,n);var m=n-p;$(".layout-sidebar",this).css({flex:"0 0 "+q,height:n});$(".layout-content",this).css({flex:"1 1 auto"});if(o==0){$(this).removeClass("ext-hidden");$(".layout-main",this).css({height:p});$(".layout-ext",this).css({height:m})}else{$(this).addClass("ext-hidden");$(".layout-main",this).css({height:n});$(".layout-ext",this).css({height:0})}$.fire_event(r,[],this)})},layout2_toggleext:function(b){$(this).each(function(){if(!$(this).hasClass("layout2")){return}var a=$(this).data("options");a.ext_hidden=b?0:1;$(this).data("options",a);$(this).layout2_resize()})},layout2_ext_state:function(){var b=0;$(this).each(function(){var a=$(this).data("options");b=$.val("ext_hidden",a,{d:-1})>0?0:1});return b}});$.fn.extend({modal_open:function(b){this.each(function(){var a=this;$(a).addClass("on");$(document.body).css({overflow:"hidden"});var f=$(a).outerHeight()-5-($(".modal-head",a).outerHeight()+$(".modal-foot",a).outerHeight());if(!isNaN(f)){$(".modal-body",a).css({height:f})}var h=$.val("reset",b,{d:false});if(h===true){$(a).reset()}var g=$.val("value",b,{d:null});if(g!=null){$(a).val(b.value)}})},modal_close:function(c,d){this.each(function(){var a=this;$(a).removeClass("on");$(".modal-bg").removeClass("on")});if($(".modal.on").length==0){$(document.body).css({overflow:""})}}});$.extend({popup_close:function(b){$(b).removeClass("on")},popup_open:function(r,q,j){$.popup_close_all();$(r).addClass("on");var n={};var o=$(q).offset();var k=o.left+r.clientWidth;var l=o.top-$(window).scrollTop()+$(q).outerHeight()+1;var m=window.innerHeight-l-10;n.top=l;n["max-height"]=m;if(k>window.innerWidth){o.left=window.innerWidth-r.clientWidth}n.left=o.left;var p=$.val("min_width",j);if(!isNaN(parseInt(p))){n["min-width"]=p}$(r).css(n)},popup_toggle:function(e,d,f){if(e.classList.contains("on")){$.popup_close(e,d,f)}else{$.popup_open(e,d,f)}},popup_close_all:function(){var d=document.body.querySelectorAll(".popup");for(var c=0;c<d.length;c++){$.popup_close(d[c])}}});$.fn.extend({radio:function(b){$(this).each(function(){var p=$.val("items",b,{d:null});var q=$.val("class",b,{d:""});var w=$.val("text",b,{d:""});var x=$.val("name",b,{d:""});var a=$.val("value",b,{d:""});var t=[];if($.type(p)=="array"){var r="radio-name-"+$.uniqid();for(var u=0;u<p.length;u++){var y=p[u];var z=y.text;var A=y.value;var i=a!=""&&a==A?true:false;var s="radio-"+$.uniqid();t.push("<input type='radio' id='"+s+"' value=\""+A+"\" name='"+r+"'"+(i?" checked":"")+"/>");t.push("<label for='"+s+"'>"+z+"</label>")}}else{var i=parseInt(a)==1||a===true?true:false;var s="radio-"+$.uniqid();t.push("<input type='radio' id='"+s+"'"+(i?" checked":"")+"/>");t.push("<label for='"+s+"'>"+w+"</label>")}$(this).addClass("radio");$(this).addClass(q);$(this).attr({"data-type":"radio"});$(this).html(t.join(""))})},radio_val:function(c){if(typeof c=="undefined"){var d=[];$(this).each(function(){var b=this.querySelectorAll("input");if(b.length==1){d.push(b[0].checked?1:0)}else{for(var a=0;a<b.length;a++){if(b[a].checked){d.push(b[a].value)}}}});d=d.join(",");return d}else{$(this).each(function(){var a=this.querySelectorAll("input");if(a.length==1){a[0].checked=(parseInt(c)==1||c===true)?true:false}else{var b=false;for(var f=0;f<a.length;f++){if(a[f].value==c){a[f].checked=true;b=true;break}}if(!b){$("input",this).attr("checked",false)}}})}}});$.extend({role_init:function(c){var d=typeof c!="undefined"&&c instanceof HTMLElement?c:document.body;$("*[data-role]",d).each(function(){var a=this.getAttribute("data-role");switch(a){case"modal.close":$(this).click(function(){$(this).closest(".modal").modal_close()});break;case"url.open":var b=$(this).attr("data-role-value");$(this).click(function(){window.location=b});break}})}});$.fn.extend({autocomplete:function(k){var h=$.val("class",k,{d:""});var l=$.val("name",k,{d:""});var m=$.val("src",k,{d:""});var i=$.val("width",k);var n=$.val("placeholder",k,{d:""});var j={};if(i!=null){j.width=i}this.each(function(){var a=this;var b=[];b.push("<input type='text' placeholder=\""+n+'"/>');b.push("<span class='icon fa fa-search hoverable selectable'></span>");b.push("<span class='popup'></span>");$(a).addClass("autocomplete");$(a).addClass(h);$(a).html(b.join(""));$(a).css(j);$(a).attr("data-name",l);$(a).attr("data-type","autocomplete");$(a).data("options",k);$("input[type='text']",a).on("keyup",function(g){var c=$(this).closest(".autocomplete");if($(c).hasClass("readonly")){return}var d=$(c).data("options");var e=$.val("readonly",d);if(!e&&m.length>0){var f={};f.key=this.value;$.api_get(m,f,function(y){var B=$.val("data",y);var C=[];if($.type(B)=="array"){for(var w=0;w<B.length;w++){var z=B[w];var x=$.val("value",z,{d:""});var A=$.val("text",z,{d:x});C.push("<div class='item' data-value=\""+x+'">');C.push("<label>"+A+"</label>");C.push("</div>")}}$(".popup",c).html(C.join(""));$(".item",$(".popup",c)).on("click",function(){var o=this.getAttribute("data-value");var p=$("label",this).text();var q={value:o,text:p};$(c).autocomplete_val(q)});$.popup_open($(".popup",c),c,{min_width:$(c).outerWidth()})})}})})},autocomplete_val:function(e,d){if(typeof e=="undefined"){var f=[];$(this).each(function(){var h=$(this).data("options");var b=$.val("multiple",h,{d:false});if(b){$(".text",this).each(function(){f.push(this.getAttribute("data-value"))})}else{var c=$("input",this).val();var a=$(this).data("value");if(a==null){a=c}f.push(a)}});return f.length==1?f[0]:(f.length>1?f:"")}else{$(this).each(function(){var j=$(this).data("options");var a=$.val("multiple",j,{d:false});var i=f="";if($.type(e)=="object"){f=$.val("value",e,{d:""});i=$.val("text",e,{d:f})}else{i=f=e}if(a){var b=typeof d!="undefined"&&d===true?true:false;if(b){$(".text",this).remove()}var c=$(this).val();if(!$.in_array(f,c)&&f!==""){$("<span class='text' data-value=\""+f+'">'+i+"<span class='icon-remove glyphicons glyphicons-remove'></span></span>").insertBefore($("input",this));$(".glyphicons-remove",$("input",this).prev()).on("click",function(){$(this).parent().remove()})}$("input",this).val("")}else{$("input",this).val(i);$(this).data("value",f)}})}},autocomplete_readonly:function(b){if(typeof b=="undefined"){return $(this).hasClass("readonly")?true:false}else{if(b){$(this).addClass("readonly");$("input",this).attr("readonly",true);$("input",this).data("placeholder",$("input",this).attr("placeholder"));$("input",this).attr("placeholder","")}else{$(this).removeClass("readonly");$("input",this).attr("readonly",false);$("input",this).attr("placeholder",$("input",this).data("placeholder"))}}},autocomplete_reset:function(){$(this).autocomplete_val("",true)}});$.fn.extend({calendar:function(b){this.each(function(){var f=this;var e=$.val("value",b,{d:"2017-01-01"});e=$.date("j M Y",$.strtotime(e));var a=[];a.push("<input type='text' value='"+e+"' readonly/>");a.push("<span class='icon fa fa-calendar'></span>");a.push("<span class='popup'>Calendar</span>");$(f).addClass("calendar");$(f).html(a.join(""));$(f).attr("data-type","calendar");$(".icon",this).click(function(c){c.preventDefault();c.stopPropagation()});$(".popup",this).click(function(c){c.preventDefault();c.stopPropagation()})})}});$.extend({calendar_open:function(e){var g=e.refEl;var f=e.value;var h=$("#calendar");if(h.length==0){h=document.createElement("div");h.id="calendar";h.className="popup";document.body.appendChild(h);h=$("#calendar")}h=h[0];$(h).data("params",e);$.calendar_set(f);$.popup_open(h,g)},calendar_set:function(f){var e=$("#calendar").data("params");var d=$.val("type",e,{d:""});switch(d){case"range":$.calendar_set_range(f);break;default:$.calendar_set_single(f);break}},calendar_set_single:function(A){var B=$("#calendar");$(B).attr("data-value",A);var i=$.date("n",$.strtotime(A));var C=$.date("Y",$.strtotime(A));var y=$.date("j",$.strtotime(A));var j=$.start_day_of_month(C,i)%7;var x=$.last_date_of_month(C,i);var w=$.date("M Y",$.strtotime(A));var t=$(B).data("params");var u=t.onchange;var q=[];q.push("<table>");q.push("<tr>");q.push("<td><span class='calendar-prev fa fa-caret-left padding5'></span></td>");q.push("<td colspan='5'><span class='date-label'>"+w+"</span></td>");q.push("<td><span class='calendar-next fa fa-caret-right padding5'></span></td>");q.push("</tr>");q.push("<tr>");q.push("<td>Sun</td>");q.push("<td>Mon</td>");q.push("<td>Tue</td>");q.push("<td>Wed</td>");q.push("<td>Thu</td>");q.push("<td>Fri</td>");q.push("<td>Sun</td>");q.push("</tr>");var z=1;for(var r=0;r<6;r++){q.push("<tr>");for(var s=0;s<7;s++){if(j>0){q.push("<td></td>");j--}else{if(z<=x){q.push(z==y?"<td class='day active'>"+z+"</td>":"<td class='day'>"+z+"</td>");z++}else{q.push("<td></td>")}}}q.push("</tr>")}q.push("</table>");B.html(q.join(""));$(".day",B).click(function(d){d.preventDefault();d.stopPropagation();var b=$(this).closest("#calendar");var g=$(b).attr("data-value");var c=this.innerHTML;var e=parseInt($.date("n",$.strtotime(g)));var f=$.date("Y",$.strtotime(g));var a=$.date("j M Y",$.mktime(0,0,0,e,c,f));$.fire_event(u,[a],b);$.popup_close(b)});$(".calendar-prev",B).click(function(e){e.preventDefault();e.stopPropagation();var d=$(this).closest("#calendar");var c=$(d).attr("data-value");var f=parseInt($.date("n",$.strtotime(c)));var g=parseInt($.date("Y",$.strtotime(c)));var b=parseInt($("td.active",d).html());var a=$.date("Y-m-d",$.mktime(0,0,0,f-1,b,g));$.calendar_set(a)});$(".calendar-next",B).click(function(e){e.preventDefault();e.stopPropagation();var d=$(this).closest("#calendar");var c=$(d).attr("data-value");var f=parseInt($.date("n",$.strtotime(c)));var g=parseInt($.date("Y",$.strtotime(c)));var b=parseInt($("td.active",d).html());var a=$.date("Y-m-d",$.mktime(0,0,0,f+1,b,g));$.calendar_set(a)})},calendar_set_range:function(M,B,Q){var T=$("#calendar");$(T).attr("data-value",M);var i=$(T).data("params");var j=i.onchange;M=M.split("-");var U=M[0];var G=M[1];if($.date("Y",$.strtotime(U))=="1970"){U=$.date("Y-m-d")}if($.date("Y",$.strtotime(G))=="1970"){G=$.date("Y-m-d")}var k=[],L=[],E=[],R=[],C=[],S=[],N=[];var I=$.date("Y",$.strtotime(B))!="1970"?B:U;var K=$.date("Y",$.strtotime(Q))!="1970"?Q:G;if($.date("Ym",$.strtotime(K))==$.date("Ym",$.strtotime(I))){K=$.date("Y-m-d",$.mktime(0,0,0,parseInt($.date("n",$.strtotime(K)))+1,$.date("j",1,$.date("Y",$.strtotime(K)))))}k[0]=$.date("n",$.strtotime(I));L[0]=$.date("m",$.strtotime(I));E[0]=$.date("Y",$.strtotime(I));R[0]=$.date("j",$.strtotime(I));C[0]=$.start_day_of_month(E[0],k[0])%7;S[0]=$.last_date_of_month(E[0],k[0]);N[0]=$.date("M Y",$.strtotime(I));k[1]=$.date("n",$.strtotime(K));L[1]=$.date("m",$.strtotime(K));E[1]=$.date("Y",$.strtotime(K));R[1]=$.date("j",$.strtotime(K));C[1]=$.start_day_of_month(E[1],k[1])%7;S[1]=$.last_date_of_month(E[1],k[1]);N[1]=$.date("M Y",$.strtotime(K));var O=[];for(var D=0;D<2;D++){O.push("<table class='calendar-table range-"+D+"'>");O.push("<tr>");O.push($.p("<td><span class='calendar-prev fa fa-caret-left padding5' data-calendaridx='$i'></span></td>",[D]));O.push("<td colspan='5'><span class='date-label'>"+N[D]+"</span></td>");O.push($.p("<td><span class='calendar-next fa fa-caret-right padding5' data-calendaridx='$i'></span></td>",[D]));O.push("</tr>");O.push("<tr>");O.push("<td>Sun</td>");O.push("<td>Mon</td>");O.push("<td>Tue</td>");O.push("<td>Wed</td>");O.push("<td>Thu</td>");O.push("<td>Fri</td>");O.push("<td>Sun</td>");O.push("</tr>");var H=1;for(var F=0;F<6;F++){O.push("<tr>");for(var J=0;J<7;J++){if(C[D]>0){O.push("<td></td>");C[D]--}else{if(H<=S[D]){var P=$.date("Y-m-d",$.strtotime(E[D]+"-"+L[D]+"-"+$.str_pad(H,2,"0","STR_PAD_LEFT")));if($.strtotime(P)>=$.strtotime(U)&&$.strtotime(P)<=$.strtotime(G)){O.push("<td class='day active' data-date='"+P+"'>"+H+"</td>")}else{O.push("<td class='day' data-date='"+P+"'>"+H+"</td>")}H++}else{O.push("<td></td>")}}}O.push("</tr>")}O.push("</table>")}T.html(O.join(""));T.data("seq",0);$(".day",T).click(function(l){l.preventDefault();l.stopPropagation();console.log("value: "+1);var o=$(this).closest("#calendar");var m=$(o).attr("data-value");var n=this.innerHTML;var h=parseInt($.date("n",$.strtotime(m)));var f=$.date("Y",$.strtotime(m));var g=$.date("j M Y",$.mktime(0,0,0,h,n,f));var b=parseInt(o.data("seq"));if(b==0){$(".day.active-0").removeClass("active active-0");$(this).addClass("active active-0");var a=$(this).attr("data-date");var e=$(o).attr("data-value");e=e.split(",");var c=$.val(1,e,{d:a});$(".day",o).each(function(){var p=$(this).attr("data-date");if($.strtotime(p)>=$.strtotime(a)&&$.strtotime(p)<=$.strtotime(c)){$(this).addClass("active")}else{$(this).removeClass("active")}})}else{$(".day.active-1").removeClass("active active-1");$(this).addClass("active active-1")}o.data("seq",b+1);if(b==1){var a=$(".day.active-0").attr("data-date");var c=$(".day.active-1").attr("data-date");if($.strtotime(a)>$.strtotime(c)){var d=a;a=c;c=d}var e=$.date("Ymd",$.strtotime(a))+"-"+$.date("Ymd",$.strtotime(c));$.popup_close(o);$.fire_event(j,[e],o)}});$(".calendar-prev",T).click(function(a){var b=parseInt($(this).attr("data-calendaridx"));console.log(["prev",M,parseInt($(this).attr("data-calendaridx")),I,K]);a.preventDefault();a.stopPropagation();if(b==0){I=$.date("Y-m-d",$.mktime(0,0,0,parseInt($.date("n",$.strtotime(I)))-1,$.date("j",$.strtotime(I)),$.date("Y",$.strtotime(I))))}else{if(b==1){K=$.date("Y-m-d",$.mktime(0,0,0,parseInt($.date("n",$.strtotime(K)))-1,$.date("j",$.strtotime(K)),$.date("Y",$.strtotime(K))));if($.date("Ym",$.strtotime(I))>=$.date("Ym",$.strtotime(K))){I=$.date("Y-m-d",$.mktime(0,0,0,parseInt($.date("n",$.strtotime(I)))-1,$.date("j",$.strtotime(I)),$.date("Y",$.strtotime(I))))}}}$.calendar_set_range(M.join(","),I,K)});$(".calendar-next",T).click(function(a){var b=parseInt($(this).attr("data-calendaridx"));a.preventDefault();a.stopPropagation();if(b==0){I=$.date("Y-m-d",$.mktime(0,0,0,parseInt($.date("n",$.strtotime(I)))+1,$.date("j",$.strtotime(I)),$.date("Y",$.strtotime(I))));if($.date("Ym",$.strtotime(K))<=$.date("Ym",$.strtotime(I))){K=$.date("Y-m-d",$.mktime(0,0,0,parseInt($.date("n",$.strtotime(K)))+1,$.date("j",$.strtotime(K)),$.date("Y",$.strtotime(K))))}}else{if(b==1){K=$.date("Y-m-d",$.mktime(0,0,0,parseInt($.date("n",$.strtotime(K)))+1,$.date("j",$.strtotime(K)),$.date("Y",$.strtotime(K))))}}$.calendar_set_range(M.join(","),I,K)})}});$.fn.extend({chart:function(f){var g=$.val("name",f);var h=$.val("height",f);var e=$.val("width",f);this.each(function(){var b=this;var c={};c.height=h;c.width=e;var a=[];$(b).addClass("chart");$(this).html(a.join(""));$(this).css(c);$(b).attr("data-type","chart");$(b).attr("data-name",g);$(b).data("options",f)})},chart_set:function(b){this.each(function(){var e=this;var a=$(e).data("options");var f=$.val("type",a,{default_value:"line"});switch(f){case"bar":$(this).chart_bar_set(b);break;default:$(this).chart_line_set(b);break}})},chart_bar_set:function(b){this.each(function(){var Q=this;var J=$(Q).data("options");var R=$(Q).outerHeight();var w=$(Q).outerWidth();var U=$.val("padding",J,{default_value:10});var aa=$.array_key_count(b);var h=$.object_value_min(b);var W=$.object_value_max(b);var L=U;var af=w-U;var P=af-L;var Y=(w*0.8)/aa;var x=(P-(Y*aa))/(aa+1);var a=R-U;var T=10;var O=a-T;var ag=O/(W-h);var Z=[];Z.push($.p('<svg width="$1" height="$2">',[w,R]));var S=L;var V=af;var K=a,N=a;Z.push($.p('<line x1="$x1" y1="$y1" x2="$x2" y2="$y2" style="stroke:rgb(0,0,0);stroke-width:1" />',[S,K,V,N]));var ad=0;for(var y in b){var M=b[y];var ab=Y;var X=ag*M;if(X<5){X=5}var ac=ad*(x+Y)+x;var ae=a-X;Z.push($.p('<rect x="$1" y="$1" width="$1" height="$1" stroke="#4A89DC" stroke-width="2" fill="rgba(74, 137, 220, .2)" data-key="$1" data-value="$1" onmouseover="$1" onmouseout="$1"/>',[ac,ae,ab,X,y,M,"$.chart_line_mouseover.call(this)","$.chart_line_mouseout.call(this)"]));ad++}Z.push("</svg>");$(Q).html(Z.join(""))})},chart_line_set:function(b){this.each(function(){var P=this;var Z=$(P).data("options");var Q=$(P).outerHeight();var H=$(P).outerWidth();var G=$.array_key_count(b);var Y=$.object_value_min(b);var T=$.object_value_max(b);var S=$.val("padding",Z,{default_value:10});var N=S;var W=H-S;var a=W-N;var K=a/(G-1);var L=Q-S;var J=10;var M=L-J;var X=M/(T-Y);var U=[];U.push($.p('<svg width="$1" height="$2">',[H,Q]));var E=N;var F=W;var aa=L,ac=L;U.push($.p('<line x1="$x1" y1="$y1" x2="$x2" y2="$y2" style="stroke:rgb(0,0,0);stroke-width:1" />',[E,aa,F,ac]));var V=1;for(var O in b){var ab=Math.round(N+(V*K));U.push($.p('<line x1="$1" y1="$1" x2="$1" y2="$1" style="stroke:rgba(0, 0, 0, .05);stroke-width:1" />',[ab,L,ab,J]));V++}var V=0;var d=[];d.push($.p("M$1 $2",[Math.round(N+(V*K)),L]));for(var O in b){var R=b[O];var ab=Math.round(N+(V*K));var I=Math.round(L-(R*X));d.push($.p("L$1 $2",[ab,I]));V++}d.push($.p("M$1 $2 Z",[ab,L]));U.push($.p('<path d="$1" stroke-width="0" stroke="transparent" fill="rgba(74, 137, 220, .2)"/>',[d.join(" ")]));var V=0;var d=[];for(var O in b){var R=b[O];var ab=Math.round(N+(V*K));var I=Math.round(L-(R*X));if(V==0){d.push($.p("M$1 $2",[ab,I]))}else{d.push($.p("L$1 $2",[ab,I]))}V++}U.push($.p('<path d="$1" stroke-width="2" stroke="#4A89DC" fill="transparent"/>',[d.join(" ")]));var V=0;for(var O in b){var R=b[O];var ab=N+(V*K);var I=L-(R*X);U.push($.p('<circle cx="$1" cy="$1" r="1" stroke="#4A89DC" stroke-width="2" fill="#4A89DC" onmouseover="$1" onmouseout="$1" data-key="$1" data-value="$1"/>',[ab,I,"$.chart_line_mouseover.call(this)","$.chart_line_mouseout.call(this)",O,R]));V++}U.push("</svg>");$(P).html(U.join(""))})}});$.extend({chart_line_mouseover:function(){$(this).attr({r:2});var d=$(this).attr("data-key");var c=$(this).attr("data-value");$.tooltip(this,d+"<br />"+c)},chart_line_mouseout:function(){$(this).attr({r:1});$.tooltip_remove()}});$.fn.extend({checkbox:function(b){this.each(function(){var j=$.val("class",b,{d:""});var l=$.val("items",b,{d:null});var k=[];if($.type(l)=="array"){$(l).each(function(){var c=$.val("text",this,{d:""});var d=$.val("value",this,{d:""});var e="checkbox-"+$.uniqid();k.push("<span class='item'><input id='"+e+"' type='checkbox' value=\""+d+"\"/><label for='"+e+"'>"+c+"</label></span>")})}else{var h=$.val("text",b,{d:""});var i="";var a="checkbox-"+$.uniqid();k.push("<span class='item'><input id='"+a+"' type='checkbox' value=\""+i+"\"/><label for='"+a+"'>"+h+"</label></span>")}$(this).addClass("checkbox");$(this).addClass(j);$(this).html(k.join(""));$(this).data("options",b)})}});$.fn.extend({checklist:function(b){$(this).each(function(){var a=this;var d=[];d.push("<div class='checklist-body'>");d.push("<div class='checklist-item'>");d.push("<input type='checkbox' />");d.push("<input type='text' />");d.push("<span class='iconbar'>");d.push("<span class='checklist-remove fa fa-times padding5 selectable'></span>");d.push("</span>");d.push("</div>");d.push("</div>");d.push("<div class='checklist-foot'>");d.push("<span class='checklist-add fa fa-plus-circle padding5 selectable hoverable'></span>");d.push("</div>");$(this).addClass("checklist");$(this).html(d.join(""));$(".checklist-add",this).click(function(){$(a).checklist_add()});$(".checklist-remove",this).on("click.checklist",function(){$(this).closest(".checklist-item").remove()})})},checklist_add:function(){$(this).each(function(){var b=[];b.push("<div class='checklist-item'>");b.push("<input type='checkbox' />");b.push("<input type='text' />");b.push("<span class='iconbar'>");b.push("<span class='checklist-remove fa fa-times padding5 selectable hoverable'></span>");b.push("</span>");b.push("</div>");$(".checklist-body",this).append(b.join(""));$(".checklist-remove",$(".checklist-body",this)).on("click.checklist",function(){$(this).closest(".checklist-item").remove()})})},checklist_get:function(){var b=[];$(this).each(function(){$(".checklist-item",this).each(function(){var a=$("input[type='checkbox']",this)[0].checked;var d=$("input[type='text']",this).val();if(d.length>0){b.push({checked:a,text:d})}})});return b.length==0?null:b},checklist_set:function(b){$(this).checklist_attr({value:b})},checklist_attr:function(b){if($.type(b)!="object"){return}$(this).each(function(){for(var a in b){var k=b[a];switch(a){case"readonly":if(k){$("input[type='checkbox']",this).attr("disabled",true);$("input[type='text']",this).attr("readonly",true);$(".checklist-remove",this).addClass("hidden");$(".checklist-add",this).addClass("hidden")}else{$("input[type='checkbox']",this).attr("disabled",false);$("input[type='text']",this).attr("readonly",false);$(".checklist-remove",this).removeClass("hidden");$(".checklist-add",this).removeClass("hidden")}break;case"value":var i=[];if($.type(k)=="array"){for(var m=0;m<k.length;m++){var l=k[m];var j=$.val("text",l,{d:""});var n=$.val("checked",l,{d:false});if(j==""){continue}i.push("<div class='checklist-item'>");i.push("<input type='checkbox'"+(n?" checked":"")+"/>");i.push("<input type='text' value=\""+j+'" />');i.push("<span class='iconbar'>");i.push("<span class='checklist-remove fa fa-times padding5 selectable hoverable'></span>");i.push("</span>");i.push("</div>")}}i.push("<div class='checklist-item'>");i.push("<input type='checkbox'/>");i.push("<input type='text'/>");i.push("<span class='iconbar'>");i.push("<span class='checklist-remove fa fa-times padding5 selectable hoverable'></span>");i.push("</span>");i.push("</div>");$(".checklist-body",this).html(i.join(""));$(".checklist-remove",$(".checklist-body",this)).on("click.checklist",function(){$(this).closest(".checklist-item").remove()});break}}})}});$.fn.extend({choice:function(b){$(this).each(function(){var m=$.val("class",b,{d:""});var n=$.val("items",b,{d:[],datatype:"array"});var a=[];if($.type(n)=="array"){for(var i=0;i<n.length;i++){var l=n[i];var k=$.val("value",l,{d:""});var j=$.val("text",l,{d:k});if(k.length==0){continue}a.push($.p('<span class="item">'));a.push($.p("</span>"))}}$(this).addClass("choice");$(this).addClass(m)})}});$.fn.extend({codeeditor:function(g){var i=$.val("height",g,{d:"200px"});var f=$.val("width",g,{d:"300px"});var h=$.val("name",g,{d:""});var j=$.val("value",g,{d:"300px"});this.each(function(){var c=$.uniqid();var a=[];a.push($.p('<textarea id="$1""></textarea>',["codeeditor-text-"+c]));$(this).addClass("codeeditor");$(this).html(a.join(""));$(this).css({width:f,height:i});$(this).codeeditor_attr({name:h});var b=CodeMirror.fromTextArea(document.getElementById("codeeditor-text-"+c),{lineNumbers:true,mode:"text/x-mariadb",indentWithTabs:true,smartIndent:true,matchBrackets:true,autofocus:true})})},codeeditor_get:function(){var b=[];$(this).each(function(){b.push($("textarea",this).val())});return b.length==1?b[0]:(b.length>1?b:"")},codeeditor_set:function(b){$(this).each(function(){$("textarea",this).val(b)})},codeeditor_attr:function(b){this.each(function(){var i={};var h={};var a={};for(var j in a){var g=a[j];switch(j){case"name":a.name=g}}$(this).attr(a);$(this).css(i);$("textarea",this).css(h)})}});$.fn.extend({codefield:function(h){var k=$.val("placeholder",h,{d:""});var i=$.val("name",h,{d:""});var j=$.val("height",h);var l=$.val("width",h);var g={width:l,height:j};this.each(function(){var a=this;var b=[];b.push("<pre style='height:"+j+";'>"+JSON.stringify({name:"andy"},null,2)+"</pre>");b.push("<span class='icon fa hidden'></span>");$(a).addClass("codefield");$(a).css(g);$(a).html(b.join(""));$(a).attr("data-type","codefield");$(a).attr("data-name",i);$(a).data("options",h)})},codefield_get:function(){var b=[];this.each(function(){var a=$("pre",this).html();b.push(a)});return b.length>1?b:(b.length==1?b[0]:"")},codefield_set:function(b){this.each(function(){$("pre",this).html(b)})}});$.fn.extend({commentlist:function(c){var d=$.val("onsubmit",c);$(this).each(function(){var b=this;var a=[];a.push("<div class='commentlist-write'>");a.push("<input type='text' placeholder='Write comment here...' />");a.push("</div>");a.push("<div class='commentlist-list'></div>");$(this).addClass("commentlist");$(this).html(a.join(""));$(this).data("options",c);$("input[type='text']",this).on("keyup",function(e){if(e.keyCode==13){if(e.shiftKey){}else{if(this.value!=""){$.fire_event(d,[this.value],b);this.value="";$(this).blur()}}}})})},commentlist_add:function(b){$(this).each(function(){var l=$(this).data("options");var j=$.val("onremove",l);var m=$.val("id",b);var n=$.val("comment",b);var o=$.val("full_name",b);var a=$.val("createdon",b);var p=$.val("removable",b,{d:0});if(!n||!o){return}var k=[];k.push("<div class='commentlist-item' data-id='"+m+"'>");k.push("<p style='word-wrap: break-word;'><b>"+o+"</b> "+n+"</p>");k.push("<div class='commentlist-item-footer'>");k.push("<label class=''>"+a+"</label>");if(p){k.push("<span class='width5 height5'>&nbsp;</span>");k.push("<span class='comment-item-remove selectable hoverable'>Remove</span>")}k.push("</div>");k.push("</div>");$(".commentlist-list",this).append(k.join(""));$(".comment-item-remove",$(".commentlist-list",this)).on("click",function(){var c=$(this).closest(".commentlist-item").attr("data-id");$.fire_event(j,[c],this)})})},commentlist_set:function(b){$(this).each(function(){var m=$(this).data("options");var s=$.val("onremove",m);var q=[];if($.type(b)=="array"){for(var r=0;r<b.length;r++){var t=b[r];var a=$.val("id",t);var p=$.val("comment",t);var o=$.val("full_name",t);var n=$.val("createdon",t);var i=$.val("removable",t,{d:0});if(!p||!o){continue}q.push("<div class='commentlist-item' data-id='"+a+"'>");q.push("<p style='word-wrap: break-word;'><b>"+o+"</b> "+p+"</p>");q.push("<div class='commentlist-item-footer'>");q.push("<label class=''>"+n+"</label>");if(i){q.push("<span class='width5 height5'>&nbsp;</span>");q.push("<span class='comment-item-remove selectable hoverable'>Remove</span>")}q.push("</div>");q.push("</div>")}}$(".commentlist-list",this).html(q.join(""));$(".comment-item-remove",$(".commentlist-list",this)).on("click",function(){var c=$(this).closest(".commentlist-item").attr("data-id");$.fire_event(s,[c],this)})})}});$.fn.extend({container_val:function(b){if(typeof b=="undefined"){result={};$("*[data-type]",this).each(function(){var a=this.getAttribute("data-name");if(a!=null&&a!=""){var d=$(this).val();result[a]=d}});return result}else{$("*[data-type]",this).each(function(){var a=this.getAttribute("data-name");if(a!=null&&a!=""){var d=$.val(a,b,{d:""});$(this).val(d)}})}},container_reset:function(){$("*[data-type]",this).each(function(){var b=$(this).attr("data-type");if(b!=null&&typeof $(this)[b+"_reset"]!="undefined"){$(this)[b+"_reset"].apply(this,arguments)}})}});$.fn.extend({datepicker:function(d){var c=$.val("type",d);this.each(function(){var a=this;var b=[];b.push("<input type='text' readonly/>");b.push("<span class='icon fa fa-calendar'></span>");$(a).addClass("datepicker");$(a).html(b.join(""));$(a).attr("data-type","datepicker");$(a).data("options",d);$(".icon",this).click(function(e){e.preventDefault();e.stopPropagation();var j=$(this).closest(".datepicker");var k=$(j).data("options");var l=$.val("readonly",k,{d:false});if(l=="0"||l==false){$.calendar_open({refEl:j,value:$(j).data("value"),type:c,onchange:function(f){$(j).datepicker_val(f)}})}});$(".popup",this).click(function(e){e.preventDefault();e.stopPropagation()});$(this).datepicker_val($.val("value",d,{d:"20170101"}))})},datepicker_val:function(b){if(typeof b=="undefined"){var b=[];$(this).each(function(){var a=$(this).data("value");b.push(a)});return b.length==1?b[0]:(b.length==0?null:b)}else{$(this).each(function(){var d="";b=$.date_parse(b);if(b.indexOf("-")>=0){var g=b.split("-");var h=$.date("M j, Y",$.strtotime(g[0]));var a=$.date("M j, Y",$.strtotime(g[1]));d=h+" - "+a}else{var g=$.date("M j, Y",$.strtotime(b));d=g}$("input",this).val(d);$(this).data("value",b)})}}});$.fn.extend({dropdown:function(m){var r=$.val("class",m,{d:""});var k=$.val("name",m,{d:""});var n=$.val("defaultvalue",m,{d:""});var o=$.val("value",m,{d:n});var q=$.val("items",m,{d:[]});var t=$.val("width",m,{d:[]});var l=$.val("src",m,{d:""});var p=$.val("placeholder",m,{d:""});var s=[];s.push("<input class='text' type='text' placeholder=\""+p+'" readonly/>');s.push("<span class='icon fa fa-caret-down hoverable'></span>");s.push("<span class='popup'></span>");this.each(function(){var a=this;$(a).addClass("dropdown");$(a).addClass(r);$(a).html(s.join(""));$(a).data("options",m);$(a).attr("data-type","dropdown");$(a).attr("data-name",k);$(a).dropdown_attr(m);$(".icon, .text",a).click(function(e){e.preventDefault();e.stopPropagation();var b=$(this).closest(".dropdown");var c=$(b).data("options");var d=$.val("readonly",c);if(!d){if($(".popup",b).hasClass("on")){$.popup_close($(".popup",b))}else{$.popup_open($(".popup",b),b,{min_width:$(b).outerWidth()});$(".search-item input",$(".popup",b)).val("");$(".search-item input",$(".popup",b)).focus();$(".item",$(".popup",b)).show()}}});if(o!=""){$(a).dropdown_val()}if(l.length>0){$(this).dropdown_load()}})},dropdown_val:function(e,f){if(typeof e=="undefined"){var d=[];this.each(function(){var a=this;var c=$(a).attr("data-value");var b=$("input",a).length==1?$("input",a).val():$(".text",a).html();c=c==null?b:c;d.push(c)});return d.length==1?d[0]:(d.length>1?d:null)}else{this.each(function(){var c=$(this).data("options");var i=$.val("items",c,{d:[]});var k="";var l="";if($.type(e)=="object"){l=$.val("value",e);k=$.val("text",e,{d:l})}else{if($.type(l)=="string"){k=l=e}}if($.type(i)=="array"){for(var b=0;b<i.length;b++){var a=i[b];if(a.value==l){k=a.text;l=a.value;break}}}$(this).attr("data-value",l);$("input",this).val(k);$(".text",this).html(k)})}},dropdown_items:function(d){if(typeof d=="undefined"){var c=[];this.each(function(){var b=this;var f=$(b).data("options");var a=$.val("items",f,{d:[]});$(a).each(function(){if($.type(this)=="object"){c.push(this)}})});return c}else{this.each(function(){var t=this;var s=$(t).data("options");var a=$.val("searchable",s,{d:false});var r=$.val("multiple",s,{d:false});var q=$.val("onchange",s);var i=[];if(a==true){i.push("<div class='search-item'>");i.push("<input type='text' placeholder='Search'/>");i.push("</div>")}if($.type(d)=="array"){for(var p=0;p<d.length;p++){var w=d[p];var x=w.text;var y=w.value;var u=(x+" "+y).toLowerCase();var b=$.uniqid();i.push("<div class='item' data-value=\""+y+'" data-search="'+u+'">');if(r){i.push("<input type='checkbox' id='dropdown_item_checkbox_"+b+"'/>")}i.push("<label for='dropdown_item_checkbox_"+b+"'>"+x+"</label>");i.push("</div>")}}i=i.join("");$(".popup",t).html(i);$(t).data("options",s);$(".item",$(".popup",t)).click(function(g){if(r){g.stopPropagation()}var n=$("label",this).html();var e=$(this).attr("data-value");var h=-1;var k=null;for(var j=0;j<d.length;j++){var m=d[j];var f=$.val("text",m);var l=$.val("value",m);if(l==e||f==n){h=j;k=m;break}}if(k){k._index=h}$("input",t).val(n);$(".text",t).html(n);$(t).attr("data-value",e);$.fire_event(q,[g,k],t)});$(".item>input[type='checkbox']",$(".popup",t)).on("change",function(){var e=this.nextElementSibling.innerHTML;var f=this.parentNode.getAttribute("data-value");$(t).dropdown_val({text:e,value:f},true)});$(".popup .search-item input",t).click(function(e){e.preventDefault();e.stopPropagation()});$(".popup .search-item input",t).keyup(function(g){var e=this.value;var f=$(this).closest(".popup");$(".item",f).show();if(e.length>0){$(".item:not([data-search*='"+e+"'])",f).hide()}});s.items=d;$(t).data("options",s);$(t).dropdown_val("*")})}},dropdown_attr:function(b){this.each(function(){var a=$(this).data("options");if($.type(b)=="object"){for(var g in b){var f=b[g];var h={};switch(g){case"items":$(this).dropdown_items(f);break;case"readonly":if(f){$(this).addClass("readonly");a.readonly=true}else{$(this).removeClass("readonly");a.readonly=false}break;case"value":$(this).dropdown_val(f);break;case"width":h.width=parseInt(f);break}$(this).css(h)}}$(this).data("options",a)})},dropdown_load:function(){this.each(function(){var f=this;var d=$(f).data("options");var e=$.val("src",d,{d:""});$.api_post(e,{},function(b){var a=$.val("data",b);if($.type(a)=="array"){$(f).dropdown_items(a)}})})},dropdown_reset:function(){$(this).each(function(){var d=$(this).data("options");var c=$.val("defaultvalue",d,{d:""});$(this).dropdown_val(c)})},dropdown_readonly:function(b){$(this).each(function(){if($.istrue(b)){$(this).addClass("readonly")}else{$(this).removeClass("readonly")}})}});$.fn.extend({feed:function(b){$(this).each(function(){var h=$.val("class",b,{d:""});var f=$.val("src",b,{d:""});var g=$.val("autoload",b,{d:false});var a=[];a.push("<div class='feed-content'></div>");a.push("<div class='feed-footer'></div>");$(this).addClass("feed");$(this).addClass(h);$(this).html(a.join(""));$(this).data("options",b);if(g){$(this).feed_load()}})},feed_val:function(c,d){if(typeof c=="undefined"){}else{$(this).each(function(){var a=$(this).data("options");var r=$.val("src",a,{d:""});var b=$.val("template",a,{d:""});if($.type(c)=="array"&&c.length>0){var m="feed_group_"+$.uniqid();var i=document.createElement("div");i.setAttribute("data-feed-group-id",m);var n=[];for(var o=0;o<c.length;o++){n.push("<div class='feed-item'></div>")}i.innerHTML=n.join("");$(".feed-content",this).append(i);for(var o=0;o<c.length;o++){var p=c[o];var q=i.childNodes[o];$.fire_event(b,[p],q)}}})}},feed_load:function(b){$(this).each(function(){if(!$(this).hasClass("feed")){return}var a=this;var f=$(this).data("options");var e=$.val("src",f,{d:""});if(e!=""){$.api_post(e,[],function(j){var c=$.val("data",j,{d:[]});var d=$.val("page",j,{d:1});var k=d==1?false:true;$(a).feed_val(c,k);var l=$.val("max_page",j,{d:d});if(l>=d+1){$(".feed-footer",a).html("<div class='load-more align-center padding10'>Load More...</div>");$(".load-more",a).on("click",function(){$(a).feed_load({page:d+1})})}else{$(".feed-footer",a).html("")}})}})}});$.extend({foldedpane_toggle:function(e){var d=$(e);if(typeof d[0]=="undefined"){return}var f=$(".toggler",d);if(d[0].classList.contains("folded")){d[0].classList.remove("folded");if(f.length==1){f.html("<span class='fa fa-caret-up'></span>")}}else{d[0].classList.add("folded");if(f.length==1){f.html("<span class='fa fa-caret-down'></span>")}}},foldedpane_init:function(){var g=document.body.querySelectorAll(".folded-pane");for(var h=0;h<g.length;h++){var f=g[h];var e=f.querySelector(".toggler");if(e!=null){e.addEventListener("click",function(){$.foldedpane_toggle(f)})}}}});$.fn.extend({grid:function(m){var j=$.val("autoload",m,{d:true});var l=$.val("columns",m,{d:[]});var k=$.val("class",m,{d:null});var n=$.val("name",m,{d:""});var p=$.val("footer",m,{d:""});var i=$.val("value",m,{d:null});var o=$.val("height",m,{d:"auto"});m.page=0;m.row_per_page=12;this.each(function(){var a=this;var b=[];b.push("<table class='grid-body'>");b.push("<tbody class='grid-size'></tbody>");b.push("</table>");b.push("<div class='grid-footer'></div>");$(a).attr("data-type","grid");$(a).addClass("grid");$(a).addClass(k);if(n!=""){$(a).attr("data-name",n)}$(a).data("options",m);$(a).attr("data-type","grid");$(a).html(b.join(""));$.fire_event(p,[],$(".grid-footer",a));$(this).grid_set_columns(l);if(i!=null){$(a).grid_set(i)}if(j){$(a).grid_load()}})},grid_add:function(b){this.each(function(){var I=this;var i=I.querySelector(".grid-body");var B=$(I).data("options");var K=$.val("columns",B,{d:[]});var J=[];if($(".grid-size",i).length==0){var y=[];y.push("<tr class='grid-size'>");for(var D=0;D<K.length;D++){var C=K[D];var x=$.val("width",C,{d:""});y.push("<td style='width:"+x+";'></td>");y.push("<td class='separator'></td>")}y.push("<td style='width:100%'></td>");y.push("</tr>");J.push(y.join(""))}J.push("<tr>");for(var F=0;F<K.length;F++){var C=K[F];var E=$.val("type",C,{d:"text"});var z=$.val("datatype",C,{d:"text"});var a=$.val("name",C,{d:""});var x=$.val("width",C,{d:""});var H=$.val("align",C,{d:""});var A="";var G="";var w="";switch(E){case"index":w=D+1;A="right";G="label";break;case"html":gridtypecoord=0+","+F;break;default:switch(z){case"number":case"money":A="right";w=$.val(a,b,{d:0});break;case"enum":var j=$.val("enums",C,{d:{}});w=$.val(a,b,{d:"-"});w=$.val(w,j,{d:"-"});break;default:w=$.val(a,b,{d:"-"});break}G="label";break}if(H!=""){A=H}J.push("<td data-gridtype='"+E+"' data-gridtypecoord='"+gridtypecoord+"' class='"+G+"' style='text-align:"+A+"'>"+w+"</td>");J.push("<td class='separator'></td>")}J.push("<td></td>");J.push("</tr>");$("tbody",i).append(J.join(""));$("td[data-gridtype='html']",$("tr",$("tbody",i)).last()).each(function(){var f=$(this).attr("data-gridtypecoord").split(",");var e=parseInt(f[1]);var d=K[e];var c=$.val("html",d,{d:""});$.fire_event(c,[b,d],this)})})},grid_remove:function(c){var d=this;$(c).each(function(){var a=$(this).closest(".grid");a=typeof a[0]!="undefined"?a[0]:-2;var b=typeof d[0]!="undefined"?d[0]:-1;if(a==b){$(this).remove()}})},grid_set_columns:function(b){$(this).each(function(){if(!$(this).hasClass("grid")){return}var i=$(this).data("options");i.columns=b;$(this).data("options",i);var m=[];m.push("<tr>");for(var a=0;a<b.length;a++){var k=b[a];var n=$.val("name",k);var l=$.val("width",k);var j=$.val("active",k,{d:1});if(j==1){m.push($.p("<td class='grid-size-label' style='width:$1' data-key='"+n+"'></td>",[l]))}else{m.push($.p("<td class='grid-size-label inactive' style='width:$1' data-key='"+n+"'></td>",[l]))}}m.push("<td style='width:100%'></td>");m.push("</tr>");$(".grid-size",this).html(m.join(""))})},grid_append:function(c,d){this.each(function(){var q=this;var s=q.querySelector(".grid-body");var r=$(q).data("options");var t=$.val("src",r,{d:""});var w=$.val("onselect",r);var p=$.val("columns",r,{d:[]});var x=$.val("page",c,{d:1});var u=$.val("row_per_page",c,{d:10});var i=$.val("max_page",c,{d:x});var y=$.val("data",c);if(typeof r.data=="undefined"){r.data=[]}var a=document.createElement("tbody");$(a).html($.grid_html(y,p,r.data.length));$(s).append(a);$("td[data-gridtype='html']",a).each(function(){var f=$(this).attr("data-gridtypecoord").split(",");var k=parseInt(f[0]);var e=parseInt(f[1]);var h=y[k];var j=p[e];var g=$.val("html",j,{d:""});$.fire_event(g,[h,j],this)});$("tr",a).click(function(){var e=$(this).closest("table");$(".active",e).removeClass("active");$(this).addClass("active");var f=$(this).attr("data-idx");var g=r.data[f];$.fire_event(w,[g],q)});$(".grid-more",q).remove();if(i>x){$(q).append("<div class='grid-more' data-page='"+x+"'><label class='cl-gray'>Load more...</label></div>");$(".grid-more",q).click(function(){var e=parseInt($(this).attr("data-page"));var f=$.val("onloadmore",r);$(this).html("<i class='fa fa-circle-o-notch fa-spin fa-fw cl-gray'></i>");if(t!=""){$(q).grid_load()}$.fire_event(f,[{page:e}],q)});$(".grid-more",q).appear(function(){var e=parseInt($(this).attr("data-page"));var f=$.val("onloadmore",r);$(this).html("<i class='fa fa-circle-o-notch fa-spinfa-fw cl-gray'></i>");if(t!=""){$(q).grid_load()}$.fire_event(f,[{page:e}],q)})}for(var b=0;b<y.length;b++){r.data.push(y[b])}$(q).data("options",r)})},grid_load:function(b){this.each(function(){var o=this;var k=$(o).data("options");var n=$.val("src",k,{d:""});var m=$.val("method",k,{d:"post"});if(n.length>0){var p=$.val("page",b,{d:1});var a=$.val("row_per_page",b,{d:10});var j=$.val("columns",k);var l={page:p,row_per_page:a,columns:j};if(m.toString().toLowerCase()=="get"){$.api_get(n,l,function(d){var f=$.val("data",d,{d:[]});var g=$.val("page",d,{d:1});var e=g==1?false:true;$(o).grid_val(f,e);var c=$.val("next_page",d,{d:g});if(c>g){$(".grid-footer",o).html("<div class='load-more align-center padding10'>Load More...</div>");$(".load-more",o).on("click",function(){$(o).grid_load({page:c})})}else{$(".grid-footer",o).html("")}})}else{$.api_post(n,l,function(d){var f=$.val("data",d,{d:[]});var g=$.val("page",d,{d:1});var e=g==1?false:true;$(o).grid_val(f,e);var c=$.val("next_page",d,{d:g});if(c>g){$(".grid-footer",o).html("<div class='load-more align-center padding10'>Load More...</div>");$(".load-more",o).on("click",function(){$(o).grid_load({page:c})})}else{$(".grid-footer",o).html("")}})}$(".grid-footer",this).html("<div class='align-center padding10'>Loading...</div>")}})},grid_val:function(c,d){if(typeof c=="undefined"){var c=[];this.each(function(){var f=this;var b=f.querySelector(".grid-body");var a=$("tbody",b);$(a).children().each(function(){if(this.classList.contains("grid-size")){}else{var h=$(this).attr("data-idx");var e=$.el_get(this);if(JSON.stringify(e).length>3){c.push(e)}}})});return c}else{this.each(function(){var t=this;var r=$(t).data("options");var A=$.val("onselect",r);var u=$.val("columns",r,{d:[]});var b=document.createElement("tbody");b.className="grid-content";b.innerHTML=$.grid_html(c,u);if(typeof d=="undefined"||d!==true){$(".grid-content",t).remove()}$(".grid-body",t).append(b);for(var i=0;i<b.childNodes.length;i++){var x=b.childNodes[i];var j=c[i];for(var s=0;s<x.childNodes.length;s++){var w=x.childNodes[s];var y=w.getAttribute("data-column-type");if(y=="html"){var z=u[s];var a=$.val("html",z,{d:""});$.fire_event(a,[j,z],w)}}}$("tr",b).on("click.gridrow",function(e){var f=$(this).closest("table");$(".active",f).removeClass("active");$(this).addClass("active");$.fire_event(A,[e,this],t)})})}},grid_get_selected_value:function(){var b=null;$(this).each(function(){var f=$(this).data("options");var e=$.val("data",f);var a=$("tr[class='active']").attr("data-idx");b=$.val(a,e)});return b}});$.extend({grid_html:function(z,E){if(!z){return}var x=[];for(var y=0;y<z.length;y++){var A=z[y];x.push("<tr>");for(var D=0;D<E.length;D++){var F=E[D];var i=$.val("type",F,{d:"text"});var j=$.val("datatype",F,{d:"text"});var s=$.val("name",F,{d:""});var G=$.val("align",F,{d:""});var t="";var B="";var u="";switch(i){case"html":break;default:switch(j){case"number":case"money":t="right";u=$.val(s,A,{d:0});u=$.number_format(u);break;case"enum":var C=$.val("enums",F,{d:{}});u=$.val(s,A,{d:"-"});u=$.val(u,C,{d:"-"});break;default:u=$.val(s,A,{d:"-"});break}var w=$.val("lettercase",F,{d:""});switch(w){case"capitalize":u=u.toString().capitalize();break;case"lowercase":u=u.toString().toLowerCase();break;case"uppercase":u=u.toString().toUpperCase();break}B="label";break}if(G!=""){t=G}x.push("<td data-column-type='"+i+"' class='"+B+"' style='text-align:"+t+"'>"+u+"</td>")}x.push("<td></td>");x.push("</tr>")}return x.join("")}});$.fn.extend({gridhead:function(j){var m=$.val("autoload",j,{d:true});var h=$.val("columns",j,{d:[]});var n=$.val("class",j,{d:null});var k=$.val("name",j,{d:""});var i=$.val("grid",j,{d:null});var l=$.val("height",j,{d:null});this.each(function(){var a=this;$(a).addClass("gridhead");$(a).addClass(n);$(a).attr("data-type","gridhead");if(k!=""){$(a).attr("data-name",k)}$(a).data("options",j);$(a).attr("data-type","gridhead");$(a).gridhead_attr({height:l});$(this).gridhead_set(h)})},gridhead_set:function(b){$(this).each(function(){var A=this;var w=$(this).data("options");var a=$.val("grid",w,{d:null});var D=$.val("oncolumnclick",w);w.columns=b;var t=[];t.push("<table class='grid-head'><tr>");for(var u=0;u<b.length;u++){var x=b[u];var E=$.val("name",x,{d:""});var B=$.val("active",x,{d:1});var z=$.val("text",x,{d:"-"});var i=$.val("width",x,{d:""});var C=$.val("datatype",x,{d:"text"});var y=$.val("align",x,{d:""});var s="";switch(C){case"number":case"money":s="right";break;case"enum":break;default:break}if(y!=""){s=y}var r="label"+(!B?" inactive":"");t.push("<td class='"+r+"' style='width:"+i+";text-align:"+s+"' data-key=\""+E+'">'+z+"<span class='separator'></span></span></td>")}t.push("<td style='width:100%'></td>");t.push("</tr></table>");$(A).html(t.join(""));$(".separator",A).mousedown(function(e){e.preventDefault();e.stopPropagation();var d=this.parentNode;var f=d.parentNode;var c=e.clientX;$(window).on("mousemove.gridhead",function(g){g.preventDefault();g.stopPropagation();var h=g.clientX-c;d.style.width=(parseInt(d.style.width)+h)+"px";c=g.clientX});$(window).on("mouseup.gridhead",function(j){j.preventDefault();j.stopPropagation();var l=$(a);var n=$(".grid-size",l);if(n.length==1){var m=-1;for(var k=0;k<f.childNodes.length;k++){if(f.childNodes[k]==d){m=k;break}}m=parseInt(m);$(".grid-size-label:eq("+(m)+")",n).css({width:$(d).outerWidth()});var h=$(A).data("options");h.columns[m]["width"]=$(d).outerWidth();var g=$.val("oncolumnresize",h);$.fire_event(g,[{index:m,width:$(d).outerWidth()}],A)}$(window).off("mousemove.gridhead");$(window).off("mouseup.gridhead")})});$(".separator",A).click(function(c){c.preventDefault();c.stopPropagation()});$(".label",A).on("click",function(e){e.preventDefault();e.stopPropagation();var c=$(this).attr("data-key");var d=$(this).attr("data-sorttype");if(d=="asc"){d="desc"}else{if(d=="desc"){d="asc"}else{d="asc"}}$(this).attr("data-sorttype",d);$.fire_event(D,[[{key:c,type:d}]],A)})})},gridhead_attr:function(b){$(this).each(function(){for(var a in b){var d=b[a];switch(a){case"height":$(this).css({height:d});break}}})},gridhead_modify_column:function(b){$(this).each(function(){if(!$(this).hasClass("gridhead")){return}var p=$(this).data("options");var o=$.val("grid",p);var q=$.val("columns",p);for(var s=0;s<q.length;s++){var a=q[s];var r=$.val("name",a,{d:""});var i=$.val("width",a,{d:""});if(r==""){continue}for(var t=0;t<b.length;t++){var u=b[t];var j=$.val("name",u,{d:""});var w=$.val("active",u,{d:1});if(r==j){if(w){$(".label[data-key='"+j+"']",this).removeClass("inactive");$(".grid-size-label[data-key='"+j+"']",$(o)).removeClass("inactive")}else{$(".label[data-key='"+j+"']",this).addClass("inactive");$(".grid-size-label[data-key='"+j+"']",$(o)).addClass("inactive")}p.columns[s]["active"]=w;column_exists=true}}}$(this).data("options",p)})}});$.fn.extend({gridsetting:function(c){var d=$.val("onchange",c);this.each(function(){var a=this;var b=[];b.push("<div class='modal-head'>");b.push("<div class='align-center padding10'>");b.push("<ul class='tab'>");b.push("<li class='active' data-value='presets'>Presets</li>");b.push("<li data-value='columns'>Columns</li>");b.push("<li data-value='filters'>Filters</li>");b.push("</ul>");b.push("</div>");b.push("</div>");b.push("<div class='modal-body padding20'>");b.push("<div class='cont12 space10 gridsetting-presets'>");b.push("<div class='lg12'><button class='blue preset-add-btn'><span class='fa fa-plus'></span> Add Preset...</button></div>");b.push("<div class='lg12'><span class='preset-grid'></span></div>");b.push("</div>");b.push("<div class='cont12 space10 gridsetting-columns' style='display:none'>");b.push("<div class='lg12'>");b.push("<button class='blue column-up-btn'><span class='fa fa-caret-up'></span>Up</button>");b.push("&nbsp;");b.push("<button class='blue column-down-btn'><span class='fa fa-caret-down'></span>Down</button>");b.push("</div>");b.push("<div class='lg6'><span class='column-grid'></span></div>");b.push("<div class='lg6'>");b.push("<div class='cont12 space10 gridsetting-column-detail'>");b.push("<div class='lg3 align-right'><label class='padding10'>Align</label></div>");b.push("<div class='lg9'><span class='gridsetting-column-align'></span></div>");b.push("<div class='lg3 align-right'><label class='padding10'>Name</label></div>");b.push("<div class='lg9'><label class='gridsetting-column-name padding10'></label></div>");b.push("<div class='lg3 align-right'><label class='padding10'>Text</label></div>");b.push("<div class='lg9'><span class='gridsetting-column-text'></span></div>");b.push("<div class='lg3 align-right'><label class='padding10'>Width</label></div>");b.push("<div class='lg9'><span class='gridsetting-column-width'></span></div>");b.push("</div>");b.push("</div>");b.push("</div>");b.push("<div class='cont12 space10 gridsetting-filters' style='display:none'>");b.push("<div class='lg12'><button class='blue filter-add-btn'><span class='fa fa-plus'></span> Add Filter...</button></div>");b.push("<div class='lg12'><span class='filter-grid'></span></div>");b.push("</div>");b.push("</div>");b.push("<div class='modal-foot'>");b.push("<button class='blue apply-btn'><span class='fa fa-save'></span> Apply Filter</button>");b.push("&nbsp;");b.push("<button class='close-btn'><span class='fa fa-times'></span> Close</button>");b.push("</div>");$(a).addClass("modal width800 gridsetting");$(a).html(b.join(""));$(".tab",a).tab({onchange:function(f){$(".modal-body",a).children().hide();$(".gridsetting-"+f.value,a).show()}});$(".preset-add-btn").click(function(){});$(".preset-grid",a).grid({"class":"transparent",columns:[{text:"",type:"html",html:"$.gridsetting_preset_option",width:"50px"},{text:"Preset Name",name:"text",width:"150px"}]});$(".column-grid",a).grid({"class":"transparent",columns:[{text:"Column Name",name:"text",width:"150px"},{text:"Width",name:"width",width:"100px"}],onselect:function(h){var j=$(this).closest(".gridsetting-columns");var i=$(".gridsetting-column-detail",j);$.el_set(i,h);$(".gridsetting-column-name",i).html($.val("name",h,{d:""}))}});$(".gridsetting-column-align",a).dropdown({name:"align",items:[{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]});$(".gridsetting-column-name",a).html("");$(".gridsetting-column-text",a).textbox({name:"text",onchange:function(k){var i=$(a).data("params");var l=$(this).closest(".gridsetting-column-detail");var n=$(".gridsetting-column-name",l).html();for(var m=0;m<i.presets[i.active_idx]["columns"].length;m++){if(i.presets[i.active_idx]["columns"][m]["name"]==n){i.presets[i.active_idx]["columns"][m]["text"]=k}}$(a).data("presets",i)}});$(".gridsetting-column-width",a).textbox({name:"width",onchange:function(k){var i=$(a).data("params");var l=$(this).closest(".gridsetting-column-detail");var n=$(".gridsetting-column-name",l).html();for(var m=0;m<i.presets[i.active_idx]["columns"].length;m++){if(i.presets[i.active_idx]["columns"][m]["name"]==n){i.presets[i.active_idx]["columns"][m]["width"]=k}}$(a).data("presets",i)}});$(".filter-add-btn",a).click(function(){$(".filter-grid",a).grid_add()});$(".filter-grid",a).grid({"class":"transparent",columns:[{text:"",type:"html",html:"$.gridsetting_grid_option",width:"50px"},{text:"Key",type:"html",html:"$.gridsetting_grid_key",width:"150px"},{text:"Operator",type:"html",html:"$.gridsetting_grid_opt",width:"150px"},{text:"Value",type:"html",html:"$.gridsetting_grid_val",width:"150px"}]});$(".apply-btn",a).click(function(){var j=$(".filter-grid",a).grid_value();var h=$(a).data("params");var i=parseInt($.val("active_idx",h,{d:0}));h.presets[i]["filters"]=j;$.fire_event(d,[h],a);$(a).modal_close()});$(".close-btn",a).click(function(){$(a).modal_close()})})},gridsetting_close:function(){$(this).modal_close()},gridsetting_open:function(c,d){this.each(function(){var b=$.val("presets",c);var g=c.presets[c.active_idx];var a=$.val("columns",c);var h=$.val("filters",c);$(this).data("params",c);$(this).data("columns",a);$(".preset-grid",this).grid_set(b);$(".column-grid",this).grid_set(a);$(".filter-grid",this).grid_set(h);$(this).modal_open({height:window.innerHeight*0.8})})}});$.extend({gridsetting_preset_option:function(b){$(this).html("<button class='preset-grid-options'><span class='fa fa-times'></span></button>");$(".preset-grid-options",this).click(function(){$(this).closest("tr").remove()})},gridsetting_grid_option:function(b){$(this).html("<button class='filter-grid-options'><span class='fa fa-times'></span></button>");$(".filter-grid-options",this).click(function(){$(this).closest("tr").remove()})},gridsetting_grid_type:function(b){$(this).html("<span class='filter-grid-type'></span>");$(".filter-grid-type",this).textbox({name:"type",value:$.val("type",b,{d:null})})},gridsetting_grid_key:function(q,s){var i=$(this).closest(".gridsetting");var r=$(i).data("params");var m=r.presets[r.active_idx];var s=r.columns;var o=[];if($.type(s)=="array"){for(var p=0;p<s.length;p++){var t=s[p];var l=$.val("name",t,{d:""});var n=$.val("text",t,{d:l});if(l.length>0){o.push({text:n,value:l})}}}$(this).html("<span class='filter-grid-key'></span>");$(".filter-grid-key",this).dropdown({name:"key",items:o,value:$.val("key",q,{d:null})})},gridsetting_grid_opt:function(b){$(this).html("<span class='filter-grid-opt'></span>");$(".filter-grid-opt",this).dropdown({name:"operator",items:[{text:"Contains",value:"contains"},{text:"Equals",value:"equals"}],value:$.val("operator",b,{d:null})})},gridsetting_grid_val:function(b){$(this).html("<span class='filter-grid-val'></span>");$(".filter-grid-val",this).textbox({name:"value",value:$.val("value",b,{d:null})})}});$.fn.extend({hidden:function(c){var d=$.val("name",c,{d:""});$(this).each(function(){var a=[];$(this).html(a.join(""));$(this).attr("data-type","hidden");$(this).attr("data-name",d);$(this).addClass("hidden");$(this).data("options",c)})},hidden_val:function(c){if(typeof c=="undefined"){var d=[];$(this).each(function(){d.push($(this).data("value"))});return d.length>1?d:(d.length==1?d[0]:"")}else{$(this).each(function(){$(this).data("value",c)})}}});$.fn.extend({image:function(h){var l=$.val("class",h,{d:""});var j=$.val("height",h,{d:"50px"});var i=$.val("name",h,{d:""});var k=$.val("value",h,{d:""});var g=$.val("width",h,{d:"50px"});this.each(function(){var a=this;var b=[];b.push('<img src="'+k+'"/>');$(a).attr("data-type","image");$(a).attr("data-name",i);$(a).addClass("image");$(a).addClass(l);$(a).html(b.join(""));$(a).data("options",h);$("img",a).css({width:g,height:j})})},image_val:function(c){if(typeof c=="undefined"){var d=[];this.each(function(){d.push($("img",this).attr("src"))});return d.length>1?d:(d.length==1?d[0]:"")}else{this.each(function(){$("img",this).attr("src",c)})}}});$.extend({layout_resize:function(){$(".layout-sidebar, .layout-main, .layout-ext",$(".layout")).css({height:window.innerHeight-$(".header").outerHeight()})}});$.fn.extend({layout:function(h){var f=$.val("class",h,{d:""});var g=$.val("size",h,{d:{}});var j=$.val("large",g,{d:"300px auto 400px"});var i=j.split(" ");$(this).each(function(){var a=$.val(0,i,{d:"200px"});var b="100%";var c=$.val(2,i,{d:"300px"});$(this).addClass("layout");$(this).addClass(f);$(".layout-sidebar",this).css({flex:"0 0 "+a});$(".layout-main",this).css({flex:"1 1 "+b});$(".layout-ext",this).css({flex:"0 0 "+c});$(".layout-sidebar, .layout-main, .layout-ext",this).css({height:window.innerHeight-$(".header").outerHeight()})});$(window).on("resize.layout",function(){$.layout_resize()})}});$.extend({layout2_resize:function(){$(".layout2").layout2_resize()}});$.fn.extend({layout2:function(h){var f=$.val("class",h,{d:""});var g=$.val("size",h,{d:"300px auto 400px"});var e=g.split(" ");$(this).each(function(){$(this).addClass("layout2");$(this).addClass(f);$(this).data("options",h);$(this).layout2_resize()});$(window).on("resize.layout",function(){$.layout2_resize()})},layout2_resize:function(){$(this).each(function(){var j=$(this).data("options");var r=$.val("onresize",j);var o=$.val("ext_hidden",j);var k=$.val("size",j,{d:"300px auto 400px"});var l=k.split(" ");var n=window.innerHeight-$(".header").outerHeight();var q=$.val(0,l,{d:"200px"});var p=$.val(2,l,{d:"300px"});var n=window.innerHeight-$(".header").outerHeight();p=$.calc_size(p,n);var m=n-p;$(".layout-sidebar",this).css({flex:"0 0 "+q,height:n});$(".layout-content",this).css({flex:"1 1 auto"});if(o==0){$(this).removeClass("ext-hidden");$(".layout-main",this).css({height:p});$(".layout-ext",this).css({height:m})}else{$(this).addClass("ext-hidden");$(".layout-main",this).css({height:n});$(".layout-ext",this).css({height:0})}$.fire_event(r,[],this)})},layout2_toggleext:function(b){$(this).each(function(){if(!$(this).hasClass("layout2")){return}var a=$(this).data("options");a.ext_hidden=b?0:1;$(this).data("options",a);$(this).layout2_resize()})},layout2_ext_state:function(){var b=0;$(this).each(function(){var a=$(this).data("options");b=$.val("ext_hidden",a,{d:-1})>0?0:1});return b}});$.fn.extend({modal_open:function(b){this.each(function(){var a=this;$(a).addClass("on");$(document.body).css({overflow:"hidden"});var f=$(a).outerHeight()-5-($(".modal-head",a).outerHeight()+$(".modal-foot",a).outerHeight());if(!isNaN(f)){$(".modal-body",a).css({height:f})}var h=$.val("reset",b,{d:false});if(h===true){$(a).reset()}var g=$.val("value",b,{d:null});if(g!=null){$(a).val(b.value)}})},modal_close:function(c,d){this.each(function(){var a=this;$(a).removeClass("on");$(".modal-bg").removeClass("on")});if($(".modal.on").length==0){$(document.body).css({overflow:""})}}});$.extend({popup_close:function(b){$(b).removeClass("on")},popup_open:function(r,q,j){$.popup_close_all();$(r).addClass("on");var n={};var o=$(q).offset();var k=o.left+r.clientWidth;var l=o.top-$(window).scrollTop()+$(q).outerHeight()+1;var m=window.innerHeight-l-10;n.top=l;n["max-height"]=m;if(k>window.innerWidth){o.left=window.innerWidth-r.clientWidth}n.left=o.left;var p=$.val("min_width",j);if(!isNaN(parseInt(p))){n["min-width"]=p}$(r).css(n)},popup_toggle:function(e,d,f){if(e.classList.contains("on")){$.popup_close(e,d,f)}else{$.popup_open(e,d,f)}},popup_close_all:function(){var d=document.body.querySelectorAll(".popup");for(var c=0;c<d.length;c++){$.popup_close(d[c])}}});$.fn.extend({radio:function(b){$(this).each(function(){var p=$.val("items",b,{d:null});var q=$.val("class",b,{d:""});var w=$.val("text",b,{d:""});var x=$.val("name",b,{d:""});var a=$.val("value",b,{d:""});var t=[];if($.type(p)=="array"){var r="radio-name-"+$.uniqid();for(var u=0;u<p.length;u++){var y=p[u];var z=y.text;var A=y.value;var i=a!=""&&a==A?true:false;var s="radio-"+$.uniqid();t.push("<input type='radio' id='"+s+"' value=\""+A+"\" name='"+r+"'"+(i?" checked":"")+"/>");t.push("<label for='"+s+"'>"+z+"</label>")}}else{var i=parseInt(a)==1||a===true?true:false;var s="radio-"+$.uniqid();t.push("<input type='radio' id='"+s+"'"+(i?" checked":"")+"/>");t.push("<label for='"+s+"'>"+w+"</label>")}$(this).addClass("radio");$(this).addClass(q);$(this).attr({"data-type":"radio"});$(this).html(t.join(""))})},radio_val:function(c){if(typeof c=="undefined"){var d=[];$(this).each(function(){var b=this.querySelectorAll("input");if(b.length==1){d.push(b[0].checked?1:0)}else{for(var a=0;a<b.length;a++){if(b[a].checked){d.push(b[a].value)}}}});d=d.join(",");return d}else{$(this).each(function(){var a=this.querySelectorAll("input");if(a.length==1){a[0].checked=(parseInt(c)==1||c===true)?true:false}else{var b=false;for(var f=0;f<a.length;f++){if(a[f].value==c){a[f].checked=true;b=true;break}}if(!b){$("input",this).attr("checked",false)}}})}}});$.extend({role_init:function(c){var d=typeof c!="undefined"&&c instanceof HTMLElement?c:document.body;$("*[data-role]",d).each(function(){var a=this.getAttribute("data-role");switch(a){case"modal.close":$(this).click(function(){$(this).closest(".modal").modal_close()});break;case"url.open":var b=$(this).attr("data-role-value");$(this).click(function(){window.location=b});break}})}});$.fn.extend({spinner:function(d){var c=$.val("size",d,{defaultvalue:"20px"});this.each(function(){var a=[];a.push('<div class="sk-fading-circle" style="width:'+c+";height:"+c+';">');a.push('<div class="sk-circle1 sk-circle"></div>');a.push('<div class="sk-circle2 sk-circle"></div>');a.push('<div class="sk-circle3 sk-circle"></div>');a.push('<div class="sk-circle4 sk-circle"></div>');a.push('<div class="sk-circle5 sk-circle"></div>');a.push('<div class="sk-circle6 sk-circle"></div>');a.push('<div class="sk-circle7 sk-circle"></div>');a.push('<div class="sk-circle8 sk-circle"></div>');a.push('<div class="sk-circle9 sk-circle"></div>');a.push('<div class="sk-circle10 sk-circle"></div>');a.push('<div class="sk-circle11 sk-circle"></div>');a.push('<div class="sk-circle12 sk-circle"></div>');a.push("</div>");$(this).html(a.join(""))})}});$.fn.extend({tab:function(e){var h=$.val("container",e,{d:""});var f=$.val("name",e,{d:""});var g=$.val("onchange",e);this.each(function(){var a=this;$(a).attr("data-type","tab");$(a).attr("data-name",f);$(a).data("options",e);$("li",a).click(function(){if(this.classList.contains("active")){}else{$("li",this.parentNode).removeClass("active");$(this).addClass("active");var d=this.innerHTML;var b=this.getAttribute("data-value");if(b==null){b=$.slug(d)}var c=$(this).index();if($(h).length>0){$(h+">*").addClass("off");$(h+">*:eq("+c+")").removeClass("off")}$.fire_event(g,[{text:d,value:b}],a)}})})},tab_set:function(e){var f=this;var g=$(f).data("options");var h=$.val("onchange",g);$("li",this).removeClass("active");$("li",this).each(function(){var b=this.innerHTML;var a=this.getAttribute("data-value");if(a==null){a=$.slug(b)}if(a==e){$(this).addClass("active");$.fire_event(h,[{text:b,value:a}],f)}})}});$.fn.extend({textarea:function(s){var u=$.val("placeholder",s,{d:""});var y=$.val("class",s,{d:""});var q=$.val("name",s,{d:""});var t=$.val("height",s,{d:"1em"});var p=$.val("width",s);var o=$.val("maxlength",s,{d:""});var x=$.val("onblur",s);var r=$.val("onkeyup",s);var n=$.val("onchange",s);var w=$.val("value",s,{d:""});var m={width:p};this.each(function(){var a=this;var b=[];b.push("<textarea rows='1' placeholder='"+u+"' style='height:"+t+";' maxlength='"+o+"'></textarea>");b.push("<span class='icon fa hidden'></span>");$(a).addClass("textarea");$(a).addClass(y);$(a).css(m);$(a).html(b.join(""));$(a).attr("data-type","textarea");$(a).attr("data-name",q);$(a).data("options",s);$("textarea",a).blur(function(c){$(a).textarea_validate();$.fire_event(x,[],a)}).keyup(function(c){$.fire_event(r,[this.value],a);if($(this).data("last_value")!=this.value){$.fire_event(n,[this.value],a)}$(this).data("last_value",this.value)});$("textarea",a).each(function(){this.setAttribute("style","height:"+(this.scrollHeight<=0?"":this.scrollHeight)+"px;overflow-y:hidden;")}).on("input",function(){this.style.height="auto";this.style.height=(this.scrollHeight)+"px"});if(w!=""){$(this).textarea_val(w)}})},textarea_val:function(c){if(typeof c=="undefined"){var d=[];$(this).each(function(){d.push($("textarea",this).val())});return d.length>1?d:(d.length==1?d[0]:"")}else{$(this).each(function(){$("textarea",this).val(c).each(function(){this.style.height="auto";this.style.height=(this.scrollHeight)+"px"})})}},textarea_placeholder:function(c){if(typeof c=="undefined"){var d=[];$(this).each(function(){d.push($("input",this).attr("placeholder"))});return d.length>1?d:(d.length==1?d[0]:"")}else{$(this).each(function(){$("input",this).attr("placeholder",c)})}},textarea_reset:function(){$(this).textarea_val("")},textarea_validate:function(){$(this).each(function(){var j=$(this).data("options");var n=$.val("required",j,{d:false});var o=$.val("required_text",j,{d:"Field required."});var q=$.val("validation",j,{d:""});var p=$.val("validation_text",j,{d:"Validation error."});var l=$(this).textarea_val();var r=true;var k="";if(n){if(l.toString().trim()==""){r=false;k=o}else{if(q!=""){switch(q){default:var m=new RegExp(q);r=m.test(l);if(!r){k=p}break}}}}else{if(l.toString().length>0){switch(q){default:var m=new RegExp(q);r=m.test(l);if(!r){k=p}break}}}if(!r){$(this).addClass("invalid");console.warn(k)}else{$(this).removeClass("invalid")}})}});$.fn.extend({textbox:function(u){var y=$.val("placeholder",u,{d:""});var t=$.val("name",u,{d:""});var A=$.val("class",u,{d:""});var w=$.val("value",u,{d:""});var p=$.val("readonly",u,{d:false});var r=$.val("maxlength",u,{d:""});var n=$.val("mode",u,{d:"text"});var s=$.val("width",u);var z=$.val("onblur",u);var x=$.val("onkeyup",u);var q=$.val("onchange",u);var o={width:s};this.each(function(){var a=this;var b=[];b.push($.p('<input type="$1" placeholder="$1" maxlength="$1"/>',[n,y,r]));b.push("<span class='icon fa hidden'></span>");$(a).addClass("textbox");$(a).addClass(A);$(a).css(o);$(a).html(b.join(""));$(a).attr("data-type","textbox");$(a).attr("data-name",t);$(a).data("options",u);$("input",a).val(w);$("input",a).blur(function(c){$(a).textbox_validate();$.fire_event(z,[],a)}).keyup(function(c){$.fire_event(x,[this.value],a);if($(this).data("last_value")!=this.value){$.fire_event(q,[this.value],a)}$(this).data("last_value",this.value)})})},textbox_val:function(c){if(typeof c=="undefined"){var d=[];$(this).each(function(){d.push($("input",this).val())});return d.length>1?d:(d.length==1?d[0]:"")}else{$(this).each(function(){$("input",this).val(c)})}},textbox_placeholder:function(c){if(typeof c=="undefined"){var d=[];$(this).each(function(){d.push($("input",this).attr("placeholder"))});return d.length>1?d:(d.length==1?d[0]:"")}else{$(this).each(function(){$("input",this).attr("placeholder",c)})}},textbox_reset:function(){$(this).textbox_val("")},textbox_validate:function(){$(this).each(function(){var j=$(this).data("options");var n=$.val("required",j,{d:false});var o=$.val("required_text",j,{d:"Field required."});var q=$.val("validation",j,{d:""});var p=$.val("validation_text",j,{d:"Validation error."});var l=$(this).textbox_val();var r=true;var k="";if(n){if(l.toString().trim()==""){r=false;k=o}else{if(q!=""){switch(q){default:var m=new RegExp(q);r=m.test(l);if(!r){k=p}break}}}}else{if(l.toString().length>0){switch(q){default:var m=new RegExp(q);r=m.test(l);if(!r){k=p}break}}}if(!r){$(this).addClass("invalid");console.warn(k)}else{$(this).removeClass("invalid")}})}});$.fn.extend({toggle:function(g){var f=$.val("class",g,{d:""});var h=$.val("name",g,{d:""});var e=$.val("value",g,{d:false});this.each(function(){var a=this;var b=[];b.push("<span class='main-toggle'></span>");a.innerHTML=b.join("");$(this).addClass("toggle");$(this).addClass(f);$(a).attr("data-type","toggle");if(h!=""){$(a).attr("data-name",h)}a.querySelector(".main-toggle").addEventListener("click",function(){if(this.parentNode.classList.contains("on")){this.parentNode.classList.remove("on")}else{this.parentNode.classList.add("on")}});$(a).toggle_val(e);return a})},toggle_val:function(b){if(!$(this).hasClass("toggle")){return undefined}if(typeof b=="undefined"){return $(this).hasClass("on")?1:0}else{if(b==true||b==1){$(this).addClass("on")}else{$(this).removeClass("on")}}}});$.extend({tooltip:function(i,g){var j=$(".tooltip");if(j.length==0){$.warn("No tooltip defined.")}$(j).addClass("on");var k=i.getBoundingClientRect();var h={};var l=[];console.log(i);h.left=k.left;console.log([k.top,k.top+k.height+$(j).outerHeight()+10,window.innerHeight]);if(k.top+k.height+$(j).outerHeight()+10>window.innerHeight){h.top=k.top-$(j).outerHeight()-10;l.push("<div class='arrow-down'></div>")}else{h.top=k.top+k.height+10;l.push("<div class='arrow-up'></div>")}l.push(g);$(j).html(l.join(""));$(j).css(h)},tooltip_remove:function(){$(".tooltip").removeClass("on")}});$.extend({date:function(f,l){var m=this;var k,n;var o=["Sun","Mon","Tues","Wednes","Thurs","Fri","Satur","January","February","March","April","May","June","July","August","September","October","November","December"];var q=/\\?(.?)/gi;var r=function(b,a){return n[b]?n[b]():a};var p=function(a,b){a=String(a);while(a.length<b){a="0"+a}return a};n={d:function(){return p(n.j(),2)},D:function(){return n.l().slice(0,3)},j:function(){return k.getDate()},l:function(){return o[n.w()]+"day"},N:function(){return n.w()||7},S:function(){var b=n.j();var a=b%10;if(a<=3&&parseInt((b%100)/10,10)==1){a=0}return["st","nd","rd"][a-1]||"th"},w:function(){return k.getDay()},z:function(){var a=new Date(n.Y(),n.n()-1,n.j());var b=new Date(n.Y(),0,1);return Math.round((a-b)/86400000)},W:function(){var a=new Date(n.Y(),n.n()-1,n.j()-n.N()+3);var b=new Date(a.getFullYear(),0,4);return p(1+Math.round((a-b)/86400000/7),2)},F:function(){return o[6+n.n()]},m:function(){return p(n.n(),2)},M:function(){return n.F().slice(0,3)},n:function(){return k.getMonth()+1},t:function(){return(new Date(n.Y(),n.n(),0)).getDate()},L:function(){var a=n.Y();return a%4===0&a%100!==0|a%400===0},o:function(){var b=n.n();var a=n.W();var c=n.Y();return c+(b===12&&a<9?1:b===1&&a>9?-1:0)},Y:function(){return k.getFullYear()},y:function(){return n.Y().toString().slice(-2)},a:function(){return k.getHours()>11?"pm":"am"},A:function(){return n.a().toUpperCase()},B:function(){var c=k.getUTCHours()*3600;var a=k.getUTCMinutes()*60;var b=k.getUTCSeconds();return p(Math.floor((c+a+b+3600)/86.4)%1000,3)},g:function(){return n.G()%12||12},G:function(){return k.getHours()},h:function(){return p(n.g(),2)},H:function(){return p(n.G(),2)},i:function(){return p(k.getMinutes(),2)},s:function(){return p(k.getSeconds(),2)},u:function(){return p(k.getMilliseconds()*1000,6)},e:function(){throw"Not supported (see source code of date() for timezone on how to add support)"},I:function(){var a=new Date(n.Y(),0);var c=Date.UTC(n.Y(),0);var b=new Date(n.Y(),6);var d=Date.UTC(n.Y(),6);return((a-c)!==(b-d))?1:0},O:function(){var a=k.getTimezoneOffset();var b=Math.abs(a);return(a>0?"-":"+")+p(Math.floor(b/60)*100+b%60,4)},P:function(){var a=n.O();return(a.substr(0,3)+":"+a.substr(3,2))},T:function(){return"UTC"},Z:function(){return -k.getTimezoneOffset()*60},c:function(){return"Y-m-d\\TH:i:sP".replace(q,r)},r:function(){return"D, d M Y H:i:s O".replace(q,r)},U:function(){return k/1000|0}};this.date=function(a,b){m=this;k=(b===undefined?new Date():(b instanceof Date)?new Date(b):new Date(b*1000));return a.replace(q,r)};return this.date(f,l)},uniqid:function(){if(typeof $.__UNIQID=="undefined"){$.__UNIQID=0}return ++$.__UNIQID},val:function(l,q,i){if(typeof i=="undefined"||$.type(i)!="object"){i={}}var m=null;var k=typeof i.default_value!="undefined"?i.default_value:(typeof i.d!="undefined"?i.d:null);var p=typeof i.t!="undefined"?i.t:(typeof i.datatype!="undefined"?i.datatype:"string");var n=typeof i.required!="undefined"&&n==1?true:false;if($.type(q)=="object"){if($.type(l)=="array"){m=null;for(var o=0;o<l.length;o++){var r=l[o];v=$.val(r,q,{default_value:null});if(v!=null){m=v;break}}}else{if($.type(l)=="string"||$.type(l)=="number"){if(typeof q[l]!="undefined"){m=q[l]}}}}else{if($.type(q)=="array"){if(typeof q[l]!="undefined"){m=q[l]}}}if(n){if(m==null){}}else{m=m==null&&k!=null?k:m}switch(p){case"number":case"integer":case"float":case"double":m=parseFloat(m);break}return m},strtotime:function(B,G){var u,z,s,x,D,F,t,y,w,i,A,E=false;if(!B){return E}if(/^\d{8}$/.test(B)){B=B.substr(0,4)+"-"+B.substr(4,2)+"-"+B.substr(6,2)}B=B.replace(/^\s+|\s+$/g,"").replace(/\s{2,}/g," ").replace(/[\t\r\n]/g,"").toLowerCase();z=B.match(/^(\d{1,4})([\-\.\/\:])(\d{1,2})([\-\.\/\:])(\d{1,4})(?:\s(\d{1,2}):(\d{2})?:?(\d{2})?)?(?:\s([A-Z]+)?)?$/);if(z&&z[2]===z[4]){if(z[1]>1901){switch(z[2]){case"-":if(z[3]>12||z[5]>31){return E}return new Date(z[1],parseInt(z[3],10)-1,z[5],z[6]||0,z[7]||0,z[8]||0,z[9]||0)/1000;case".":return E;case"/":if(z[3]>12||z[5]>31){return E}return new Date(z[1],parseInt(z[3],10)-1,z[5],z[6]||0,z[7]||0,z[8]||0,z[9]||0)/1000}}else{if(z[5]>1901){switch(z[2]){case"-":if(z[3]>12||z[1]>31){return E}return new Date(z[5],parseInt(z[3],10)-1,z[1],z[6]||0,z[7]||0,z[8]||0,z[9]||0)/1000;case".":if(z[3]>12||z[1]>31){return E}return new Date(z[5],parseInt(z[3],10)-1,z[1],z[6]||0,z[7]||0,z[8]||0,z[9]||0)/1000;case"/":if(z[1]>12||z[3]>31){return E}return new Date(z[5],parseInt(z[1],10)-1,z[3],z[6]||0,z[7]||0,z[8]||0,z[9]||0)/1000}}else{switch(z[2]){case"-":if(z[3]>12||z[5]>31||(z[1]<70&&z[1]>38)){return E}x=z[1]>=0&&z[1]<=38?+z[1]+2000:z[1];return new Date(x,parseInt(z[3],10)-1,z[5],z[6]||0,z[7]||0,z[8]||0,z[9]||0)/1000;case".":if(z[5]>=70){if(z[3]>12||z[1]>31){return E}return new Date(z[5],parseInt(z[3],10)-1,z[1],z[6]||0,z[7]||0,z[8]||0,z[9]||0)/1000}if(z[5]<60&&!z[6]){if(z[1]>23||z[3]>59){return E}s=new Date();return new Date(s.getFullYear(),s.getMonth(),s.getDate(),z[1]||0,z[3]||0,z[5]||0,z[9]||0)/1000}return E;case"/":if(z[1]>12||z[3]>31||(z[5]<70&&z[5]>38)){return E}x=z[5]>=0&&z[5]<=38?+z[5]+2000:z[5];return new Date(x,parseInt(z[1],10)-1,z[3],z[6]||0,z[7]||0,z[8]||0,z[9]||0)/1000;case":":if(z[1]>23||z[3]>59||z[5]>59){return E}s=new Date();return new Date(s.getFullYear(),s.getMonth(),s.getDate(),z[1]||0,z[3]||0,z[5]||0)/1000}}}}if(B==="now"){return G===null||isNaN(G)?new Date().getTime()/1000|0:G|0}if(!isNaN(u=Date.parse(B))){return u/1000|0}D=G?new Date(G*1000):new Date();F={sun:0,mon:1,tue:2,wed:3,thu:4,fri:5,sat:6};t={yea:"FullYear",mon:"Month",day:"Date",hou:"Hours",min:"Minutes",sec:"Seconds"};function C(a,c,b){var e,d=F[c];if(typeof d!=="undefined"){e=d-D.getDay();if(e===0){e=7*b}else{if(e>0&&a==="last"){e-=7}else{if(e<0&&a==="next"){e+=7}}}D.setDate(D.getDate()+e)}}function r(e){var g=e.split(" "),c=g[0],b=g[1].substring(0,3),a=/\d+/.test(c),d=g[2]==="ago",f=(c==="last"?-1:1)*(d?-1:1);if(a){f*=parseInt(c,10)}if(t.hasOwnProperty(b)&&!g[1].match(/^mon(day|\.)?$/i)){return D["set"+t[b]](D["get"+t[b]]()+f)}if(b==="wee"){return D.setDate(D.getDate()+(f*7))}if(c==="next"||c==="last"){C(c,b,f)}else{if(!a){return false}}return true}w="(years?|months?|weeks?|days?|hours?|minutes?|min|seconds?|sec|sunday|sun\\.?|monday|mon\\.?|tuesday|tue\\.?|wednesday|wed\\.?|thursday|thu\\.?|friday|fri\\.?|saturday|sat\\.?)";i="([+-]?\\d+\\s"+w+"|(last|next)\\s"+w+")(\\sago)?";z=B.match(new RegExp(i,"gi"));if(!z){return E}for(A=0,y=z.length;A<y;A++){if(!r(z[A])){return E}}return(D.getTime()/1000)},mktime:function(){var d=new Date(),g=arguments,h=0,e=["Hours","Minutes","Seconds","Month","Date","FullYear"];for(h=0;h<e.length;h++){if(typeof g[h]==="undefined"){g[h]=d["get"+e[h]]();g[h]+=(h===3)}else{g[h]=parseInt(g[h],10);if(isNaN(g[h])){return false}}}g[5]+=(g[5]>=0?(g[5]<=69?2000:(g[5]<=100?1900:0)):0);d.setFullYear(g[5],g[3]-1,g[4]);d.setHours(g[0],g[1],g[2]);return(d.getTime()/1000>>0)-(d.getTime()<0)},date_parse:function(b){switch(b){case"this_month":b=$.date("Ym")+"01-"+$.date("Ymd",$.mktime(0,0,0,parseInt($.date("m"))+1,0,$.date("Y")));break}return b},start_day_of_month:function(d,f){var e=$.date("N",$.mktime(0,0,0,f,1,d));return e},last_date_of_month:function(g,f){var d=27;do{d++;var h=parseInt($.date("j",$.mktime(0,0,0,f,d,g)));if(h!=d){d--;break}}while(true);return d},api_get:function(h,l,k,i){var j=$.http_build_query(l);h+=j.length>0?"?"+j:"";var g=new XMLHttpRequest();g.open("GET",h,true);g.addEventListener("load",function(){if(this.readyState==4){var b=$.eval_as_object(this.responseText);var a=$.val("error",b,{d:0,datatype:"integer"});var c=$.val("error_message",b,{d:""});if(a>0){if(i!=null){$.fire_event(i,[this.responseText],g)}else{alert(c)}}else{$.fire_event(k,[b],g)}}});g.addEventListener("error",function(){if(typeof i!="undefined"||i!=null){$.fire_event(i)}else{console.log(this.responseText)}});g.send();return g},api_post:function(h,f,j,i){var g=new XMLHttpRequest();g.open("POST",h,true);g.addEventListener("load",function(){if(this.readyState==4){var b=$.eval_as_object(this.responseText);var a=$.val("error",b,{d:0,datatype:"integer"});var c=$.val("error_message",b,{d:""});if(parseInt(a)==0){$.fire_event(j,[b],g)}else{if(typeof i!="undefined"||i!=null){$.fire_event(i,[{error:a,error_message:c}])}else{alert(JSON.stringify(b,null,2))}}}});g.addEventListener("error",function(){if(typeof i!="undefined"||i!=null){$.fire_event(i)}else{console.log(this.responseText)}});g.send(JSON.stringify(f));return g},http_build_query:function(f,h,e){var g=[];if($.type(f)=="object"){Object.keys(f).forEach(function(c){var b=c;h&&!isNaN(b)?b=h+b:"";var b=encodeURIComponent(b.toString().replace(/[!'()*]/g,escape));e?b=e+"["+b+"]":"";if(typeof f[c]==="object"){var d=$.http_build_query(f[c],null,b);g.push(d)}else{var a=encodeURIComponent(f[c].toString().replace(/[!'()*]/g,escape));g.push(b+"="+a)}})}return g.join("&")},fire_event:function(callback,params,thisArg){if(typeof thisArg=="undefined"){thisArg=null}if($.type(callback)=="string"){callback=eval(callback)}if($.type(callback)=="function"){return callback.apply(thisArg,params)}},eval_as_object:function(exp){try{return eval("("+exp+")")}catch(e){return null}},ux:function(d){d=typeof d=="undefined"||!(d instanceof HTMLElement)?document.body:d;var c=d.querySelectorAll("*[data-type]");$(c).each(function(){var a=this.getAttribute("data-type");if(typeof $(this)[a]=="function"){var b=$.options_from_html(this);$(this)[a](b)}else{console.warn("Unknown ux "+a)}})},el_get:function(h){if($(h).attr("data-type")!=null){var f=$(h).attr("data-type");if(typeof $(h)[f+"_get"]=="function"){return $(h)[f+"_get"]()}return null}else{var e={};var g=$("*[data-type]",h);$(g).each(function(){var c=this;var b=$.el_get(c);var a=c.getAttribute("data-name");if(a==null){a="undefined"}e[a]=b});return e}},el_set:function(d,c){$("*[data-type]",d).each(function(){var f=this.getAttribute("data-type");var a=this.getAttribute("data-name");var b=$.val(a,c);if(typeof $(this)[f+"_set"]=="function"){$(this)[f+"_set"](b)}else{console.warn("unknown method")}})},options_from_html:function(el){var options=null;if(el.getAttribute("data-options")!=null){try{options=eval("("+el.getAttribute("data-options")+")")}catch(e){options=null}}else{var options={};for(var i=0;i<el.attributes.length;i++){options[el.attributes[i].nodeName.replace("data-","")]=el.attributes[i].nodeValue}}return options},cookie_getitem:function(b){if(!b){return null}return decodeURIComponent(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+encodeURIComponent(b).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1"))||null},cookie_setitem:function(i,m,j,k,l,h){if(!i||/^(?:expires|max\-age|path|domain|secure)$/i.test(i)){return false}var n="";if(j){switch(j.constructor){case Number:n=j===Infinity?"; expires=Fri, 31 Dec 9999 23:59:59 GMT":"; max-age="+j;break;case String:n="; expires="+j;break;case Date:n="; expires="+j.toUTCString();break}}document.cookie=encodeURIComponent(i)+"="+encodeURIComponent(m)+n+(l?"; domain="+l:"")+(k?"; path="+k:"")+(h?"; secure":"");return true},cookie_removeitem:function(e,f,d){if(!this.hasItem(e)){return false}document.cookie=encodeURIComponent(e)+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT"+(d?"; domain="+d:"")+(f?"; path="+f:"");return true},cookie_hasitem:function(b){if(!b){return false}return(new RegExp("(?:^|;\\s*)"+encodeURIComponent(b).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=")).test(document.cookie)},cookie_keys:function(){var d=document.cookie.replace(/((?:^|\s*;)[^\=]+)(?=;|$)|^\s*|\s*(?:\=[^;]*)?(?:\1|$)/g,"").split(/\s*(?:\=[^;]*)?;\s*/);for(var e=d.length,f=0;f<e;f++){d[f]=decodeURIComponent(d[f])}return d},slug:function(e){var f="";var d=$.trim(e);f=d.replace(/[^a-z0-9-]/gi,"-").replace(/-+/g,"-").replace(/^-|-$/g,"");return f.toLowerCase()},warn:function(b){console.warn(b)},array_merge:function(){var t=Array.prototype.slice.call(arguments);var r=t.length;var q;var k={};var o="";var p=0;var j=0;var w=0;var u=0;var s=Object.prototype.toString;var i=true;for(w=0;w<r;w++){if(s.call(t[w])!=="[object Array]"){i=false;break}}if(i){i=[];for(w=0;w<r;w++){i=i.concat(t[w])}return i}for(w=0,u=0;w<r;w++){q=t[w];if(s.call(q)==="[object Array]"){for(j=0,p=q.length;j<p;j++){k[u++]=q[j]}}else{for(o in q){if(q.hasOwnProperty(o)){if(parseInt(o,10)+""===o){k[u++]=q[o]}else{k[o]=q[o]}}}}}return k},in_array:function(j,f,g){var h="";var i=!!g;if(i){for(h in f){if(f[h]===j){return true}}}else{for(h in f){if(f[h]==j){return true}}}return false},number_format:function(r,t,o,p){r=(r+"").replace(/[^0-9+\-Ee.]/g,"");var k=!isFinite(+r)?0:+r;var l=!isFinite(+t)?0:Math.abs(t);var m=(typeof p==="undefined")?",":p;var s=(typeof o==="undefined")?".":o;var n="";var q=function(a,b){var c=Math.pow(10,b);return""+(Math.round(a*c)/c).toFixed(b)};n=(l?q(k,l):""+Math.round(k)).split(".");if(n[0].length>3){n[0]=n[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,m)}if((n[1]||"").length<l){n[1]=n[1]||"";n[1]+=new Array(l-n[1].length+1).join("0")}return n.join(s)},qs:(function(a){if(a==""){return{}}var b={};for(var h=0;h<a.length;++h){var g=a[h].split("=",2);if(g.length==1){b[g[0]]=""}else{b[g[0]]=decodeURIComponent(g[1].replace(/\+/g," "))}}return b})(window.location.search.substr(1).split("&")),p:function(m,n){var h=m.match(/\$\w+/g);if(h!=null){if($.type(n)=="array"){for(var j=0;j<h.length;j++){var l=h[j];var i=typeof n[j]!="undefined"?n[j]:"";m=m.replace(l,i)}}else{if($.type(n)=="object"){for(var j=0;j<h.length;j++){var l=h[j];var k=l.replace("$","");var i=typeof n[k]!="undefined"?n[k]:"";m=m.replace(l,i)}}}}return m},array_key_count:function(e){var f=0;for(var d in e){f++}return f},object_value_min:function(f){var g=-1;if($.type(f)=="object"){for(var h in f){var e=f[h];if(g==-1||parseFloat(e)<parseFloat(g)){g=e}}}return g},object_value_max:function(f){var g=-1;if($.type(f)=="object"){for(var h in f){var e=f[h];if(g==-1||parseFloat(e)>parseFloat(g)){g=e}}}return g},ksort:function(e){var f=Object.keys(e).sort(),h={};for(var g in f){h[f[g]]=e[f[g]]}return h},str_pad:function(k,n,i,m){var h="";var l;var j=function(c,a){var b="";while(b.length<a){b+=c}b=b.substr(0,a);return b};k+="";i=i!==undefined?i:" ";if(m!=="STR_PAD_LEFT"&&m!=="STR_PAD_RIGHT"&&m!=="STR_PAD_BOTH"){m="STR_PAD_RIGHT"}if((l=n-k.length)>0){if(m==="STR_PAD_LEFT"){k=j(i,l)+k}else{if(m==="STR_PAD_RIGHT"){k=k+j(i,l)}else{if(m==="STR_PAD_BOTH"){h=j(i,Math.ceil(l/2));k=h+k+h;k=k.substr(0,n)}}}}return k},template_parse:function(n,i){var s=n.match(/<!--IF.+?(?=-->)(.+)?(?=<!--END-->)<!--END-->/gi,"gi");if($.type(s)=="array"){for(var t=0;t<s.length;t++){var r=s[t];var s=r.match(/\(.+?(?=\))\)/gi,"gi");var o=s[0];o=o.substr(1,o.length-2);var q=new Function("obj","return "+o+";");if(!q(i)){n=n.replace(r,"","gi")}}}var s=n.match(/<!--IF_NOT_EMPTY.+?(?=-->)(.+)?(?=<!--END-->)<!--END-->/gi,"gi");if($.type(s)=="array"){for(var t=0;t<s.length;t++){var r=s[t];var s=r.match(/\(\w+\)/gi,"gi");var o=s[0];o=o.substr(1,o.length-2);if($.val(o,i,{d:""})==""){n=n.replace(r,"","gi")}}}var s=n.match(/{\w+(:\w+)*?(?=})}/gi,"gi");if($.type(s)=="array"){for(var t=0;t<s.length;t++){var r=s[t];var o=r.substr(1,r.length-2);var f="string";if(o.indexOf(":")>=0){var m=o.split(":");o=m[0];f=m[1]}var p=$.val(o,i,{d:"-"});p=$.convert_datatype(p,f);n=n.replace(r,p,"gi")}}return n},convert_datatype:function(c,d){switch(d){case"date":c=$.date("j M Y",$.strtotime(c));break}return c},calc_size:function(c,d){d=typeof d=="undefined"||!d?window.innerWidth:d;if(c.indexOf("%")>=0){c=c.replace("%","","gi");if(!isNaN(parseFloat(c))){c=parseFloat(c)/100*d}}return c},download:function(d){var a=document.createElement("a");a.href=d;a.setAttribute("download",d);document.body.appendChild(a);a.click();document.body.removeChild(a)},ux_init:function(b){b=typeof b=="undefined"||!(b instanceof HTMLElement)?document.body:b;$("*[data-type]",b).each(function(){var d=this.getAttribute("data-type");if(typeof $(this)[d]=="function"){var a=$.options_from_html(this);$(this)[d](a)}else{console.warn("Unknown ux "+d)}});$("*[data-action]",b).each(function(){switch(this.getAttribute("data-action")){case"modal.close":$(this).on("click.data-action",function(){$(this).closest(".modal").modal_close()});break}});$(window).on("click",$.popup_close_all).on("scroll",$.popup_close_all);$(window).on("keyup",function(a){switch(a.keyCode){case 27:$(".modal").modal_close();break}})},istrue:function(b){if(typeof b!="undefined"&&(parseInt(b)==1||b===true)){return true}return false}});var oldVal=$.fn.val;$.fn.val=function(c){var d=$(this).attr("data-type");if(d!=null&&typeof $(this)[d+"_val"]!="undefined"){return $(this)[d+"_val"].apply(this,arguments)}else{if($(this).hasClass("container")){return $(this).container_val.apply(this,arguments)}else{return oldVal.apply(this,arguments)}}};$.fn.placeholder=function(){var b=$(this).attr("data-type");if(b!=null&&typeof $(this)[b+"_placeholder"]!="undefined"){return $(this)[b+"_placeholder"].apply(this,arguments)}else{if($(this).hasClass("container")){return $(this).container_placeholder.apply(this,arguments)}}};$.fn.readonly=function(){var b=$(this).attr("data-type");if(b!=null&&typeof $(this)[b+"_readonly"]!="undefined"){return $(this)[b+"_readonly"].apply(this,arguments)}else{if($(this).hasClass("container")){return $(this).container_readonly.apply(this,arguments)}}};$.fn.reset=function(){var b=$(this).attr("data-type");if(b!=null&&typeof $(this)[b+"_reset"]!="undefined"){return $(this)[b+"_reset"].apply(this,arguments)}else{if($(this).hasClass("container")){return $(this).container_reset.apply(this,arguments)}}};String.prototype.capitalize=function(){return this.charAt(0).toUpperCase()+this.slice(1)};$($.ux_init);$.fn.extend({vfields:function(d){var c=$.val("value",d);$(this).each(function(){var a=this;$(a).addClass("vfields");$(a).data("options",d);if($.type(c)=="array"){$(a).form_set(c)}})},form_set:function(b){if(typeof b=="undefined"||$.type(b)!="array"){return}$(this).each(function(){var a=this;var e=$(this).data("options");var f=$.val("html_callback",e);$(b).each(function(){var d=this;var h=[];h.push("<table><tr><td class='vfields-col1' align='center' style='width:24px'>");h.push("<span class='fa fa-times-circle selectable vfields-remove hoverable'></span>");h.push("</td><td class='vfields-col2'></td></tr></table>");var c=document.createElement("div");c.className="vfields-item";c.innerHTML=h.join("");$(a).append(c);$.fire_event(f,[d],$(".vfields-col2",c))});$(".vfields-remove",a).click(function(){$(this).closest(".vfields-item").remove()})})},vfields_get:function(){var b=[];$(this).each(function(){var a=this;$(".vfields-col2",a).each(function(){var d=$.el_get(this);b.push(d)})});return b}});$.fn.extend({webeditor:function(c){var d=$.val("height",c);this.each(function(){var a=$.uniqid();var b=[];b.push($.p('<textarea id="$1"></textarea>',["webeditor"+a]));$(this).addClass("webeditor");$(this).html(b.join(""));$(this).data("options",c);CKEDITOR.replace("webeditor"+a,{height:d})})},webeditor_get:function(c){var d=[];this.each(function(){var a=$("textarea",this).attr("id");if(typeof CKEDITOR.instances[a]!="undefined"){var b=CKEDITOR.instances[a].getData();d.push(b)}});return d.length==1?d[0]:(d.length>1?d:null)},webeditor_set:function(b){this.each(function(){var a=$("textarea",this).attr("id");if(typeof CKEDITOR.instances[a]!="undefined"){CKEDITOR.instances[a].setData(b)}})}});$.fn.extend({widget:function(b){this.each(function(){var D=this;var r=$.val("type",b);var E=$.val("src",b);var a=$.val("title",b,{default_value:"Untitled"});var B=$.val("columns",b);var s=$.uniqid();var t=$.val("default_presets",b);var u=parseInt($.val("preset_idx",b,{d:0}));if(isNaN(u)){u=0}var x=[];x.push($.p('<div class="widget-head padding10">',[a]));x.push($.p("<table><tr>",[]));x.push($.p('<td style="width:100%">',[]));x.push($.p('<h5 class="padding10">$1</h5>',[a]));x.push($.p("</td>",[a]));x.push($.p("<td>",[]));x.push($.p('<span id="$1"></span>',["preset-selector"+s]));x.push($.p('<span class="icon icon-reload fa fa-refresh padding10 selectable"></span>',[]));x.push($.p('<span class="icon icon-customize fa fa-ellipsis-h padding10 selectable"></span>',[]));x.push($.p("</td>",[]));x.push($.p("</tr></table>",[]));x.push($.p("</div>",[]));x.push($.p('<div class="modal" id="$1"></div>',["customize"+s]));var z=null;var C=[];var y="";if($.type(t)=="array"){for(var A=0;A<t.length;A++){if(A==u){y=t[A]["text"];z=t[A]}C.push({text:t[A]["text"],value:t[A]["text"]})}}switch(r){case"grid":x.push($.p('<div class="widget-body align-center margin10 ">',[]));x.push($.p('<span id="$1"></span>',["gridhead"+s]));x.push($.p("<div></div>",[]));x.push($.p('<span id="$1"></span>',["grid"+s]));x.push($.p("</div>",[]));$(D).html(x.join(""));var B=$.val("columns",b);$("#gridhead"+s,D).gridhead({columns:B,grid:"#grid"+s});var w=$(D).outerHeight()-$(".widget-head",D).outerHeight()-$("#gridhead"+s,D).outerHeight()-15;$("#grid"+s,D).grid({columns:B,height:w});break;case"chart":x.push($.p('<div class="widget-body align-center margin10 ">',[]));x.push($.p('<span id="$1"></span>',["chart"+s]));x.push($.p("</div>",[]));$(D).html(x.join(""));var i=$.val("chart_type",b);var w=$(D).outerHeight()-$(".widget-head",D).outerHeight()-$("#gridhead"+s,D).outerHeight()-15;$("#chart"+s).chart({width:"100%",height:w,padding:0,type:i});break;case"metric":x.push($.p('<div class="widget-body align-left margin10 ">',[]));x.push($.p('<span id="$1"></span>',["metric"+s]));x.push($.p("</div>",[]));$(D).html(x.join(""));break}$("#preset-selector"+s).dropdown({items:C,value:y,onchange:function(){$(D).widget_load()}});$("#customize"+s).gridsetting({onchange:function(e){var c=$(this).closest(".widget");var d=$(c).data("options");d=$.array_merge(d,e);$(c).data("options",d);$(D).widget_load()}});$(".icon-reload",D).click(function(){$(D).widget_load()});$(".icon-customize",D).click(function(){var e=$(this).closest(".widget");var d=$(e).data("options");var f=$.val("columns",d);var c=$.val("default_presets",d);$("#customize"+s).gridsetting_open({columns:f,presets:c,active_idx:0})});$(D).data("options",b);$(D).data("uid",s);$(D).widget_load()})},widget_load:function(){this.each(function(){var u=this;var s=$(u).data("options");var r=$.val("src",s);var w=$.val("type",s);var y=$.val("default_presets",s);var i=parseInt($.val("preset_idx",s,{d:0}));var x=$(u).data("uid");var p=$("#preset-selector"+x).dropdown_get();var t=null;var q=[];var n="";if($.type(y)=="array"){for(var o=0;o<y.length;o++){if(y[o]["text"]==p){n=y[o]["text"];t=y[o]}q.push({text:y[o]["text"],value:y[o]["text"]})}}switch(w){case"metric":$.api_post(r,t,function(a){$("#metric"+x).html("<h2>"+a.data+"</h2>")});break;case"grid":$.api_post(r,t,function(b){var a=$.val("data",b);$("#grid"+x,u).grid_set(a)});break;case"chart":$.api_post(r,t,function(a){$("#chart"+x).chart_set(a.data)});break}})}});$.extend({workspace_init:function(){$(".workspace").each(function(){var b=window.innerHeight-$(".header").outerHeight()-20;$(this).workspace_set({state:$(this).attr("data-state"),size:$(this).attr("data-size"),height:b});$.workspace_rtime;$.workspace_timeout=false;$.workspace_delta=200;$(window).resize(function(){$.workspace_rtime=new Date();if($.workspace_timeout===false){$.workspace_timeout=true;setTimeout($.workspace_resizeend,$.workspace_delta)}})})},workspace_resizeend:function(){if(new Date()-$.workspace_rtime<$.workspace_delta){setTimeout($.workspace_resizeend,$.workspace_delta)}else{$.workspace_timeout=false;$(".workspace").each(function(){var b=window.innerHeight-$(".header").outerHeight()-20;$($(this).children()[0]).css({height:b});$($(this).children()[1]).css({height:b});$($(this).children()[2]).css({height:b})})}}});$.fn.extend({workspace_set:function(b){if(typeof b=="undefined"||$.type(b)!="object"){return}$(this).each(function(){b=$.ksort(b);var l={};var n={flex:"1 1 auto"};var o={};for(var p in b){switch(p){case"size":var m=b[p];m=m.split(" ");var t=$.val(0,m,{d:300,t:"number"});var r=$.val(1,m,{d:400,t:"number"});l.flex="0 0 "+(t+"px");o.flex="0 0 "+(r+"px");$(this).data("left_size",t);$(this).data("right_size",r);break;case"height":l.height=b[p];n.height=b[p];o.height=b[p];break;case"state":var a=$.val("state",b,{d:""});a=a.split(" ");var q=$.val(0,a,{d:1,t:"number"});var s=$.val(2,a,{d:0,t:"number"});var t=q<1?"0":$(this).data("left_size");var r=s<1?"0":$(this).data("right_size");l.flex="0 0 "+(t+"px");o.flex="0 0 "+(r+"px");break}}if($(this).children().length==3){$($(this).children()[0]).css(l);$($(this).children()[1]).css(n);$($(this).children()[2]).css(o)}})}});$.fn.extend({spinner:function(d){var c=$.val("size",d,{defaultvalue:"20px"});this.each(function(){var a=[];a.push('<div class="sk-fading-circle" style="width:'+c+";height:"+c+';">');a.push('<div class="sk-circle1 sk-circle"></div>');a.push('<div class="sk-circle2 sk-circle"></div>');a.push('<div class="sk-circle3 sk-circle"></div>');a.push('<div class="sk-circle4 sk-circle"></div>');a.push('<div class="sk-circle5 sk-circle"></div>');a.push('<div class="sk-circle6 sk-circle"></div>');a.push('<div class="sk-circle7 sk-circle"></div>');a.push('<div class="sk-circle8 sk-circle"></div>');a.push('<div class="sk-circle9 sk-circle"></div>');a.push('<div class="sk-circle10 sk-circle"></div>');a.push('<div class="sk-circle11 sk-circle"></div>');a.push('<div class="sk-circle12 sk-circle"></div>');a.push("</div>");$(this).html(a.join(""))})}});$.fn.extend({tab:function(e){var h=$.val("container",e,{d:""});var f=$.val("name",e,{d:""});var g=$.val("onchange",e);this.each(function(){var a=this;$(a).attr("data-type","tab");$(a).attr("data-name",f);$(a).data("options",e);$("li",a).click(function(){if(this.classList.contains("active")){}else{$("li",this.parentNode).removeClass("active");$(this).addClass("active");var d=this.innerHTML;var b=this.getAttribute("data-value");if(b==null){b=$.slug(d)}var c=$(this).index();if($(h).length>0){$(h+">*").addClass("off");$(h+">*:eq("+c+")").removeClass("off")}$.fire_event(g,[{text:d,value:b}],a)}})})},tab_set:function(e){var f=this;var g=$(f).data("options");var h=$.val("onchange",g);$("li",this).removeClass("active");$("li",this).each(function(){var b=this.innerHTML;var a=this.getAttribute("data-value");if(a==null){a=$.slug(b)}if(a==e){$(this).addClass("active");$.fire_event(h,[{text:b,value:a}],f)}})}});$.fn.extend({textarea:function(s){var u=$.val("placeholder",s,{d:""});var y=$.val("class",s,{d:""});var q=$.val("name",s,{d:""});var t=$.val("height",s,{d:"1em"});var p=$.val("width",s);var o=$.val("maxlength",s,{d:""});var x=$.val("onblur",s);var r=$.val("onkeyup",s);var n=$.val("onchange",s);var w=$.val("value",s,{d:""});var m={width:p};this.each(function(){var a=this;var b=[];b.push("<textarea rows='1' placeholder='"+u+"' style='height:"+t+";' maxlength='"+o+"'></textarea>");b.push("<span class='icon fa hidden'></span>");$(a).addClass("textarea");$(a).addClass(y);$(a).css(m);$(a).html(b.join(""));$(a).attr("data-type","textarea");$(a).attr("data-name",q);$(a).data("options",s);$("textarea",a).blur(function(c){$(a).textarea_validate();$.fire_event(x,[],a)}).keyup(function(c){$.fire_event(r,[this.value],a);if($(this).data("last_value")!=this.value){$.fire_event(n,[this.value],a)}$(this).data("last_value",this.value)});$("textarea",a).each(function(){this.setAttribute("style","height:"+(this.scrollHeight<=0?"":this.scrollHeight)+"px;overflow-y:hidden;")}).on("input",function(){this.style.height="auto";this.style.height=(this.scrollHeight)+"px"});if(w!=""){$(this).textarea_val(w)}})},textarea_val:function(c){if(typeof c=="undefined"){var d=[];$(this).each(function(){d.push($("textarea",this).val())});return d.length>1?d:(d.length==1?d[0]:"")}else{$(this).each(function(){$("textarea",this).val(c).each(function(){this.style.height="auto";this.style.height=(this.scrollHeight)+"px"})})}},textarea_placeholder:function(c){if(typeof c=="undefined"){var d=[];$(this).each(function(){d.push($("input",this).attr("placeholder"))});return d.length>1?d:(d.length==1?d[0]:"")}else{$(this).each(function(){$("input",this).attr("placeholder",c)})}},textarea_reset:function(){$(this).textarea_val("")},textarea_validate:function(){$(this).each(function(){var j=$(this).data("options");var n=$.val("required",j,{d:false});var o=$.val("required_text",j,{d:"Field required."});var q=$.val("validation",j,{d:""});var p=$.val("validation_text",j,{d:"Validation error."});var l=$(this).textarea_val();var r=true;var k="";if(n){if(l.toString().trim()==""){r=false;k=o}else{if(q!=""){switch(q){default:var m=new RegExp(q);r=m.test(l);if(!r){k=p}break}}}}else{if(l.toString().length>0){switch(q){default:var m=new RegExp(q);r=m.test(l);if(!r){k=p}break}}}if(!r){$(this).addClass("invalid");console.warn(k)}else{$(this).removeClass("invalid")}})}});$.fn.extend({textbox:function(u){var y=$.val("placeholder",u,{d:""});var t=$.val("name",u,{d:""});var A=$.val("class",u,{d:""});var w=$.val("value",u,{d:""});var p=$.val("readonly",u,{d:false});var r=$.val("maxlength",u,{d:""});var n=$.val("mode",u,{d:"text"});var s=$.val("width",u);var z=$.val("onblur",u);var x=$.val("onkeyup",u);var q=$.val("onchange",u);var o={width:s};this.each(function(){var a=this;var b=[];b.push($.p('<input type="$1" placeholder="$1" maxlength="$1"/>',[n,y,r]));b.push("<span class='icon fa hidden'></span>");$(a).addClass("textbox");$(a).addClass(A);$(a).css(o);$(a).html(b.join(""));$(a).attr("data-type","textbox");$(a).attr("data-name",t);$(a).data("options",u);$("input",a).val(w);$("input",a).blur(function(c){$(a).textbox_validate();$.fire_event(z,[],a)}).keyup(function(c){$.fire_event(x,[this.value],a);if($(this).data("last_value")!=this.value){$.fire_event(q,[this.value],a)}$(this).data("last_value",this.value)})})},textbox_val:function(c){if(typeof c=="undefined"){var d=[];$(this).each(function(){d.push($("input",this).val())});return d.length>1?d:(d.length==1?d[0]:"")}else{$(this).each(function(){$("input",this).val(c)})}},textbox_placeholder:function(c){if(typeof c=="undefined"){var d=[];$(this).each(function(){d.push($("input",this).attr("placeholder"))});return d.length>1?d:(d.length==1?d[0]:"")}else{$(this).each(function(){$("input",this).attr("placeholder",c)})}},textbox_reset:function(){$(this).textbox_val("")},textbox_validate:function(){$(this).each(function(){var j=$(this).data("options");var n=$.val("required",j,{d:false});var o=$.val("required_text",j,{d:"Field required."});var q=$.val("validation",j,{d:""});var p=$.val("validation_text",j,{d:"Validation error."});var l=$(this).textbox_val();var r=true;var k="";if(n){if(l.toString().trim()==""){r=false;k=o}else{if(q!=""){switch(q){default:var m=new RegExp(q);r=m.test(l);if(!r){k=p}break}}}}else{if(l.toString().length>0){switch(q){default:var m=new RegExp(q);r=m.test(l);if(!r){k=p}break}}}if(!r){$(this).addClass("invalid");console.warn(k)}else{$(this).removeClass("invalid")}})}});$.fn.extend({toggle:function(g){var f=$.val("class",g,{d:""});var h=$.val("name",g,{d:""});var e=$.val("value",g,{d:false});this.each(function(){var a=this;var b=[];b.push("<span class='main-toggle'></span>");a.innerHTML=b.join("");$(this).addClass("toggle");$(this).addClass(f);$(a).attr("data-type","toggle");if(h!=""){$(a).attr("data-name",h)}a.querySelector(".main-toggle").addEventListener("click",function(){if(this.parentNode.classList.contains("on")){this.parentNode.classList.remove("on")}else{this.parentNode.classList.add("on")}});$(a).toggle_val(e);return a})},toggle_val:function(b){if(!$(this).hasClass("toggle")){return undefined}if(typeof b=="undefined"){return $(this).hasClass("on")?1:0}else{if(b==true||b==1){$(this).addClass("on")}else{$(this).removeClass("on")}}}});$.extend({tooltip:function(i,g){var j=$(".tooltip");if(j.length==0){$.warn("No tooltip defined.")}$(j).addClass("on");var k=i.getBoundingClientRect();var h={};var l=[];console.log(i);h.left=k.left;console.log([k.top,k.top+k.height+$(j).outerHeight()+10,window.innerHeight]);if(k.top+k.height+$(j).outerHeight()+10>window.innerHeight){h.top=k.top-$(j).outerHeight()-10;l.push("<div class='arrow-down'></div>")}else{h.top=k.top+k.height+10;l.push("<div class='arrow-up'></div>")}l.push(g);$(j).html(l.join(""));$(j).css(h)},tooltip_remove:function(){$(".tooltip").removeClass("on")}});$.extend({date:function(f,l){var m=this;var k,n;var o=["Sun","Mon","Tues","Wednes","Thurs","Fri","Satur","January","February","March","April","May","June","July","August","September","October","November","December"];var q=/\\?(.?)/gi;var r=function(b,a){return n[b]?n[b]():a};var p=function(a,b){a=String(a);while(a.length<b){a="0"+a}return a};n={d:function(){return p(n.j(),2)},D:function(){return n.l().slice(0,3)},j:function(){return k.getDate()},l:function(){return o[n.w()]+"day"},N:function(){return n.w()||7},S:function(){var b=n.j();var a=b%10;if(a<=3&&parseInt((b%100)/10,10)==1){a=0}return["st","nd","rd"][a-1]||"th"},w:function(){return k.getDay()},z:function(){var a=new Date(n.Y(),n.n()-1,n.j());var b=new Date(n.Y(),0,1);return Math.round((a-b)/86400000)},W:function(){var a=new Date(n.Y(),n.n()-1,n.j()-n.N()+3);var b=new Date(a.getFullYear(),0,4);return p(1+Math.round((a-b)/86400000/7),2)},F:function(){return o[6+n.n()]},m:function(){return p(n.n(),2)},M:function(){return n.F().slice(0,3)},n:function(){return k.getMonth()+1},t:function(){return(new Date(n.Y(),n.n(),0)).getDate()},L:function(){var a=n.Y();return a%4===0&a%100!==0|a%400===0},o:function(){var b=n.n();var a=n.W();var c=n.Y();return c+(b===12&&a<9?1:b===1&&a>9?-1:0)},Y:function(){return k.getFullYear()},y:function(){return n.Y().toString().slice(-2)},a:function(){return k.getHours()>11?"pm":"am"},A:function(){return n.a().toUpperCase()},B:function(){var c=k.getUTCHours()*3600;var a=k.getUTCMinutes()*60;var b=k.getUTCSeconds();return p(Math.floor((c+a+b+3600)/86.4)%1000,3)},g:function(){return n.G()%12||12},G:function(){return k.getHours()},h:function(){return p(n.g(),2)},H:function(){return p(n.G(),2)},i:function(){return p(k.getMinutes(),2)},s:function(){return p(k.getSeconds(),2)},u:function(){return p(k.getMilliseconds()*1000,6)},e:function(){throw"Not supported (see source code of date() for timezone on how to add support)"},I:function(){var a=new Date(n.Y(),0);var c=Date.UTC(n.Y(),0);var b=new Date(n.Y(),6);var d=Date.UTC(n.Y(),6);return((a-c)!==(b-d))?1:0},O:function(){var a=k.getTimezoneOffset();var b=Math.abs(a);return(a>0?"-":"+")+p(Math.floor(b/60)*100+b%60,4)},P:function(){var a=n.O();return(a.substr(0,3)+":"+a.substr(3,2))},T:function(){return"UTC"},Z:function(){return -k.getTimezoneOffset()*60},c:function(){return"Y-m-d\\TH:i:sP".replace(q,r)},r:function(){return"D, d M Y H:i:s O".replace(q,r)},U:function(){return k/1000|0}};this.date=function(a,b){m=this;k=(b===undefined?new Date():(b instanceof Date)?new Date(b):new Date(b*1000));return a.replace(q,r)};return this.date(f,l)},uniqid:function(){if(typeof $.__UNIQID=="undefined"){$.__UNIQID=0}return ++$.__UNIQID},val:function(l,q,i){if(typeof i=="undefined"||$.type(i)!="object"){i={}}var m=null;var k=typeof i.default_value!="undefined"?i.default_value:(typeof i.d!="undefined"?i.d:null);var p=typeof i.t!="undefined"?i.t:(typeof i.datatype!="undefined"?i.datatype:"string");var n=typeof i.required!="undefined"&&n==1?true:false;if($.type(q)=="object"){if($.type(l)=="array"){m=null;for(var o=0;o<l.length;o++){var r=l[o];v=$.val(r,q,{default_value:null});if(v!=null){m=v;break}}}else{if($.type(l)=="string"||$.type(l)=="number"){if(typeof q[l]!="undefined"){m=q[l]}}}}else{if($.type(q)=="array"){if(typeof q[l]!="undefined"){m=q[l]}}}if(n){if(m==null){}}else{m=m==null&&k!=null?k:m}switch(p){case"number":case"integer":case"float":case"double":m=parseFloat(m);break}return m},strtotime:function(B,G){var u,z,s,x,D,F,t,y,w,i,A,E=false;if(!B){return E}if(/^\d{8}$/.test(B)){B=B.substr(0,4)+"-"+B.substr(4,2)+"-"+B.substr(6,2)}B=B.replace(/^\s+|\s+$/g,"").replace(/\s{2,}/g," ").replace(/[\t\r\n]/g,"").toLowerCase();z=B.match(/^(\d{1,4})([\-\.\/\:])(\d{1,2})([\-\.\/\:])(\d{1,4})(?:\s(\d{1,2}):(\d{2})?:?(\d{2})?)?(?:\s([A-Z]+)?)?$/);if(z&&z[2]===z[4]){if(z[1]>1901){switch(z[2]){case"-":if(z[3]>12||z[5]>31){return E}return new Date(z[1],parseInt(z[3],10)-1,z[5],z[6]||0,z[7]||0,z[8]||0,z[9]||0)/1000;case".":return E;case"/":if(z[3]>12||z[5]>31){return E}return new Date(z[1],parseInt(z[3],10)-1,z[5],z[6]||0,z[7]||0,z[8]||0,z[9]||0)/1000}}else{if(z[5]>1901){switch(z[2]){case"-":if(z[3]>12||z[1]>31){return E}return new Date(z[5],parseInt(z[3],10)-1,z[1],z[6]||0,z[7]||0,z[8]||0,z[9]||0)/1000;case".":if(z[3]>12||z[1]>31){return E}return new Date(z[5],parseInt(z[3],10)-1,z[1],z[6]||0,z[7]||0,z[8]||0,z[9]||0)/1000;case"/":if(z[1]>12||z[3]>31){return E}return new Date(z[5],parseInt(z[1],10)-1,z[3],z[6]||0,z[7]||0,z[8]||0,z[9]||0)/1000}}else{switch(z[2]){case"-":if(z[3]>12||z[5]>31||(z[1]<70&&z[1]>38)){return E}x=z[1]>=0&&z[1]<=38?+z[1]+2000:z[1];return new Date(x,parseInt(z[3],10)-1,z[5],z[6]||0,z[7]||0,z[8]||0,z[9]||0)/1000;case".":if(z[5]>=70){if(z[3]>12||z[1]>31){return E}return new Date(z[5],parseInt(z[3],10)-1,z[1],z[6]||0,z[7]||0,z[8]||0,z[9]||0)/1000}if(z[5]<60&&!z[6]){if(z[1]>23||z[3]>59){return E}s=new Date();return new Date(s.getFullYear(),s.getMonth(),s.getDate(),z[1]||0,z[3]||0,z[5]||0,z[9]||0)/1000}return E;case"/":if(z[1]>12||z[3]>31||(z[5]<70&&z[5]>38)){return E}x=z[5]>=0&&z[5]<=38?+z[5]+2000:z[5];return new Date(x,parseInt(z[1],10)-1,z[3],z[6]||0,z[7]||0,z[8]||0,z[9]||0)/1000;case":":if(z[1]>23||z[3]>59||z[5]>59){return E}s=new Date();return new Date(s.getFullYear(),s.getMonth(),s.getDate(),z[1]||0,z[3]||0,z[5]||0)/1000}}}}if(B==="now"){return G===null||isNaN(G)?new Date().getTime()/1000|0:G|0}if(!isNaN(u=Date.parse(B))){return u/1000|0}D=G?new Date(G*1000):new Date();F={sun:0,mon:1,tue:2,wed:3,thu:4,fri:5,sat:6};t={yea:"FullYear",mon:"Month",day:"Date",hou:"Hours",min:"Minutes",sec:"Seconds"};function C(a,c,b){var e,d=F[c];if(typeof d!=="undefined"){e=d-D.getDay();if(e===0){e=7*b}else{if(e>0&&a==="last"){e-=7}else{if(e<0&&a==="next"){e+=7}}}D.setDate(D.getDate()+e)}}function r(e){var g=e.split(" "),c=g[0],b=g[1].substring(0,3),a=/\d+/.test(c),d=g[2]==="ago",f=(c==="last"?-1:1)*(d?-1:1);if(a){f*=parseInt(c,10)}if(t.hasOwnProperty(b)&&!g[1].match(/^mon(day|\.)?$/i)){return D["set"+t[b]](D["get"+t[b]]()+f)}if(b==="wee"){return D.setDate(D.getDate()+(f*7))}if(c==="next"||c==="last"){C(c,b,f)}else{if(!a){return false}}return true}w="(years?|months?|weeks?|days?|hours?|minutes?|min|seconds?|sec|sunday|sun\\.?|monday|mon\\.?|tuesday|tue\\.?|wednesday|wed\\.?|thursday|thu\\.?|friday|fri\\.?|saturday|sat\\.?)";i="([+-]?\\d+\\s"+w+"|(last|next)\\s"+w+")(\\sago)?";z=B.match(new RegExp(i,"gi"));if(!z){return E}for(A=0,y=z.length;A<y;A++){if(!r(z[A])){return E}}return(D.getTime()/1000)},mktime:function(){var d=new Date(),g=arguments,h=0,e=["Hours","Minutes","Seconds","Month","Date","FullYear"];for(h=0;h<e.length;h++){if(typeof g[h]==="undefined"){g[h]=d["get"+e[h]]();g[h]+=(h===3)}else{g[h]=parseInt(g[h],10);if(isNaN(g[h])){return false}}}g[5]+=(g[5]>=0?(g[5]<=69?2000:(g[5]<=100?1900:0)):0);d.setFullYear(g[5],g[3]-1,g[4]);d.setHours(g[0],g[1],g[2]);return(d.getTime()/1000>>0)-(d.getTime()<0)},date_parse:function(b){switch(b){case"this_month":b=$.date("Ym")+"01-"+$.date("Ymd",$.mktime(0,0,0,parseInt($.date("m"))+1,0,$.date("Y")));break}return b},start_day_of_month:function(d,f){var e=$.date("N",$.mktime(0,0,0,f,1,d));return e},last_date_of_month:function(g,f){var d=27;do{d++;var h=parseInt($.date("j",$.mktime(0,0,0,f,d,g)));if(h!=d){d--;break}}while(true);return d},api_get:function(h,l,k,i){var j=$.http_build_query(l);h+=j.length>0?"?"+j:"";var g=new XMLHttpRequest();g.open("GET",h,true);g.addEventListener("load",function(){if(this.readyState==4){var b=$.eval_as_object(this.responseText);var a=$.val("error",b,{d:0,datatype:"integer"});var c=$.val("error_message",b,{d:""});if(a>0){if(i!=null){$.fire_event(i,[this.responseText],g)}else{alert(c)}}else{$.fire_event(k,[b],g)}}});g.addEventListener("error",function(){if(typeof i!="undefined"||i!=null){$.fire_event(i)}else{console.log(this.responseText)}});g.send();return g},api_post:function(h,f,j,i){var g=new XMLHttpRequest();g.open("POST",h,true);g.addEventListener("load",function(){if(this.readyState==4){var b=$.eval_as_object(this.responseText);var a=$.val("error",b,{d:0,datatype:"integer"});var c=$.val("error_message",b,{d:""});if(parseInt(a)==0){$.fire_event(j,[b],g)}else{if(typeof i!="undefined"||i!=null){$.fire_event(i,[{error:a,error_message:c}])}else{alert(JSON.stringify(b,null,2))}}}});g.addEventListener("error",function(){if(typeof i!="undefined"||i!=null){$.fire_event(i)}else{console.log(this.responseText)}});g.send(JSON.stringify(f));return g},http_build_query:function(f,h,e){var g=[];if($.type(f)=="object"){Object.keys(f).forEach(function(c){var b=c;h&&!isNaN(b)?b=h+b:"";var b=encodeURIComponent(b.toString().replace(/[!'()*]/g,escape));e?b=e+"["+b+"]":"";if(typeof f[c]==="object"){var d=$.http_build_query(f[c],null,b);g.push(d)}else{var a=encodeURIComponent(f[c].toString().replace(/[!'()*]/g,escape));g.push(b+"="+a)}})}return g.join("&")},fire_event:function(callback,params,thisArg){if(typeof thisArg=="undefined"){thisArg=null}if($.type(callback)=="string"){callback=eval(callback)}if($.type(callback)=="function"){return callback.apply(thisArg,params)}},eval_as_object:function(exp){try{return eval("("+exp+")")}catch(e){return null}},ux:function(d){d=typeof d=="undefined"||!(d instanceof HTMLElement)?document.body:d;var c=d.querySelectorAll("*[data-type]");$(c).each(function(){var a=this.getAttribute("data-type");if(typeof $(this)[a]=="function"){var b=$.options_from_html(this);$(this)[a](b)}else{console.warn("Unknown ux "+a)}})},el_get:function(h){if($(h).attr("data-type")!=null){var f=$(h).attr("data-type");if(typeof $(h)[f+"_get"]=="function"){return $(h)[f+"_get"]()}return null}else{var e={};var g=$("*[data-type]",h);$(g).each(function(){var c=this;var b=$.el_get(c);var a=c.getAttribute("data-name");if(a==null){a="undefined"}e[a]=b});return e}},el_set:function(d,c){$("*[data-type]",d).each(function(){var f=this.getAttribute("data-type");var a=this.getAttribute("data-name");var b=$.val(a,c);if(typeof $(this)[f+"_set"]=="function"){$(this)[f+"_set"](b)}else{console.warn("unknown method")}})},options_from_html:function(el){var options=null;if(el.getAttribute("data-options")!=null){try{options=eval("("+el.getAttribute("data-options")+")")}catch(e){options=null}}else{var options={};for(var i=0;i<el.attributes.length;i++){options[el.attributes[i].nodeName.replace("data-","")]=el.attributes[i].nodeValue}}return options},cookie_getitem:function(b){if(!b){return null}return decodeURIComponent(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+encodeURIComponent(b).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1"))||null},cookie_setitem:function(i,m,j,k,l,h){if(!i||/^(?:expires|max\-age|path|domain|secure)$/i.test(i)){return false}var n="";if(j){switch(j.constructor){case Number:n=j===Infinity?"; expires=Fri, 31 Dec 9999 23:59:59 GMT":"; max-age="+j;break;case String:n="; expires="+j;break;case Date:n="; expires="+j.toUTCString();break}}document.cookie=encodeURIComponent(i)+"="+encodeURIComponent(m)+n+(l?"; domain="+l:"")+(k?"; path="+k:"")+(h?"; secure":"");return true},cookie_removeitem:function(e,f,d){if(!this.hasItem(e)){return false}document.cookie=encodeURIComponent(e)+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT"+(d?"; domain="+d:"")+(f?"; path="+f:"");return true},cookie_hasitem:function(b){if(!b){return false}return(new RegExp("(?:^|;\\s*)"+encodeURIComponent(b).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=")).test(document.cookie)},cookie_keys:function(){var d=document.cookie.replace(/((?:^|\s*;)[^\=]+)(?=;|$)|^\s*|\s*(?:\=[^;]*)?(?:\1|$)/g,"").split(/\s*(?:\=[^;]*)?;\s*/);for(var e=d.length,f=0;f<e;f++){d[f]=decodeURIComponent(d[f])}return d},slug:function(e){var f="";var d=$.trim(e);f=d.replace(/[^a-z0-9-]/gi,"-").replace(/-+/g,"-").replace(/^-|-$/g,"");return f.toLowerCase()},warn:function(b){console.warn(b)},array_merge:function(){var t=Array.prototype.slice.call(arguments);var r=t.length;var q;var k={};var o="";var p=0;var j=0;var w=0;var u=0;var s=Object.prototype.toString;var i=true;for(w=0;w<r;w++){if(s.call(t[w])!=="[object Array]"){i=false;break}}if(i){i=[];for(w=0;w<r;w++){i=i.concat(t[w])}return i}for(w=0,u=0;w<r;w++){q=t[w];if(s.call(q)==="[object Array]"){for(j=0,p=q.length;j<p;j++){k[u++]=q[j]}}else{for(o in q){if(q.hasOwnProperty(o)){if(parseInt(o,10)+""===o){k[u++]=q[o]}else{k[o]=q[o]}}}}}return k},in_array:function(j,f,g){var h="";var i=!!g;if(i){for(h in f){if(f[h]===j){return true}}}else{for(h in f){if(f[h]==j){return true}}}return false},number_format:function(r,t,o,p){r=(r+"").replace(/[^0-9+\-Ee.]/g,"");var k=!isFinite(+r)?0:+r;var l=!isFinite(+t)?0:Math.abs(t);var m=(typeof p==="undefined")?",":p;var s=(typeof o==="undefined")?".":o;var n="";var q=function(a,b){var c=Math.pow(10,b);return""+(Math.round(a*c)/c).toFixed(b)};n=(l?q(k,l):""+Math.round(k)).split(".");if(n[0].length>3){n[0]=n[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,m)}if((n[1]||"").length<l){n[1]=n[1]||"";n[1]+=new Array(l-n[1].length+1).join("0")}return n.join(s)},qs:(function(a){if(a==""){return{}}var b={};for(var h=0;h<a.length;++h){var g=a[h].split("=",2);if(g.length==1){b[g[0]]=""}else{b[g[0]]=decodeURIComponent(g[1].replace(/\+/g," "))}}return b})(window.location.search.substr(1).split("&")),p:function(m,n){var h=m.match(/\$\w+/g);if(h!=null){if($.type(n)=="array"){for(var j=0;j<h.length;j++){var l=h[j];var i=typeof n[j]!="undefined"?n[j]:"";m=m.replace(l,i)}}else{if($.type(n)=="object"){for(var j=0;j<h.length;j++){var l=h[j];var k=l.replace("$","");var i=typeof n[k]!="undefined"?n[k]:"";m=m.replace(l,i)}}}}return m},array_key_count:function(e){var f=0;for(var d in e){f++}return f},object_value_min:function(f){var g=-1;if($.type(f)=="object"){for(var h in f){var e=f[h];if(g==-1||parseFloat(e)<parseFloat(g)){g=e}}}return g},object_value_max:function(f){var g=-1;if($.type(f)=="object"){for(var h in f){var e=f[h];if(g==-1||parseFloat(e)>parseFloat(g)){g=e}}}return g},ksort:function(e){var f=Object.keys(e).sort(),h={};for(var g in f){h[f[g]]=e[f[g]]}return h},str_pad:function(k,n,i,m){var h="";var l;var j=function(c,a){var b="";while(b.length<a){b+=c}b=b.substr(0,a);return b};k+="";i=i!==undefined?i:" ";if(m!=="STR_PAD_LEFT"&&m!=="STR_PAD_RIGHT"&&m!=="STR_PAD_BOTH"){m="STR_PAD_RIGHT"}if((l=n-k.length)>0){if(m==="STR_PAD_LEFT"){k=j(i,l)+k}else{if(m==="STR_PAD_RIGHT"){k=k+j(i,l)}else{if(m==="STR_PAD_BOTH"){h=j(i,Math.ceil(l/2));k=h+k+h;k=k.substr(0,n)}}}}return k},template_parse:function(n,i){var s=n.match(/<!--IF.+?(?=-->)(.+)?(?=<!--END-->)<!--END-->/gi,"gi");if($.type(s)=="array"){for(var t=0;t<s.length;t++){var r=s[t];var s=r.match(/\(.+?(?=\))\)/gi,"gi");var o=s[0];o=o.substr(1,o.length-2);var q=new Function("obj","return "+o+";");if(!q(i)){n=n.replace(r,"","gi")}}}var s=n.match(/<!--IF_NOT_EMPTY.+?(?=-->)(.+)?(?=<!--END-->)<!--END-->/gi,"gi");if($.type(s)=="array"){for(var t=0;t<s.length;t++){var r=s[t];var s=r.match(/\(\w+\)/gi,"gi");var o=s[0];o=o.substr(1,o.length-2);if($.val(o,i,{d:""})==""){n=n.replace(r,"","gi")}}}var s=n.match(/{\w+(:\w+)*?(?=})}/gi,"gi");if($.type(s)=="array"){for(var t=0;t<s.length;t++){var r=s[t];var o=r.substr(1,r.length-2);var f="string";if(o.indexOf(":")>=0){var m=o.split(":");o=m[0];f=m[1]}var p=$.val(o,i,{d:"-"});p=$.convert_datatype(p,f);n=n.replace(r,p,"gi")}}return n},convert_datatype:function(c,d){switch(d){case"date":c=$.date("j M Y",$.strtotime(c));break}return c},calc_size:function(c,d){d=typeof d=="undefined"||!d?window.innerWidth:d;if(c.indexOf("%")>=0){c=c.replace("%","","gi");if(!isNaN(parseFloat(c))){c=parseFloat(c)/100*d}}return c},download:function(d){var a=document.createElement("a");a.href=d;a.setAttribute("download",d);document.body.appendChild(a);a.click();document.body.removeChild(a)},ux_init:function(b){b=typeof b=="undefined"||!(b instanceof HTMLElement)?document.body:b;$("*[data-type]",b).each(function(){var d=this.getAttribute("data-type");if(typeof $(this)[d]=="function"){var a=$.options_from_html(this);$(this)[d](a)}else{console.warn("Unknown ux "+d)}});$("*[data-action]",b).each(function(){switch(this.getAttribute("data-action")){case"modal.close":$(this).on("click.data-action",function(){$(this).closest(".modal").modal_close()});break}});$(window).on("click",$.popup_close_all).on("scroll",$.popup_close_all);$(window).on("keyup",function(a){switch(a.keyCode){case 27:$(".modal").modal_close();break}})},istrue:function(b){if(typeof b!="undefined"&&(parseInt(b)==1||b===true)){return true}return false}});var oldVal=$.fn.val;$.fn.val=function(c){var d=$(this).attr("data-type");if(d!=null&&typeof $(this)[d+"_val"]!="undefined"){return $(this)[d+"_val"].apply(this,arguments)}else{if($(this).hasClass("container")){return $(this).container_val.apply(this,arguments)}else{return oldVal.apply(this,arguments)}}};$.fn.placeholder=function(){var b=$(this).attr("data-type");if(b!=null&&typeof $(this)[b+"_placeholder"]!="undefined"){return $(this)[b+"_placeholder"].apply(this,arguments)}else{if($(this).hasClass("container")){return $(this).container_placeholder.apply(this,arguments)}}};$.fn.readonly=function(){var b=$(this).attr("data-type");if(b!=null&&typeof $(this)[b+"_readonly"]!="undefined"){return $(this)[b+"_readonly"].apply(this,arguments)}else{if($(this).hasClass("container")){return $(this).container_readonly.apply(this,arguments)}}};$.fn.reset=function(){var b=$(this).attr("data-type");if(b!=null&&typeof $(this)[b+"_reset"]!="undefined"){return $(this)[b+"_reset"].apply(this,arguments)}else{if($(this).hasClass("container")){return $(this).container_reset.apply(this,arguments)}}};String.prototype.capitalize=function(){return this.charAt(0).toUpperCase()+this.slice(1)};$($.ux_init);$.fn.extend({vfields:function(d){var c=$.val("value",d);$(this).each(function(){var a=this;$(a).addClass("vfields");$(a).data("options",d);if($.type(c)=="array"){$(a).form_set(c)}})},form_set:function(b){if(typeof b=="undefined"||$.type(b)!="array"){return}$(this).each(function(){var a=this;var e=$(this).data("options");var f=$.val("html_callback",e);$(b).each(function(){var d=this;var h=[];h.push("<table><tr><td class='vfields-col1' align='center' style='width:24px'>");h.push("<span class='fa fa-times-circle selectable vfields-remove hoverable'></span>");h.push("</td><td class='vfields-col2'></td></tr></table>");var c=document.createElement("div");c.className="vfields-item";c.innerHTML=h.join("");$(a).append(c);$.fire_event(f,[d],$(".vfields-col2",c))});$(".vfields-remove",a).click(function(){$(this).closest(".vfields-item").remove()})})},vfields_get:function(){var b=[];$(this).each(function(){var a=this;$(".vfields-col2",a).each(function(){var d=$.el_get(this);b.push(d)})});return b}});$.fn.extend({webeditor:function(c){var d=$.val("height",c);this.each(function(){var a=$.uniqid();var b=[];b.push($.p('<textarea id="$1"></textarea>',["webeditor"+a]));$(this).addClass("webeditor");$(this).html(b.join(""));$(this).data("options",c);CKEDITOR.replace("webeditor"+a,{height:d})})},webeditor_get:function(c){var d=[];this.each(function(){var a=$("textarea",this).attr("id");if(typeof CKEDITOR.instances[a]!="undefined"){var b=CKEDITOR.instances[a].getData();d.push(b)}});return d.length==1?d[0]:(d.length>1?d:null)},webeditor_set:function(b){this.each(function(){var a=$("textarea",this).attr("id");if(typeof CKEDITOR.instances[a]!="undefined"){CKEDITOR.instances[a].setData(b)}})}});$.fn.extend({widget:function(b){this.each(function(){var D=this;var r=$.val("type",b);var E=$.val("src",b);var a=$.val("title",b,{default_value:"Untitled"});var B=$.val("columns",b);var s=$.uniqid();var t=$.val("default_presets",b);var u=parseInt($.val("preset_idx",b,{d:0}));if(isNaN(u)){u=0}var x=[];x.push($.p('<div class="widget-head padding10">',[a]));x.push($.p("<table><tr>",[]));x.push($.p('<td style="width:100%">',[]));x.push($.p('<h5 class="padding10">$1</h5>',[a]));x.push($.p("</td>",[a]));x.push($.p("<td>",[]));x.push($.p('<span id="$1"></span>',["preset-selector"+s]));x.push($.p('<span class="icon icon-reload fa fa-refresh padding10 selectable"></span>',[]));x.push($.p('<span class="icon icon-customize fa fa-ellipsis-h padding10 selectable"></span>',[]));x.push($.p("</td>",[]));x.push($.p("</tr></table>",[]));x.push($.p("</div>",[]));x.push($.p('<div class="modal" id="$1"></div>',["customize"+s]));var z=null;var C=[];var y="";if($.type(t)=="array"){for(var A=0;A<t.length;A++){if(A==u){y=t[A]["text"];z=t[A]}C.push({text:t[A]["text"],value:t[A]["text"]})}}switch(r){case"grid":x.push($.p('<div class="widget-body align-center margin10 ">',[]));x.push($.p('<span id="$1"></span>',["gridhead"+s]));x.push($.p("<div></div>",[]));x.push($.p('<span id="$1"></span>',["grid"+s]));x.push($.p("</div>",[]));$(D).html(x.join(""));var B=$.val("columns",b);$("#gridhead"+s,D).gridhead({columns:B,grid:"#grid"+s});var w=$(D).outerHeight()-$(".widget-head",D).outerHeight()-$("#gridhead"+s,D).outerHeight()-15;$("#grid"+s,D).grid({columns:B,height:w});break;case"chart":x.push($.p('<div class="widget-body align-center margin10 ">',[]));x.push($.p('<span id="$1"></span>',["chart"+s]));x.push($.p("</div>",[]));$(D).html(x.join(""));var i=$.val("chart_type",b);var w=$(D).outerHeight()-$(".widget-head",D).outerHeight()-$("#gridhead"+s,D).outerHeight()-15;$("#chart"+s).chart({width:"100%",height:w,padding:0,type:i});break;case"metric":x.push($.p('<div class="widget-body align-left margin10 ">',[]));x.push($.p('<span id="$1"></span>',["metric"+s]));x.push($.p("</div>",[]));$(D).html(x.join(""));break}$("#preset-selector"+s).dropdown({items:C,value:y,onchange:function(){$(D).widget_load()}});$("#customize"+s).gridsetting({onchange:function(e){var c=$(this).closest(".widget");var d=$(c).data("options");d=$.array_merge(d,e);$(c).data("options",d);$(D).widget_load()}});$(".icon-reload",D).click(function(){$(D).widget_load()});$(".icon-customize",D).click(function(){var e=$(this).closest(".widget");var d=$(e).data("options");var f=$.val("columns",d);var c=$.val("default_presets",d);$("#customize"+s).gridsetting_open({columns:f,presets:c,active_idx:0})});$(D).data("options",b);$(D).data("uid",s);$(D).widget_load()})},widget_load:function(){this.each(function(){var u=this;var s=$(u).data("options");var r=$.val("src",s);var w=$.val("type",s);var y=$.val("default_presets",s);var i=parseInt($.val("preset_idx",s,{d:0}));var x=$(u).data("uid");var p=$("#preset-selector"+x).dropdown_get();var t=null;var q=[];var n="";if($.type(y)=="array"){for(var o=0;o<y.length;o++){if(y[o]["text"]==p){n=y[o]["text"];t=y[o]}q.push({text:y[o]["text"],value:y[o]["text"]})}}switch(w){case"metric":$.api_post(r,t,function(a){$("#metric"+x).html("<h2>"+a.data+"</h2>")});break;case"grid":$.api_post(r,t,function(b){var a=$.val("data",b);$("#grid"+x,u).grid_set(a)});break;case"chart":$.api_post(r,t,function(a){$("#chart"+x).chart_set(a.data)});break}})}});$.extend({workspace_init:function(){$(".workspace").each(function(){var b=window.innerHeight-$(".header").outerHeight()-20;$(this).workspace_set({state:$(this).attr("data-state"),size:$(this).attr("data-size"),height:b});$.workspace_rtime;$.workspace_timeout=false;$.workspace_delta=200;$(window).resize(function(){$.workspace_rtime=new Date();if($.workspace_timeout===false){$.workspace_timeout=true;setTimeout($.workspace_resizeend,$.workspace_delta)}})})},workspace_resizeend:function(){if(new Date()-$.workspace_rtime<$.workspace_delta){setTimeout($.workspace_resizeend,$.workspace_delta)}else{$.workspace_timeout=false;$(".workspace").each(function(){var b=window.innerHeight-$(".header").outerHeight()-20;$($(this).children()[0]).css({height:b});$($(this).children()[1]).css({height:b});$($(this).children()[2]).css({height:b})})}}});$.fn.extend({workspace_set:function(b){if(typeof b=="undefined"||$.type(b)!="object"){return}$(this).each(function(){b=$.ksort(b);var l={};var n={flex:"1 1 auto"};var o={};for(var p in b){switch(p){case"size":var m=b[p];m=m.split(" ");var t=$.val(0,m,{d:300,t:"number"});var r=$.val(1,m,{d:400,t:"number"});l.flex="0 0 "+(t+"px");o.flex="0 0 "+(r+"px");$(this).data("left_size",t);$(this).data("right_size",r);break;case"height":l.height=b[p];n.height=b[p];o.height=b[p];break;case"state":var a=$.val("state",b,{d:""});a=a.split(" ");var q=$.val(0,a,{d:1,t:"number"});var s=$.val(2,a,{d:0,t:"number"});var t=q<1?"0":$(this).data("left_size");var r=s<1?"0":$(this).data("right_size");l.flex="0 0 "+(t+"px");o.flex="0 0 "+(r+"px");break}}if($(this).children().length==3){$($(this).children()[0]).css(l);$($(this).children()[1]).css(n);$($(this).children()[2]).css(o)}})}});$.fn.extend({spinner:function(a){var b=$.val("size",a,{defaultvalue:"20px"});this.each(function(){var c=[];c.push('<div class="sk-fading-circle" style="width:'+b+";height:"+b+';">');c.push('<div class="sk-circle1 sk-circle"></div>');c.push('<div class="sk-circle2 sk-circle"></div>');c.push('<div class="sk-circle3 sk-circle"></div>');c.push('<div class="sk-circle4 sk-circle"></div>');c.push('<div class="sk-circle5 sk-circle"></div>');c.push('<div class="sk-circle6 sk-circle"></div>');c.push('<div class="sk-circle7 sk-circle"></div>');c.push('<div class="sk-circle8 sk-circle"></div>');c.push('<div class="sk-circle9 sk-circle"></div>');c.push('<div class="sk-circle10 sk-circle"></div>');c.push('<div class="sk-circle11 sk-circle"></div>');c.push('<div class="sk-circle12 sk-circle"></div>');c.push("</div>");$(this).html(c.join(""))})}});$.fn.extend({tab:function(b){var c=$.val("container",b,{d:""});var a=$.val("name",b,{d:""});var d=$.val("onchange",b);this.each(function(){var e=this;$(e).attr("data-type","tab");$(e).attr("data-name",a);$(e).data("options",b);$("li",e).click(function(){if(this.classList.contains("active")){}else{$("li",this.parentNode).removeClass("active");$(this).addClass("active");var f=this.innerHTML;var h=this.getAttribute("data-value");if(h==null){h=$.slug(f)}var g=$(this).index();if($(c).length>0){$(c+">*").addClass("off");$(c+">*:eq("+g+")").removeClass("off")}$.fire_event(d,[{text:f,value:h}],e)}})})},tab_set:function(b){var a=this;var d=$(a).data("options");var c=$.val("onchange",d);$("li",this).removeClass("active");$("li",this).each(function(){var e=this.innerHTML;var f=this.getAttribute("data-value");if(f==null){f=$.slug(e)}if(f==b){$(this).addClass("active");$.fire_event(c,[{text:e,value:f}],a)}})}});$.fn.extend({textarea:function(f){var d=$.val("placeholder",f,{d:""});var a=$.val("class",f,{d:""});var h=$.val("name",f,{d:""});var e=$.val("height",f,{d:"1em"});var i=$.val("width",f);var j=$.val("maxlength",f,{d:""});var b=$.val("onblur",f);var g=$.val("onkeyup",f);var k=$.val("onchange",f);var c=$.val("value",f,{d:""});var l={width:i};this.each(function(){var m=this;var n=[];n.push("<textarea rows='1' placeholder='"+d+"' style='height:"+e+";' maxlength='"+j+"'></textarea>");n.push("<span class='icon fa hidden'></span>");$(m).addClass("textarea");$(m).addClass(a);$(m).css(l);$(m).html(n.join(""));$(m).attr("data-type","textarea");$(m).attr("data-name",h);$(m).data("options",f);$("textarea",m).blur(function(o){$(m).textarea_validate();$.fire_event(b,[],m)}).keyup(function(o){$.fire_event(g,[this.value],m);if($(this).data("last_value")!=this.value){$.fire_event(k,[this.value],m)}$(this).data("last_value",this.value)});$("textarea",m).each(function(){this.setAttribute("style","height:"+(this.scrollHeight<=0?"":this.scrollHeight)+"px;overflow-y:hidden;")}).on("input",function(){this.style.height="auto";this.style.height=(this.scrollHeight)+"px"});if(c!=""){$(this).textarea_val(c)}})},textarea_val:function(b){if(typeof b=="undefined"){var a=[];$(this).each(function(){a.push($("textarea",this).val())});return a.length>1?a:(a.length==1?a[0]:"")}else{$(this).each(function(){$("textarea",this).val(b).each(function(){this.style.height="auto";this.style.height=(this.scrollHeight)+"px"})})}},textarea_placeholder:function(b){if(typeof b=="undefined"){var a=[];$(this).each(function(){a.push($("input",this).attr("placeholder"))});return a.length>1?a:(a.length==1?a[0]:"")}else{$(this).each(function(){$("input",this).attr("placeholder",b)})}},textarea_reset:function(){$(this).textarea_val("")},textarea_validate:function(){$(this).each(function(){var i=$(this).data("options");var e=$.val("required",i,{d:false});var d=$.val("required_text",i,{d:"Field required."});var b=$.val("validation",i,{d:""});var c=$.val("validation_text",i,{d:"Validation error."});var g=$(this).textarea_val();var a=true;var h="";if(e){if(g.toString().trim()==""){a=false;h=d}else{if(b!=""){switch(b){default:var f=new RegExp(b);a=f.test(g);if(!a){h=c}break}}}}else{if(g.toString().length>0){switch(b){default:var f=new RegExp(b);a=f.test(g);if(!a){h=c}break}}}if(!a){$(this).addClass("invalid");console.warn(h)}else{$(this).removeClass("invalid")}})}});$.fn.extend({textbox:function(f){var c=$.val("placeholder",f,{d:""});var g=$.val("name",f,{d:""});var a=$.val("class",f,{d:""});var e=$.val("value",f,{d:""});var k=$.val("readonly",f,{d:false});var i=$.val("maxlength",f,{d:""});var m=$.val("mode",f,{d:"text"});var h=$.val("width",f);var b=$.val("onblur",f);var d=$.val("onkeyup",f);var j=$.val("onchange",f);var l={width:h};this.each(function(){var o=this;var n=[];n.push($.p('<input type="$1" placeholder="$1" maxlength="$1"/>',[m,c,i]));n.push("<span class='icon fa hidden'></span>");$(o).addClass("textbox");$(o).addClass(a);$(o).css(l);$(o).html(n.join(""));$(o).attr("data-type","textbox");$(o).attr("data-name",g);$(o).data("options",f);$("input",o).val(e);$("input",o).blur(function(p){$(o).textbox_validate();$.fire_event(b,[],o)}).keyup(function(p){$.fire_event(d,[this.value],o);if($(this).data("last_value")!=this.value){$.fire_event(j,[this.value],o)}$(this).data("last_value",this.value)})})},textbox_val:function(b){if(typeof b=="undefined"){var a=[];$(this).each(function(){a.push($("input",this).val())});return a.length>1?a:(a.length==1?a[0]:"")}else{$(this).each(function(){$("input",this).val(b)})}},textbox_placeholder:function(b){if(typeof b=="undefined"){var a=[];$(this).each(function(){a.push($("input",this).attr("placeholder"))});return a.length>1?a:(a.length==1?a[0]:"")}else{$(this).each(function(){$("input",this).attr("placeholder",b)})}},textbox_reset:function(){$(this).textbox_val("")},textbox_validate:function(){$(this).each(function(){var i=$(this).data("options");var e=$.val("required",i,{d:false});var d=$.val("required_text",i,{d:"Field required."});var b=$.val("validation",i,{d:""});var c=$.val("validation_text",i,{d:"Validation error."});var g=$(this).textbox_val();var a=true;var h="";if(e){if(g.toString().trim()==""){a=false;h=d}else{if(b!=""){switch(b){default:var f=new RegExp(b);a=f.test(g);if(!a){h=c}break}}}}else{if(g.toString().length>0){switch(b){default:var f=new RegExp(b);a=f.test(g);if(!a){h=c}break}}}if(!a){$(this).addClass("invalid");console.warn(h)}else{$(this).removeClass("invalid")}})}});$.fn.extend({toggle:function(d){var a=$.val("class",d,{d:""});var c=$.val("name",d,{d:""});var b=$.val("value",d,{d:false});this.each(function(){var f=this;var e=[];e.push("<span class='main-toggle'></span>");f.innerHTML=e.join("");$(this).addClass("toggle");$(this).addClass(a);$(f).attr("data-type","toggle");if(c!=""){$(f).attr("data-name",c)}f.querySelector(".main-toggle").addEventListener("click",function(){if(this.parentNode.classList.contains("on")){this.parentNode.classList.remove("on")}else{this.parentNode.classList.add("on")}});$(f).toggle_val(b);return f})},toggle_val:function(a){if(!$(this).hasClass("toggle")){return undefined}if(typeof a=="undefined"){return $(this).hasClass("on")?1:0}else{if(a==true||a==1){$(this).addClass("on")}else{$(this).removeClass("on")}}}});$.extend({tooltip:function(f,b){var e=$(".tooltip");if(e.length==0){$.warn("No tooltip defined.")}$(e).addClass("on");var d=f.getBoundingClientRect();var a={};var c=[];console.log(f);a.left=d.left;console.log([d.top,d.top+d.height+$(e).outerHeight()+10,window.innerHeight]);if(d.top+d.height+$(e).outerHeight()+10>window.innerHeight){a.top=d.top-$(e).outerHeight()-10;c.push("<div class='arrow-down'></div>")}else{a.top=d.top+d.height+10;c.push("<div class='arrow-up'></div>")}c.push(b);$(e).html(c.join(""));$(e).css(a)},tooltip_remove:function(){$(".tooltip").removeClass("on")}});$.extend({date:function(j,h){var g=this;var i,e;var d=["Sun","Mon","Tues","Wednes","Thurs","Fri","Satur","January","February","March","April","May","June","July","August","September","October","November","December"];var b=/\\?(.?)/gi;var a=function(f,k){return e[f]?e[f]():k};var c=function(k,f){k=String(k);while(k.length<f){k="0"+k}return k};e={d:function(){return c(e.j(),2)},D:function(){return e.l().slice(0,3)},j:function(){return i.getDate()},l:function(){return d[e.w()]+"day"},N:function(){return e.w()||7},S:function(){var f=e.j();var k=f%10;if(k<=3&&parseInt((f%100)/10,10)==1){k=0}return["st","nd","rd"][k-1]||"th"},w:function(){return i.getDay()},z:function(){var k=new Date(e.Y(),e.n()-1,e.j());var f=new Date(e.Y(),0,1);return Math.round((k-f)/86400000)},W:function(){var k=new Date(e.Y(),e.n()-1,e.j()-e.N()+3);var f=new Date(k.getFullYear(),0,4);return c(1+Math.round((k-f)/86400000/7),2)},F:function(){return d[6+e.n()]},m:function(){return c(e.n(),2)},M:function(){return e.F().slice(0,3)},n:function(){return i.getMonth()+1},t:function(){return(new Date(e.Y(),e.n(),0)).getDate()},L:function(){var f=e.Y();return f%4===0&f%100!==0|f%400===0},o:function(){var k=e.n();var l=e.W();var f=e.Y();return f+(k===12&&l<9?1:k===1&&l>9?-1:0)},Y:function(){return i.getFullYear()},y:function(){return e.Y().toString().slice(-2)},a:function(){return i.getHours()>11?"pm":"am"},A:function(){return e.a().toUpperCase()},B:function(){var f=i.getUTCHours()*3600;var l=i.getUTCMinutes()*60;var k=i.getUTCSeconds();return c(Math.floor((f+l+k+3600)/86.4)%1000,3)},g:function(){return e.G()%12||12},G:function(){return i.getHours()},h:function(){return c(e.g(),2)},H:function(){return c(e.G(),2)},i:function(){return c(i.getMinutes(),2)},s:function(){return c(i.getSeconds(),2)},u:function(){return c(i.getMilliseconds()*1000,6)},e:function(){throw"Not supported (see source code of date() for timezone on how to add support)"},I:function(){var m=new Date(e.Y(),0);var k=Date.UTC(e.Y(),0);var l=new Date(e.Y(),6);var f=Date.UTC(e.Y(),6);return((m-k)!==(l-f))?1:0},O:function(){var k=i.getTimezoneOffset();var f=Math.abs(k);return(k>0?"-":"+")+c(Math.floor(f/60)*100+f%60,4)},P:function(){var f=e.O();return(f.substr(0,3)+":"+f.substr(3,2))},T:function(){return"UTC"},Z:function(){return -i.getTimezoneOffset()*60},c:function(){return"Y-m-d\\TH:i:sP".replace(b,a)},r:function(){return"D, d M Y H:i:s O".replace(b,a)},U:function(){return i/1000|0}};this.date=function(k,f){g=this;i=(f===undefined?new Date():(f instanceof Date)?new Date(f):new Date(f*1000));return k.replace(b,a)};return this.date(j,h)},uniqid:function(){if(typeof $.__UNIQID=="undefined"){$.__UNIQID=0}return ++$.__UNIQID},val:function(g,b,j){if(typeof j=="undefined"||$.type(j)!="object"){j={}}var f=null;var h=typeof j.default_value!="undefined"?j.default_value:(typeof j.d!="undefined"?j.d:null);var c=typeof j.t!="undefined"?j.t:(typeof j.datatype!="undefined"?j.datatype:"string");var e=typeof j.required!="undefined"&&e==1?true:false;if($.type(b)=="object"){if($.type(g)=="array"){f=null;for(var d=0;d<g.length;d++){var a=g[d];v=$.val(a,b,{default_value:null});if(v!=null){f=v;break}}}else{if($.type(g)=="string"||$.type(g)=="number"){if(typeof b[g]!="undefined"){f=b[g]}}}}else{if($.type(b)=="array"){if(typeof b[g]!="undefined"){f=b[g]}}}if(e){if(f==null){}}else{f=f==null&&h!=null?h:f}switch(c){case"number":case"integer":case"float":case"double":f=parseFloat(f);break}return f},strtotime:function(f,a){var m,h,o,k,d,b,n,j,l,q,g,c=false;if(!f){return c}if(/^\d{8}$/.test(f)){f=f.substr(0,4)+"-"+f.substr(4,2)+"-"+f.substr(6,2)}f=f.replace(/^\s+|\s+$/g,"").replace(/\s{2,}/g," ").replace(/[\t\r\n]/g,"").toLowerCase();h=f.match(/^(\d{1,4})([\-\.\/\:])(\d{1,2})([\-\.\/\:])(\d{1,4})(?:\s(\d{1,2}):(\d{2})?:?(\d{2})?)?(?:\s([A-Z]+)?)?$/);if(h&&h[2]===h[4]){if(h[1]>1901){switch(h[2]){case"-":if(h[3]>12||h[5]>31){return c}return new Date(h[1],parseInt(h[3],10)-1,h[5],h[6]||0,h[7]||0,h[8]||0,h[9]||0)/1000;case".":return c;case"/":if(h[3]>12||h[5]>31){return c}return new Date(h[1],parseInt(h[3],10)-1,h[5],h[6]||0,h[7]||0,h[8]||0,h[9]||0)/1000}}else{if(h[5]>1901){switch(h[2]){case"-":if(h[3]>12||h[1]>31){return c}return new Date(h[5],parseInt(h[3],10)-1,h[1],h[6]||0,h[7]||0,h[8]||0,h[9]||0)/1000;case".":if(h[3]>12||h[1]>31){return c}return new Date(h[5],parseInt(h[3],10)-1,h[1],h[6]||0,h[7]||0,h[8]||0,h[9]||0)/1000;case"/":if(h[1]>12||h[3]>31){return c}return new Date(h[5],parseInt(h[1],10)-1,h[3],h[6]||0,h[7]||0,h[8]||0,h[9]||0)/1000}}else{switch(h[2]){case"-":if(h[3]>12||h[5]>31||(h[1]<70&&h[1]>38)){return c}k=h[1]>=0&&h[1]<=38?+h[1]+2000:h[1];return new Date(k,parseInt(h[3],10)-1,h[5],h[6]||0,h[7]||0,h[8]||0,h[9]||0)/1000;case".":if(h[5]>=70){if(h[3]>12||h[1]>31){return c}return new Date(h[5],parseInt(h[3],10)-1,h[1],h[6]||0,h[7]||0,h[8]||0,h[9]||0)/1000}if(h[5]<60&&!h[6]){if(h[1]>23||h[3]>59){return c}o=new Date();return new Date(o.getFullYear(),o.getMonth(),o.getDate(),h[1]||0,h[3]||0,h[5]||0,h[9]||0)/1000}return c;case"/":if(h[1]>12||h[3]>31||(h[5]<70&&h[5]>38)){return c}k=h[5]>=0&&h[5]<=38?+h[5]+2000:h[5];return new Date(k,parseInt(h[1],10)-1,h[3],h[6]||0,h[7]||0,h[8]||0,h[9]||0)/1000;case":":if(h[1]>23||h[3]>59||h[5]>59){return c}o=new Date();return new Date(o.getFullYear(),o.getMonth(),o.getDate(),h[1]||0,h[3]||0,h[5]||0)/1000}}}}if(f==="now"){return a===null||isNaN(a)?new Date().getTime()/1000|0:a|0}if(!isNaN(m=Date.parse(f))){return m/1000|0}d=a?new Date(a*1000):new Date();b={sun:0,mon:1,tue:2,wed:3,thu:4,fri:5,sat:6};n={yea:"FullYear",mon:"Month",day:"Date",hou:"Hours",min:"Minutes",sec:"Seconds"};function e(u,t,i){var r,s=b[t];if(typeof s!=="undefined"){r=s-d.getDay();if(r===0){r=7*i}else{if(r>0&&u==="last"){r-=7}else{if(r<0&&u==="next"){r+=7}}}d.setDate(d.getDate()+r)}}function p(i){var r=i.split(" "),u=r[0],w=r[1].substring(0,3),x=/\d+/.test(u),t=r[2]==="ago",s=(u==="last"?-1:1)*(t?-1:1);if(x){s*=parseInt(u,10)}if(n.hasOwnProperty(w)&&!r[1].match(/^mon(day|\.)?$/i)){return d["set"+n[w]](d["get"+n[w]]()+s)}if(w==="wee"){return d.setDate(d.getDate()+(s*7))}if(u==="next"||u==="last"){e(u,w,s)}else{if(!x){return false}}return true}l="(years?|months?|weeks?|days?|hours?|minutes?|min|seconds?|sec|sunday|sun\\.?|monday|mon\\.?|tuesday|tue\\.?|wednesday|wed\\.?|thursday|thu\\.?|friday|fri\\.?|saturday|sat\\.?)";q="([+-]?\\d+\\s"+l+"|(last|next)\\s"+l+")(\\sago)?";h=f.match(new RegExp(q,"gi"));if(!h){return c}for(g=0,j=h.length;g<j;g++){if(!p(h[g])){return c}}return(d.getTime()/1000)},mktime:function(){var b=new Date(),f=arguments,c=0,a=["Hours","Minutes","Seconds","Month","Date","FullYear"];for(c=0;c<a.length;c++){if(typeof f[c]==="undefined"){f[c]=b["get"+a[c]]();f[c]+=(c===3)}else{f[c]=parseInt(f[c],10);if(isNaN(f[c])){return false}}}f[5]+=(f[5]>=0?(f[5]<=69?2000:(f[5]<=100?1900:0)):0);b.setFullYear(f[5],f[3]-1,f[4]);b.setHours(f[0],f[1],f[2]);return(b.getTime()/1000>>0)-(b.getTime()<0)},date_parse:function(a){switch(a){case"this_month":a=$.date("Ym")+"01-"+$.date("Ymd",$.mktime(0,0,0,parseInt($.date("m"))+1,0,$.date("Y")));break}return a},start_day_of_month:function(b,c){var a=$.date("N",$.mktime(0,0,0,c,1,b));return a},last_date_of_month:function(e,a){var b=27;do{b++;var c=parseInt($.date("j",$.mktime(0,0,0,a,b,e)));if(c!=b){b--;break}}while(true);return b},api_get:function(a,c,d,f){var e=$.http_build_query(c);a+=e.length>0?"?"+e:"";var b=new XMLHttpRequest();b.open("GET",a,true);b.addEventListener("load",function(){if(this.readyState==4){var h=$.eval_as_object(this.responseText);var i=$.val("error",h,{d:0,datatype:"integer"});var g=$.val("error_message",h,{d:""});if(i>0){if(f!=null){$.fire_event(f,[this.responseText],b)}else{alert(g)}}else{$.fire_event(d,[h],b)}}});b.addEventListener("error",function(){if(typeof f!="undefined"||f!=null){$.fire_event(f)}else{console.log(this.responseText)}});b.send();return b},api_post:function(e,b,c,d){var a=new XMLHttpRequest();a.open("POST",e,true);a.addEventListener("load",function(){if(this.readyState==4){var g=$.eval_as_object(this.responseText);var h=$.val("error",g,{d:0,datatype:"integer"});var f=$.val("error_message",g,{d:""});if(parseInt(h)==0){$.fire_event(c,[g],a)}else{if(typeof d!="undefined"||d!=null){$.fire_event(d,[{error:h,error_message:f}])}else{alert(JSON.stringify(g,null,2))}}}});a.addEventListener("error",function(){if(typeof d!="undefined"||d!=null){$.fire_event(d)}else{console.log(this.responseText)}});a.send(JSON.stringify(b));return a},http_build_query:function(a,c,b){var d=[];if($.type(a)=="object"){Object.keys(a).forEach(function(f){var g=f;c&&!isNaN(g)?g=c+g:"";var g=encodeURIComponent(g.toString().replace(/[!'()*]/g,escape));b?g=b+"["+g+"]":"";if(typeof a[f]==="object"){var e=$.http_build_query(a[f],null,g);d.push(e)}else{var h=encodeURIComponent(a[f].toString().replace(/[!'()*]/g,escape));d.push(g+"="+h)}})}return d.join("&")},fire_event:function(callback,params,thisArg){if(typeof thisArg=="undefined"){thisArg=null}if($.type(callback)=="string"){callback=eval(callback)}if($.type(callback)=="function"){return callback.apply(thisArg,params)}},eval_as_object:function(exp){try{return eval("("+exp+")")}catch(e){return null}},ux:function(a){a=typeof a=="undefined"||!(a instanceof HTMLElement)?document.body:a;var b=a.querySelectorAll("*[data-type]");$(b).each(function(){var d=this.getAttribute("data-type");if(typeof $(this)[d]=="function"){var c=$.options_from_html(this);$(this)[d](c)}else{console.warn("Unknown ux "+d)}})},el_get:function(c){if($(c).attr("data-type")!=null){var a=$(c).attr("data-type");if(typeof $(c)[a+"_get"]=="function"){return $(c)[a+"_get"]()}return null}else{var b={};var d=$("*[data-type]",c);$(d).each(function(){var e=this;var f=$.el_get(e);var g=e.getAttribute("data-name");if(g==null){g="undefined"}b[g]=f});return b}},el_set:function(a,b){$("*[data-type]",a).each(function(){var c=this.getAttribute("data-type");var e=this.getAttribute("data-name");var d=$.val(e,b);if(typeof $(this)[c+"_set"]=="function"){$(this)[c+"_set"](d)}else{console.warn("unknown method")}})},options_from_html:function(el){var options=null;if(el.getAttribute("data-options")!=null){try{options=eval("("+el.getAttribute("data-options")+")")}catch(e){options=null}}else{var options={};for(var i=0;i<el.attributes.length;i++){options[el.attributes[i].nodeName.replace("data-","")]=el.attributes[i].nodeValue}}return options},cookie_getitem:function(a){if(!a){return null}return decodeURIComponent(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+encodeURIComponent(a).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1"))||null},cookie_setitem:function(a,d,g,f,e,b){if(!a||/^(?:expires|max\-age|path|domain|secure)$/i.test(a)){return false}var c="";if(g){switch(g.constructor){case Number:c=g===Infinity?"; expires=Fri, 31 Dec 9999 23:59:59 GMT":"; max-age="+g;break;case String:c="; expires="+g;break;case Date:c="; expires="+g.toUTCString();break}}document.cookie=encodeURIComponent(a)+"="+encodeURIComponent(d)+c+(e?"; domain="+e:"")+(f?"; path="+f:"")+(b?"; secure":"");return true},cookie_removeitem:function(a,c,b){if(!this.hasItem(a)){return false}document.cookie=encodeURIComponent(a)+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT"+(b?"; domain="+b:"")+(c?"; path="+c:"");return true},cookie_hasitem:function(a){if(!a){return false}return(new RegExp("(?:^|;\\s*)"+encodeURIComponent(a).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=")).test(document.cookie)},cookie_keys:function(){var b=document.cookie.replace(/((?:^|\s*;)[^\=]+)(?=;|$)|^\s*|\s*(?:\=[^;]*)?(?:\1|$)/g,"").split(/\s*(?:\=[^;]*)?;\s*/);for(var a=b.length,c=0;c<a;c++){b[c]=decodeURIComponent(b[c])}return b},slug:function(a){var c="";var b=$.trim(a);c=b.replace(/[^a-z0-9-]/gi,"-").replace(/-+/g,"-").replace(/^-|-$/g,"");return c.toLowerCase()},warn:function(a){console.warn(a)},array_merge:function(){var c=Array.prototype.slice.call(arguments);var e=c.length;var f;var l={};var h="";var g=0;var m=0;var a=0;var b=0;var d=Object.prototype.toString;var n=true;for(a=0;a<e;a++){if(d.call(c[a])!=="[object Array]"){n=false;break}}if(n){n=[];for(a=0;a<e;a++){n=n.concat(c[a])}return n}for(a=0,b=0;a<e;a++){f=c[a];if(d.call(f)==="[object Array]"){for(m=0,g=f.length;m<g;m++){l[b++]=f[m]}}else{for(h in f){if(f.hasOwnProperty(h)){if(parseInt(h,10)+""===h){l[b++]=f[h]}else{l[h]=f[h]}}}}}return l},in_array:function(c,b,a){var e="";var d=!!a;if(d){for(e in b){if(b[e]===c){return true}}}else{for(e in b){if(b[e]==c){return true}}}return false},number_format:function(c,a,f,e){c=(c+"").replace(/[^0-9+\-Ee.]/g,"");var j=!isFinite(+c)?0:+c;var i=!isFinite(+a)?0:Math.abs(a);var h=(typeof e==="undefined")?",":e;var b=(typeof f==="undefined")?".":f;var g="";var d=function(m,l){var k=Math.pow(10,l);return""+(Math.round(m*k)/k).toFixed(l)};g=(i?d(j,i):""+Math.round(j)).split(".");if(g[0].length>3){g[0]=g[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,h)}if((g[1]||"").length<i){g[1]=g[1]||"";g[1]+=new Array(i-g[1].length+1).join("0")}return g.join(b)},qs:(function(f){if(f==""){return{}}var e={};for(var c=0;c<f.length;++c){var d=f[c].split("=",2);if(d.length==1){e[d[0]]=""}else{e[d[0]]=decodeURIComponent(d[1].replace(/\+/g," "))}}return e})(window.location.search.substr(1).split("&")),p:function(d,c){var b=d.match(/\$\w+/g);if(b!=null){if($.type(c)=="array"){for(var g=0;g<b.length;g++){var e=b[g];var a=typeof c[g]!="undefined"?c[g]:"";d=d.replace(e,a)}}else{if($.type(c)=="object"){for(var g=0;g<b.length;g++){var e=b[g];var f=e.replace("$","");var a=typeof c[f]!="undefined"?c[f]:"";d=d.replace(e,a)}}}}return d},array_key_count:function(a){var c=0;for(var b in a){c++}return c},object_value_min:function(a){var d=-1;if($.type(a)=="object"){for(var c in a){var b=a[c];if(d==-1||parseFloat(b)<parseFloat(d)){d=b}}}return d},object_value_max:function(a){var d=-1;if($.type(a)=="object"){for(var c in a){var b=a[c];if(d==-1||parseFloat(b)>parseFloat(d)){d=b}}}return d},ksort:function(b){var a=Object.keys(b).sort(),c={};for(var d in a){c[a[d]]=b[a[d]]}return c},str_pad:function(f,c,a,d){var b="";var e;var g=function(h,j){var i="";while(i.length<j){i+=h}i=i.substr(0,j);return i};f+="";a=a!==undefined?a:" ";if(d!=="STR_PAD_LEFT"&&d!=="STR_PAD_RIGHT"&&d!=="STR_PAD_BOTH"){d="STR_PAD_RIGHT"}if((e=c-f.length)>0){if(d==="STR_PAD_LEFT"){f=g(a,e)+f}else{if(d==="STR_PAD_RIGHT"){f=f+g(a,e)}else{if(d==="STR_PAD_BOTH"){b=g(a,Math.ceil(e/2));f=b+f+b;f=f.substr(0,c)}}}}return f},template_parse:function(h,k){var b=h.match(/<!--IF.+?(?=-->)(.+)?(?=<!--END-->)<!--END-->/gi,"gi");if($.type(b)=="array"){for(var a=0;a<b.length;a++){var c=b[a];var b=c.match(/\(.+?(?=\))\)/gi,"gi");var g=b[0];g=g.substr(1,g.length-2);var d=new Function("obj","return "+g+";");if(!d(k)){h=h.replace(c,"","gi")}}}var b=h.match(/<!--IF_NOT_EMPTY.+?(?=-->)(.+)?(?=<!--END-->)<!--END-->/gi,"gi");if($.type(b)=="array"){for(var a=0;a<b.length;a++){var c=b[a];var b=c.match(/\(\w+\)/gi,"gi");var g=b[0];g=g.substr(1,g.length-2);if($.val(g,k,{d:""})==""){h=h.replace(c,"","gi")}}}var b=h.match(/{\w+(:\w+)*?(?=})}/gi,"gi");if($.type(b)=="array"){for(var a=0;a<b.length;a++){var c=b[a];var g=c.substr(1,c.length-2);var l="string";if(g.indexOf(":")>=0){var j=g.split(":");g=j[0];l=j[1]}var e=$.val(g,k,{d:"-"});e=$.convert_datatype(e,l);h=h.replace(c,e,"gi")}}return h},convert_datatype:function(b,a){switch(a){case"date":b=$.date("j M Y",$.strtotime(b));break}return b},calc_size:function(b,a){a=typeof a=="undefined"||!a?window.innerWidth:a;if(b.indexOf("%")>=0){b=b.replace("%","","gi");if(!isNaN(parseFloat(b))){b=parseFloat(b)/100*a}}return b},download:function(c){var b=document.createElement("a");b.href=c;b.setAttribute("download",c);document.body.appendChild(b);b.click();document.body.removeChild(b)},ux_init:function(a){a=typeof a=="undefined"||!(a instanceof HTMLElement)?document.body:a;$("*[data-type]",a).each(function(){var c=this.getAttribute("data-type");if(typeof $(this)[c]=="function"){var b=$.options_from_html(this);$(this)[c](b)}else{console.warn("Unknown ux "+c)}});$("*[data-action]",a).each(function(){switch(this.getAttribute("data-action")){case"modal.close":$(this).on("click.data-action",function(){$(this).closest(".modal").modal_close()});break}});$(window).on("click",$.popup_close_all).on("scroll",$.popup_close_all);$(window).on("keyup",function(b){switch(b.keyCode){case 27:$(".modal").modal_close();break}})},istrue:function(a){if(typeof a!="undefined"&&(parseInt(a)==1||a===true)){return true}return false}});var oldVal=$.fn.val;$.fn.val=function(b){var a=$(this).attr("data-type");if(a!=null&&typeof $(this)[a+"_val"]!="undefined"){return $(this)[a+"_val"].apply(this,arguments)}else{if($(this).hasClass("container")){return $(this).container_val.apply(this,arguments)}else{return oldVal.apply(this,arguments)}}};$.fn.placeholder=function(){var a=$(this).attr("data-type");if(a!=null&&typeof $(this)[a+"_placeholder"]!="undefined"){return $(this)[a+"_placeholder"].apply(this,arguments)}else{if($(this).hasClass("container")){return $(this).container_placeholder.apply(this,arguments)}}};$.fn.readonly=function(){var a=$(this).attr("data-type");if(a!=null&&typeof $(this)[a+"_readonly"]!="undefined"){return $(this)[a+"_readonly"].apply(this,arguments)}else{if($(this).hasClass("container")){return $(this).container_readonly.apply(this,arguments)}}};$.fn.reset=function(){var a=$(this).attr("data-type");if(a!=null&&typeof $(this)[a+"_reset"]!="undefined"){return $(this)[a+"_reset"].apply(this,arguments)}else{if($(this).hasClass("container")){return $(this).container_reset.apply(this,arguments)}}};String.prototype.capitalize=function(){return this.charAt(0).toUpperCase()+this.slice(1)};$($.ux_init);$.fn.extend({vfields:function(a){var b=$.val("value",a);$(this).each(function(){var c=this;$(c).addClass("vfields");$(c).data("options",a);if($.type(b)=="array"){$(c).form_set(b)}})},form_set:function(a){if(typeof a=="undefined"||$.type(a)!="array"){return}$(this).each(function(){var b=this;var d=$(this).data("options");var c=$.val("html_callback",d);$(a).each(function(){var f=this;var e=[];e.push("<table><tr><td class='vfields-col1' align='center' style='width:24px'>");e.push("<span class='fa fa-times-circle selectable vfields-remove hoverable'></span>");e.push("</td><td class='vfields-col2'></td></tr></table>");var g=document.createElement("div");g.className="vfields-item";g.innerHTML=e.join("");$(b).append(g);$.fire_event(c,[f],$(".vfields-col2",g))});$(".vfields-remove",b).click(function(){$(this).closest(".vfields-item").remove()})})},vfields_get:function(){var a=[];$(this).each(function(){var b=this;$(".vfields-col2",b).each(function(){var c=$.el_get(this);a.push(c)})});return a}});$.fn.extend({webeditor:function(b){var a=$.val("height",b);this.each(function(){var d=$.uniqid();var c=[];c.push($.p('<textarea id="$1"></textarea>',["webeditor"+d]));$(this).addClass("webeditor");$(this).html(c.join(""));$(this).data("options",b);CKEDITOR.replace("webeditor"+d,{height:a})})},webeditor_get:function(b){var a=[];this.each(function(){var d=$("textarea",this).attr("id");if(typeof CKEDITOR.instances[d]!="undefined"){var c=CKEDITOR.instances[d].getData();a.push(c)}});return a.length==1?a[0]:(a.length>1?a:null)},webeditor_set:function(a){this.each(function(){var b=$("textarea",this).attr("id");if(typeof CKEDITOR.instances[b]!="undefined"){CKEDITOR.instances[b].setData(a)}})}});$.fn.extend({widget:function(a){this.each(function(){var c=this;var o=$.val("type",a);var b=$.val("src",a);var q=$.val("title",a,{default_value:"Untitled"});var e=$.val("columns",a);var n=$.uniqid();var m=$.val("default_presets",a);var l=parseInt($.val("preset_idx",a,{d:0}));if(isNaN(l)){l=0}var j=[];j.push($.p('<div class="widget-head padding10">',[q]));j.push($.p("<table><tr>",[]));j.push($.p('<td style="width:100%">',[]));j.push($.p('<h5 class="padding10">$1</h5>',[q]));j.push($.p("</td>",[q]));j.push($.p("<td>",[]));j.push($.p('<span id="$1"></span>',["preset-selector"+n]));j.push($.p('<span class="icon icon-reload fa fa-refresh padding10 selectable"></span>',[]));j.push($.p('<span class="icon icon-customize fa fa-ellipsis-h padding10 selectable"></span>',[]));j.push($.p("</td>",[]));j.push($.p("</tr></table>",[]));j.push($.p("</div>",[]));j.push($.p('<div class="modal" id="$1"></div>',["customize"+n]));var g=null;var d=[];var h="";if($.type(m)=="array"){for(var f=0;f<m.length;f++){if(f==l){h=m[f]["text"];g=m[f]}d.push({text:m[f]["text"],value:m[f]["text"]})}}switch(o){case"grid":j.push($.p('<div class="widget-body align-center margin10 ">',[]));j.push($.p('<span id="$1"></span>',["gridhead"+n]));j.push($.p("<div></div>",[]));j.push($.p('<span id="$1"></span>',["grid"+n]));j.push($.p("</div>",[]));$(c).html(j.join(""));var e=$.val("columns",a);$("#gridhead"+n,c).gridhead({columns:e,grid:"#grid"+n});var k=$(c).outerHeight()-$(".widget-head",c).outerHeight()-$("#gridhead"+n,c).outerHeight()-15;$("#grid"+n,c).grid({columns:e,height:k});break;case"chart":j.push($.p('<div class="widget-body align-center margin10 ">',[]));j.push($.p('<span id="$1"></span>',["chart"+n]));j.push($.p("</div>",[]));$(c).html(j.join(""));var p=$.val("chart_type",a);var k=$(c).outerHeight()-$(".widget-head",c).outerHeight()-$("#gridhead"+n,c).outerHeight()-15;$("#chart"+n).chart({width:"100%",height:k,padding:0,type:p});break;case"metric":j.push($.p('<div class="widget-body align-left margin10 ">',[]));j.push($.p('<span id="$1"></span>',["metric"+n]));j.push($.p("</div>",[]));$(c).html(j.join(""));break}$("#preset-selector"+n).dropdown({items:d,value:h,onchange:function(){$(c).widget_load()}});$("#customize"+n).gridsetting({onchange:function(r){var i=$(this).closest(".widget");var s=$(i).data("options");s=$.array_merge(s,r);$(i).data("options",s);$(c).widget_load()}});$(".icon-reload",c).click(function(){$(c).widget_load()});$(".icon-customize",c).click(function(){var s=$(this).closest(".widget");var i=$(s).data("options");var r=$.val("columns",i);var t=$.val("default_presets",i);$("#customize"+n).gridsetting_open({columns:r,presets:t,active_idx:0})});$(c).data("options",a);$(c).data("uid",n);$(c).widget_load()})},widget_load:function(){this.each(function(){var d=this;var f=$(d).data("options");var g=$.val("src",f);var c=$.val("type",f);var a=$.val("default_presets",f);var m=parseInt($.val("preset_idx",f,{d:0}));var b=$(d).data("uid");var j=$("#preset-selector"+b).dropdown_get();var e=null;var h=[];var l="";if($.type(a)=="array"){for(var k=0;k<a.length;k++){if(a[k]["text"]==j){l=a[k]["text"];e=a[k]}h.push({text:a[k]["text"],value:a[k]["text"]})}}switch(c){case"metric":$.api_post(g,e,function(i){$("#metric"+b).html("<h2>"+i.data+"</h2>")});break;case"grid":$.api_post(g,e,function(n){var i=$.val("data",n);$("#grid"+b,d).grid_set(i)});break;case"chart":$.api_post(g,e,function(i){$("#chart"+b).chart_set(i.data)});break}})}});$.extend({workspace_init:function(){$(".workspace").each(function(){var a=window.innerHeight-$(".header").outerHeight()-20;$(this).workspace_set({state:$(this).attr("data-state"),size:$(this).attr("data-size"),height:a});$.workspace_rtime;$.workspace_timeout=false;$.workspace_delta=200;$(window).resize(function(){$.workspace_rtime=new Date();if($.workspace_timeout===false){$.workspace_timeout=true;setTimeout($.workspace_resizeend,$.workspace_delta)}})})},workspace_resizeend:function(){if(new Date()-$.workspace_rtime<$.workspace_delta){setTimeout($.workspace_resizeend,$.workspace_delta)}else{$.workspace_timeout=false;$(".workspace").each(function(){var a=window.innerHeight-$(".header").outerHeight()-20;$($(this).children()[0]).css({height:a});$($(this).children()[1]).css({height:a});$($(this).children()[2]).css({height:a})})}}});$.fn.extend({workspace_set:function(a){if(typeof a=="undefined"||$.type(a)!="object"){return}$(this).each(function(){a=$.ksort(a);var j={};var h={flex:"1 1 auto"};var g={};for(var f in a){switch(f){case"size":var i=a[f];i=i.split(" ");var b=$.val(0,i,{d:300,t:"number"});var d=$.val(1,i,{d:400,t:"number"});j.flex="0 0 "+(b+"px");g.flex="0 0 "+(d+"px");$(this).data("left_size",b);$(this).data("right_size",d);break;case"height":j.height=a[f];h.height=a[f];g.height=a[f];break;case"state":var k=$.val("state",a,{d:""});k=k.split(" ");var e=$.val(0,k,{d:1,t:"number"});var c=$.val(2,k,{d:0,t:"number"});var b=e<1?"0":$(this).data("left_size");var d=c<1?"0":$(this).data("right_size");j.flex="0 0 "+(b+"px");g.flex="0 0 "+(d+"px");break}}if($(this).children().length==3){$($(this).children()[0]).css(j);$($(this).children()[1]).css(h);$($(this).children()[2]).css(g)}})}});$.fn.extend({spinner:function(d){var c=$.val("size",d,{defaultvalue:"20px"});this.each(function(){var a=[];a.push('<div class="sk-fading-circle" style="width:'+c+";height:"+c+';">');a.push('<div class="sk-circle1 sk-circle"></div>');a.push('<div class="sk-circle2 sk-circle"></div>');a.push('<div class="sk-circle3 sk-circle"></div>');a.push('<div class="sk-circle4 sk-circle"></div>');a.push('<div class="sk-circle5 sk-circle"></div>');a.push('<div class="sk-circle6 sk-circle"></div>');a.push('<div class="sk-circle7 sk-circle"></div>');a.push('<div class="sk-circle8 sk-circle"></div>');a.push('<div class="sk-circle9 sk-circle"></div>');a.push('<div class="sk-circle10 sk-circle"></div>');a.push('<div class="sk-circle11 sk-circle"></div>');a.push('<div class="sk-circle12 sk-circle"></div>');a.push("</div>");$(this).html(a.join(""))})}});$.fn.extend({tab:function(g){var f=$.val("container",g,{d:""});var h=$.val("name",g,{d:""});var e=$.val("onchange",g);this.each(function(){var a=this;$(a).attr("data-type","tab");$(a).attr("data-name",h);$(a).data("options",g);$("li",a).click(function(){if(this.classList.contains("active")){}else{$("li",this.parentNode).removeClass("active");$(this).addClass("active");var b=this.innerHTML;var c=this.getAttribute("data-value");if(c==null){c=$.slug(b)}var d=$(this).index();if($(f).length>0){$(f+">*").addClass("off");$(f+">*:eq("+d+")").removeClass("off")}$.fire_event(e,[{text:b,value:c}],a)}})})},tab_set:function(g){var h=this;var e=$(h).data("options");var f=$.val("onchange",e);$("li",this).removeClass("active");$("li",this).each(function(){var b=this.innerHTML;var a=this.getAttribute("data-value");if(a==null){a=$.slug(b)}if(a==g){$(this).addClass("active");$.fire_event(f,[{text:b,value:a}],h)}})}});$.fn.extend({textarea:function(m){var o=$.val("placeholder",m,{d:""});var r=$.val("class",m,{d:""});var x=$.val("name",m,{d:""});var n=$.val("height",m,{d:"1em"});var w=$.val("width",m);var u=$.val("maxlength",m,{d:""});var q=$.val("onblur",m);var y=$.val("onkeyup",m);var t=$.val("onchange",m);var p=$.val("value",m,{d:""});var s={width:w};this.each(function(){var b=this;var a=[];a.push("<textarea rows='1' placeholder='"+o+"' style='height:"+n+";' maxlength='"+u+"'></textarea>");a.push("<span class='icon fa hidden'></span>");$(b).addClass("textarea");$(b).addClass(r);$(b).css(s);$(b).html(a.join(""));$(b).attr("data-type","textarea");$(b).attr("data-name",x);$(b).data("options",m);$("textarea",b).blur(function(c){$(b).textarea_validate();$.fire_event(q,[],b)}).keyup(function(c){$.fire_event(y,[this.value],b);if($(this).data("last_value")!=this.value){$.fire_event(t,[this.value],b)}$(this).data("last_value",this.value)});$("textarea",b).each(function(){this.setAttribute("style","height:"+(this.scrollHeight<=0?"":this.scrollHeight)+"px;overflow-y:hidden;")}).on("input",function(){this.style.height="auto";this.style.height=(this.scrollHeight)+"px"});if(p!=""){$(this).textarea_val(p)}})},textarea_val:function(c){if(typeof c=="undefined"){var d=[];$(this).each(function(){d.push($("textarea",this).val())});return d.length>1?d:(d.length==1?d[0]:"")}else{$(this).each(function(){$("textarea",this).val(c).each(function(){this.style.height="auto";this.style.height=(this.scrollHeight)+"px"})})}},textarea_placeholder:function(c){if(typeof c=="undefined"){var d=[];$(this).each(function(){d.push($("input",this).attr("placeholder"))});return d.length>1?d:(d.length==1?d[0]:"")}else{$(this).each(function(){$("input",this).attr("placeholder",c)})}},textarea_reset:function(){$(this).textarea_val("")},textarea_validate:function(){$(this).each(function(){var j=$(this).data("options");var n=$.val("required",j,{d:false});var o=$.val("required_text",j,{d:"Field required."});var q=$.val("validation",j,{d:""});var p=$.val("validation_text",j,{d:"Validation error."});var l=$(this).textarea_val();var r=true;var k="";if(n){if(l.toString().trim()==""){r=false;k=o}else{if(q!=""){switch(q){default:var m=new RegExp(q);r=m.test(l);if(!r){k=p}break}}}}else{if(l.toString().length>0){switch(q){default:var m=new RegExp(q);r=m.test(l);if(!r){k=p}break}}}if(!r){$(this).addClass("invalid");console.warn(k)}else{$(this).removeClass("invalid")}})}});$.fn.extend({textbox:function(n){var p=$.val("placeholder",n,{d:""});var z=$.val("name",n,{d:""});var r=$.val("class",n,{d:""});var o=$.val("value",n,{d:""});var u=$.val("readonly",n,{d:false});var x=$.val("maxlength",n,{d:""});var s=$.val("mode",n,{d:"text"});var y=$.val("width",n);var q=$.val("onblur",n);var A=$.val("onkeyup",n);var w=$.val("onchange",n);var t={width:y};this.each(function(){var a=this;var b=[];b.push($.p('<input type="$1" placeholder="$1" maxlength="$1"/>',[s,p,x]));b.push("<span class='icon fa hidden'></span>");$(a).addClass("textbox");$(a).addClass(r);$(a).css(t);$(a).html(b.join(""));$(a).attr("data-type","textbox");$(a).attr("data-name",z);$(a).data("options",n);$("input",a).val(o);$("input",a).blur(function(c){$(a).textbox_validate();$.fire_event(q,[],a)}).keyup(function(c){$.fire_event(A,[this.value],a);if($(this).data("last_value")!=this.value){$.fire_event(w,[this.value],a)}$(this).data("last_value",this.value)})})},textbox_val:function(c){if(typeof c=="undefined"){var d=[];$(this).each(function(){d.push($("input",this).val())});return d.length>1?d:(d.length==1?d[0]:"")}else{$(this).each(function(){$("input",this).val(c)})}},textbox_placeholder:function(c){if(typeof c=="undefined"){var d=[];$(this).each(function(){d.push($("input",this).attr("placeholder"))});return d.length>1?d:(d.length==1?d[0]:"")}else{$(this).each(function(){$("input",this).attr("placeholder",c)})}},textbox_reset:function(){$(this).textbox_val("")},textbox_validate:function(){$(this).each(function(){var j=$(this).data("options");var n=$.val("required",j,{d:false});var o=$.val("required_text",j,{d:"Field required."});var q=$.val("validation",j,{d:""});var p=$.val("validation_text",j,{d:"Validation error."});var l=$(this).textbox_val();var r=true;var k="";if(n){if(l.toString().trim()==""){r=false;k=o}else{if(q!=""){switch(q){default:var m=new RegExp(q);r=m.test(l);if(!r){k=p}break}}}}else{if(l.toString().length>0){switch(q){default:var m=new RegExp(q);r=m.test(l);if(!r){k=p}break}}}if(!r){$(this).addClass("invalid");console.warn(k)}else{$(this).removeClass("invalid")}})}});$.fn.extend({toggle:function(e){var h=$.val("class",e,{d:""});var f=$.val("name",e,{d:""});var g=$.val("value",e,{d:false});this.each(function(){var a=this;var b=[];b.push("<span class='main-toggle'></span>");a.innerHTML=b.join("");$(this).addClass("toggle");$(this).addClass(h);$(a).attr("data-type","toggle");if(f!=""){$(a).attr("data-name",f)}a.querySelector(".main-toggle").addEventListener("click",function(){if(this.parentNode.classList.contains("on")){this.parentNode.classList.remove("on")}else{this.parentNode.classList.add("on")}});$(a).toggle_val(g);return a})},toggle_val:function(b){if(!$(this).hasClass("toggle")){return undefined}if(typeof b=="undefined"){return $(this).hasClass("on")?1:0}else{if(b==true||b==1){$(this).addClass("on")}else{$(this).removeClass("on")}}}});$.extend({tooltip:function(g,k){var h=$(".tooltip");if(h.length==0){$.warn("No tooltip defined.")}$(h).addClass("on");var i=g.getBoundingClientRect();var l={};var j=[];console.log(g);l.left=i.left;console.log([i.top,i.top+i.height+$(h).outerHeight()+10,window.innerHeight]);if(i.top+i.height+$(h).outerHeight()+10>window.innerHeight){l.top=i.top-$(h).outerHeight()-10;j.push("<div class='arrow-down'></div>")}else{l.top=i.top+i.height+10;j.push("<div class='arrow-up'></div>")}j.push(k);$(h).html(j.join(""));$(h).css(l)},tooltip_remove:function(){$(".tooltip").removeClass("on")}});$.extend({date:function(f,l){var m=this;var k,n;var o=["Sun","Mon","Tues","Wednes","Thurs","Fri","Satur","January","February","March","April","May","June","July","August","September","October","November","December"];var q=/\\?(.?)/gi;var r=function(b,a){return n[b]?n[b]():a};var p=function(a,b){a=String(a);while(a.length<b){a="0"+a}return a};n={d:function(){return p(n.j(),2)},D:function(){return n.l().slice(0,3)},j:function(){return k.getDate()},l:function(){return o[n.w()]+"day"},N:function(){return n.w()||7},S:function(){var b=n.j();var a=b%10;if(a<=3&&parseInt((b%100)/10,10)==1){a=0}return["st","nd","rd"][a-1]||"th"},w:function(){return k.getDay()},z:function(){var a=new Date(n.Y(),n.n()-1,n.j());var b=new Date(n.Y(),0,1);return Math.round((a-b)/86400000)},W:function(){var a=new Date(n.Y(),n.n()-1,n.j()-n.N()+3);var b=new Date(a.getFullYear(),0,4);return p(1+Math.round((a-b)/86400000/7),2)},F:function(){return o[6+n.n()]},m:function(){return p(n.n(),2)},M:function(){return n.F().slice(0,3)},n:function(){return k.getMonth()+1},t:function(){return(new Date(n.Y(),n.n(),0)).getDate()},L:function(){var a=n.Y();return a%4===0&a%100!==0|a%400===0},o:function(){var a=n.n();var c=n.W();var b=n.Y();return b+(a===12&&c<9?1:a===1&&c>9?-1:0)},Y:function(){return k.getFullYear()},y:function(){return n.Y().toString().slice(-2)},a:function(){return k.getHours()>11?"pm":"am"},A:function(){return n.a().toUpperCase()},B:function(){var b=k.getUTCHours()*3600;var c=k.getUTCMinutes()*60;var a=k.getUTCSeconds();return p(Math.floor((b+c+a+3600)/86.4)%1000,3)},g:function(){return n.G()%12||12},G:function(){return k.getHours()},h:function(){return p(n.g(),2)},H:function(){return p(n.G(),2)},i:function(){return p(k.getMinutes(),2)},s:function(){return p(k.getSeconds(),2)},u:function(){return p(k.getMilliseconds()*1000,6)},e:function(){throw"Not supported (see source code of date() for timezone on how to add support)"},I:function(){var c=new Date(n.Y(),0);var a=Date.UTC(n.Y(),0);var d=new Date(n.Y(),6);var b=Date.UTC(n.Y(),6);return((c-a)!==(d-b))?1:0},O:function(){var a=k.getTimezoneOffset();var b=Math.abs(a);return(a>0?"-":"+")+p(Math.floor(b/60)*100+b%60,4)},P:function(){var a=n.O();return(a.substr(0,3)+":"+a.substr(3,2))},T:function(){return"UTC"},Z:function(){return -k.getTimezoneOffset()*60},c:function(){return"Y-m-d\\TH:i:sP".replace(q,r)},r:function(){return"D, d M Y H:i:s O".replace(q,r)},U:function(){return k/1000|0}};this.date=function(a,b){m=this;k=(b===undefined?new Date():(b instanceof Date)?new Date(b):new Date(b*1000));return a.replace(q,r)};return this.date(f,l)},uniqid:function(){if(typeof $.__UNIQID=="undefined"){$.__UNIQID=0}return ++$.__UNIQID},val:function(l,q,i){if(typeof i=="undefined"||$.type(i)!="object"){i={}}var m=null;var k=typeof i.default_value!="undefined"?i.default_value:(typeof i.d!="undefined"?i.d:null);var p=typeof i.t!="undefined"?i.t:(typeof i.datatype!="undefined"?i.datatype:"string");var n=typeof i.required!="undefined"&&n==1?true:false;if($.type(q)=="object"){if($.type(l)=="array"){m=null;for(var o=0;o<l.length;o++){var r=l[o];v=$.val(r,q,{default_value:null});if(v!=null){m=v;break}}}else{if($.type(l)=="string"||$.type(l)=="number"){if(typeof q[l]!="undefined"){m=q[l]}}}}else{if($.type(q)=="array"){if(typeof q[l]!="undefined"){m=q[l]}}}if(n){if(m==null){}}else{m=m==null&&k!=null?k:m}switch(p){case"number":case"integer":case"float":case"double":m=parseFloat(m);break}return m},strtotime:function(i,D){var u,y,t,w,B,r,F,x,G,s,z,C=false;if(!i){return C}if(/^\d{8}$/.test(i)){i=i.substr(0,4)+"-"+i.substr(4,2)+"-"+i.substr(6,2)}i=i.replace(/^\s+|\s+$/g,"").replace(/\s{2,}/g," ").replace(/[\t\r\n]/g,"").toLowerCase();y=i.match(/^(\d{1,4})([\-\.\/\:])(\d{1,2})([\-\.\/\:])(\d{1,4})(?:\s(\d{1,2}):(\d{2})?:?(\d{2})?)?(?:\s([A-Z]+)?)?$/);if(y&&y[2]===y[4]){if(y[1]>1901){switch(y[2]){case"-":if(y[3]>12||y[5]>31){return C}return new Date(y[1],parseInt(y[3],10)-1,y[5],y[6]||0,y[7]||0,y[8]||0,y[9]||0)/1000;case".":return C;case"/":if(y[3]>12||y[5]>31){return C}return new Date(y[1],parseInt(y[3],10)-1,y[5],y[6]||0,y[7]||0,y[8]||0,y[9]||0)/1000}}else{if(y[5]>1901){switch(y[2]){case"-":if(y[3]>12||y[1]>31){return C}return new Date(y[5],parseInt(y[3],10)-1,y[1],y[6]||0,y[7]||0,y[8]||0,y[9]||0)/1000;case".":if(y[3]>12||y[1]>31){return C}return new Date(y[5],parseInt(y[3],10)-1,y[1],y[6]||0,y[7]||0,y[8]||0,y[9]||0)/1000;case"/":if(y[1]>12||y[3]>31){return C}return new Date(y[5],parseInt(y[1],10)-1,y[3],y[6]||0,y[7]||0,y[8]||0,y[9]||0)/1000}}else{switch(y[2]){case"-":if(y[3]>12||y[5]>31||(y[1]<70&&y[1]>38)){return C}w=y[1]>=0&&y[1]<=38?+y[1]+2000:y[1];return new Date(w,parseInt(y[3],10)-1,y[5],y[6]||0,y[7]||0,y[8]||0,y[9]||0)/1000;case".":if(y[5]>=70){if(y[3]>12||y[1]>31){return C}return new Date(y[5],parseInt(y[3],10)-1,y[1],y[6]||0,y[7]||0,y[8]||0,y[9]||0)/1000}if(y[5]<60&&!y[6]){if(y[1]>23||y[3]>59){return C}t=new Date();return new Date(t.getFullYear(),t.getMonth(),t.getDate(),y[1]||0,y[3]||0,y[5]||0,y[9]||0)/1000}return C;case"/":if(y[1]>12||y[3]>31||(y[5]<70&&y[5]>38)){return C}w=y[5]>=0&&y[5]<=38?+y[5]+2000:y[5];return new Date(w,parseInt(y[1],10)-1,y[3],y[6]||0,y[7]||0,y[8]||0,y[9]||0)/1000;case":":if(y[1]>23||y[3]>59||y[5]>59){return C}t=new Date();return new Date(t.getFullYear(),t.getMonth(),t.getDate(),y[1]||0,y[3]||0,y[5]||0)/1000}}}}if(i==="now"){return D===null||isNaN(D)?new Date().getTime()/1000|0:D|0}if(!isNaN(u=Date.parse(i))){return u/1000|0}B=D?new Date(D*1000):new Date();r={sun:0,mon:1,tue:2,wed:3,thu:4,fri:5,sat:6};F={yea:"FullYear",mon:"Month",day:"Date",hou:"Hours",min:"Minutes",sec:"Seconds"};function A(c,d,b){var a,e=r[d];if(typeof e!=="undefined"){a=e-B.getDay();if(a===0){a=7*b}else{if(a>0&&c==="last"){a-=7}else{if(a<0&&c==="next"){a+=7}}}B.setDate(B.getDate()+a)}}function E(b){var a=b.split(" "),e=a[0],d=a[1].substring(0,3),c=/\d+/.test(e),f=a[2]==="ago",g=(e==="last"?-1:1)*(f?-1:1);if(c){g*=parseInt(e,10)}if(F.hasOwnProperty(d)&&!a[1].match(/^mon(day|\.)?$/i)){return B["set"+F[d]](B["get"+F[d]]()+g)}if(d==="wee"){return B.setDate(B.getDate()+(g*7))}if(e==="next"||e==="last"){A(e,d,g)}else{if(!c){return false}}return true}G="(years?|months?|weeks?|days?|hours?|minutes?|min|seconds?|sec|sunday|sun\\.?|monday|mon\\.?|tuesday|tue\\.?|wednesday|wed\\.?|thursday|thu\\.?|friday|fri\\.?|saturday|sat\\.?)";s="([+-]?\\d+\\s"+G+"|(last|next)\\s"+G+")(\\sago)?";y=i.match(new RegExp(s,"gi"));if(!y){return C}for(z=0,x=y.length;z<x;z++){if(!E(y[z])){return C}}return(B.getTime()/1000)},mktime:function(){var g=new Date(),d=arguments,e=0,h=["Hours","Minutes","Seconds","Month","Date","FullYear"];for(e=0;e<h.length;e++){if(typeof d[e]==="undefined"){d[e]=g["get"+h[e]]();d[e]+=(e===3)}else{d[e]=parseInt(d[e],10);if(isNaN(d[e])){return false}}}d[5]+=(d[5]>=0?(d[5]<=69?2000:(d[5]<=100?1900:0)):0);g.setFullYear(d[5],d[3]-1,d[4]);g.setHours(d[0],d[1],d[2]);return(g.getTime()/1000>>0)-(g.getTime()<0)},date_parse:function(b){switch(b){case"this_month":b=$.date("Ym")+"01-"+$.date("Ymd",$.mktime(0,0,0,parseInt($.date("m"))+1,0,$.date("Y")));break}return b},start_day_of_month:function(e,d){var f=$.date("N",$.mktime(0,0,0,d,1,e));return f},last_date_of_month:function(d,h){var g=27;do{g++;var f=parseInt($.date("j",$.mktime(0,0,0,h,g,d)));if(f!=g){g--;break}}while(true);return g},api_get:function(l,j,i,g){var h=$.http_build_query(j);l+=h.length>0?"?"+h:"";var k=new XMLHttpRequest();k.open("GET",l,true);k.addEventListener("load",function(){if(this.readyState==4){var a=$.eval_as_object(this.responseText);var c=$.val("error",a,{d:0,datatype:"integer"});var b=$.val("error_message",a,{d:""});if(c>0){if(g!=null){$.fire_event(g,[this.responseText],k)}else{alert(b)}}else{$.fire_event(i,[a],k)}}});k.addEventListener("error",function(){if(typeof g!="undefined"||g!=null){$.fire_event(g)}else{console.log(this.responseText)}});k.send();return k},api_post:function(f,i,h,g){var j=new XMLHttpRequest();j.open("POST",f,true);j.addEventListener("load",function(){if(this.readyState==4){var a=$.eval_as_object(this.responseText);var c=$.val("error",a,{d:0,datatype:"integer"});var b=$.val("error_message",a,{d:""});if(parseInt(c)==0){$.fire_event(h,[a],j)}else{if(typeof g!="undefined"||g!=null){$.fire_event(g,[{error:c,error_message:b}])}else{alert(JSON.stringify(a,null,2))}}}});j.addEventListener("error",function(){if(typeof g!="undefined"||g!=null){$.fire_event(g)}else{console.log(this.responseText)}});j.send(JSON.stringify(i));return j},http_build_query:function(h,f,g){var e=[];if($.type(h)=="object"){Object.keys(h).forEach(function(a){var d=a;f&&!isNaN(d)?d=f+d:"";var d=encodeURIComponent(d.toString().replace(/[!'()*]/g,escape));g?d=g+"["+d+"]":"";if(typeof h[a]==="object"){var b=$.http_build_query(h[a],null,d);e.push(b)}else{var c=encodeURIComponent(h[a].toString().replace(/[!'()*]/g,escape));e.push(d+"="+c)}})}return e.join("&")},fire_event:function(callback,params,thisArg){if(typeof thisArg=="undefined"){thisArg=null}if($.type(callback)=="string"){callback=eval(callback)}if($.type(callback)=="function"){return callback.apply(thisArg,params)}},eval_as_object:function(exp){try{return eval("("+exp+")")}catch(e){return null}},ux:function(d){d=typeof d=="undefined"||!(d instanceof HTMLElement)?document.body:d;var c=d.querySelectorAll("*[data-type]");$(c).each(function(){var a=this.getAttribute("data-type");if(typeof $(this)[a]=="function"){var b=$.options_from_html(this);$(this)[a](b)}else{console.warn("Unknown ux "+a)}})},el_get:function(f){if($(f).attr("data-type")!=null){var h=$(f).attr("data-type");if(typeof $(f)[h+"_get"]=="function"){return $(f)[h+"_get"]()}return null}else{var g={};var e=$("*[data-type]",f);$(e).each(function(){var b=this;var a=$.el_get(b);var c=b.getAttribute("data-name");if(c==null){c="undefined"}g[c]=a});return g}},el_set:function(d,c){$("*[data-type]",d).each(function(){var b=this.getAttribute("data-type");var f=this.getAttribute("data-name");var a=$.val(f,c);if(typeof $(this)[b+"_set"]=="function"){$(this)[b+"_set"](a)}else{console.warn("unknown method")}})},options_from_html:function(el){var options=null;if(el.getAttribute("data-options")!=null){try{options=eval("("+el.getAttribute("data-options")+")")}catch(e){options=null}}else{var options={};for(var i=0;i<el.attributes.length;i++){options[el.attributes[i].nodeName.replace("data-","")]=el.attributes[i].nodeValue}}return options},cookie_getitem:function(b){if(!b){return null}return decodeURIComponent(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+encodeURIComponent(b).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1"))||null},cookie_setitem:function(m,j,n,h,i,l){if(!m||/^(?:expires|max\-age|path|domain|secure)$/i.test(m)){return false}var k="";if(n){switch(n.constructor){case Number:k=n===Infinity?"; expires=Fri, 31 Dec 9999 23:59:59 GMT":"; max-age="+n;break;case String:k="; expires="+n;break;case Date:k="; expires="+n.toUTCString();break}}document.cookie=encodeURIComponent(m)+"="+encodeURIComponent(j)+k+(i?"; domain="+i:"")+(h?"; path="+h:"")+(l?"; secure":"");return true},cookie_removeitem:function(f,d,e){if(!this.hasItem(f)){return false}document.cookie=encodeURIComponent(f)+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT"+(e?"; domain="+e:"")+(d?"; path="+d:"");return true},cookie_hasitem:function(b){if(!b){return false}return(new RegExp("(?:^|;\\s*)"+encodeURIComponent(b).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=")).test(document.cookie)},cookie_keys:function(){var e=document.cookie.replace(/((?:^|\s*;)[^\=]+)(?=;|$)|^\s*|\s*(?:\=[^;]*)?(?:\1|$)/g,"").split(/\s*(?:\=[^;]*)?;\s*/);for(var f=e.length,d=0;d<f;d++){e[d]=decodeURIComponent(e[d])}return e},slug:function(f){var d="";var e=$.trim(f);d=e.replace(/[^a-z0-9-]/gi,"-").replace(/-+/g,"-").replace(/^-|-$/g,"");return d.toLowerCase()},warn:function(b){console.warn(b)},array_merge:function(){var p=Array.prototype.slice.call(arguments);var k=p.length;var j;var u={};var w="";var i=0;var t=0;var r=0;var q=0;var o=Object.prototype.toString;var s=true;for(r=0;r<k;r++){if(o.call(p[r])!=="[object Array]"){s=false;break}}if(s){s=[];for(r=0;r<k;r++){s=s.concat(p[r])}return s}for(r=0,q=0;r<k;r++){j=p[r];if(o.call(j)==="[object Array]"){for(t=0,i=j.length;t<i;t++){u[q++]=j[t]}}else{for(w in j){if(j.hasOwnProperty(w)){if(parseInt(w,10)+""===w){u[q++]=j[w]}else{u[w]=j[w]}}}}}return u},in_array:function(h,i,j){var f="";var g=!!j;if(g){for(f in i){if(i[f]===h){return true}}}else{for(f in i){if(i[f]==h){return true}}}return false},number_format:function(p,r,m,n){p=(p+"").replace(/[^0-9+\-Ee.]/g,"");var s=!isFinite(+p)?0:+p;var t=!isFinite(+r)?0:Math.abs(r);var k=(typeof n==="undefined")?",":n;var q=(typeof m==="undefined")?".":m;var l="";var o=function(c,a){var b=Math.pow(10,a);return""+(Math.round(c*b)/b).toFixed(a)};l=(t?o(s,t):""+Math.round(s)).split(".");if(l[0].length>3){l[0]=l[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,k)}if((l[1]||"").length<t){l[1]=l[1]||"";l[1]+=new Array(t-l[1].length+1).join("0")}return l.join(q)},qs:(function(g){if(g==""){return{}}var h={};for(var b=0;b<g.length;++b){var a=g[b].split("=",2);if(a.length==1){h[a[0]]=""}else{h[a[0]]=decodeURIComponent(a[1].replace(/\+/g," "))}}return h})(window.location.search.substr(1).split("&")),p:function(j,k){var l=j.match(/\$\w+/g);if(l!=null){if($.type(k)=="array"){for(var n=0;n<l.length;n++){var i=l[n];var m=typeof k[n]!="undefined"?k[n]:"";j=j.replace(i,m)}}else{if($.type(k)=="object"){for(var n=0;n<l.length;n++){var i=l[n];var h=i.replace("$","");var m=typeof k[h]!="undefined"?k[h]:"";j=j.replace(i,m)}}}}return j},array_key_count:function(f){var d=0;for(var e in f){d++}return d},object_value_min:function(h){var e=-1;if($.type(h)=="object"){for(var f in h){var g=h[f];if(e==-1||parseFloat(g)<parseFloat(e)){e=g}}}return e},object_value_max:function(h){var e=-1;if($.type(h)=="object"){for(var f in h){var g=h[f];if(e==-1||parseFloat(g)>parseFloat(e)){e=g}}}return e},ksort:function(g){var h=Object.keys(g).sort(),f={};for(var e in h){f[h[e]]=g[h[e]]}return f},str_pad:function(h,k,m,j){var l="";var i;var n=function(b,c){var a="";while(a.length<c){a+=b}a=a.substr(0,c);return a};h+="";m=m!==undefined?m:" ";if(j!=="STR_PAD_LEFT"&&j!=="STR_PAD_RIGHT"&&j!=="STR_PAD_BOTH"){j="STR_PAD_RIGHT"}if((i=k-h.length)>0){if(j==="STR_PAD_LEFT"){h=n(m,i)+h}else{if(j==="STR_PAD_RIGHT"){h=h+n(m,i)}else{if(j==="STR_PAD_BOTH"){l=n(m,Math.ceil(i/2));h=l+h+l;h=h.substr(0,k)}}}}return h},template_parse:function(i,t){var q=i.match(/<!--IF.+?(?=-->)(.+)?(?=<!--END-->)<!--END-->/gi,"gi");if($.type(q)=="array"){for(var r=0;r<q.length;r++){var p=q[r];var q=p.match(/\(.+?(?=\))\)/gi,"gi");var m=q[0];m=m.substr(1,m.length-2);var o=new Function("obj","return "+m+";");if(!o(t)){i=i.replace(p,"","gi")}}}var q=i.match(/<!--IF_NOT_EMPTY.+?(?=-->)(.+)?(?=<!--END-->)<!--END-->/gi,"gi");if($.type(q)=="array"){for(var r=0;r<q.length;r++){var p=q[r];var q=p.match(/\(\w+\)/gi,"gi");var m=q[0];m=m.substr(1,m.length-2);if($.val(m,t,{d:""})==""){i=i.replace(p,"","gi")}}}var q=i.match(/{\w+(:\w+)*?(?=})}/gi,"gi");if($.type(q)=="array"){for(var r=0;r<q.length;r++){var p=q[r];var m=p.substr(1,p.length-2);var s="string";if(m.indexOf(":")>=0){var f=m.split(":");m=f[0];s=f[1]}var n=$.val(m,t,{d:"-"});n=$.convert_datatype(n,s);i=i.replace(p,n,"gi")}}return i},convert_datatype:function(c,d){switch(d){case"date":c=$.date("j M Y",$.strtotime(c));break}return c},calc_size:function(c,d){d=typeof d=="undefined"||!d?window.innerWidth:d;if(c.indexOf("%")>=0){c=c.replace("%","","gi");if(!isNaN(parseFloat(c))){c=parseFloat(c)/100*d}}return c},download:function(d){var a=document.createElement("a");a.href=d;a.setAttribute("download",d);document.body.appendChild(a);a.click();document.body.removeChild(a)},ux_init:function(b){b=typeof b=="undefined"||!(b instanceof HTMLElement)?document.body:b;$("*[data-type]",b).each(function(){var d=this.getAttribute("data-type");if(typeof $(this)[d]=="function"){var a=$.options_from_html(this);$(this)[d](a)}else{console.warn("Unknown ux "+d)}});$("*[data-action]",b).each(function(){switch(this.getAttribute("data-action")){case"modal.close":$(this).on("click.data-action",function(){$(this).closest(".modal").modal_close()});break}});$(window).on("click",$.popup_close_all).on("scroll",$.popup_close_all);$(window).on("keyup",function(a){switch(a.keyCode){case 27:$(".modal").modal_close();break}})},istrue:function(b){if(typeof b!="undefined"&&(parseInt(b)==1||b===true)){return true}return false}});var oldVal=$.fn.val;$.fn.val=function(c){var d=$(this).attr("data-type");if(d!=null&&typeof $(this)[d+"_val"]!="undefined"){return $(this)[d+"_val"].apply(this,arguments)}else{if($(this).hasClass("container")){return $(this).container_val.apply(this,arguments)}else{return oldVal.apply(this,arguments)}}};$.fn.placeholder=function(){var b=$(this).attr("data-type");if(b!=null&&typeof $(this)[b+"_placeholder"]!="undefined"){return $(this)[b+"_placeholder"].apply(this,arguments)}else{if($(this).hasClass("container")){return $(this).container_placeholder.apply(this,arguments)}}};$.fn.readonly=function(){var b=$(this).attr("data-type");if(b!=null&&typeof $(this)[b+"_readonly"]!="undefined"){return $(this)[b+"_readonly"].apply(this,arguments)}else{if($(this).hasClass("container")){return $(this).container_readonly.apply(this,arguments)}}};$.fn.reset=function(){var b=$(this).attr("data-type");if(b!=null&&typeof $(this)[b+"_reset"]!="undefined"){return $(this)[b+"_reset"].apply(this,arguments)}else{if($(this).hasClass("container")){return $(this).container_reset.apply(this,arguments)}}};String.prototype.capitalize=function(){return this.charAt(0).toUpperCase()+this.slice(1)};$($.ux_init);$.fn.extend({vfields:function(d){var c=$.val("value",d);$(this).each(function(){var a=this;$(a).addClass("vfields");$(a).data("options",d);if($.type(c)=="array"){$(a).form_set(c)}})},form_set:function(b){if(typeof b=="undefined"||$.type(b)!="array"){return}$(this).each(function(){var a=this;var e=$(this).data("options");var f=$.val("html_callback",e);$(b).each(function(){var d=this;var h=[];h.push("<table><tr><td class='vfields-col1' align='center' style='width:24px'>");h.push("<span class='fa fa-times-circle selectable vfields-remove hoverable'></span>");h.push("</td><td class='vfields-col2'></td></tr></table>");var c=document.createElement("div");c.className="vfields-item";c.innerHTML=h.join("");$(a).append(c);$.fire_event(f,[d],$(".vfields-col2",c))});$(".vfields-remove",a).click(function(){$(this).closest(".vfields-item").remove()})})},vfields_get:function(){var b=[];$(this).each(function(){var a=this;$(".vfields-col2",a).each(function(){var d=$.el_get(this);b.push(d)})});return b}});$.fn.extend({webeditor:function(c){var d=$.val("height",c);this.each(function(){var a=$.uniqid();var b=[];b.push($.p('<textarea id="$1"></textarea>',["webeditor"+a]));$(this).addClass("webeditor");$(this).html(b.join(""));$(this).data("options",c);CKEDITOR.replace("webeditor"+a,{height:d})})},webeditor_get:function(c){var d=[];this.each(function(){var a=$("textarea",this).attr("id");if(typeof CKEDITOR.instances[a]!="undefined"){var b=CKEDITOR.instances[a].getData();d.push(b)}});return d.length==1?d[0]:(d.length>1?d:null)},webeditor_set:function(b){this.each(function(){var a=$("textarea",this).attr("id");if(typeof CKEDITOR.instances[a]!="undefined"){CKEDITOR.instances[a].setData(b)}})}});$.fn.extend({widget:function(b){this.each(function(){var r=this;var t=$.val("type",b);var D=$.val("src",b);var s=$.val("title",b,{default_value:"Untitled"});var B=$.val("columns",b);var u=$.uniqid();var w=$.val("default_presets",b);var x=parseInt($.val("preset_idx",b,{d:0}));if(isNaN(x)){x=0}var y=[];y.push($.p('<div class="widget-head padding10">',[s]));y.push($.p("<table><tr>",[]));y.push($.p('<td style="width:100%">',[]));y.push($.p('<h5 class="padding10">$1</h5>',[s]));y.push($.p("</td>",[s]));y.push($.p("<td>",[]));y.push($.p('<span id="$1"></span>',["preset-selector"+u]));y.push($.p('<span class="icon icon-reload fa fa-refresh padding10 selectable"></span>',[]));y.push($.p('<span class="icon icon-customize fa fa-ellipsis-h padding10 selectable"></span>',[]));y.push($.p("</td>",[]));y.push($.p("</tr></table>",[]));y.push($.p("</div>",[]));y.push($.p('<div class="modal" id="$1"></div>',["customize"+u]));var i=null;var C=[];var z="";if($.type(w)=="array"){for(var A=0;A<w.length;A++){if(A==x){z=w[A]["text"];i=w[A]}C.push({text:w[A]["text"],value:w[A]["text"]})}}switch(t){case"grid":y.push($.p('<div class="widget-body align-center margin10 ">',[]));y.push($.p('<span id="$1"></span>',["gridhead"+u]));y.push($.p("<div></div>",[]));y.push($.p('<span id="$1"></span>',["grid"+u]));y.push($.p("</div>",[]));$(r).html(y.join(""));var B=$.val("columns",b);$("#gridhead"+u,r).gridhead({columns:B,grid:"#grid"+u});var a=$(r).outerHeight()-$(".widget-head",r).outerHeight()-$("#gridhead"+u,r).outerHeight()-15;$("#grid"+u,r).grid({columns:B,height:a});break;case"chart":y.push($.p('<div class="widget-body align-center margin10 ">',[]));y.push($.p('<span id="$1"></span>',["chart"+u]));y.push($.p("</div>",[]));$(r).html(y.join(""));var E=$.val("chart_type",b);var a=$(r).outerHeight()-$(".widget-head",r).outerHeight()-$("#gridhead"+u,r).outerHeight()-15;$("#chart"+u).chart({width:"100%",height:a,padding:0,type:E});break;case"metric":y.push($.p('<div class="widget-body align-left margin10 ">',[]));y.push($.p('<span id="$1"></span>',["metric"+u]));y.push($.p("</div>",[]));$(r).html(y.join(""));break}$("#preset-selector"+u).dropdown({items:C,value:z,onchange:function(){$(r).widget_load()}});$("#customize"+u).gridsetting({onchange:function(d){var e=$(this).closest(".widget");var c=$(e).data("options");c=$.array_merge(c,d);$(e).data("options",c);$(r).widget_load()}});$(".icon-reload",r).click(function(){$(r).widget_load()});$(".icon-customize",r).click(function(){var d=$(this).closest(".widget");var f=$(d).data("options");var e=$.val("columns",f);var c=$.val("default_presets",f);$("#customize"+u).gridsetting_open({columns:e,presets:c,active_idx:0})});$(r).data("options",b);$(r).data("uid",u);$(r).widget_load()})},widget_load:function(){this.each(function(){var o=this;var i=$(o).data("options");var y=$.val("src",i);var p=$.val("type",i);var r=$.val("default_presets",i);var s=parseInt($.val("preset_idx",i,{d:0}));var q=$(o).data("uid");var w=$("#preset-selector"+q).dropdown_get();var n=null;var x=[];var t="";if($.type(r)=="array"){for(var u=0;u<r.length;u++){if(r[u]["text"]==w){t=r[u]["text"];n=r[u]}x.push({text:r[u]["text"],value:r[u]["text"]})}}switch(p){case"metric":$.api_post(y,n,function(a){$("#metric"+q).html("<h2>"+a.data+"</h2>")});break;case"grid":$.api_post(y,n,function(a){var b=$.val("data",a);$("#grid"+q,o).grid_set(b)});break;case"chart":$.api_post(y,n,function(a){$("#chart"+q).chart_set(a.data)});break}})}});$.extend({workspace_init:function(){$(".workspace").each(function(){var b=window.innerHeight-$(".header").outerHeight()-20;$(this).workspace_set({state:$(this).attr("data-state"),size:$(this).attr("data-size"),height:b});$.workspace_rtime;$.workspace_timeout=false;$.workspace_delta=200;$(window).resize(function(){$.workspace_rtime=new Date();if($.workspace_timeout===false){$.workspace_timeout=true;setTimeout($.workspace_resizeend,$.workspace_delta)}})})},workspace_resizeend:function(){if(new Date()-$.workspace_rtime<$.workspace_delta){setTimeout($.workspace_resizeend,$.workspace_delta)}else{$.workspace_timeout=false;$(".workspace").each(function(){var b=window.innerHeight-$(".header").outerHeight()-20;$($(this).children()[0]).css({height:b});$($(this).children()[1]).css({height:b});$($(this).children()[2]).css({height:b})})}}});$.fn.extend({workspace_set:function(b){if(typeof b=="undefined"||$.type(b)!="object"){return}$(this).each(function(){b=$.ksort(b);var t={};var l={flex:"1 1 auto"};var m={};for(var n in b){switch(n){case"size":var a=b[n];a=a.split(" ");var r=$.val(0,a,{d:300,t:"number"});var p=$.val(1,a,{d:400,t:"number"});t.flex="0 0 "+(r+"px");m.flex="0 0 "+(p+"px");$(this).data("left_size",r);$(this).data("right_size",p);break;case"height":t.height=b[n];l.height=b[n];m.height=b[n];break;case"state":var s=$.val("state",b,{d:""});s=s.split(" ");var o=$.val(0,s,{d:1,t:"number"});var q=$.val(2,s,{d:0,t:"number"});var r=o<1?"0":$(this).data("left_size");var p=q<1?"0":$(this).data("right_size");t.flex="0 0 "+(r+"px");m.flex="0 0 "+(p+"px");break}}if($(this).children().length==3){$($(this).children()[0]).css(t);$($(this).children()[1]).css(l);$($(this).children()[2]).css(m)}})}});$.fn.extend({spinner:function(a){var b=$.val("size",a,{defaultvalue:"20px"});this.each(function(){var c=[];c.push('<div class="sk-fading-circle" style="width:'+b+";height:"+b+';">');c.push('<div class="sk-circle1 sk-circle"></div>');c.push('<div class="sk-circle2 sk-circle"></div>');c.push('<div class="sk-circle3 sk-circle"></div>');c.push('<div class="sk-circle4 sk-circle"></div>');c.push('<div class="sk-circle5 sk-circle"></div>');c.push('<div class="sk-circle6 sk-circle"></div>');c.push('<div class="sk-circle7 sk-circle"></div>');c.push('<div class="sk-circle8 sk-circle"></div>');c.push('<div class="sk-circle9 sk-circle"></div>');c.push('<div class="sk-circle10 sk-circle"></div>');c.push('<div class="sk-circle11 sk-circle"></div>');c.push('<div class="sk-circle12 sk-circle"></div>');c.push("</div>");$(this).html(c.join(""))})}});$.fn.extend({tab:function(d){var a=$.val("container",d,{d:""});var c=$.val("name",d,{d:""});var b=$.val("onchange",d);this.each(function(){var e=this;$(e).attr("data-type","tab");$(e).attr("data-name",c);$(e).data("options",d);$("li",e).click(function(){if(this.classList.contains("active")){}else{$("li",this.parentNode).removeClass("active");$(this).addClass("active");var h=this.innerHTML;var g=this.getAttribute("data-value");if(g==null){g=$.slug(h)}var f=$(this).index();if($(a).length>0){$(a+">*").addClass("off");$(a+">*:eq("+f+")").removeClass("off")}$.fire_event(b,[{text:h,value:g}],e)}})})},tab_set:function(d){var c=this;var b=$(c).data("options");var a=$.val("onchange",b);$("li",this).removeClass("active");$("li",this).each(function(){var e=this.innerHTML;var f=this.getAttribute("data-value");if(f==null){f=$.slug(e)}if(f==d){$(this).addClass("active");$.fire_event(a,[{text:e,value:f}],c)}})}});$.fn.extend({textarea:function(l){var j=$.val("placeholder",l,{d:""});var g=$.val("class",l,{d:""});var b=$.val("name",l,{d:""});var k=$.val("height",l,{d:"1em"});var c=$.val("width",l);var d=$.val("maxlength",l,{d:""});var h=$.val("onblur",l);var a=$.val("onkeyup",l);var e=$.val("onchange",l);var i=$.val("value",l,{d:""});var f={width:c};this.each(function(){var n=this;var m=[];m.push("<textarea rows='1' placeholder='"+j+"' style='height:"+k+";' maxlength='"+d+"'></textarea>");m.push("<span class='icon fa hidden'></span>");$(n).addClass("textarea");$(n).addClass(g);$(n).css(f);$(n).html(m.join(""));$(n).attr("data-type","textarea");$(n).attr("data-name",b);$(n).data("options",l);$("textarea",n).blur(function(o){$(n).textarea_validate();$.fire_event(h,[],n)}).keyup(function(o){$.fire_event(a,[this.value],n);if($(this).data("last_value")!=this.value){$.fire_event(e,[this.value],n)}$(this).data("last_value",this.value)});$("textarea",n).each(function(){this.setAttribute("style","height:"+(this.scrollHeight<=0?"":this.scrollHeight)+"px;overflow-y:hidden;")}).on("input",function(){this.style.height="auto";this.style.height=(this.scrollHeight)+"px"});if(i!=""){$(this).textarea_val(i)}})},textarea_val:function(b){if(typeof b=="undefined"){var a=[];$(this).each(function(){a.push($("textarea",this).val())});return a.length>1?a:(a.length==1?a[0]:"")}else{$(this).each(function(){$("textarea",this).val(b).each(function(){this.style.height="auto";this.style.height=(this.scrollHeight)+"px"})})}},textarea_placeholder:function(b){if(typeof b=="undefined"){var a=[];$(this).each(function(){a.push($("input",this).attr("placeholder"))});return a.length>1?a:(a.length==1?a[0]:"")}else{$(this).each(function(){$("input",this).attr("placeholder",b)})}},textarea_reset:function(){$(this).textarea_val("")},textarea_validate:function(){$(this).each(function(){var i=$(this).data("options");var e=$.val("required",i,{d:false});var d=$.val("required_text",i,{d:"Field required."});var b=$.val("validation",i,{d:""});var c=$.val("validation_text",i,{d:"Validation error."});var g=$(this).textarea_val();var a=true;var h="";if(e){if(g.toString().trim()==""){a=false;h=d}else{if(b!=""){switch(b){default:var f=new RegExp(b);a=f.test(g);if(!a){h=c}break}}}}else{if(g.toString().length>0){switch(b){default:var f=new RegExp(b);a=f.test(g);if(!a){h=c}break}}}if(!a){$(this).addClass("invalid");console.warn(h)}else{$(this).removeClass("invalid")}})}});$.fn.extend({textbox:function(m){var k=$.val("placeholder",m,{d:""});var b=$.val("name",m,{d:""});var i=$.val("class",m,{d:""});var l=$.val("value",m,{d:""});var f=$.val("readonly",m,{d:false});var d=$.val("maxlength",m,{d:""});var h=$.val("mode",m,{d:"text"});var c=$.val("width",m);var j=$.val("onblur",m);var a=$.val("onkeyup",m);var e=$.val("onchange",m);var g={width:c};this.each(function(){var o=this;var n=[];n.push($.p('<input type="$1" placeholder="$1" maxlength="$1"/>',[h,k,d]));n.push("<span class='icon fa hidden'></span>");$(o).addClass("textbox");$(o).addClass(i);$(o).css(g);$(o).html(n.join(""));$(o).attr("data-type","textbox");$(o).attr("data-name",b);$(o).data("options",m);$("input",o).val(l);$("input",o).blur(function(p){$(o).textbox_validate();$.fire_event(j,[],o)}).keyup(function(p){$.fire_event(a,[this.value],o);if($(this).data("last_value")!=this.value){$.fire_event(e,[this.value],o)}$(this).data("last_value",this.value)})})},textbox_val:function(b){if(typeof b=="undefined"){var a=[];$(this).each(function(){a.push($("input",this).val())});return a.length>1?a:(a.length==1?a[0]:"")}else{$(this).each(function(){$("input",this).val(b)})}},textbox_placeholder:function(b){if(typeof b=="undefined"){var a=[];$(this).each(function(){a.push($("input",this).attr("placeholder"))});return a.length>1?a:(a.length==1?a[0]:"")}else{$(this).each(function(){$("input",this).attr("placeholder",b)})}},textbox_reset:function(){$(this).textbox_val("")},textbox_validate:function(){$(this).each(function(){var i=$(this).data("options");var e=$.val("required",i,{d:false});var d=$.val("required_text",i,{d:"Field required."});var b=$.val("validation",i,{d:""});var c=$.val("validation_text",i,{d:"Validation error."});var g=$(this).textbox_val();var a=true;var h="";if(e){if(g.toString().trim()==""){a=false;h=d}else{if(b!=""){switch(b){default:var f=new RegExp(b);a=f.test(g);if(!a){h=c}break}}}}else{if(g.toString().length>0){switch(b){default:var f=new RegExp(b);a=f.test(g);if(!a){h=c}break}}}if(!a){$(this).addClass("invalid");console.warn(h)}else{$(this).removeClass("invalid")}})}});$.fn.extend({toggle:function(b){var c=$.val("class",b,{d:""});var a=$.val("name",b,{d:""});var d=$.val("value",b,{d:false});this.each(function(){var f=this;var e=[];e.push("<span class='main-toggle'></span>");f.innerHTML=e.join("");$(this).addClass("toggle");$(this).addClass(c);$(f).attr("data-type","toggle");if(a!=""){$(f).attr("data-name",a)}f.querySelector(".main-toggle").addEventListener("click",function(){if(this.parentNode.classList.contains("on")){this.parentNode.classList.remove("on")}else{this.parentNode.classList.add("on")}});$(f).toggle_val(d);return f})},toggle_val:function(a){if(!$(this).hasClass("toggle")){return undefined}if(typeof a=="undefined"){return $(this).hasClass("on")?1:0}else{if(a==true||a==1){$(this).addClass("on")}else{$(this).removeClass("on")}}}});$.extend({tooltip:function(b,d){var a=$(".tooltip");if(a.length==0){$.warn("No tooltip defined.")}$(a).addClass("on");var f=b.getBoundingClientRect();var c={};var e=[];console.log(b);c.left=f.left;console.log([f.top,f.top+f.height+$(a).outerHeight()+10,window.innerHeight]);if(f.top+f.height+$(a).outerHeight()+10>window.innerHeight){c.top=f.top-$(a).outerHeight()-10;e.push("<div class='arrow-down'></div>")}else{c.top=f.top+f.height+10;e.push("<div class='arrow-up'></div>")}e.push(d);$(a).html(e.join(""));$(a).css(c)},tooltip_remove:function(){$(".tooltip").removeClass("on")}});$.extend({date:function(j,h){var g=this;var i,e;var d=["Sun","Mon","Tues","Wednes","Thurs","Fri","Satur","January","February","March","April","May","June","July","August","September","October","November","December"];var b=/\\?(.?)/gi;var a=function(f,k){return e[f]?e[f]():k};var c=function(k,f){k=String(k);while(k.length<f){k="0"+k}return k};e={d:function(){return c(e.j(),2)},D:function(){return e.l().slice(0,3)},j:function(){return i.getDate()},l:function(){return d[e.w()]+"day"},N:function(){return e.w()||7},S:function(){var f=e.j();var k=f%10;if(k<=3&&parseInt((f%100)/10,10)==1){k=0}return["st","nd","rd"][k-1]||"th"},w:function(){return i.getDay()},z:function(){var k=new Date(e.Y(),e.n()-1,e.j());var f=new Date(e.Y(),0,1);return Math.round((k-f)/86400000)},W:function(){var k=new Date(e.Y(),e.n()-1,e.j()-e.N()+3);var f=new Date(k.getFullYear(),0,4);return c(1+Math.round((k-f)/86400000/7),2)},F:function(){return d[6+e.n()]},m:function(){return c(e.n(),2)},M:function(){return e.F().slice(0,3)},n:function(){return i.getMonth()+1},t:function(){return(new Date(e.Y(),e.n(),0)).getDate()},L:function(){var f=e.Y();return f%4===0&f%100!==0|f%400===0},o:function(){var l=e.n();var f=e.W();var k=e.Y();return k+(l===12&&f<9?1:l===1&&f>9?-1:0)},Y:function(){return i.getFullYear()},y:function(){return e.Y().toString().slice(-2)},a:function(){return i.getHours()>11?"pm":"am"},A:function(){return e.a().toUpperCase()},B:function(){var k=i.getUTCHours()*3600;var f=i.getUTCMinutes()*60;var l=i.getUTCSeconds();return c(Math.floor((k+f+l+3600)/86.4)%1000,3)},g:function(){return e.G()%12||12},G:function(){return i.getHours()},h:function(){return c(e.g(),2)},H:function(){return c(e.G(),2)},i:function(){return c(i.getMinutes(),2)},s:function(){return c(i.getSeconds(),2)},u:function(){return c(i.getMilliseconds()*1000,6)},e:function(){throw"Not supported (see source code of date() for timezone on how to add support)"},I:function(){var k=new Date(e.Y(),0);var m=Date.UTC(e.Y(),0);var f=new Date(e.Y(),6);var l=Date.UTC(e.Y(),6);return((k-m)!==(f-l))?1:0},O:function(){var k=i.getTimezoneOffset();var f=Math.abs(k);return(k>0?"-":"+")+c(Math.floor(f/60)*100+f%60,4)},P:function(){var f=e.O();return(f.substr(0,3)+":"+f.substr(3,2))},T:function(){return"UTC"},Z:function(){return -i.getTimezoneOffset()*60},c:function(){return"Y-m-d\\TH:i:sP".replace(b,a)},r:function(){return"D, d M Y H:i:s O".replace(b,a)},U:function(){return i/1000|0}};this.date=function(k,f){g=this;i=(f===undefined?new Date():(f instanceof Date)?new Date(f):new Date(f*1000));return k.replace(b,a)};return this.date(j,h)},uniqid:function(){if(typeof $.__UNIQID=="undefined"){$.__UNIQID=0}return ++$.__UNIQID},val:function(g,b,j){if(typeof j=="undefined"||$.type(j)!="object"){j={}}var f=null;var h=typeof j.default_value!="undefined"?j.default_value:(typeof j.d!="undefined"?j.d:null);var c=typeof j.t!="undefined"?j.t:(typeof j.datatype!="undefined"?j.datatype:"string");var e=typeof j.required!="undefined"&&e==1?true:false;if($.type(b)=="object"){if($.type(g)=="array"){f=null;for(var d=0;d<g.length;d++){var a=g[d];v=$.val(a,b,{default_value:null});if(v!=null){f=v;break}}}else{if($.type(g)=="string"||$.type(g)=="number"){if(typeof b[g]!="undefined"){f=b[g]}}}}else{if($.type(b)=="array"){if(typeof b[g]!="undefined"){f=b[g]}}}if(e){if(f==null){}}else{f=f==null&&h!=null?h:f}switch(c){case"number":case"integer":case"float":case"double":f=parseFloat(f);break}return f},strtotime:function(q,d){var m,j,n,l,f,p,b,k,a,o,h,e=false;if(!q){return e}if(/^\d{8}$/.test(q)){q=q.substr(0,4)+"-"+q.substr(4,2)+"-"+q.substr(6,2)}q=q.replace(/^\s+|\s+$/g,"").replace(/\s{2,}/g," ").replace(/[\t\r\n]/g,"").toLowerCase();j=q.match(/^(\d{1,4})([\-\.\/\:])(\d{1,2})([\-\.\/\:])(\d{1,4})(?:\s(\d{1,2}):(\d{2})?:?(\d{2})?)?(?:\s([A-Z]+)?)?$/);if(j&&j[2]===j[4]){if(j[1]>1901){switch(j[2]){case"-":if(j[3]>12||j[5]>31){return e}return new Date(j[1],parseInt(j[3],10)-1,j[5],j[6]||0,j[7]||0,j[8]||0,j[9]||0)/1000;case".":return e;case"/":if(j[3]>12||j[5]>31){return e}return new Date(j[1],parseInt(j[3],10)-1,j[5],j[6]||0,j[7]||0,j[8]||0,j[9]||0)/1000}}else{if(j[5]>1901){switch(j[2]){case"-":if(j[3]>12||j[1]>31){return e}return new Date(j[5],parseInt(j[3],10)-1,j[1],j[6]||0,j[7]||0,j[8]||0,j[9]||0)/1000;case".":if(j[3]>12||j[1]>31){return e}return new Date(j[5],parseInt(j[3],10)-1,j[1],j[6]||0,j[7]||0,j[8]||0,j[9]||0)/1000;case"/":if(j[1]>12||j[3]>31){return e}return new Date(j[5],parseInt(j[1],10)-1,j[3],j[6]||0,j[7]||0,j[8]||0,j[9]||0)/1000}}else{switch(j[2]){case"-":if(j[3]>12||j[5]>31||(j[1]<70&&j[1]>38)){return e}l=j[1]>=0&&j[1]<=38?+j[1]+2000:j[1];return new Date(l,parseInt(j[3],10)-1,j[5],j[6]||0,j[7]||0,j[8]||0,j[9]||0)/1000;case".":if(j[5]>=70){if(j[3]>12||j[1]>31){return e}return new Date(j[5],parseInt(j[3],10)-1,j[1],j[6]||0,j[7]||0,j[8]||0,j[9]||0)/1000}if(j[5]<60&&!j[6]){if(j[1]>23||j[3]>59){return e}n=new Date();return new Date(n.getFullYear(),n.getMonth(),n.getDate(),j[1]||0,j[3]||0,j[5]||0,j[9]||0)/1000}return e;case"/":if(j[1]>12||j[3]>31||(j[5]<70&&j[5]>38)){return e}l=j[5]>=0&&j[5]<=38?+j[5]+2000:j[5];return new Date(l,parseInt(j[1],10)-1,j[3],j[6]||0,j[7]||0,j[8]||0,j[9]||0)/1000;case":":if(j[1]>23||j[3]>59||j[5]>59){return e}n=new Date();return new Date(n.getFullYear(),n.getMonth(),n.getDate(),j[1]||0,j[3]||0,j[5]||0)/1000}}}}if(q==="now"){return d===null||isNaN(d)?new Date().getTime()/1000|0:d|0}if(!isNaN(m=Date.parse(q))){return m/1000|0}f=d?new Date(d*1000):new Date();p={sun:0,mon:1,tue:2,wed:3,thu:4,fri:5,sat:6};b={yea:"FullYear",mon:"Month",day:"Date",hou:"Hours",min:"Minutes",sec:"Seconds"};function g(t,s,i){var u,r=p[s];if(typeof r!=="undefined"){u=r-f.getDay();if(u===0){u=7*i}else{if(u>0&&t==="last"){u-=7}else{if(u<0&&t==="next"){u+=7}}}f.setDate(f.getDate()+u)}}function c(w){var x=w.split(" "),t=x[0],i=x[1].substring(0,3),u=/\d+/.test(t),s=x[2]==="ago",r=(t==="last"?-1:1)*(s?-1:1);if(u){r*=parseInt(t,10)}if(b.hasOwnProperty(i)&&!x[1].match(/^mon(day|\.)?$/i)){return f["set"+b[i]](f["get"+b[i]]()+r)}if(i==="wee"){return f.setDate(f.getDate()+(r*7))}if(t==="next"||t==="last"){g(t,i,r)}else{if(!u){return false}}return true}a="(years?|months?|weeks?|days?|hours?|minutes?|min|seconds?|sec|sunday|sun\\.?|monday|mon\\.?|tuesday|tue\\.?|wednesday|wed\\.?|thursday|thu\\.?|friday|fri\\.?|saturday|sat\\.?)";o="([+-]?\\d+\\s"+a+"|(last|next)\\s"+a+")(\\sago)?";j=q.match(new RegExp(o,"gi"));if(!j){return e}for(h=0,k=j.length;h<k;h++){if(!c(j[h])){return e}}return(f.getTime()/1000)},mktime:function(){var f=new Date(),b=arguments,a=0,c=["Hours","Minutes","Seconds","Month","Date","FullYear"];for(a=0;a<c.length;a++){if(typeof b[a]==="undefined"){b[a]=f["get"+c[a]]();b[a]+=(a===3)}else{b[a]=parseInt(b[a],10);if(isNaN(b[a])){return false}}}b[5]+=(b[5]>=0?(b[5]<=69?2000:(b[5]<=100?1900:0)):0);f.setFullYear(b[5],b[3]-1,b[4]);f.setHours(b[0],b[1],b[2]);return(f.getTime()/1000>>0)-(f.getTime()<0)},date_parse:function(a){switch(a){case"this_month":a=$.date("Ym")+"01-"+$.date("Ymd",$.mktime(0,0,0,parseInt($.date("m"))+1,0,$.date("Y")));break}return a},start_day_of_month:function(a,b){var c=$.date("N",$.mktime(0,0,0,b,1,a));return c},last_date_of_month:function(b,c){var e=27;do{e++;var a=parseInt($.date("j",$.mktime(0,0,0,c,e,b)));if(a!=e){e--;break}}while(true);return e},api_get:function(c,e,f,b){var a=$.http_build_query(e);c+=a.length>0?"?"+a:"";var d=new XMLHttpRequest();d.open("GET",c,true);d.addEventListener("load",function(){if(this.readyState==4){var i=$.eval_as_object(this.responseText);var g=$.val("error",i,{d:0,datatype:"integer"});var h=$.val("error_message",i,{d:""});if(g>0){if(b!=null){$.fire_event(b,[this.responseText],d)}else{alert(h)}}else{$.fire_event(f,[i],d)}}});d.addEventListener("error",function(){if(typeof b!="undefined"||b!=null){$.fire_event(b)}else{console.log(this.responseText)}});d.send();return d},api_post:function(b,d,e,a){var c=new XMLHttpRequest();c.open("POST",b,true);c.addEventListener("load",function(){if(this.readyState==4){var h=$.eval_as_object(this.responseText);var f=$.val("error",h,{d:0,datatype:"integer"});var g=$.val("error_message",h,{d:""});if(parseInt(f)==0){$.fire_event(e,[h],c)}else{if(typeof a!="undefined"||a!=null){$.fire_event(a,[{error:f,error_message:g}])}else{alert(JSON.stringify(h,null,2))}}}});c.addEventListener("error",function(){if(typeof a!="undefined"||a!=null){$.fire_event(a)}else{console.log(this.responseText)}});c.send(JSON.stringify(d));return c},http_build_query:function(c,a,d){var b=[];if($.type(c)=="object"){Object.keys(c).forEach(function(h){var e=h;a&&!isNaN(e)?e=a+e:"";var e=encodeURIComponent(e.toString().replace(/[!'()*]/g,escape));d?e=d+"["+e+"]":"";if(typeof c[h]==="object"){var g=$.http_build_query(c[h],null,e);b.push(g)}else{var f=encodeURIComponent(c[h].toString().replace(/[!'()*]/g,escape));b.push(e+"="+f)}})}return b.join("&")},fire_event:function(callback,params,thisArg){if(typeof thisArg=="undefined"){thisArg=null}if($.type(callback)=="string"){callback=eval(callback)}if($.type(callback)=="function"){return callback.apply(thisArg,params)}},eval_as_object:function(exp){try{return eval("("+exp+")")}catch(e){return null}},ux:function(a){a=typeof a=="undefined"||!(a instanceof HTMLElement)?document.body:a;var b=a.querySelectorAll("*[data-type]");$(b).each(function(){var d=this.getAttribute("data-type");if(typeof $(this)[d]=="function"){var c=$.options_from_html(this);$(this)[d](c)}else{console.warn("Unknown ux "+d)}})},el_get:function(a){if($(a).attr("data-type")!=null){var c=$(a).attr("data-type");if(typeof $(a)[c+"_get"]=="function"){return $(a)[c+"_get"]()}return null}else{var d={};var b=$("*[data-type]",a);$(b).each(function(){var f=this;var g=$.el_get(f);var e=f.getAttribute("data-name");if(e==null){e="undefined"}d[e]=g});return d}},el_set:function(a,b){$("*[data-type]",a).each(function(){var d=this.getAttribute("data-type");var c=this.getAttribute("data-name");var e=$.val(c,b);if(typeof $(this)[d+"_set"]=="function"){$(this)[d+"_set"](e)}else{console.warn("unknown method")}})},options_from_html:function(el){var options=null;if(el.getAttribute("data-options")!=null){try{options=eval("("+el.getAttribute("data-options")+")")}catch(e){options=null}}else{var options={};for(var i=0;i<el.attributes.length;i++){options[el.attributes[i].nodeName.replace("data-","")]=el.attributes[i].nodeValue}}return options},cookie_getitem:function(a){if(!a){return null}return decodeURIComponent(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+encodeURIComponent(a).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1"))||null},cookie_setitem:function(d,g,c,b,a,e){if(!d||/^(?:expires|max\-age|path|domain|secure)$/i.test(d)){return false}var f="";if(c){switch(c.constructor){case Number:f=c===Infinity?"; expires=Fri, 31 Dec 9999 23:59:59 GMT":"; max-age="+c;break;case String:f="; expires="+c;break;case Date:f="; expires="+c.toUTCString();break}}document.cookie=encodeURIComponent(d)+"="+encodeURIComponent(g)+f+(a?"; domain="+a:"")+(b?"; path="+b:"")+(e?"; secure":"");return true},cookie_removeitem:function(c,b,a){if(!this.hasItem(c)){return false}document.cookie=encodeURIComponent(c)+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT"+(a?"; domain="+a:"")+(b?"; path="+b:"");return true},cookie_hasitem:function(a){if(!a){return false}return(new RegExp("(?:^|;\\s*)"+encodeURIComponent(a).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=")).test(document.cookie)},cookie_keys:function(){var a=document.cookie.replace(/((?:^|\s*;)[^\=]+)(?=;|$)|^\s*|\s*(?:\=[^;]*)?(?:\1|$)/g,"").split(/\s*(?:\=[^;]*)?;\s*/);for(var c=a.length,b=0;b<c;b++){a[b]=decodeURIComponent(a[b])}return a},slug:function(c){var b="";var a=$.trim(c);b=a.replace(/[^a-z0-9-]/gi,"-").replace(/-+/g,"-").replace(/^-|-$/g,"");return b.toLowerCase()},warn:function(a){console.warn(a)},array_merge:function(){var g=Array.prototype.slice.call(arguments);var l=g.length;var m;var b={};var a="";var n=0;var c=0;var e=0;var f=0;var h=Object.prototype.toString;var d=true;for(e=0;e<l;e++){if(h.call(g[e])!=="[object Array]"){d=false;break}}if(d){d=[];for(e=0;e<l;e++){d=d.concat(g[e])}return d}for(e=0,f=0;e<l;e++){m=g[e];if(h.call(m)==="[object Array]"){for(c=0,n=m.length;c<n;c++){b[f++]=m[c]}}else{for(a in m){if(m.hasOwnProperty(a)){if(parseInt(a,10)+""===a){b[f++]=m[a]}else{b[a]=m[a]}}}}}return b},in_array:function(e,d,c){var b="";var a=!!c;if(a){for(b in d){if(d[b]===e){return true}}}else{for(b in d){if(d[b]==e){return true}}}return false},number_format:function(e,c,h,g){e=(e+"").replace(/[^0-9+\-Ee.]/g,"");var b=!isFinite(+e)?0:+e;var a=!isFinite(+c)?0:Math.abs(c);var j=(typeof g==="undefined")?",":g;var d=(typeof h==="undefined")?".":h;var i="";var f=function(o,m){var l=Math.pow(10,m);return""+(Math.round(o*l)/l).toFixed(m)};i=(a?f(b,a):""+Math.round(b)).split(".");if(i[0].length>3){i[0]=i[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,j)}if((i[1]||"").length<a){i[1]=i[1]||"";i[1]+=new Array(a-i[1].length+1).join("0")}return i.join(d)},qs:(function(d){if(d==""){return{}}var c={};for(var e=0;e<d.length;++e){var f=d[e].split("=",2);if(f.length==1){c[f[0]]=""}else{c[f[0]]=decodeURIComponent(f[1].replace(/\+/g," "))}}return c})(window.location.search.substr(1).split("&")),p:function(g,f){var e=g.match(/\$\w+/g);if(e!=null){if($.type(f)=="array"){for(var c=0;c<e.length;c++){var a=e[c];var d=typeof f[c]!="undefined"?f[c]:"";g=g.replace(a,d)}}else{if($.type(f)=="object"){for(var c=0;c<e.length;c++){var a=e[c];var b=a.replace("$","");var d=typeof f[b]!="undefined"?f[b]:"";g=g.replace(a,d)}}}}return g},array_key_count:function(c){var b=0;for(var a in c){b++}return b},object_value_min:function(c){var b=-1;if($.type(c)=="object"){for(var a in c){var d=c[a];if(b==-1||parseFloat(d)<parseFloat(b)){b=d}}}return b},object_value_max:function(c){var b=-1;if($.type(c)=="object"){for(var a in c){var d=c[a];if(b==-1||parseFloat(d)>parseFloat(b)){b=d}}}return b},ksort:function(d){var c=Object.keys(d).sort(),a={};for(var b in c){a[c[b]]=d[c[b]]}return a},str_pad:function(b,f,d,g){var e="";var a;var c=function(i,h){var j="";while(j.length<h){j+=i}j=j.substr(0,h);return j};b+="";d=d!==undefined?d:" ";if(g!=="STR_PAD_LEFT"&&g!=="STR_PAD_RIGHT"&&g!=="STR_PAD_BOTH"){g="STR_PAD_RIGHT"}if((a=f-b.length)>0){if(g==="STR_PAD_LEFT"){b=c(d,a)+b}else{if(g==="STR_PAD_RIGHT"){b=b+c(d,a)}else{if(g==="STR_PAD_BOTH"){e=c(d,Math.ceil(a/2));b=e+b+e;b=b.substr(0,f)}}}}return b},template_parse:function(k,a){var d=k.match(/<!--IF.+?(?=-->)(.+)?(?=<!--END-->)<!--END-->/gi,"gi");if($.type(d)=="array"){for(var c=0;c<d.length;c++){var e=d[c];var d=e.match(/\(.+?(?=\))\)/gi,"gi");var j=d[0];j=j.substr(1,j.length-2);var g=new Function("obj","return "+j+";");if(!g(a)){k=k.replace(e,"","gi")}}}var d=k.match(/<!--IF_NOT_EMPTY.+?(?=-->)(.+)?(?=<!--END-->)<!--END-->/gi,"gi");if($.type(d)=="array"){for(var c=0;c<d.length;c++){var e=d[c];var d=e.match(/\(\w+\)/gi,"gi");var j=d[0];j=j.substr(1,j.length-2);if($.val(j,a,{d:""})==""){k=k.replace(e,"","gi")}}}var d=k.match(/{\w+(:\w+)*?(?=})}/gi,"gi");if($.type(d)=="array"){for(var c=0;c<d.length;c++){var e=d[c];var j=e.substr(1,e.length-2);var b="string";if(j.indexOf(":")>=0){var l=j.split(":");j=l[0];b=l[1]}var h=$.val(j,a,{d:"-"});h=$.convert_datatype(h,b);k=k.replace(e,h,"gi")}}return k},convert_datatype:function(b,a){switch(a){case"date":b=$.date("j M Y",$.strtotime(b));break}return b},calc_size:function(b,a){a=typeof a=="undefined"||!a?window.innerWidth:a;if(b.indexOf("%")>=0){b=b.replace("%","","gi");if(!isNaN(parseFloat(b))){b=parseFloat(b)/100*a}}return b},download:function(c){var b=document.createElement("a");b.href=c;b.setAttribute("download",c);document.body.appendChild(b);b.click();document.body.removeChild(b)},ux_init:function(a){a=typeof a=="undefined"||!(a instanceof HTMLElement)?document.body:a;$("*[data-type]",a).each(function(){var c=this.getAttribute("data-type");if(typeof $(this)[c]=="function"){var b=$.options_from_html(this);$(this)[c](b)}else{console.warn("Unknown ux "+c)}});$("*[data-action]",a).each(function(){switch(this.getAttribute("data-action")){case"modal.close":$(this).on("click.data-action",function(){$(this).closest(".modal").modal_close()});break}});$(window).on("click",$.popup_close_all).on("scroll",$.popup_close_all);$(window).on("keyup",function(b){switch(b.keyCode){case 27:$(".modal").modal_close();break}})},istrue:function(a){if(typeof a!="undefined"&&(parseInt(a)==1||a===true)){return true}return false}});var oldVal=$.fn.val;$.fn.val=function(b){var a=$(this).attr("data-type");if(a!=null&&typeof $(this)[a+"_val"]!="undefined"){return $(this)[a+"_val"].apply(this,arguments)}else{if($(this).hasClass("container")){return $(this).container_val.apply(this,arguments)}else{return oldVal.apply(this,arguments)}}};$.fn.placeholder=function(){var a=$(this).attr("data-type");if(a!=null&&typeof $(this)[a+"_placeholder"]!="undefined"){return $(this)[a+"_placeholder"].apply(this,arguments)}else{if($(this).hasClass("container")){return $(this).container_placeholder.apply(this,arguments)}}};$.fn.readonly=function(){var a=$(this).attr("data-type");if(a!=null&&typeof $(this)[a+"_readonly"]!="undefined"){return $(this)[a+"_readonly"].apply(this,arguments)}else{if($(this).hasClass("container")){return $(this).container_readonly.apply(this,arguments)}}};$.fn.reset=function(){var a=$(this).attr("data-type");if(a!=null&&typeof $(this)[a+"_reset"]!="undefined"){return $(this)[a+"_reset"].apply(this,arguments)}else{if($(this).hasClass("container")){return $(this).container_reset.apply(this,arguments)}}};String.prototype.capitalize=function(){return this.charAt(0).toUpperCase()+this.slice(1)};$($.ux_init);$.fn.extend({vfields:function(a){var b=$.val("value",a);$(this).each(function(){var c=this;$(c).addClass("vfields");$(c).data("options",a);if($.type(b)=="array"){$(c).form_set(b)}})},form_set:function(a){if(typeof a=="undefined"||$.type(a)!="array"){return}$(this).each(function(){var b=this;var d=$(this).data("options");var c=$.val("html_callback",d);$(a).each(function(){var f=this;var e=[];e.push("<table><tr><td class='vfields-col1' align='center' style='width:24px'>");e.push("<span class='fa fa-times-circle selectable vfields-remove hoverable'></span>");e.push("</td><td class='vfields-col2'></td></tr></table>");var g=document.createElement("div");g.className="vfields-item";g.innerHTML=e.join("");$(b).append(g);$.fire_event(c,[f],$(".vfields-col2",g))});$(".vfields-remove",b).click(function(){$(this).closest(".vfields-item").remove()})})},vfields_get:function(){var a=[];$(this).each(function(){var b=this;$(".vfields-col2",b).each(function(){var c=$.el_get(this);a.push(c)})});return a}});$.fn.extend({webeditor:function(b){var a=$.val("height",b);this.each(function(){var d=$.uniqid();var c=[];c.push($.p('<textarea id="$1"></textarea>',["webeditor"+d]));$(this).addClass("webeditor");$(this).html(c.join(""));$(this).data("options",b);CKEDITOR.replace("webeditor"+d,{height:a})})},webeditor_get:function(b){var a=[];this.each(function(){var d=$("textarea",this).attr("id");if(typeof CKEDITOR.instances[d]!="undefined"){var c=CKEDITOR.instances[d].getData();a.push(c)}});return a.length==1?a[0]:(a.length>1?a:null)},webeditor_set:function(a){this.each(function(){var b=$("textarea",this).attr("id");if(typeof CKEDITOR.instances[b]!="undefined"){CKEDITOR.instances[b].setData(a)}})}});$.fn.extend({widget:function(a){this.each(function(){var o=this;var m=$.val("type",a);var c=$.val("src",a);var n=$.val("title",a,{default_value:"Untitled"});var e=$.val("columns",a);var l=$.uniqid();var k=$.val("default_presets",a);var j=parseInt($.val("preset_idx",a,{d:0}));if(isNaN(j)){j=0}var h=[];h.push($.p('<div class="widget-head padding10">',[n]));h.push($.p("<table><tr>",[]));h.push($.p('<td style="width:100%">',[]));h.push($.p('<h5 class="padding10">$1</h5>',[n]));h.push($.p("</td>",[n]));h.push($.p("<td>",[]));h.push($.p('<span id="$1"></span>',["preset-selector"+l]));h.push($.p('<span class="icon icon-reload fa fa-refresh padding10 selectable"></span>',[]));h.push($.p('<span class="icon icon-customize fa fa-ellipsis-h padding10 selectable"></span>',[]));h.push($.p("</td>",[]));h.push($.p("</tr></table>",[]));h.push($.p("</div>",[]));h.push($.p('<div class="modal" id="$1"></div>',["customize"+l]));var p=null;var d=[];var g="";if($.type(k)=="array"){for(var f=0;f<k.length;f++){if(f==j){g=k[f]["text"];p=k[f]}d.push({text:k[f]["text"],value:k[f]["text"]})}}switch(m){case"grid":h.push($.p('<div class="widget-body align-center margin10 ">',[]));h.push($.p('<span id="$1"></span>',["gridhead"+l]));h.push($.p("<div></div>",[]));h.push($.p('<span id="$1"></span>',["grid"+l]));h.push($.p("</div>",[]));$(o).html(h.join(""));var e=$.val("columns",a);$("#gridhead"+l,o).gridhead({columns:e,grid:"#grid"+l});var q=$(o).outerHeight()-$(".widget-head",o).outerHeight()-$("#gridhead"+l,o).outerHeight()-15;$("#grid"+l,o).grid({columns:e,height:q});break;case"chart":h.push($.p('<div class="widget-body align-center margin10 ">',[]));h.push($.p('<span id="$1"></span>',["chart"+l]));h.push($.p("</div>",[]));$(o).html(h.join(""));var b=$.val("chart_type",a);var q=$(o).outerHeight()-$(".widget-head",o).outerHeight()-$("#gridhead"+l,o).outerHeight()-15;$("#chart"+l).chart({width:"100%",height:q,padding:0,type:b});break;case"metric":h.push($.p('<div class="widget-body align-left margin10 ">',[]));h.push($.p('<span id="$1"></span>',["metric"+l]));h.push($.p("</div>",[]));$(o).html(h.join(""));break}$("#preset-selector"+l).dropdown({items:d,value:g,onchange:function(){$(o).widget_load()}});$("#customize"+l).gridsetting({onchange:function(s){var r=$(this).closest(".widget");var i=$(r).data("options");i=$.array_merge(i,s);$(r).data("options",i);$(o).widget_load()}});$(".icon-reload",o).click(function(){$(o).widget_load()});$(".icon-customize",o).click(function(){var t=$(this).closest(".widget");var r=$(t).data("options");var s=$.val("columns",r);var i=$.val("default_presets",r);$("#customize"+l).gridsetting_open({columns:s,presets:i,active_idx:0})});$(o).data("options",a);$(o).data("uid",l);$(o).widget_load()})},widget_load:function(){this.each(function(){var k=this;var m=$(k).data("options");var a=$.val("src",m);var j=$.val("type",m);var g=$.val("default_presets",m);var f=parseInt($.val("preset_idx",m,{d:0}));var h=$(k).data("uid");var c=$("#preset-selector"+h).dropdown_get();var l=null;var b=[];var e="";if($.type(g)=="array"){for(var d=0;d<g.length;d++){if(g[d]["text"]==c){e=g[d]["text"];l=g[d]}b.push({text:g[d]["text"],value:g[d]["text"]})}}switch(j){case"metric":$.api_post(a,l,function(i){$("#metric"+h).html("<h2>"+i.data+"</h2>")});break;case"grid":$.api_post(a,l,function(i){var n=$.val("data",i);$("#grid"+h,k).grid_set(n)});break;case"chart":$.api_post(a,l,function(i){$("#chart"+h).chart_set(i.data)});break}})}});$.extend({workspace_init:function(){$(".workspace").each(function(){var a=window.innerHeight-$(".header").outerHeight()-20;$(this).workspace_set({state:$(this).attr("data-state"),size:$(this).attr("data-size"),height:a});$.workspace_rtime;$.workspace_timeout=false;$.workspace_delta=200;$(window).resize(function(){$.workspace_rtime=new Date();if($.workspace_timeout===false){$.workspace_timeout=true;setTimeout($.workspace_resizeend,$.workspace_delta)}})})},workspace_resizeend:function(){if(new Date()-$.workspace_rtime<$.workspace_delta){setTimeout($.workspace_resizeend,$.workspace_delta)}else{$.workspace_timeout=false;$(".workspace").each(function(){var a=window.innerHeight-$(".header").outerHeight()-20;$($(this).children()[0]).css({height:a});$($(this).children()[1]).css({height:a});$($(this).children()[2]).css({height:a})})}}});$.fn.extend({workspace_set:function(a){if(typeof a=="undefined"||$.type(a)!="object"){return}$(this).each(function(){a=$.ksort(a);var b={};var j={flex:"1 1 auto"};var i={};for(var h in a){switch(h){case"size":var k=a[h];k=k.split(" ");var d=$.val(0,k,{d:300,t:"number"});var f=$.val(1,k,{d:400,t:"number"});b.flex="0 0 "+(d+"px");i.flex="0 0 "+(f+"px");$(this).data("left_size",d);$(this).data("right_size",f);break;case"height":b.height=a[h];j.height=a[h];i.height=a[h];break;case"state":var c=$.val("state",a,{d:""});c=c.split(" ");var g=$.val(0,c,{d:1,t:"number"});var e=$.val(2,c,{d:0,t:"number"});var d=g<1?"0":$(this).data("left_size");var f=e<1?"0":$(this).data("right_size");b.flex="0 0 "+(d+"px");i.flex="0 0 "+(f+"px");break}}if($(this).children().length==3){$($(this).children()[0]).css(b);$($(this).children()[1]).css(j);$($(this).children()[2]).css(i)}})}});